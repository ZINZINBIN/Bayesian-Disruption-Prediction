================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 209.28it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 206.54it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 204.69it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 206.69it/s]remove invalid data : null / measurement error:  17%|█▋        | 106/616 [00:00<00:02, 208.40it/s]remove invalid data : null / measurement error:  21%|██        | 128/616 [00:00<00:02, 211.26it/s]remove invalid data : null / measurement error:  24%|██▍       | 150/616 [00:00<00:02, 214.05it/s]remove invalid data : null / measurement error:  28%|██▊       | 172/616 [00:00<00:02, 215.68it/s]remove invalid data : null / measurement error:  31%|███▏      | 194/616 [00:00<00:01, 213.28it/s]remove invalid data : null / measurement error:  35%|███▌      | 216/616 [00:01<00:01, 212.49it/s]remove invalid data : null / measurement error:  39%|███▊      | 238/616 [00:01<00:01, 212.11it/s]remove invalid data : null / measurement error:  42%|████▏     | 260/616 [00:01<00:01, 211.88it/s]remove invalid data : null / measurement error:  46%|████▌     | 282/616 [00:01<00:01, 211.69it/s]remove invalid data : null / measurement error:  49%|████▉     | 304/616 [00:01<00:01, 210.75it/s]remove invalid data : null / measurement error:  53%|█████▎    | 326/616 [00:01<00:01, 209.83it/s]remove invalid data : null / measurement error:  56%|█████▋    | 347/616 [00:01<00:01, 209.17it/s]remove invalid data : null / measurement error:  60%|██████    | 370/616 [00:01<00:01, 214.47it/s]remove invalid data : null / measurement error:  64%|██████▍   | 397/616 [00:01<00:00, 228.66it/s]remove invalid data : null / measurement error:  69%|██████▉   | 424/616 [00:01<00:00, 239.55it/s]remove invalid data : null / measurement error:  73%|███████▎  | 448/616 [00:02<00:00, 237.11it/s]remove invalid data : null / measurement error:  77%|███████▋  | 472/616 [00:02<00:00, 231.84it/s]remove invalid data : null / measurement error:  81%|████████  | 496/616 [00:02<00:00, 225.51it/s]remove invalid data : null / measurement error:  84%|████████▍ | 519/616 [00:02<00:00, 218.90it/s]remove invalid data : null / measurement error:  88%|████████▊ | 541/616 [00:02<00:00, 214.78it/s]remove invalid data : null / measurement error:  91%|█████████▏| 563/616 [00:02<00:00, 212.14it/s]remove invalid data : null / measurement error:  95%|█████████▍| 585/616 [00:02<00:00, 210.78it/s]remove invalid data : null / measurement error:  99%|█████████▊| 607/616 [00:02<00:00, 209.74it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 215.17it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 241.17it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 240.81it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 241.66it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 243.76it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 244.81it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 246.13it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 246.90it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 246.69it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 247.13it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 247.41it/s]replace nan value:  54%|█████▎    | 276/515 [00:01<00:00, 248.31it/s]replace nan value:  58%|█████▊    | 301/515 [00:01<00:00, 247.24it/s]replace nan value:  63%|██████▎   | 326/515 [00:01<00:00, 247.50it/s]replace nan value:  68%|██████▊   | 351/515 [00:01<00:00, 244.67it/s]replace nan value:  73%|███████▎  | 376/515 [00:01<00:00, 246.08it/s]replace nan value:  78%|███████▊  | 401/515 [00:01<00:00, 246.50it/s]replace nan value:  83%|████████▎ | 426/515 [00:01<00:00, 246.57it/s]replace nan value:  88%|████████▊ | 451/515 [00:01<00:00, 245.12it/s]replace nan value:  92%|█████████▏| 476/515 [00:01<00:00, 245.74it/s]replace nan value:  97%|█████████▋| 501/515 [00:02<00:00, 246.59it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 245.93it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.79it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.79it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.39it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.63it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 74.01it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.75it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.91it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 49.04it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 55.81it/s]generate index:  15%|█▌        | 78/515 [00:01<00:07, 54.66it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.62it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.18it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.92it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.77it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 64.26it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 72.07it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 72.16it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.41it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.03it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.91it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.01it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.09it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.40it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.83it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.77it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.94it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.11it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 88.99it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 88.94it/s]generate index:  49%|████▉     | 253/515 [00:03<00:03, 74.05it/s]generate index:  51%|█████     | 262/515 [00:03<00:03, 76.84it/s]generate index:  53%|█████▎    | 271/515 [00:03<00:03, 80.13it/s]generate index:  54%|█████▍    | 280/515 [00:04<00:03, 66.66it/s]generate index:  56%|█████▌    | 288/515 [00:04<00:03, 66.76it/s]generate index:  57%|█████▋    | 296/515 [00:04<00:03, 65.76it/s]generate index:  59%|█████▉    | 303/515 [00:04<00:03, 64.33it/s]generate index:  60%|██████    | 311/515 [00:04<00:03, 65.82it/s]generate index:  62%|██████▏   | 318/515 [00:04<00:03, 60.62it/s]generate index:  63%|██████▎   | 326/515 [00:04<00:02, 64.88it/s]generate index:  65%|██████▍   | 333/515 [00:04<00:02, 65.85it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 48.56it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 46.78it/s]generate index:  68%|██████▊   | 352/515 [00:05<00:03, 46.06it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 58.61it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 73.17it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 77.10it/s]generate index:  76%|███████▋  | 393/515 [00:05<00:01, 75.61it/s]generate index:  78%|███████▊  | 401/515 [00:05<00:01, 75.26it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 64.21it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.81it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 77.68it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 55.17it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 51.04it/s]generate index:  88%|████████▊ | 455/515 [00:06<00:00, 60.91it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.83it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.56it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.76it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.54it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 65.26it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 71.15it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 65.61it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:03, 49.63it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 143.60it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 175.88it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 192.75it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 200.67it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 216.00it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 213.91it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 196.32it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 256.34it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 257.70it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 258.16it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 255.44it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 256.89it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 256.82it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.96it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.09it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.51it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.08it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.51it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.94it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.88it/s]generate index:  45%|████▌     | 59/131 [00:00<00:01, 67.03it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.80it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 70.05it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.68it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.39it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.29it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.36it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 49.16it/s]generate index:  89%|████████▊ | 116/131 [00:01<00:00, 58.61it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 70.90it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.37it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 97.01it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:00, 162.18it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 188.26it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 200.40it/s]remove invalid data : null / measurement error:  50%|█████     | 97/193 [00:00<00:00, 205.97it/s]remove invalid data : null / measurement error:  62%|██████▏   | 120/193 [00:00<00:00, 212.17it/s]remove invalid data : null / measurement error:  75%|███████▌  | 145/193 [00:00<00:00, 222.00it/s]remove invalid data : null / measurement error:  87%|████████▋ | 168/193 [00:00<00:00, 217.56it/s]remove invalid data : null / measurement error:  98%|█████████▊| 190/193 [00:00<00:00, 215.50it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 205.10it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 258.25it/s]replace nan value:  33%|███▎      | 53/160 [00:00<00:00, 260.26it/s]replace nan value:  50%|█████     | 80/160 [00:00<00:00, 258.88it/s]replace nan value:  66%|██████▋   | 106/160 [00:00<00:00, 255.98it/s]replace nan value:  82%|████████▎ | 132/160 [00:00<00:00, 256.01it/s]replace nan value:  99%|█████████▉| 158/160 [00:00<00:00, 256.30it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 256.81it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 107.69it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 65.42it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.58it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 76.48it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 83.20it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 85.01it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 85.17it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.95it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.03it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.97it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.48it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.58it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.61it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.73it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 57.13it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.85it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 60.06it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 64.43it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.95it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.208, valid loss : 0.053, train acc : 0.969, valid acc : 0.992, train f1 : 0.500, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
  7%|▋         | 13/196 [00:00<00:01, 128.96it/s][A
 18%|█▊        | 36/196 [00:00<00:00, 184.14it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 165.79it/s][A
 38%|███▊      | 74/196 [00:00<00:00, 170.77it/s][A
 47%|████▋     | 92/196 [00:00<00:00, 167.18it/s][A
 57%|█████▋    | 112/196 [00:00<00:00, 175.91it/s][A
 66%|██████▋   | 130/196 [00:00<00:00, 169.89it/s][A
 78%|███████▊  | 152/196 [00:00<00:00, 179.36it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 173.87it/s][A
 97%|█████████▋| 190/196 [00:01<00:00, 179.07it/s][A100%|██████████| 196/196 [00:01<00:00, 168.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.498
training process:   1%|          | 1/128 [01:58<4:09:51, 118.04s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:25<3:29:42, 99.87s/it] EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:52<3:16:12, 94.18s/it]EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:21<3:10:23, 92.13s/it]epoch : 5, train loss : 0.049, valid loss : 0.049, train acc : 0.991, valid acc : 0.992, train f1 : 0.498, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|█         | 20/196 [00:00<00:00, 196.14it/s][A
 20%|██        | 40/196 [00:00<00:00, 170.70it/s][A
 30%|██▉       | 58/196 [00:00<00:00, 171.74it/s][A
 39%|███▉      | 76/196 [00:00<00:00, 168.25it/s][A
 48%|████▊     | 95/196 [00:00<00:00, 172.39it/s][A
 58%|█████▊    | 113/196 [00:00<00:00, 169.60it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 177.25it/s][A
 77%|███████▋  | 151/196 [00:00<00:00, 167.45it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 168.90it/s][A
 95%|█████████▍| 186/196 [00:01<00:00, 164.40it/s][A100%|██████████| 196/196 [00:01<00:00, 173.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:15<3:25:13, 100.11s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:42<3:14:09, 95.49s/it] EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:12<3:09:19, 93.88s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:39<3:03:03, 91.53s/it]epoch : 9, train loss : 0.043, valid loss : 0.046, train acc : 0.991, valid acc : 0.992, train f1 : 0.502, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▉         | 18/196 [00:00<00:01, 167.79it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 162.58it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 172.90it/s][A
 37%|███▋      | 73/196 [00:00<00:00, 168.45it/s][A
 47%|████▋     | 92/196 [00:00<00:00, 172.42it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 169.87it/s][A
 66%|██████▌   | 129/196 [00:00<00:00, 174.97it/s][A
 75%|███████▌  | 147/196 [00:00<00:00, 171.35it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 177.83it/s][A
 94%|█████████▍| 185/196 [00:01<00:00, 171.93it/s][A100%|██████████| 196/196 [00:01<00:00, 176.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:36<3:17:24, 99.54s/it]Best score increase :0.498 -> 0.506
training process:   8%|▊         | 10/128 [16:04<3:08:59, 96.10s/it]Best score increase :0.506 -> 0.527
training process:   9%|▊         | 11/128 [17:33<3:03:05, 93.89s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [18:59<2:56:28, 91.28s/it]epoch : 13, train loss : 0.038, valid loss : 0.036, train acc : 0.991, valid acc : 0.992, train f1 : 0.566, valid f1 : 0.563

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|▉         | 19/196 [00:00<00:00, 181.31it/s][A
 19%|█▉        | 38/196 [00:00<00:00, 173.46it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 177.81it/s][A
 38%|███▊      | 75/196 [00:00<00:00, 173.54it/s][A
 48%|████▊     | 95/196 [00:00<00:00, 178.97it/s][A
 58%|█████▊    | 113/196 [00:00<00:00, 174.72it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 182.72it/s][A
 78%|███████▊  | 153/196 [00:00<00:00, 176.99it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 180.49it/s][A
 98%|█████████▊| 192/196 [00:01<00:00, 177.58it/s][A100%|██████████| 196/196 [00:01<00:00, 179.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.527 -> 0.563
training process:  10%|█         | 13/128 [20:52<3:07:53, 98.03s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [22:23<3:01:59, 95.79s/it]Best score increase :0.563 -> 0.671
training process:  12%|█▏        | 15/128 [23:53<2:56:58, 93.97s/it]EarlyStopping counter : 1 out of 40
training process:  12%|█▎        | 16/128 [25:19<2:51:05, 91.66s/it]epoch : 17, train loss : 0.031, valid loss : 0.031, train acc : 0.993, valid acc : 0.993, train f1 : 0.716, valid f1 : 0.653

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 22/196 [00:00<00:00, 212.32it/s][A
 22%|██▏       | 44/196 [00:00<00:00, 178.36it/s][A
 32%|███▏      | 63/196 [00:00<00:00, 167.70it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 178.11it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 149.89it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 174.50it/s][A
 74%|███████▍  | 145/196 [00:00<00:00, 162.39it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 169.94it/s][A
 94%|█████████▍| 184/196 [00:01<00:00, 167.23it/s][A100%|██████████| 196/196 [00:01<00:00, 172.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  13%|█▎        | 17/128 [27:15<3:02:55, 98.88s/it]Best score increase :0.671 -> 0.793
training process:  14%|█▍        | 18/128 [28:42<2:54:44, 95.31s/it]EarlyStopping counter : 1 out of 40
training process:  15%|█▍        | 19/128 [30:12<2:50:30, 93.86s/it]EarlyStopping counter : 2 out of 40
training process:  16%|█▌        | 20/128 [31:41<2:46:06, 92.28s/it]epoch : 21, train loss : 0.027, valid loss : 0.024, train acc : 0.994, valid acc : 0.995, train f1 : 0.779, valid f1 : 0.824

  0%|          | 0/196 [00:00<?, ?it/s][A
  8%|▊         | 16/196 [00:00<00:01, 159.33it/s][A
 16%|█▋        | 32/196 [00:00<00:01, 155.04it/s][A
 26%|██▌       | 51/196 [00:00<00:00, 166.34it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 164.18it/s][A
 44%|████▍     | 87/196 [00:00<00:00, 172.28it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 168.16it/s][A
 63%|██████▎   | 123/196 [00:00<00:00, 171.23it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 169.04it/s][A
 82%|████████▏ | 160/196 [00:00<00:00, 173.63it/s][A
 91%|█████████ | 178/196 [00:01<00:00, 171.51it/s][A
100%|██████████| 196/196 [00:01<00:00, 173.56it/s][A100%|██████████| 196/196 [00:01<00:00, 169.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.793 -> 0.824
training process:  16%|█▋        | 21/128 [33:38<2:58:15, 99.96s/it]EarlyStopping counter : 1 out of 40
training process:  17%|█▋        | 22/128 [35:09<2:51:36, 97.14s/it]Best score increase :0.824 -> 0.829
training process:  18%|█▊        | 23/128 [36:39<2:46:08, 94.94s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [38:09<2:42:08, 93.54s/it]epoch : 25, train loss : 0.025, valid loss : 0.027, train acc : 0.994, valid acc : 0.995, train f1 : 0.807, valid f1 : 0.817

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|▉         | 19/196 [00:00<00:01, 176.77it/s][A
 19%|█▉        | 37/196 [00:00<00:00, 170.61it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 161.70it/s][A
 39%|███▉      | 77/196 [00:00<00:00, 181.97it/s][A
 49%|████▉     | 96/196 [00:00<00:00, 154.06it/s][A
 62%|██████▏   | 122/196 [00:00<00:00, 180.25it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 170.85it/s][A
 82%|████████▏ | 161/196 [00:00<00:00, 176.92it/s][A
 92%|█████████▏| 180/196 [00:01<00:00, 174.45it/s][A100%|██████████| 196/196 [00:01<00:00, 172.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  20%|█▉        | 25/128 [40:06<2:52:23, 100.42s/it]EarlyStopping counter : 3 out of 40
training process:  20%|██        | 26/128 [41:36<2:45:33, 97.39s/it] EarlyStopping counter : 4 out of 40
training process:  21%|██        | 27/128 [43:07<2:40:56, 95.61s/it]EarlyStopping counter : 5 out of 40
training process:  22%|██▏       | 28/128 [44:39<2:37:21, 94.42s/it]epoch : 29, train loss : 0.025, valid loss : 0.027, train acc : 0.995, valid acc : 0.995, train f1 : 0.811, valid f1 : 0.818

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 22/196 [00:00<00:00, 210.88it/s][A
 22%|██▏       | 44/196 [00:00<00:00, 186.38it/s][A
 32%|███▏      | 63/196 [00:00<00:00, 152.51it/s][A
 45%|████▍     | 88/196 [00:00<00:00, 178.51it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 169.84it/s][A
 64%|██████▍   | 125/196 [00:00<00:00, 172.24it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 171.14it/s][A
 82%|████████▏ | 161/196 [00:00<00:00, 164.74it/s][A
 93%|█████████▎| 182/196 [00:01<00:00, 177.14it/s][A100%|██████████| 196/196 [00:01<00:00, 168.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 29/128 [46:35<2:46:28, 100.90s/it]EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 30/128 [48:04<2:38:50, 97.25s/it] Best score increase :0.829 -> 0.847
training process:  24%|██▍       | 31/128 [49:28<2:30:44, 93.25s/it]EarlyStopping counter : 1 out of 40
training process:  25%|██▌       | 32/128 [50:57<2:27:15, 92.03s/it]epoch : 33, train loss : 0.024, valid loss : 0.034, train acc : 0.995, valid acc : 0.994, train f1 : 0.825, valid f1 : 0.793

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▉         | 18/196 [00:00<00:01, 162.84it/s][A
 19%|█▉        | 37/196 [00:00<00:00, 177.86it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 156.27it/s][A
 41%|████      | 80/196 [00:00<00:00, 186.96it/s][A
 51%|█████     | 100/196 [00:00<00:00, 164.87it/s][A
 62%|██████▏   | 122/196 [00:00<00:00, 180.77it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 174.16it/s][A
 82%|████████▏ | 160/196 [00:00<00:00, 176.01it/s][A
 91%|█████████ | 178/196 [00:01<00:00, 174.93it/s][A
100%|██████████| 196/196 [00:01<00:00, 163.39it/s][A100%|██████████| 196/196 [00:01<00:00, 170.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  26%|██▌       | 33/128 [52:53<2:37:06, 99.23s/it]EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 34/128 [54:21<2:30:25, 96.01s/it]EarlyStopping counter : 4 out of 40
training process:  27%|██▋       | 35/128 [55:49<2:24:57, 93.52s/it]EarlyStopping counter : 5 out of 40
training process:  28%|██▊       | 36/128 [57:17<2:20:51, 91.86s/it]epoch : 37, train loss : 0.023, valid loss : 0.025, train acc : 0.995, valid acc : 0.996, train f1 : 0.841, valid f1 : 0.845

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 253.19it/s][A
 27%|██▋       | 52/196 [00:00<00:00, 191.27it/s][A
 37%|███▋      | 73/196 [00:00<00:00, 159.01it/s][A
 49%|████▉     | 96/196 [00:00<00:00, 174.16it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 141.02it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 138.22it/s][A
 74%|███████▍  | 146/196 [00:00<00:00, 127.81it/s][A
 84%|████████▍ | 165/196 [00:01<00:00, 140.79it/s][A
 92%|█████████▏| 180/196 [00:01<00:00, 135.45it/s][A100%|██████████| 196/196 [00:01<00:00, 152.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  29%|██▉       | 37/128 [59:13<2:30:06, 98.97s/it]EarlyStopping counter : 7 out of 40
training process:  30%|██▉       | 38/128 [1:00:41<2:23:52, 95.92s/it]EarlyStopping counter : 8 out of 40
training process:  30%|███       | 39/128 [1:02:08<2:18:19, 93.25s/it]EarlyStopping counter : 9 out of 40
training process:  31%|███▏      | 40/128 [1:03:39<2:15:35, 92.44s/it]epoch : 41, train loss : 0.022, valid loss : 0.030, train acc : 0.996, valid acc : 0.996, train f1 : 0.851, valid f1 : 0.848

  0%|          | 0/196 [00:00<?, ?it/s][A
  6%|▌         | 11/196 [00:00<00:01, 105.35it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 175.99it/s][A
 27%|██▋       | 52/196 [00:00<00:00, 160.50it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 170.69it/s][A
 45%|████▌     | 89/196 [00:00<00:00, 172.86it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 154.68it/s][A
 66%|██████▋   | 130/196 [00:00<00:00, 172.93it/s][A
 76%|███████▌  | 148/196 [00:00<00:00, 163.50it/s][A
 86%|████████▌ | 168/196 [00:01<00:00, 168.40it/s][A
 96%|█████████▌| 188/196 [00:01<00:00, 176.73it/s][A100%|██████████| 196/196 [00:01<00:00, 167.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.847 -> 0.848
training process:  32%|███▏      | 41/128 [1:05:37<2:25:04, 100.06s/it]Best score increase :0.848 -> 0.856
training process:  33%|███▎      | 42/128 [1:07:07<2:19:02, 97.01s/it] EarlyStopping counter : 1 out of 40
training process:  34%|███▎      | 43/128 [1:08:37<2:14:21, 94.84s/it]EarlyStopping counter : 2 out of 40
training process:  34%|███▍      | 44/128 [1:10:05<2:10:09, 92.98s/it]epoch : 45, train loss : 0.023, valid loss : 0.028, train acc : 0.995, valid acc : 0.995, train f1 : 0.846, valid f1 : 0.825

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▉         | 18/196 [00:00<00:01, 161.61it/s][A
 19%|█▉        | 38/196 [00:00<00:00, 182.37it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 151.03it/s][A
 41%|████▏     | 81/196 [00:00<00:00, 177.25it/s][A
 51%|█████     | 100/196 [00:00<00:00, 172.63it/s][A
 60%|██████    | 118/196 [00:00<00:00, 158.89it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 178.91it/s][A
 82%|████████▏ | 160/196 [00:00<00:00, 165.14it/s][A
 91%|█████████ | 178/196 [00:01<00:00, 166.00it/s][A100%|██████████| 196/196 [00:01<00:00, 169.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  35%|███▌      | 45/128 [1:11:55<2:15:37, 98.04s/it]Best score increase :0.856 -> 0.863
training process:  36%|███▌      | 46/128 [1:13:24<2:10:11, 95.27s/it]Best score increase :0.863 -> 0.868
training process:  37%|███▋      | 47/128 [1:14:52<2:05:34, 93.02s/it]EarlyStopping counter : 1 out of 40
training process:  38%|███▊      | 48/128 [1:16:21<2:02:28, 91.85s/it]epoch : 49, train loss : 0.021, valid loss : 0.032, train acc : 0.996, valid acc : 0.996, train f1 : 0.861, valid f1 : 0.854

  0%|          | 0/196 [00:00<?, ?it/s][A
  5%|▌         | 10/196 [00:00<00:01, 95.85it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 170.31it/s][A
 26%|██▌       | 51/196 [00:00<00:00, 154.05it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 156.04it/s][A
 44%|████▍     | 87/196 [00:00<00:00, 170.66it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 151.17it/s][A
 65%|██████▍   | 127/196 [00:00<00:00, 165.42it/s][A
 75%|███████▌  | 147/196 [00:00<00:00, 174.64it/s][A
 84%|████████▍ | 165/196 [00:01<00:00, 156.24it/s][A
 96%|█████████▋| 189/196 [00:01<00:00, 177.56it/s][A100%|██████████| 196/196 [00:01<00:00, 160.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  38%|███▊      | 49/128 [1:18:11<2:08:10, 97.35s/it]EarlyStopping counter : 3 out of 40
training process:  39%|███▉      | 50/128 [1:19:40<2:03:17, 94.84s/it]EarlyStopping counter : 4 out of 40
training process:  40%|███▉      | 51/128 [1:21:10<1:59:42, 93.28s/it]EarlyStopping counter : 5 out of 40
training process:  41%|████      | 52/128 [1:22:41<1:57:37, 92.86s/it]epoch : 53, train loss : 0.021, valid loss : 0.031, train acc : 0.996, valid acc : 0.996, train f1 : 0.869, valid f1 : 0.852

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▉         | 18/196 [00:00<00:01, 176.17it/s][A
 19%|█▉        | 38/196 [00:00<00:00, 187.77it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 155.17it/s][A
 39%|███▉      | 77/196 [00:00<00:00, 167.87it/s][A
 49%|████▉     | 96/196 [00:00<00:00, 174.86it/s][A
 58%|█████▊    | 114/196 [00:00<00:00, 154.63it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 165.41it/s][A
 79%|███████▊  | 154/196 [00:00<00:00, 174.06it/s][A
 88%|████████▊ | 172/196 [00:01<00:00, 155.98it/s][A
 98%|█████████▊| 193/196 [00:01<00:00, 166.81it/s][A100%|██████████| 196/196 [00:01<00:00, 163.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  41%|████▏     | 53/128 [1:24:39<2:05:16, 100.23s/it]EarlyStopping counter : 7 out of 40
training process:  42%|████▏     | 54/128 [1:26:09<1:59:53, 97.21s/it] EarlyStopping counter : 8 out of 40
training process:  43%|████▎     | 55/128 [1:27:37<1:54:54, 94.44s/it]EarlyStopping counter : 9 out of 40
training process:  44%|████▍     | 56/128 [1:29:05<1:50:51, 92.39s/it]epoch : 57, train loss : 0.021, valid loss : 0.029, train acc : 0.996, valid acc : 0.996, train f1 : 0.872, valid f1 : 0.860

  0%|          | 0/196 [00:00<?, ?it/s][A
  7%|▋         | 13/196 [00:00<00:01, 128.06it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 173.94it/s][A
 27%|██▋       | 53/196 [00:00<00:00, 179.69it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 154.12it/s][A
 46%|████▋     | 91/196 [00:00<00:00, 168.65it/s][A
 56%|█████▌    | 109/196 [00:00<00:00, 169.52it/s][A
 65%|██████▍   | 127/196 [00:00<00:00, 153.05it/s][A
 77%|███████▋  | 150/196 [00:00<00:00, 170.60it/s][A
 86%|████████▌ | 169/196 [00:01<00:00, 175.07it/s][A
 95%|█████████▌| 187/196 [00:01<00:00, 157.24it/s][A100%|██████████| 196/196 [00:01<00:00, 166.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  45%|████▍     | 57/128 [1:31:00<1:57:23, 99.21s/it]EarlyStopping counter : 11 out of 40
training process:  45%|████▌     | 58/128 [1:32:30<1:52:34, 96.49s/it]EarlyStopping counter : 12 out of 40
training process:  46%|████▌     | 59/128 [1:34:02<1:49:36, 95.31s/it]EarlyStopping counter : 13 out of 40
training process:  47%|████▋     | 60/128 [1:35:33<1:46:25, 93.91s/it]epoch : 61, train loss : 0.020, valid loss : 0.028, train acc : 0.996, valid acc : 0.996, train f1 : 0.875, valid f1 : 0.858

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 21/196 [00:00<00:00, 209.29it/s][A
 21%|██▏       | 42/196 [00:00<00:00, 164.45it/s][A
 31%|███       | 60/196 [00:00<00:00, 153.28it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 175.20it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 173.39it/s][A
 61%|██████    | 119/196 [00:00<00:00, 156.92it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 171.10it/s][A
 81%|████████  | 159/196 [00:00<00:00, 176.51it/s][A
 91%|█████████ | 178/196 [00:01<00:00, 161.72it/s][A100%|██████████| 196/196 [00:01<00:00, 169.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  48%|████▊     | 61/128 [1:37:32<1:53:20, 101.50s/it]EarlyStopping counter : 15 out of 40
training process:  48%|████▊     | 62/128 [1:39:03<1:48:05, 98.27s/it] EarlyStopping counter : 16 out of 40
training process:  49%|████▉     | 63/128 [1:40:34<1:44:02, 96.03s/it]EarlyStopping counter : 17 out of 40
training process:  50%|█████     | 64/128 [1:42:02<1:40:03, 93.80s/it]epoch : 65, train loss : 0.019, valid loss : 0.032, train acc : 0.996, valid acc : 0.996, train f1 : 0.870, valid f1 : 0.846

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|▉         | 19/196 [00:00<00:00, 182.35it/s][A
 20%|█▉        | 39/196 [00:00<00:00, 190.19it/s][A
 30%|███       | 59/196 [00:00<00:00, 166.16it/s][A
 39%|███▉      | 76/196 [00:00<00:00, 147.42it/s][A
 48%|████▊     | 94/196 [00:00<00:00, 157.05it/s][A
 58%|█████▊    | 114/196 [00:00<00:00, 169.15it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 159.35it/s][A
 76%|███████▌  | 149/196 [00:00<00:00, 154.23it/s][A
 87%|████████▋ | 171/196 [00:01<00:00, 171.29it/s][A
 96%|█████████▋| 189/196 [00:01<00:00, 168.29it/s][A100%|██████████| 196/196 [00:01<00:00, 165.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  51%|█████     | 65/128 [1:43:58<1:45:17, 100.29s/it]EarlyStopping counter : 19 out of 40
training process:  52%|█████▏    | 66/128 [1:45:26<1:39:59, 96.77s/it] EarlyStopping counter : 20 out of 40
training process:  52%|█████▏    | 67/128 [1:46:58<1:36:50, 95.26s/it]EarlyStopping counter : 21 out of 40
training process:  53%|█████▎    | 68/128 [1:48:28<1:33:40, 93.68s/it]epoch : 69, train loss : 0.018, valid loss : 0.031, train acc : 0.996, valid acc : 0.996, train f1 : 0.880, valid f1 : 0.859

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 22/196 [00:00<00:00, 208.09it/s][A
 22%|██▏       | 43/196 [00:00<00:00, 174.31it/s][A
 31%|███       | 61/196 [00:00<00:00, 153.81it/s][A
 40%|███▉      | 78/196 [00:00<00:00, 158.27it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 168.22it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 159.40it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 148.17it/s][A
 79%|███████▊  | 154/196 [00:00<00:00, 163.07it/s][A
 89%|████████▉ | 175/196 [00:01<00:00, 175.18it/s][A
 98%|█████████▊| 193/196 [00:01<00:00, 166.09it/s][A100%|██████████| 196/196 [00:01<00:00, 165.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  54%|█████▍    | 69/128 [1:50:22<1:38:11, 99.85s/it]EarlyStopping counter : 23 out of 40
training process:  55%|█████▍    | 70/128 [1:51:52<1:33:40, 96.90s/it]EarlyStopping counter : 24 out of 40
training process:  55%|█████▌    | 71/128 [1:53:20<1:29:32, 94.25s/it]EarlyStopping counter : 25 out of 40
training process:  56%|█████▋    | 72/128 [1:54:52<1:27:20, 93.59s/it]epoch : 73, train loss : 0.017, valid loss : 0.035, train acc : 0.997, valid acc : 0.996, train f1 : 0.894, valid f1 : 0.860

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 21/196 [00:00<00:00, 188.92it/s][A
 21%|██        | 41/196 [00:00<00:00, 187.14it/s][A
 31%|███       | 60/196 [00:00<00:00, 175.27it/s][A
 40%|███▉      | 78/196 [00:00<00:00, 158.53it/s][A
 48%|████▊     | 95/196 [00:00<00:00, 153.31it/s][A
 59%|█████▉    | 116/196 [00:00<00:00, 165.50it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 172.17it/s][A
 79%|███████▊  | 154/196 [00:00<00:00, 162.77it/s][A
 87%|████████▋ | 171/196 [00:01<00:00, 152.29it/s][A
 97%|█████████▋| 190/196 [00:01<00:00, 159.40it/s][A100%|██████████| 196/196 [00:01<00:00, 161.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  57%|█████▋    | 73/128 [1:56:46<1:31:22, 99.68s/it]EarlyStopping counter : 27 out of 40
training process:  58%|█████▊    | 74/128 [1:58:20<1:28:07, 97.92s/it]EarlyStopping counter : 28 out of 40
training process:  59%|█████▊    | 75/128 [1:59:50<1:24:23, 95.53s/it]EarlyStopping counter : 29 out of 40
training process:  59%|█████▉    | 76/128 [2:01:23<1:22:08, 94.78s/it]epoch : 77, train loss : 0.016, valid loss : 0.029, train acc : 0.997, valid acc : 0.997, train f1 : 0.895, valid f1 : 0.878

  0%|          | 0/196 [00:00<?, ?it/s][A
  7%|▋         | 13/196 [00:00<00:01, 120.30it/s][A
 17%|█▋        | 33/196 [00:00<00:01, 156.11it/s][A
 27%|██▋       | 53/196 [00:00<00:00, 170.18it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 159.84it/s][A
 45%|████▍     | 88/196 [00:00<00:00, 149.86it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 152.84it/s][A
 63%|██████▎   | 124/196 [00:00<00:00, 162.64it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 164.35it/s][A
 81%|████████  | 158/196 [00:01<00:00, 153.55it/s][A
 90%|█████████ | 177/196 [00:01<00:00, 163.16it/s][A100%|██████████| 196/196 [00:01<00:00, 162.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.868 -> 0.878
training process:  60%|██████    | 77/128 [2:03:18<1:25:38, 100.75s/it]EarlyStopping counter : 1 out of 40
training process:  61%|██████    | 78/128 [2:04:46<1:20:48, 96.98s/it] EarlyStopping counter : 2 out of 40
training process:  62%|██████▏   | 79/128 [2:06:14<1:16:57, 94.24s/it]EarlyStopping counter : 3 out of 40
training process:  62%|██████▎   | 80/128 [2:07:39<1:13:17, 91.62s/it]epoch : 81, train loss : 0.016, valid loss : 0.035, train acc : 0.997, valid acc : 0.996, train f1 : 0.909, valid f1 : 0.853

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|▉         | 19/196 [00:00<00:00, 189.41it/s][A
 19%|█▉        | 38/196 [00:00<00:00, 169.72it/s][A
 29%|██▊       | 56/196 [00:00<00:00, 152.78it/s][A
 37%|███▋      | 72/196 [00:00<00:00, 142.94it/s][A
 44%|████▍     | 87/196 [00:00<00:00, 129.46it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 131.39it/s][A
 61%|██████    | 120/196 [00:00<00:00, 139.23it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 137.89it/s][A
 76%|███████▌  | 149/196 [00:01<00:00, 132.11it/s][A
 83%|████████▎ | 163/196 [00:01<00:00, 123.20it/s][A
 90%|████████▉ | 176/196 [00:01<00:00, 116.94it/s][A
 96%|█████████▋| 189/196 [00:01<00:00, 119.84it/s][A100%|██████████| 196/196 [00:01<00:00, 133.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  63%|██████▎   | 81/128 [2:09:37<1:17:52, 99.42s/it]EarlyStopping counter : 5 out of 40
training process:  64%|██████▍   | 82/128 [2:11:03<1:13:13, 95.50s/it]EarlyStopping counter : 6 out of 40
training process:  65%|██████▍   | 83/128 [2:12:30<1:09:40, 92.90s/it]EarlyStopping counter : 7 out of 40
training process:  66%|██████▌   | 84/128 [2:13:55<1:06:19, 90.43s/it]epoch : 85, train loss : 0.016, valid loss : 0.035, train acc : 0.997, valid acc : 0.996, train f1 : 0.905, valid f1 : 0.864

  0%|          | 0/196 [00:00<?, ?it/s][A
  7%|▋         | 14/196 [00:00<00:01, 137.93it/s][A
 15%|█▍        | 29/196 [00:00<00:01, 136.98it/s][A
 25%|██▌       | 49/196 [00:00<00:00, 157.88it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 162.87it/s][A
 43%|████▎     | 85/196 [00:00<00:00, 167.47it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 156.61it/s][A
 60%|██████    | 118/196 [00:00<00:00, 147.98it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 152.02it/s][A
 79%|███████▊  | 154/196 [00:00<00:00, 160.79it/s][A
 88%|████████▊ | 172/196 [00:01<00:00, 166.18it/s][A
 96%|█████████▋| 189/196 [00:01<00:00, 157.28it/s][A100%|██████████| 196/196 [00:01<00:00, 156.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  66%|██████▋   | 85/128 [2:15:48<1:09:47, 97.39s/it]EarlyStopping counter : 9 out of 40
training process:  67%|██████▋   | 86/128 [2:17:15<1:05:56, 94.21s/it]EarlyStopping counter : 10 out of 40
training process:  68%|██████▊   | 87/128 [2:18:45<1:03:27, 92.88s/it]EarlyStopping counter : 11 out of 40
training process:  69%|██████▉   | 88/128 [2:20:14<1:01:04, 91.61s/it]epoch : 89, train loss : 0.014, valid loss : 0.039, train acc : 0.997, valid acc : 0.996, train f1 : 0.920, valid f1 : 0.857

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▊         | 17/196 [00:00<00:01, 152.37it/s][A
 17%|█▋        | 33/196 [00:00<00:01, 123.71it/s][A
 26%|██▌       | 50/196 [00:00<00:01, 140.09it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 136.22it/s][A
 40%|████      | 79/196 [00:00<00:00, 132.14it/s][A
 47%|████▋     | 93/196 [00:00<00:00, 129.03it/s][A
 55%|█████▌    | 108/196 [00:00<00:00, 130.75it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 143.31it/s][A
 72%|███████▏  | 142/196 [00:01<00:00, 146.70it/s][A
 80%|████████  | 157/196 [00:01<00:00, 141.92it/s][A
 88%|████████▊ | 172/196 [00:01<00:00, 137.71it/s][A
 96%|█████████▌| 188/196 [00:01<00:00, 143.22it/s][A100%|██████████| 196/196 [00:01<00:00, 140.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  70%|██████▉   | 89/128 [2:22:10<1:04:20, 98.98s/it]EarlyStopping counter : 13 out of 40
training process:  70%|███████   | 90/128 [2:23:36<1:00:13, 95.09s/it]EarlyStopping counter : 14 out of 40
training process:  71%|███████   | 91/128 [2:25:03<57:06, 92.61s/it]  EarlyStopping counter : 15 out of 40
training process:  72%|███████▏  | 92/128 [2:26:29<54:30, 90.85s/it]epoch : 93, train loss : 0.016, valid loss : 0.081, train acc : 0.997, valid acc : 0.983, train f1 : 0.913, valid f1 : 0.692

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▉         | 18/196 [00:00<00:00, 179.27it/s][A
 18%|█▊        | 36/196 [00:00<00:00, 162.30it/s][A
 27%|██▋       | 53/196 [00:00<00:00, 165.39it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 158.67it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 150.56it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 145.73it/s][A
 61%|██████    | 119/196 [00:00<00:00, 152.54it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 159.37it/s][A
 79%|███████▊  | 154/196 [00:00<00:00, 159.91it/s][A
 87%|████████▋ | 171/196 [00:01<00:00, 159.89it/s][A
 96%|█████████▌| 188/196 [00:01<00:00, 156.89it/s][A100%|██████████| 196/196 [00:01<00:00, 154.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  73%|███████▎  | 93/128 [2:28:20<56:28, 96.81s/it]EarlyStopping counter : 17 out of 40
training process:  73%|███████▎  | 94/128 [2:29:49<53:27, 94.35s/it]EarlyStopping counter : 18 out of 40
training process:  74%|███████▍  | 95/128 [2:31:19<51:17, 93.26s/it]EarlyStopping counter : 19 out of 40
training process:  75%|███████▌  | 96/128 [2:32:48<48:56, 91.77s/it]epoch : 97, train loss : 0.014, valid loss : 0.044, train acc : 0.997, valid acc : 0.995, train f1 : 0.921, valid f1 : 0.836

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▊         | 17/196 [00:00<00:01, 156.50it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 162.96it/s][A
 26%|██▌       | 51/196 [00:00<00:00, 153.97it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 156.80it/s][A
 43%|████▎     | 84/196 [00:00<00:00, 154.55it/s][A
 51%|█████     | 100/196 [00:00<00:00, 149.28it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 144.13it/s][A
 66%|██████▋   | 130/196 [00:00<00:00, 143.06it/s][A
 75%|███████▌  | 147/196 [00:00<00:00, 146.64it/s][A
 84%|████████▍ | 165/196 [00:01<00:00, 156.27it/s][A
 92%|█████████▏| 181/196 [00:01<00:00, 156.08it/s][A100%|██████████| 196/196 [00:01<00:00, 153.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  76%|███████▌  | 97/128 [2:34:45<51:21, 99.41s/it]EarlyStopping counter : 21 out of 40
training process:  77%|███████▋  | 98/128 [2:36:14<48:12, 96.41s/it]EarlyStopping counter : 22 out of 40
training process:  77%|███████▋  | 99/128 [2:37:44<45:33, 94.27s/it]EarlyStopping counter : 23 out of 40
training process:  78%|███████▊  | 100/128 [2:39:12<43:09, 92.48s/it]epoch : 101, train loss : 0.013, valid loss : 0.042, train acc : 0.998, valid acc : 0.996, train f1 : 0.928, valid f1 : 0.867

  0%|          | 0/196 [00:00<?, ?it/s][A
  6%|▌         | 11/196 [00:00<00:01, 108.65it/s][A
 14%|█▍        | 27/196 [00:00<00:01, 132.42it/s][A
 22%|██▏       | 43/196 [00:00<00:01, 142.06it/s][A
 30%|███       | 59/196 [00:00<00:00, 146.03it/s][A
 38%|███▊      | 75/196 [00:00<00:00, 147.90it/s][A
 47%|████▋     | 92/196 [00:00<00:00, 151.92it/s][A
 55%|█████▌    | 108/196 [00:00<00:00, 151.31it/s][A
 63%|██████▎   | 124/196 [00:00<00:00, 151.78it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 150.43it/s][A
 80%|███████▉  | 156/196 [00:01<00:00, 149.27it/s][A
 87%|████████▋ | 171/196 [00:01<00:00, 144.42it/s][A
 95%|█████████▍| 186/196 [00:01<00:00, 141.42it/s][A100%|██████████| 196/196 [00:01<00:00, 144.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  79%|███████▉  | 101/128 [2:41:08<44:46, 99.51s/it]EarlyStopping counter : 25 out of 40
training process:  80%|███████▉  | 102/128 [2:42:39<42:05, 97.13s/it]EarlyStopping counter : 26 out of 40
training process:  80%|████████  | 103/128 [2:44:08<39:24, 94.60s/it]EarlyStopping counter : 27 out of 40
training process:  81%|████████▏ | 104/128 [2:45:38<37:14, 93.12s/it]epoch : 105, train loss : 0.013, valid loss : 0.045, train acc : 0.998, valid acc : 0.995, train f1 : 0.933, valid f1 : 0.851

  0%|          | 0/196 [00:00<?, ?it/s][A
  8%|▊         | 16/196 [00:00<00:01, 151.16it/s][A
 16%|█▋        | 32/196 [00:00<00:01, 140.05it/s][A
 24%|██▍       | 47/196 [00:00<00:01, 135.85it/s][A
 32%|███▏      | 62/196 [00:00<00:00, 139.10it/s][A
 39%|███▉      | 77/196 [00:00<00:00, 140.24it/s][A
 47%|████▋     | 92/196 [00:00<00:00, 137.68it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 139.40it/s][A
 62%|██████▏   | 122/196 [00:00<00:00, 140.80it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 138.92it/s][A
 78%|███████▊  | 152/196 [00:01<00:00, 138.12it/s][A
 86%|████████▌ | 168/196 [00:01<00:00, 141.82it/s][A
 93%|█████████▎| 183/196 [00:01<00:00, 141.11it/s][A100%|██████████| 196/196 [00:01<00:00, 139.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  82%|████████▏ | 105/128 [2:47:36<38:34, 100.62s/it]EarlyStopping counter : 29 out of 40
training process:  83%|████████▎ | 106/128 [2:49:06<35:41, 97.34s/it] EarlyStopping counter : 30 out of 40
training process:  84%|████████▎ | 107/128 [2:50:31<32:48, 93.73s/it]EarlyStopping counter : 31 out of 40
training process:  84%|████████▍ | 108/128 [2:52:00<30:46, 92.33s/it]epoch : 109, train loss : 0.014, valid loss : 0.057, train acc : 0.998, valid acc : 0.991, train f1 : 0.927, valid f1 : 0.777

  0%|          | 0/196 [00:00<?, ?it/s][A
  8%|▊         | 15/196 [00:00<00:01, 140.98it/s][A
 15%|█▌        | 30/196 [00:00<00:01, 135.35it/s][A
 22%|██▏       | 44/196 [00:00<00:01, 136.31it/s][A
 30%|██▉       | 58/196 [00:00<00:01, 135.37it/s][A
 37%|███▋      | 72/196 [00:00<00:00, 136.25it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 135.32it/s][A
 51%|█████     | 100/196 [00:00<00:00, 129.68it/s][A
 58%|█████▊    | 114/196 [00:00<00:00, 127.50it/s][A
 65%|██████▍   | 127/196 [00:00<00:00, 124.43it/s][A
 72%|███████▏  | 141/196 [00:01<00:00, 128.31it/s][A
 79%|███████▉  | 155/196 [00:01<00:00, 131.15it/s][A
 87%|████████▋ | 170/196 [00:01<00:00, 132.42it/s][A
 94%|█████████▍| 184/196 [00:01<00:00, 134.10it/s][A100%|██████████| 196/196 [00:01<00:00, 132.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  85%|████████▌ | 109/128 [2:53:57<31:32, 99.59s/it]EarlyStopping counter : 33 out of 40
training process:  86%|████████▌ | 110/128 [2:55:23<28:42, 95.68s/it]EarlyStopping counter : 34 out of 40
training process:  87%|████████▋ | 111/128 [2:56:52<26:34, 93.78s/it]EarlyStopping counter : 35 out of 40
training process:  88%|████████▊ | 112/128 [2:58:25<24:56, 93.55s/it]epoch : 113, train loss : 0.010, valid loss : 0.045, train acc : 0.998, valid acc : 0.996, train f1 : 0.945, valid f1 : 0.875

  0%|          | 0/196 [00:00<?, ?it/s][A
  8%|▊         | 15/196 [00:00<00:01, 142.73it/s][A
 15%|█▌        | 30/196 [00:00<00:01, 135.61it/s][A
 22%|██▏       | 44/196 [00:00<00:01, 136.09it/s][A
 30%|██▉       | 58/196 [00:00<00:01, 136.30it/s][A
 37%|███▋      | 72/196 [00:00<00:00, 129.65it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 124.81it/s][A
 51%|█████     | 99/196 [00:00<00:00, 120.46it/s][A
 58%|█████▊    | 114/196 [00:00<00:00, 125.52it/s][A
 65%|██████▌   | 128/196 [00:00<00:00, 128.34it/s][A
 73%|███████▎  | 143/196 [00:01<00:00, 131.29it/s][A
 81%|████████  | 158/196 [00:01<00:00, 132.49it/s][A
 88%|████████▊ | 172/196 [00:01<00:00, 134.11it/s][A
 95%|█████████▍| 186/196 [00:01<00:00, 128.47it/s][A100%|██████████| 196/196 [00:01<00:00, 128.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  88%|████████▊ | 113/128 [3:00:25<25:21, 101.45s/it]EarlyStopping counter : 37 out of 40
training process:  89%|████████▉ | 114/128 [3:01:55<22:49, 97.82s/it] EarlyStopping counter : 38 out of 40
training process:  90%|████████▉ | 115/128 [3:03:23<20:34, 94.96s/it]EarlyStopping counter : 39 out of 40
training process:  91%|█████████ | 116/128 [3:04:52<18:39, 93.29s/it]epoch : 117, train loss : 0.013, valid loss : 0.048, train acc : 0.998, valid acc : 0.996, train f1 : 0.939, valid f1 : 0.858

  0%|          | 0/196 [00:00<?, ?it/s][A
  7%|▋         | 14/196 [00:00<00:01, 131.73it/s][A
 14%|█▍        | 28/196 [00:00<00:01, 124.05it/s][A
 21%|██        | 41/196 [00:00<00:01, 114.57it/s][A
 28%|██▊       | 54/196 [00:00<00:01, 116.20it/s][A
 35%|███▍      | 68/196 [00:00<00:01, 121.43it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 125.26it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 129.48it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 129.30it/s][A
 63%|██████▎   | 123/196 [00:00<00:00, 122.95it/s][A
 70%|██████▉   | 137/196 [00:01<00:00, 123.70it/s][A
 78%|███████▊  | 152/196 [00:01<00:00, 127.14it/s][A
 85%|████████▌ | 167/196 [00:01<00:00, 131.19it/s][A
 92%|█████████▏| 181/196 [00:01<00:00, 132.29it/s][A
 99%|█████████▉| 195/196 [00:01<00:00, 131.15it/s][A100%|██████████| 196/196 [00:01<00:00, 126.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 116, best f1 score : 0.878
training process:  91%|█████████ | 116/128 [3:06:49<19:19, 96.63s/it]
training process finished, best loss : 0.029 and best acc : 0.997, best f1 : 0.878, best epoch : 76

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.83      0.52      0.64       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.91      0.76      0.82     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.82, test AUC : 0.76, test loss : 12.790

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:13, 12.10s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:55, 11.69s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:41, 11.52s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:29, 11.53s/it]processing for feature importance:  29%|██▉       | 5/17 [00:58<02:20, 11.75s/it]processing for feature importance:  35%|███▌      | 6/17 [01:10<02:08, 11.71s/it]processing for feature importance:  41%|████      | 7/17 [01:21<01:56, 11.66s/it]processing for feature importance:  47%|████▋     | 8/17 [01:33<01:44, 11.60s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:45<01:35, 11.94s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:58<01:24, 12.01s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:09<01:12, 12.00s/it]processing for feature importance:  71%|███████   | 12/17 [02:22<01:00, 12.01s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:32<00:46, 11.66s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:44<00:34, 11.50s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:55<00:22, 11.48s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:08<00:11, 11.81s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.45s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.68s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:04<17:19,  4.97s/it]visualize 2D latent space:   1%|          | 2/210 [00:06<11:47,  3.40s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:06,  1.88s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:25,  1.29s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:02<09:34,  2.75s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:02<04:16,  1.23s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<06:42,  1.94s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:07,  1.90s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:29,  1.36s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s]  7%|▋         | 14/196 [00:00<00:01, 126.46it/s] 14%|█▍        | 28/196 [00:00<00:01, 130.83it/s] 21%|██▏       | 42/196 [00:00<00:01, 127.49it/s] 28%|██▊       | 55/196 [00:00<00:01, 122.65it/s] 35%|███▍      | 68/196 [00:00<00:01, 114.23it/s] 41%|████▏     | 81/196 [00:00<00:00, 118.38it/s] 48%|████▊     | 95/196 [00:00<00:00, 123.05it/s] 56%|█████▌    | 109/196 [00:00<00:00, 126.95it/s] 62%|██████▏   | 122/196 [00:00<00:00, 121.52it/s] 69%|██████▉   | 135/196 [00:01<00:00, 115.73it/s] 76%|███████▌  | 149/196 [00:01<00:00, 120.07it/s] 83%|████████▎ | 163/196 [00:01<00:00, 124.28it/s] 90%|█████████ | 177/196 [00:01<00:00, 127.32it/s] 97%|█████████▋| 190/196 [00:01<00:00, 115.66it/s]100%|██████████| 196/196 [00:01<00:00, 119.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:02, 198.92it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 197.15it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 195.32it/s]remove invalid data : null / measurement error:  13%|█▎        | 80/616 [00:00<00:02, 196.76it/s]remove invalid data : null / measurement error:  16%|█▋        | 101/616 [00:00<00:02, 199.31it/s]remove invalid data : null / measurement error:  20%|█▉        | 123/616 [00:00<00:02, 203.90it/s]remove invalid data : null / measurement error:  24%|██▎       | 145/616 [00:00<00:02, 205.93it/s]remove invalid data : null / measurement error:  27%|██▋       | 167/616 [00:00<00:02, 208.00it/s]remove invalid data : null / measurement error:  31%|███       | 188/616 [00:00<00:02, 205.31it/s]remove invalid data : null / measurement error:  34%|███▍      | 209/616 [00:01<00:01, 203.59it/s]remove invalid data : null / measurement error:  37%|███▋      | 230/616 [00:01<00:01, 203.49it/s]remove invalid data : null / measurement error:  41%|████      | 251/616 [00:01<00:01, 202.05it/s]remove invalid data : null / measurement error:  44%|████▍     | 272/616 [00:01<00:01, 202.98it/s]remove invalid data : null / measurement error:  48%|████▊     | 293/616 [00:01<00:01, 201.73it/s]remove invalid data : null / measurement error:  51%|█████     | 314/616 [00:01<00:01, 200.26it/s]remove invalid data : null / measurement error:  54%|█████▍    | 335/616 [00:01<00:01, 199.76it/s]remove invalid data : null / measurement error:  58%|█████▊    | 355/616 [00:01<00:01, 199.33it/s]remove invalid data : null / measurement error:  62%|██████▏   | 379/616 [00:01<00:01, 210.75it/s]remove invalid data : null / measurement error:  66%|██████▌   | 405/616 [00:01<00:00, 223.20it/s]remove invalid data : null / measurement error:  70%|██████▉   | 429/616 [00:02<00:00, 227.07it/s]remove invalid data : null / measurement error:  73%|███████▎  | 452/616 [00:02<00:00, 227.89it/s]remove invalid data : null / measurement error:  77%|███████▋  | 475/616 [00:02<00:00, 222.08it/s]remove invalid data : null / measurement error:  81%|████████  | 498/616 [00:02<00:00, 214.73it/s]remove invalid data : null / measurement error:  84%|████████▍ | 520/616 [00:02<00:00, 210.36it/s]remove invalid data : null / measurement error:  88%|████████▊ | 542/616 [00:02<00:00, 205.85it/s]remove invalid data : null / measurement error:  91%|█████████▏| 563/616 [00:02<00:00, 203.63it/s]remove invalid data : null / measurement error:  95%|█████████▍| 584/616 [00:02<00:00, 201.69it/s]remove invalid data : null / measurement error:  98%|█████████▊| 605/616 [00:02<00:00, 200.13it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 205.87it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 231.15it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 230.82it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 231.79it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 234.11it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 235.39it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 237.02it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 237.57it/s]replace nan value:  37%|███▋      | 193/515 [00:00<00:01, 237.71it/s]replace nan value:  42%|████▏     | 217/515 [00:00<00:01, 237.77it/s]replace nan value:  47%|████▋     | 241/515 [00:01<00:01, 238.26it/s]replace nan value:  52%|█████▏    | 266/515 [00:01<00:01, 238.81it/s]replace nan value:  56%|█████▋    | 290/515 [00:01<00:00, 238.04it/s]replace nan value:  61%|██████    | 314/515 [00:01<00:00, 236.33it/s]replace nan value:  66%|██████▌   | 338/515 [00:01<00:00, 235.88it/s]replace nan value:  70%|███████   | 362/515 [00:01<00:00, 234.94it/s]replace nan value:  75%|███████▌  | 387/515 [00:01<00:00, 236.68it/s]replace nan value:  80%|███████▉  | 411/515 [00:01<00:00, 236.86it/s]replace nan value:  84%|████████▍ | 435/515 [00:01<00:00, 236.43it/s]replace nan value:  89%|████████▉ | 459/515 [00:01<00:00, 236.00it/s]replace nan value:  94%|█████████▍| 483/515 [00:02<00:00, 236.69it/s]replace nan value:  98%|█████████▊| 507/515 [00:02<00:00, 237.13it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 236.33it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.83it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.60it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.51it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.34it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.48it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.44it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 57.36it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.63it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.09it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 52.94it/s]generate index:  17%|█▋        | 88/515 [00:01<00:07, 60.60it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.18it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 57.97it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 63.40it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 61.95it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 68.41it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 69.01it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 70.23it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 69.29it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.17it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 70.36it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.18it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.42it/s]generate index:  37%|███▋      | 191/515 [00:03<00:04, 68.28it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 67.01it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 65.60it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 85.89it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 82.45it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 79.26it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 81.28it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 66.74it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 72.71it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 75.67it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.62it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.68it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.35it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 61.30it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 61.05it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 60.44it/s]generate index:  64%|██████▎   | 328/515 [00:05<00:02, 63.98it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.66it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.82it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 45.92it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.93it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 58.67it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 73.45it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 77.01it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 74.81it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.01it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.66it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.03it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.37it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 54.99it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.86it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.76it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.54it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.57it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.36it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.22it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.64it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 68.52it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.41it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 67.07it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 146.13it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 172.11it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 186.16it/s]remove invalid data : null / measurement error:  59%|█████▉    | 91/154 [00:00<00:00, 192.96it/s]remove invalid data : null / measurement error:  75%|███████▍  | 115/154 [00:00<00:00, 208.01it/s]remove invalid data : null / measurement error:  88%|████████▊ | 136/154 [00:00<00:00, 205.11it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 190.01it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 243.75it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 246.58it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 247.35it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 243.08it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 244.79it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 245.13it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.43it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.43it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 53.85it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.02it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.19it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.49it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.78it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 62.99it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.98it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.83it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.66it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 48.28it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 48.02it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.50it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.92it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 55.67it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 64.39it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.22it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▎         | 7/193 [00:00<00:02, 66.83it/s]remove invalid data : null / measurement error:  15%|█▍        | 28/193 [00:00<00:01, 148.61it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 174.79it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 189.56it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 197.17it/s]remove invalid data : null / measurement error:  59%|█████▊    | 113/193 [00:00<00:00, 197.84it/s]remove invalid data : null / measurement error:  72%|███████▏  | 138/193 [00:00<00:00, 212.34it/s]remove invalid data : null / measurement error:  83%|████████▎ | 160/193 [00:00<00:00, 210.93it/s]remove invalid data : null / measurement error:  94%|█████████▍| 182/193 [00:00<00:00, 207.72it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 194.98it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 246.89it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 249.43it/s]replace nan value:  48%|████▊     | 76/160 [00:00<00:00, 248.98it/s]replace nan value:  63%|██████▎   | 101/160 [00:00<00:00, 246.40it/s]replace nan value:  79%|███████▉  | 126/160 [00:00<00:00, 245.30it/s]replace nan value:  94%|█████████▍| 151/160 [00:00<00:00, 245.93it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 246.48it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 102.50it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.71it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.21it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.72it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.30it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.19it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.53it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 67.79it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.31it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.13it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.88it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.12it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.84it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.93it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.43it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.20it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.27it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 62.44it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.94it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.498, valid loss : 0.294, train acc : 0.748, valid acc : 0.837, train f1 : 0.748, valid f1 : 0.488

  0%|          | 0/196 [00:00<?, ?it/s][A
  6%|▌         | 11/196 [00:00<00:01, 106.08it/s][A
 13%|█▎        | 25/196 [00:00<00:01, 123.34it/s][A
 20%|█▉        | 39/196 [00:00<00:01, 127.13it/s][A
 27%|██▋       | 52/196 [00:00<00:01, 118.38it/s][A
 33%|███▎      | 64/196 [00:00<00:01, 113.27it/s][A
 40%|███▉      | 78/196 [00:00<00:00, 118.56it/s][A
 47%|████▋     | 92/196 [00:00<00:00, 121.06it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 121.46it/s][A
 60%|██████    | 118/196 [00:01<00:00, 114.56it/s][A
 67%|██████▋   | 131/196 [00:01<00:00, 115.43it/s][A
 74%|███████▍  | 145/196 [00:01<00:00, 120.10it/s][A
 81%|████████  | 159/196 [00:01<00:00, 123.69it/s][A
 88%|████████▊ | 172/196 [00:01<00:00, 121.28it/s][A
 94%|█████████▍| 185/196 [00:01<00:00, 115.37it/s][A100%|██████████| 196/196 [00:01<00:00, 118.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.488
training process:   1%|          | 1/128 [02:00<4:15:50, 120.87s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:33<3:38:47, 104.19s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [05:06<3:26:31, 99.14s/it] Best score increase :0.488 -> 0.493
training process:   3%|▎         | 4/128 [06:37<3:18:28, 96.04s/it]epoch : 5, train loss : 0.164, valid loss : 0.376, train acc : 0.939, valid acc : 0.849, train f1 : 0.939, valid f1 : 0.501

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 326.32it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.67it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 333.47it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 335.67it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 337.30it/s][A100%|██████████| 196/196 [00:00<00:00, 335.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.493 -> 0.501
training process:   4%|▍         | 5/128 [08:34<3:32:10, 103.50s/it]Best score increase :0.501 -> 0.548
training process:   5%|▍         | 6/128 [10:06<3:22:14, 99.47s/it] EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:38<3:15:36, 97.00s/it]EarlyStopping counter : 2 out of 40
training process:   6%|▋         | 8/128 [13:09<3:10:38, 95.32s/it]epoch : 9, train loss : 0.089, valid loss : 0.197, train acc : 0.970, valid acc : 0.929, train f1 : 0.970, valid f1 : 0.555

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 312.41it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 320.72it/s][A
 50%|█████     | 98/196 [00:00<00:00, 323.34it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 321.49it/s][A
 84%|████████▎ | 164/196 [00:00<00:00, 323.39it/s][A100%|██████████| 196/196 [00:00<00:00, 322.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.548 -> 0.555
training process:   7%|▋         | 9/128 [15:07<3:23:10, 102.44s/it]Best score increase :0.555 -> 0.573
training process:   8%|▊         | 10/128 [16:40<3:15:14, 99.27s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [18:08<3:07:08, 95.97s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▉         | 12/128 [19:38<3:02:08, 94.21s/it]epoch : 13, train loss : 0.060, valid loss : 0.181, train acc : 0.980, valid acc : 0.941, train f1 : 0.980, valid f1 : 0.568

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 308.31it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 322.78it/s][A
 51%|█████     | 99/196 [00:00<00:00, 328.22it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 329.00it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 328.20it/s][A100%|██████████| 196/196 [00:00<00:00, 326.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  10%|█         | 13/128 [21:37<3:15:04, 101.78s/it]EarlyStopping counter : 4 out of 40
training process:  11%|█         | 14/128 [23:09<3:07:25, 98.65s/it] EarlyStopping counter : 5 out of 40
training process:  12%|█▏        | 15/128 [24:41<3:01:57, 96.61s/it]Best score increase :0.573 -> 0.597
training process:  12%|█▎        | 16/128 [26:12<2:57:36, 95.15s/it]epoch : 17, train loss : 0.046, valid loss : 0.147, train acc : 0.985, valid acc : 0.946, train f1 : 0.985, valid f1 : 0.578

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 317.00it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 324.99it/s][A
 51%|█████     | 100/196 [00:00<00:00, 328.25it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 330.72it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 332.06it/s][A100%|██████████| 196/196 [00:00<00:00, 330.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:09<3:07:59, 101.62s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [29:40<3:00:27, 98.43s/it] EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [31:12<2:55:25, 96.56s/it]Best score increase :0.597 -> 0.601
training process:  16%|█▌        | 20/128 [32:44<2:51:14, 95.14s/it]epoch : 21, train loss : 0.036, valid loss : 0.229, train acc : 0.989, valid acc : 0.932, train f1 : 0.989, valid f1 : 0.561

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 314.03it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 320.24it/s][A
 51%|█████     | 99/196 [00:00<00:00, 326.55it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 330.11it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 332.47it/s][A100%|██████████| 196/196 [00:00<00:00, 330.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [34:41<3:01:21, 101.70s/it]EarlyStopping counter : 2 out of 40
training process:  17%|█▋        | 22/128 [36:11<2:53:33, 98.24s/it] Best score increase :0.601 -> 0.633
training process:  18%|█▊        | 23/128 [37:43<2:48:22, 96.21s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [39:16<2:45:02, 95.22s/it]epoch : 25, train loss : 0.028, valid loss : 0.129, train acc : 0.992, valid acc : 0.959, train f1 : 0.992, valid f1 : 0.605

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 308.41it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 322.28it/s][A
 51%|█████     | 99/196 [00:00<00:00, 327.91it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 331.50it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 333.88it/s][A100%|██████████| 196/196 [00:00<00:00, 330.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  20%|█▉        | 25/128 [41:12<2:54:13, 101.49s/it]EarlyStopping counter : 3 out of 40
training process:  20%|██        | 26/128 [42:44<2:47:57, 98.80s/it] EarlyStopping counter : 4 out of 40
training process:  21%|██        | 27/128 [44:14<2:41:53, 96.17s/it]EarlyStopping counter : 5 out of 40
training process:  22%|██▏       | 28/128 [45:45<2:37:17, 94.38s/it]epoch : 29, train loss : 0.026, valid loss : 0.180, train acc : 0.992, valid acc : 0.958, train f1 : 0.992, valid f1 : 0.603

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 306.84it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 321.73it/s][A
 51%|█████     | 99/196 [00:00<00:00, 326.83it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 329.65it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 330.15it/s][A100%|██████████| 196/196 [00:00<00:00, 327.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 29/128 [47:44<2:47:56, 101.79s/it]EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 30/128 [49:16<2:41:33, 98.91s/it] EarlyStopping counter : 8 out of 40
training process:  24%|██▍       | 31/128 [50:47<2:36:14, 96.64s/it]EarlyStopping counter : 9 out of 40
training process:  25%|██▌       | 32/128 [52:18<2:31:49, 94.89s/it]epoch : 33, train loss : 0.021, valid loss : 0.151, train acc : 0.994, valid acc : 0.956, train f1 : 0.994, valid f1 : 0.602

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 299.79it/s][A
 33%|███▎      | 64/196 [00:00<00:00, 317.92it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 322.12it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 327.10it/s][A
 84%|████████▎ | 164/196 [00:00<00:00, 325.65it/s][A100%|██████████| 196/196 [00:00<00:00, 324.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  26%|██▌       | 33/128 [54:17<2:41:34, 102.05s/it]EarlyStopping counter : 11 out of 40
training process:  27%|██▋       | 34/128 [55:48<2:34:47, 98.80s/it] Best score increase :0.633 -> 0.650
training process:  27%|██▋       | 35/128 [57:21<2:30:28, 97.08s/it]EarlyStopping counter : 1 out of 40
training process:  28%|██▊       | 36/128 [58:52<2:26:14, 95.38s/it]epoch : 37, train loss : 0.018, valid loss : 0.101, train acc : 0.995, valid acc : 0.975, train f1 : 0.995, valid f1 : 0.664

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.44it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 333.64it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 335.88it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 334.97it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 333.76it/s][A100%|██████████| 196/196 [00:00<00:00, 333.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.650 -> 0.664
training process:  29%|██▉       | 37/128 [1:00:50<2:34:46, 102.05s/it]EarlyStopping counter : 1 out of 40
training process:  30%|██▉       | 38/128 [1:02:22<2:28:21, 98.91s/it] EarlyStopping counter : 2 out of 40
training process:  30%|███       | 39/128 [1:03:52<2:23:06, 96.48s/it]EarlyStopping counter : 3 out of 40
training process:  31%|███▏      | 40/128 [1:05:22<2:18:29, 94.43s/it]epoch : 41, train loss : 0.020, valid loss : 0.133, train acc : 0.994, valid acc : 0.970, train f1 : 0.994, valid f1 : 0.637

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 317.58it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 327.02it/s][A
 51%|█████     | 100/196 [00:00<00:00, 330.77it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 333.74it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 331.95it/s][A100%|██████████| 196/196 [00:00<00:00, 331.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  32%|███▏      | 41/128 [1:07:16<2:25:27, 100.31s/it]Best score increase :0.664 -> 0.681
training process:  33%|███▎      | 42/128 [1:08:46<2:19:25, 97.27s/it] EarlyStopping counter : 1 out of 40
training process:  34%|███▎      | 43/128 [1:10:18<2:15:27, 95.62s/it]EarlyStopping counter : 2 out of 40
training process:  34%|███▍      | 44/128 [1:11:50<2:12:26, 94.60s/it]epoch : 45, train loss : 0.016, valid loss : 0.157, train acc : 0.996, valid acc : 0.968, train f1 : 0.996, valid f1 : 0.622

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 318.49it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 328.89it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.83it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 334.68it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 336.45it/s][A100%|██████████| 196/196 [00:00<00:00, 334.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  35%|███▌      | 45/128 [1:13:46<2:19:46, 101.04s/it]EarlyStopping counter : 4 out of 40
training process:  36%|███▌      | 46/128 [1:15:18<2:14:20, 98.30s/it] EarlyStopping counter : 5 out of 40
training process:  37%|███▋      | 47/128 [1:16:49<2:09:43, 96.09s/it]EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 48/128 [1:18:22<2:06:42, 95.03s/it]epoch : 49, train loss : 0.012, valid loss : 0.168, train acc : 0.997, valid acc : 0.964, train f1 : 0.997, valid f1 : 0.625

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 317.80it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.75it/s][A
 51%|█████     | 100/196 [00:00<00:00, 330.53it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 331.41it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 333.34it/s][A100%|██████████| 196/196 [00:00<00:00, 331.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  38%|███▊      | 49/128 [1:20:18<2:13:31, 101.41s/it]EarlyStopping counter : 8 out of 40
training process:  39%|███▉      | 50/128 [1:21:50<2:08:00, 98.47s/it] EarlyStopping counter : 9 out of 40
training process:  40%|███▉      | 51/128 [1:23:19<2:02:56, 95.80s/it]EarlyStopping counter : 10 out of 40
training process:  41%|████      | 52/128 [1:24:49<1:59:13, 94.13s/it]epoch : 53, train loss : 0.014, valid loss : 0.213, train acc : 0.996, valid acc : 0.963, train f1 : 0.996, valid f1 : 0.621

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 324.77it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.14it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 338.04it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.98it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 341.57it/s][A100%|██████████| 196/196 [00:00<00:00, 339.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  41%|████▏     | 53/128 [1:26:48<2:06:47, 101.43s/it]EarlyStopping counter : 12 out of 40
training process:  42%|████▏     | 54/128 [1:28:22<2:02:25, 99.27s/it] EarlyStopping counter : 13 out of 40
training process:  43%|████▎     | 55/128 [1:29:55<1:58:27, 97.36s/it]EarlyStopping counter : 14 out of 40
training process:  44%|████▍     | 56/128 [1:31:26<1:54:36, 95.50s/it]epoch : 57, train loss : 0.014, valid loss : 0.131, train acc : 0.997, valid acc : 0.975, train f1 : 0.997, valid f1 : 0.655

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.69it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.95it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.50it/s][A
 71%|███████   | 139/196 [00:00<00:00, 344.02it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 344.83it/s][A100%|██████████| 196/196 [00:00<00:00, 343.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  45%|████▍     | 57/128 [1:33:22<2:00:02, 101.44s/it]EarlyStopping counter : 16 out of 40
training process:  45%|████▌     | 58/128 [1:34:52<1:54:34, 98.21s/it] EarlyStopping counter : 17 out of 40
training process:  46%|████▌     | 59/128 [1:36:24<1:50:51, 96.40s/it]EarlyStopping counter : 18 out of 40
training process:  47%|████▋     | 60/128 [1:37:58<1:48:26, 95.68s/it]epoch : 61, train loss : 0.013, valid loss : 0.196, train acc : 0.997, valid acc : 0.965, train f1 : 0.997, valid f1 : 0.619

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 303.11it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 319.12it/s][A
 50%|█████     | 98/196 [00:00<00:00, 322.23it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 326.43it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 325.98it/s][A100%|██████████| 196/196 [00:00<00:00, 324.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  48%|████▊     | 61/128 [1:39:55<1:54:00, 102.09s/it]EarlyStopping counter : 20 out of 40
training process:  48%|████▊     | 62/128 [1:41:28<1:49:15, 99.33s/it] EarlyStopping counter : 21 out of 40
training process:  49%|████▉     | 63/128 [1:42:58<1:44:37, 96.57s/it]EarlyStopping counter : 22 out of 40
training process:  50%|█████     | 64/128 [1:44:28<1:40:45, 94.46s/it]epoch : 65, train loss : 0.012, valid loss : 0.233, train acc : 0.997, valid acc : 0.965, train f1 : 0.997, valid f1 : 0.626

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 318.15it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 327.67it/s][A
 51%|█████     | 100/196 [00:00<00:00, 331.84it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 333.82it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 335.24it/s][A100%|██████████| 196/196 [00:00<00:00, 333.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  51%|█████     | 65/128 [1:46:25<1:46:24, 101.34s/it]EarlyStopping counter : 24 out of 40
training process:  52%|█████▏    | 66/128 [1:47:56<1:41:18, 98.04s/it] EarlyStopping counter : 25 out of 40
training process:  52%|█████▏    | 67/128 [1:49:27<1:37:37, 96.02s/it]Best score increase :0.681 -> 0.700
training process:  53%|█████▎    | 68/128 [1:50:59<1:34:49, 94.83s/it]epoch : 69, train loss : 0.012, valid loss : 0.136, train acc : 0.998, valid acc : 0.983, train f1 : 0.998, valid f1 : 0.703

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 326.76it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.81it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 337.01it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 338.78it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 339.71it/s][A100%|██████████| 196/196 [00:00<00:00, 338.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.700 -> 0.703
training process:  54%|█████▍    | 69/128 [1:52:55<1:39:34, 101.26s/it]EarlyStopping counter : 1 out of 40
training process:  55%|█████▍    | 70/128 [1:54:27<1:35:07, 98.40s/it] EarlyStopping counter : 2 out of 40
training process:  55%|█████▌    | 71/128 [1:55:58<1:31:25, 96.23s/it]Best score increase :0.703 -> 0.705
training process:  56%|█████▋    | 72/128 [1:57:33<1:29:19, 95.70s/it]epoch : 73, train loss : 0.011, valid loss : 0.131, train acc : 0.998, valid acc : 0.987, train f1 : 0.998, valid f1 : 0.738

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 318.64it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 330.07it/s][A
 51%|█████     | 100/196 [00:00<00:00, 331.71it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 335.42it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 337.90it/s][A100%|██████████| 196/196 [00:00<00:00, 335.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.705 -> 0.738
training process:  57%|█████▋    | 73/128 [1:59:30<1:33:42, 102.23s/it]Best score increase :0.738 -> 0.749
training process:  58%|█████▊    | 74/128 [2:01:03<1:29:21, 99.29s/it] EarlyStopping counter : 1 out of 40
training process:  59%|█████▊    | 75/128 [2:02:35<1:25:55, 97.28s/it]EarlyStopping counter : 2 out of 40
training process:  59%|█████▉    | 76/128 [2:04:06<1:22:32, 95.24s/it]epoch : 77, train loss : 0.012, valid loss : 0.226, train acc : 0.998, valid acc : 0.969, train f1 : 0.998, valid f1 : 0.633

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.57it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 334.22it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 336.91it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 339.24it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 340.14it/s][A100%|██████████| 196/196 [00:00<00:00, 338.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  60%|██████    | 77/128 [2:06:01<1:26:05, 101.28s/it]EarlyStopping counter : 4 out of 40
training process:  61%|██████    | 78/128 [2:07:35<1:22:34, 99.09s/it] Best score increase :0.749 -> 0.753
training process:  62%|██████▏   | 79/128 [2:09:08<1:19:24, 97.23s/it]EarlyStopping counter : 1 out of 40
training process:  62%|██████▎   | 80/128 [2:10:40<1:16:30, 95.63s/it]epoch : 81, train loss : 0.011, valid loss : 0.137, train acc : 0.998, valid acc : 0.987, train f1 : 0.998, valid f1 : 0.737

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 326.49it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 328.96it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 330.07it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 330.85it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 329.94it/s][A100%|██████████| 196/196 [00:00<00:00, 329.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  63%|██████▎   | 81/128 [2:12:41<1:21:00, 103.42s/it]EarlyStopping counter : 3 out of 40
training process:  64%|██████▍   | 82/128 [2:14:14<1:16:52, 100.28s/it]EarlyStopping counter : 4 out of 40
training process:  65%|██████▍   | 83/128 [2:15:44<1:12:52, 97.18s/it] EarlyStopping counter : 5 out of 40
training process:  66%|██████▌   | 84/128 [2:17:16<1:09:56, 95.38s/it]epoch : 85, train loss : 0.009, valid loss : 0.153, train acc : 0.998, valid acc : 0.984, train f1 : 0.998, valid f1 : 0.713

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.21it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 332.31it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 333.99it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 335.24it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 335.91it/s][A100%|██████████| 196/196 [00:00<00:00, 335.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  66%|██████▋   | 85/128 [2:19:12<1:12:48, 101.60s/it]EarlyStopping counter : 7 out of 40
training process:  67%|██████▋   | 86/128 [2:20:44<1:09:13, 98.90s/it] EarlyStopping counter : 8 out of 40
training process:  68%|██████▊   | 87/128 [2:22:16<1:06:01, 96.62s/it]EarlyStopping counter : 9 out of 40
training process:  69%|██████▉   | 88/128 [2:23:51<1:04:13, 96.34s/it]epoch : 89, train loss : 0.009, valid loss : 0.200, train acc : 0.998, valid acc : 0.978, train f1 : 0.998, valid f1 : 0.673

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 307.04it/s][A
 33%|███▎      | 64/196 [00:00<00:00, 318.64it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 323.37it/s][A
 66%|██████▋   | 130/196 [00:00<00:00, 325.94it/s][A
 84%|████████▎ | 164/196 [00:00<00:00, 327.78it/s][A100%|██████████| 196/196 [00:00<00:00, 325.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  70%|██████▉   | 89/128 [2:25:48<1:06:36, 102.49s/it]EarlyStopping counter : 11 out of 40
training process:  70%|███████   | 90/128 [2:27:21<1:03:05, 99.62s/it] EarlyStopping counter : 12 out of 40
training process:  71%|███████   | 91/128 [2:28:50<59:31, 96.53s/it]  EarlyStopping counter : 13 out of 40
training process:  72%|███████▏  | 92/128 [2:30:23<57:13, 95.39s/it]epoch : 93, train loss : 0.011, valid loss : 0.148, train acc : 0.998, valid acc : 0.985, train f1 : 0.998, valid f1 : 0.717

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.64it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.25it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.39it/s][A
 71%|███████   | 139/196 [00:00<00:00, 344.67it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 346.24it/s][A100%|██████████| 196/196 [00:00<00:00, 344.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  73%|███████▎  | 93/128 [2:32:19<59:11, 101.46s/it]EarlyStopping counter : 15 out of 40
training process:  73%|███████▎  | 94/128 [2:33:52<56:09, 99.10s/it] EarlyStopping counter : 16 out of 40
training process:  74%|███████▍  | 95/128 [2:35:24<53:18, 96.93s/it]EarlyStopping counter : 17 out of 40
training process:  75%|███████▌  | 96/128 [2:36:56<50:56, 95.52s/it]epoch : 97, train loss : 0.006, valid loss : 0.160, train acc : 0.999, valid acc : 0.986, train f1 : 0.999, valid f1 : 0.726

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 296.31it/s][A
 33%|███▎      | 64/196 [00:00<00:00, 318.62it/s][A
 50%|█████     | 98/196 [00:00<00:00, 326.38it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 318.16it/s][A
 83%|████████▎ | 163/196 [00:00<00:00, 268.93it/s][A
 99%|█████████▉| 194/196 [00:00<00:00, 280.31it/s][A100%|██████████| 196/196 [00:00<00:00, 291.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  76%|███████▌  | 97/128 [2:38:53<52:41, 101.99s/it]EarlyStopping counter : 19 out of 40
training process:  77%|███████▋  | 98/128 [2:40:24<49:12, 98.43s/it] EarlyStopping counter : 20 out of 40
training process:  77%|███████▋  | 99/128 [2:41:54<46:29, 96.19s/it]EarlyStopping counter : 21 out of 40
training process:  78%|███████▊  | 100/128 [2:43:27<44:20, 95.03s/it]epoch : 101, train loss : 0.008, valid loss : 0.186, train acc : 0.999, valid acc : 0.980, train f1 : 0.999, valid f1 : 0.685

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 312.99it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.05it/s][A
 51%|█████     | 99/196 [00:00<00:00, 326.77it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 272.65it/s][A
 82%|████████▏ | 161/196 [00:00<00:00, 273.59it/s][A
 98%|█████████▊| 193/196 [00:00<00:00, 287.19it/s][A100%|██████████| 196/196 [00:00<00:00, 291.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  79%|███████▉  | 101/128 [2:45:25<45:52, 101.93s/it]EarlyStopping counter : 23 out of 40
training process:  80%|███████▉  | 102/128 [2:46:55<42:34, 98.27s/it] EarlyStopping counter : 24 out of 40
training process:  80%|████████  | 103/128 [2:48:26<40:05, 96.21s/it]EarlyStopping counter : 25 out of 40
training process:  81%|████████▏ | 104/128 [2:50:00<38:11, 95.49s/it]epoch : 105, train loss : 0.008, valid loss : 0.171, train acc : 0.999, valid acc : 0.984, train f1 : 0.999, valid f1 : 0.715

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.83it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 337.01it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.77it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.05it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 341.91it/s][A100%|██████████| 196/196 [00:00<00:00, 340.63it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  82%|████████▏ | 105/128 [2:52:00<39:28, 102.97s/it]EarlyStopping counter : 27 out of 40
training process:  83%|████████▎ | 106/128 [2:53:29<36:14, 98.84s/it] EarlyStopping counter : 28 out of 40
training process:  84%|████████▎ | 107/128 [2:54:59<33:39, 96.18s/it]EarlyStopping counter : 29 out of 40
training process:  84%|████████▍ | 108/128 [2:56:29<31:25, 94.26s/it]epoch : 109, train loss : 0.008, valid loss : 0.217, train acc : 0.999, valid acc : 0.976, train f1 : 0.999, valid f1 : 0.664

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.35it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.27it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 343.57it/s][A
 71%|███████   | 139/196 [00:00<00:00, 345.57it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 346.70it/s][A100%|██████████| 196/196 [00:00<00:00, 344.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  85%|████████▌ | 109/128 [2:58:24<31:49, 100.51s/it]EarlyStopping counter : 31 out of 40
training process:  86%|████████▌ | 110/128 [2:59:57<29:26, 98.15s/it] EarlyStopping counter : 32 out of 40
training process:  87%|████████▋ | 111/128 [3:01:28<27:12, 96.05s/it]EarlyStopping counter : 33 out of 40
training process:  88%|████████▊ | 112/128 [3:03:00<25:15, 94.75s/it]epoch : 113, train loss : 0.006, valid loss : 0.182, train acc : 0.999, valid acc : 0.984, train f1 : 0.999, valid f1 : 0.712

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 316.32it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 327.59it/s][A
 51%|█████     | 100/196 [00:00<00:00, 331.65it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 333.96it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 335.59it/s][A100%|██████████| 196/196 [00:00<00:00, 332.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 34 out of 40
training process:  88%|████████▊ | 113/128 [3:04:59<25:32, 102.15s/it]EarlyStopping counter : 35 out of 40
training process:  89%|████████▉ | 114/128 [3:06:29<22:58, 98.47s/it] EarlyStopping counter : 36 out of 40
training process:  90%|████████▉ | 115/128 [3:07:58<20:44, 95.74s/it]EarlyStopping counter : 37 out of 40
training process:  91%|█████████ | 116/128 [3:09:30<18:53, 94.46s/it]epoch : 117, train loss : 0.006, valid loss : 0.222, train acc : 0.999, valid acc : 0.979, train f1 : 0.999, valid f1 : 0.675

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 301.64it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 318.56it/s][A
 51%|█████     | 99/196 [00:00<00:00, 326.70it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 331.02it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 333.55it/s][A100%|██████████| 196/196 [00:00<00:00, 330.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 38 out of 40
training process:  91%|█████████▏| 117/128 [3:11:24<18:22, 100.27s/it]EarlyStopping counter : 39 out of 40
training process:  92%|█████████▏| 118/128 [3:12:56<16:18, 97.83s/it] EarlyStopping counter : 40 out of 40
Early stopping | epoch : 118, best f1 score : 0.753
training process:  92%|█████████▏| 118/128 [3:14:27<16:28, 98.88s/it]
training process finished, best loss : 0.127 and best acc : 0.989, best f1 : 0.753, best epoch : 78

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.60      0.59       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.79      0.80      0.79     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.79, test AUC : 0.80, test loss : 26.006

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:14, 12.14s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:02, 12.20s/it]processing for feature importance:  18%|█▊        | 3/17 [00:37<02:55, 12.50s/it]processing for feature importance:  24%|██▎       | 4/17 [00:48<02:36, 12.07s/it]processing for feature importance:  29%|██▉       | 5/17 [01:01<02:29, 12.46s/it]processing for feature importance:  35%|███▌      | 6/17 [01:13<02:16, 12.37s/it]processing for feature importance:  41%|████      | 7/17 [01:25<02:01, 12.13s/it]processing for feature importance:  47%|████▋     | 8/17 [01:38<01:50, 12.28s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:49<01:36, 12.12s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:02<01:24, 12.13s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:14<01:13, 12.20s/it]processing for feature importance:  71%|███████   | 12/17 [02:27<01:02, 12.51s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:39<00:49, 12.36s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:52<00:37, 12.54s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:04<00:24, 12.45s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:17<00:12, 12.51s/it]processing for feature importance: 100%|██████████| 17/17 [03:30<00:00, 12.56s/it]processing for feature importance: 100%|██████████| 17/17 [03:30<00:00, 12.37s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:02<09:34,  2.75s/it]visualize 2D latent space:   1%|          | 2/210 [00:03<04:50,  1.39s/it]visualize 2D latent space:   1%|          | 2/210 [00:03<06:32,  1.89s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:01,  1.81s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:28,  1.34s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<11:14,  3.23s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<06:31,  1.88s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:06,  1.88s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:29,  1.36s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 15%|█▍        | 29/196 [00:00<00:00, 286.70it/s] 32%|███▏      | 62/196 [00:00<00:00, 307.52it/s] 48%|████▊     | 95/196 [00:00<00:00, 315.65it/s] 66%|██████▌   | 129/196 [00:00<00:00, 322.70it/s] 83%|████████▎ | 163/196 [00:00<00:00, 327.48it/s]100%|██████████| 196/196 [00:00<00:00, 323.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 201.62it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 201.01it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 199.97it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 202.88it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 205.01it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 205.96it/s]remove invalid data : null / measurement error:  24%|██▍       | 148/616 [00:00<00:02, 208.48it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 211.31it/s]remove invalid data : null / measurement error:  31%|███       | 192/616 [00:00<00:02, 209.06it/s]remove invalid data : null / measurement error:  35%|███▍      | 213/616 [00:01<00:01, 208.58it/s]remove invalid data : null / measurement error:  38%|███▊      | 234/616 [00:01<00:01, 207.58it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 207.27it/s]remove invalid data : null / measurement error:  45%|████▍     | 277/616 [00:01<00:01, 208.55it/s]remove invalid data : null / measurement error:  48%|████▊     | 298/616 [00:01<00:01, 208.03it/s]remove invalid data : null / measurement error:  52%|█████▏    | 319/616 [00:01<00:01, 207.00it/s]remove invalid data : null / measurement error:  55%|█████▌    | 340/616 [00:01<00:01, 204.80it/s]remove invalid data : null / measurement error:  59%|█████▊    | 361/616 [00:01<00:01, 186.64it/s]remove invalid data : null / measurement error:  62%|██████▏   | 381/616 [00:01<00:01, 188.31it/s]remove invalid data : null / measurement error:  66%|██████▌   | 406/616 [00:01<00:01, 205.51it/s]remove invalid data : null / measurement error:  70%|██████▉   | 430/616 [00:02<00:00, 213.76it/s]remove invalid data : null / measurement error:  74%|███████▎  | 453/616 [00:02<00:00, 218.44it/s]remove invalid data : null / measurement error:  77%|███████▋  | 476/616 [00:02<00:00, 216.29it/s]remove invalid data : null / measurement error:  81%|████████  | 498/616 [00:02<00:00, 209.63it/s]remove invalid data : null / measurement error:  84%|████████▍ | 520/616 [00:02<00:00, 209.32it/s]remove invalid data : null / measurement error:  88%|████████▊ | 542/616 [00:02<00:00, 207.49it/s]remove invalid data : null / measurement error:  91%|█████████▏| 563/616 [00:02<00:00, 205.27it/s]remove invalid data : null / measurement error:  95%|█████████▍| 584/616 [00:02<00:00, 205.51it/s]remove invalid data : null / measurement error:  98%|█████████▊| 605/616 [00:02<00:00, 205.78it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 206.00it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 240.46it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:02, 172.37it/s]replace nan value:  13%|█▎        | 69/515 [00:00<00:02, 165.69it/s]replace nan value:  17%|█▋        | 88/515 [00:00<00:02, 173.62it/s]replace nan value:  22%|██▏       | 113/515 [00:00<00:02, 195.88it/s]replace nan value:  27%|██▋       | 138/515 [00:00<00:01, 212.04it/s]replace nan value:  32%|███▏      | 163/515 [00:00<00:01, 221.12it/s]replace nan value:  37%|███▋      | 188/515 [00:00<00:01, 229.01it/s]replace nan value:  41%|████▏     | 213/515 [00:01<00:01, 234.03it/s]replace nan value:  46%|████▌     | 238/515 [00:01<00:01, 238.18it/s]replace nan value:  51%|█████     | 263/515 [00:01<00:01, 239.65it/s]replace nan value:  56%|█████▌    | 288/515 [00:01<00:00, 241.52it/s]replace nan value:  61%|██████    | 313/515 [00:01<00:00, 243.13it/s]replace nan value:  66%|██████▌   | 338/515 [00:01<00:00, 242.57it/s]replace nan value:  70%|███████   | 363/515 [00:01<00:00, 238.43it/s]replace nan value:  75%|███████▌  | 388/515 [00:01<00:00, 241.56it/s]replace nan value:  80%|████████  | 413/515 [00:01<00:00, 242.34it/s]replace nan value:  85%|████████▌ | 438/515 [00:01<00:00, 242.73it/s]replace nan value:  90%|████████▉ | 463/515 [00:02<00:00, 243.50it/s]replace nan value:  95%|█████████▍| 488/515 [00:02<00:00, 244.53it/s]replace nan value: 100%|█████████▉| 513/515 [00:02<00:00, 245.22it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 229.04it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.50it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.84it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.56it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.11it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.34it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.45it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.69it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.67it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.47it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.49it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.53it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.16it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.94it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.21it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.70it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.52it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.45it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.48it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.82it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.19it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.29it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.43it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.78it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.15it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.24it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.54it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.58it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.46it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.98it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.53it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.64it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.39it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.45it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.27it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.46it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.57it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.16it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.43it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 62.42it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 66.50it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 55.57it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.37it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:04, 40.08it/s]generate index:  69%|██████▉   | 356/515 [00:05<00:03, 47.16it/s]generate index:  71%|███████▏  | 367/515 [00:05<00:02, 59.88it/s]generate index:  73%|███████▎  | 378/515 [00:05<00:01, 71.37it/s]generate index:  75%|███████▍  | 386/515 [00:05<00:01, 72.39it/s]generate index:  77%|███████▋  | 394/515 [00:06<00:01, 73.80it/s]generate index:  78%|███████▊  | 402/515 [00:06<00:01, 69.03it/s]generate index:  80%|███████▉  | 410/515 [00:06<00:01, 53.76it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 56.52it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 69.43it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 51.66it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 45.58it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 56.68it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 61.23it/s]generate index:  91%|█████████▏| 471/515 [00:07<00:00, 54.23it/s]generate index:  93%|█████████▎| 481/515 [00:07<00:00, 64.02it/s]generate index:  95%|█████████▍| 489/515 [00:07<00:00, 65.34it/s]generate index:  97%|█████████▋| 497/515 [00:07<00:00, 61.20it/s]generate index:  98%|█████████▊| 507/515 [00:07<00:00, 67.33it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 57.10it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.00it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 4/154 [00:00<00:03, 39.01it/s]remove invalid data : null / measurement error:  16%|█▌        | 24/154 [00:00<00:00, 131.74it/s]remove invalid data : null / measurement error:  29%|██▊       | 44/154 [00:00<00:00, 162.33it/s]remove invalid data : null / measurement error:  42%|████▏     | 64/154 [00:00<00:00, 175.93it/s]remove invalid data : null / measurement error:  55%|█████▍    | 84/154 [00:00<00:00, 183.01it/s]remove invalid data : null / measurement error:  69%|██████▉   | 107/154 [00:00<00:00, 195.34it/s]remove invalid data : null / measurement error:  83%|████████▎ | 128/154 [00:00<00:00, 197.80it/s]remove invalid data : null / measurement error:  96%|█████████▌| 148/154 [00:00<00:00, 196.91it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 181.02it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 24/131 [00:00<00:00, 230.52it/s]replace nan value:  37%|███▋      | 48/131 [00:00<00:00, 233.83it/s]replace nan value:  55%|█████▍    | 72/131 [00:00<00:00, 230.95it/s]replace nan value:  73%|███████▎  | 96/131 [00:00<00:00, 230.96it/s]replace nan value:  92%|█████████▏| 120/131 [00:00<00:00, 233.18it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 233.19it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.75it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.12it/s]generate index:  16%|█▌        | 21/131 [00:00<00:01, 56.01it/s]generate index:  21%|██        | 27/131 [00:00<00:01, 56.28it/s]generate index:  26%|██▌       | 34/131 [00:00<00:01, 58.97it/s]generate index:  32%|███▏      | 42/131 [00:00<00:01, 60.72it/s]generate index:  37%|███▋      | 49/131 [00:00<00:01, 61.28it/s]generate index:  43%|████▎     | 56/131 [00:00<00:01, 61.33it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 62.98it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 62.40it/s]generate index:  59%|█████▉    | 77/131 [00:01<00:00, 63.95it/s]generate index:  64%|██████▍   | 84/131 [00:01<00:00, 64.52it/s]generate index:  69%|██████▉   | 91/131 [00:01<00:00, 44.66it/s]generate index:  74%|███████▍  | 97/131 [00:01<00:00, 46.91it/s]generate index:  79%|███████▊  | 103/131 [00:01<00:00, 45.65it/s]generate index:  83%|████████▎ | 109/131 [00:02<00:00, 48.16it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 57.67it/s]generate index:  98%|█████████▊| 129/131 [00:02<00:00, 70.93it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 57.82it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 6/193 [00:00<00:03, 59.64it/s]remove invalid data : null / measurement error:  14%|█▍        | 27/193 [00:00<00:01, 144.63it/s]remove invalid data : null / measurement error:  24%|██▍       | 47/193 [00:00<00:00, 169.48it/s]remove invalid data : null / measurement error:  35%|███▌      | 68/193 [00:00<00:00, 183.55it/s]remove invalid data : null / measurement error:  46%|████▌     | 89/193 [00:00<00:00, 192.51it/s]remove invalid data : null / measurement error:  56%|█████▋    | 109/193 [00:00<00:00, 189.83it/s]remove invalid data : null / measurement error:  69%|██████▉   | 133/193 [00:00<00:00, 203.81it/s]remove invalid data : null / measurement error:  80%|███████▉  | 154/193 [00:00<00:00, 203.12it/s]remove invalid data : null / measurement error:  91%|█████████ | 175/193 [00:00<00:00, 200.56it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 188.74it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 24/160 [00:00<00:00, 239.67it/s]replace nan value:  31%|███       | 49/160 [00:00<00:00, 242.25it/s]replace nan value:  46%|████▋     | 74/160 [00:00<00:00, 242.56it/s]replace nan value:  62%|██████▏   | 99/160 [00:00<00:00, 240.97it/s]replace nan value:  78%|███████▊  | 124/160 [00:00<00:00, 240.09it/s]replace nan value:  93%|█████████▎| 149/160 [00:00<00:00, 240.18it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 239.57it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 103.24it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.24it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.60it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.87it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 79.85it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 81.23it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 81.25it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 66.31it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 57.07it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 57.88it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 51.76it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 48.10it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 57.82it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 58.95it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 54.43it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 53.18it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 57.16it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 61.29it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.01it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.012, train acc : 0.621, valid acc : 0.923, train f1 : 0.396, valid f1 : 0.505

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 332.72it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 345.91it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 347.11it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 350.38it/s][A
 90%|█████████ | 177/196 [00:00<00:00, 351.71it/s][A100%|██████████| 196/196 [00:00<00:00, 350.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.505
training process:   1%|          | 1/128 [01:58<4:11:08, 118.65s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:25<3:29:44, 99.88s/it] Best score increase :0.505 -> 0.554
training process:   2%|▏         | 3/128 [04:53<3:16:56, 94.53s/it]EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:20<3:09:17, 91.59s/it]epoch : 5, train loss : 0.010, valid loss : 0.009, train acc : 0.858, valid acc : 0.925, train f1 : 0.495, valid f1 : 0.534

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.45it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 341.31it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.52it/s][A
 71%|███████   | 139/196 [00:00<00:00, 342.24it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 343.08it/s][A100%|██████████| 196/196 [00:00<00:00, 342.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   4%|▍         | 5/128 [08:10<3:21:21, 98.22s/it]EarlyStopping counter : 3 out of 40
training process:   5%|▍         | 6/128 [09:37<3:11:52, 94.36s/it]EarlyStopping counter : 4 out of 40
training process:   5%|▌         | 7/128 [11:03<3:04:38, 91.56s/it]EarlyStopping counter : 5 out of 40
training process:   6%|▋         | 8/128 [12:30<3:00:27, 90.23s/it]epoch : 9, train loss : 0.008, valid loss : 0.011, train acc : 0.912, valid acc : 0.974, train f1 : 0.532, valid f1 : 0.599

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 308.60it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 322.58it/s][A
 50%|█████     | 98/196 [00:00<00:00, 323.24it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 321.61it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 326.29it/s][A100%|██████████| 196/196 [00:00<00:00, 325.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.554 -> 0.599
training process:   7%|▋         | 9/128 [14:25<3:14:20, 97.99s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:00<3:10:41, 96.96s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [17:32<3:06:21, 95.57s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▉         | 12/128 [19:04<3:02:45, 94.53s/it]epoch : 13, train loss : 0.008, valid loss : 0.009, train acc : 0.940, valid acc : 0.964, train f1 : 0.564, valid f1 : 0.591

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.38it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.23it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 341.22it/s][A
 71%|███████   | 139/196 [00:00<00:00, 342.13it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 343.60it/s][A100%|██████████| 196/196 [00:00<00:00, 342.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  10%|█         | 13/128 [21:05<3:16:17, 102.41s/it]Best score increase :0.599 -> 0.696
training process:  11%|█         | 14/128 [22:34<3:07:07, 98.49s/it] EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [24:03<2:59:36, 95.37s/it]EarlyStopping counter : 2 out of 40
training process:  12%|█▎        | 16/128 [25:31<2:53:58, 93.20s/it]epoch : 17, train loss : 0.008, valid loss : 0.008, train acc : 0.955, valid acc : 0.962, train f1 : 0.593, valid f1 : 0.600

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 328.55it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 333.02it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 329.39it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 333.47it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 334.51it/s][A100%|██████████| 196/196 [00:00<00:00, 333.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  13%|█▎        | 17/128 [27:20<3:01:36, 98.17s/it]EarlyStopping counter : 4 out of 40
training process:  14%|█▍        | 18/128 [28:46<2:53:07, 94.44s/it]EarlyStopping counter : 5 out of 40
training process:  15%|█▍        | 19/128 [30:15<2:48:44, 92.89s/it]EarlyStopping counter : 6 out of 40
training process:  16%|█▌        | 20/128 [31:45<2:45:22, 91.87s/it]epoch : 21, train loss : 0.008, valid loss : 0.012, train acc : 0.972, valid acc : 0.992, train f1 : 0.642, valid f1 : 0.755

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 321.19it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 328.36it/s][A
 51%|█████     | 100/196 [00:00<00:00, 328.13it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 329.99it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 331.34it/s][A100%|██████████| 196/196 [00:00<00:00, 329.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.696 -> 0.755
training process:  16%|█▋        | 21/128 [33:37<2:54:45, 98.00s/it]EarlyStopping counter : 1 out of 40
training process:  17%|█▋        | 22/128 [35:02<2:45:53, 93.91s/it]Best score increase :0.755 -> 0.785
training process:  18%|█▊        | 23/128 [36:28<2:40:33, 91.75s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [37:54<2:35:56, 89.96s/it]epoch : 25, train loss : 0.008, valid loss : 0.008, train acc : 0.982, valid acc : 0.966, train f1 : 0.694, valid f1 : 0.625

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.89it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.23it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 334.73it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 336.61it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 337.23it/s][A100%|██████████| 196/196 [00:00<00:00, 336.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  20%|█▉        | 25/128 [39:47<2:46:20, 96.90s/it]EarlyStopping counter : 3 out of 40
training process:  20%|██        | 26/128 [41:15<2:39:54, 94.07s/it]EarlyStopping counter : 4 out of 40
training process:  21%|██        | 27/128 [42:44<2:36:07, 92.75s/it]EarlyStopping counter : 5 out of 40
training process:  22%|██▏       | 28/128 [44:14<2:33:15, 91.96s/it]epoch : 29, train loss : 0.007, valid loss : 0.010, train acc : 0.986, valid acc : 0.994, train f1 : 0.726, valid f1 : 0.819

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.68it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 335.41it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 337.00it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.69it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 337.49it/s][A100%|██████████| 196/196 [00:00<00:00, 337.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.785 -> 0.819
training process:  23%|██▎       | 29/128 [46:07<2:42:05, 98.24s/it]EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 30/128 [47:36<2:35:39, 95.30s/it]EarlyStopping counter : 2 out of 40
training process:  24%|██▍       | 31/128 [49:06<2:31:32, 93.74s/it]EarlyStopping counter : 3 out of 40
training process:  25%|██▌       | 32/128 [50:34<2:27:23, 92.12s/it]epoch : 33, train loss : 0.007, valid loss : 0.009, train acc : 0.987, valid acc : 0.971, train f1 : 0.751, valid f1 : 0.639

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.47it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 339.81it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 341.29it/s][A
 71%|███████   | 139/196 [00:00<00:00, 340.41it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 339.19it/s][A100%|██████████| 196/196 [00:00<00:00, 339.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  26%|██▌       | 33/128 [52:30<2:37:11, 99.28s/it]EarlyStopping counter : 5 out of 40
training process:  27%|██▋       | 34/128 [53:58<2:30:21, 95.97s/it]EarlyStopping counter : 6 out of 40
training process:  27%|██▋       | 35/128 [55:28<2:25:48, 94.07s/it]Best score increase :0.819 -> 0.825
training process:  28%|██▊       | 36/128 [56:55<2:21:10, 92.07s/it]epoch : 37, train loss : 0.006, valid loss : 0.008, train acc : 0.990, valid acc : 0.989, train f1 : 0.788, valid f1 : 0.768

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.81it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 335.91it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 334.54it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 336.44it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 337.15it/s][A100%|██████████| 196/196 [00:00<00:00, 336.73it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  29%|██▉       | 37/128 [58:50<2:29:55, 98.85s/it]EarlyStopping counter : 2 out of 40
training process:  30%|██▉       | 38/128 [1:00:17<2:22:55, 95.29s/it]EarlyStopping counter : 3 out of 40
training process:  30%|███       | 39/128 [1:01:42<2:16:39, 92.13s/it]EarlyStopping counter : 4 out of 40
training process:  31%|███▏      | 40/128 [1:03:07<2:12:09, 90.10s/it]epoch : 41, train loss : 0.006, valid loss : 0.012, train acc : 0.992, valid acc : 0.995, train f1 : 0.821, valid f1 : 0.860

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.80it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.56it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 345.91it/s][A
 71%|███████   | 139/196 [00:00<00:00, 278.63it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 282.97it/s][A100%|██████████| 196/196 [00:00<00:00, 301.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.825 -> 0.860
training process:  32%|███▏      | 41/128 [1:05:02<2:21:20, 97.48s/it]EarlyStopping counter : 1 out of 40
training process:  33%|███▎      | 42/128 [1:06:27<2:14:34, 93.89s/it]Best score increase :0.860 -> 0.862
training process:  34%|███▎      | 43/128 [1:07:54<2:09:54, 91.70s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▍      | 44/128 [1:09:23<2:07:04, 90.76s/it]epoch : 45, train loss : 0.005, valid loss : 0.011, train acc : 0.993, valid acc : 0.994, train f1 : 0.836, valid f1 : 0.845

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.06it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 276.59it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 265.97it/s][A
 66%|██████▌   | 129/196 [00:00<00:00, 278.72it/s][A
 81%|████████  | 158/196 [00:00<00:00, 252.27it/s][A
 97%|█████████▋| 190/196 [00:00<00:00, 270.26it/s][A100%|██████████| 196/196 [00:00<00:00, 273.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  35%|███▌      | 45/128 [1:11:17<2:15:09, 97.70s/it]EarlyStopping counter : 3 out of 40
training process:  36%|███▌      | 46/128 [1:12:45<2:09:46, 94.95s/it]EarlyStopping counter : 4 out of 40
training process:  37%|███▋      | 47/128 [1:14:13<2:05:25, 92.91s/it]EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 48/128 [1:15:42<2:02:18, 91.73s/it]epoch : 49, train loss : 0.005, valid loss : 0.012, train acc : 0.993, valid acc : 0.995, train f1 : 0.839, valid f1 : 0.849

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 324.98it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 333.50it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 334.75it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 337.12it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 338.11it/s][A100%|██████████| 196/196 [00:00<00:00, 336.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 49/128 [1:17:34<2:08:50, 97.85s/it]EarlyStopping counter : 7 out of 40
training process:  39%|███▉      | 50/128 [1:19:04<2:03:50, 95.27s/it]EarlyStopping counter : 8 out of 40
training process:  40%|███▉      | 51/128 [1:20:32<1:59:28, 93.10s/it]EarlyStopping counter : 9 out of 40
training process:  41%|████      | 52/128 [1:22:03<1:57:21, 92.65s/it]epoch : 53, train loss : 0.005, valid loss : 0.013, train acc : 0.994, valid acc : 0.994, train f1 : 0.860, valid f1 : 0.828

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.15it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 333.80it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.65it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 334.28it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 336.99it/s][A100%|██████████| 196/196 [00:00<00:00, 335.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  41%|████▏     | 53/128 [1:23:59<2:04:21, 99.49s/it]EarlyStopping counter : 11 out of 40
training process:  42%|████▏     | 54/128 [1:25:27<1:58:28, 96.06s/it]EarlyStopping counter : 12 out of 40
training process:  43%|████▎     | 55/128 [1:26:57<1:54:39, 94.25s/it]EarlyStopping counter : 13 out of 40
training process:  44%|████▍     | 56/128 [1:28:23<1:50:15, 91.88s/it]epoch : 57, train loss : 0.004, valid loss : 0.014, train acc : 0.995, valid acc : 0.994, train f1 : 0.873, valid f1 : 0.841

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 328.66it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.31it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 333.82it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 336.60it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 337.61it/s][A100%|██████████| 196/196 [00:00<00:00, 332.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  45%|████▍     | 57/128 [1:30:16<1:56:18, 98.30s/it]EarlyStopping counter : 15 out of 40
training process:  45%|████▌     | 58/128 [1:31:45<1:51:08, 95.26s/it]EarlyStopping counter : 16 out of 40
training process:  46%|████▌     | 59/128 [1:33:14<1:47:43, 93.67s/it]EarlyStopping counter : 17 out of 40
training process:  47%|████▋     | 60/128 [1:34:41<1:43:38, 91.45s/it]epoch : 61, train loss : 0.004, valid loss : 0.014, train acc : 0.995, valid acc : 0.991, train f1 : 0.878, valid f1 : 0.795

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 324.65it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.87it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.04it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 338.29it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 339.82it/s][A100%|██████████| 196/196 [00:00<00:00, 337.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  48%|████▊     | 61/128 [1:36:36<1:49:56, 98.46s/it]EarlyStopping counter : 19 out of 40
training process:  48%|████▊     | 62/128 [1:38:05<1:45:22, 95.80s/it]EarlyStopping counter : 20 out of 40
training process:  49%|████▉     | 63/128 [1:39:34<1:41:38, 93.82s/it]Best score increase :0.862 -> 0.868
training process:  50%|█████     | 64/128 [1:41:04<1:38:48, 92.64s/it]epoch : 65, train loss : 0.003, valid loss : 0.017, train acc : 0.996, valid acc : 0.993, train f1 : 0.896, valid f1 : 0.815

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 310.69it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 324.04it/s][A
 51%|█████     | 99/196 [00:00<00:00, 326.17it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 329.99it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 332.21it/s][A100%|██████████| 196/196 [00:00<00:00, 329.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  51%|█████     | 65/128 [1:42:59<1:44:11, 99.23s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 66/128 [1:44:27<1:39:15, 96.05s/it]EarlyStopping counter : 3 out of 40
training process:  52%|█████▏    | 67/128 [1:45:52<1:34:13, 92.69s/it]EarlyStopping counter : 4 out of 40
training process:  53%|█████▎    | 68/128 [1:47:21<1:31:34, 91.58s/it]epoch : 69, train loss : 0.003, valid loss : 0.018, train acc : 0.996, valid acc : 0.993, train f1 : 0.898, valid f1 : 0.825

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 252.93it/s][A
 28%|██▊       | 54/196 [00:00<00:00, 267.58it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 273.00it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 275.68it/s][A
 70%|███████   | 138/196 [00:00<00:00, 276.91it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 277.19it/s][A
 99%|█████████▉| 194/196 [00:00<00:00, 276.75it/s][A100%|██████████| 196/196 [00:00<00:00, 274.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  54%|█████▍    | 69/128 [1:49:17<1:37:07, 98.77s/it]EarlyStopping counter : 6 out of 40
training process:  55%|█████▍    | 70/128 [1:50:44<1:32:06, 95.29s/it]EarlyStopping counter : 7 out of 40
training process:  55%|█████▌    | 71/128 [1:52:13<1:28:38, 93.30s/it]EarlyStopping counter : 8 out of 40
training process:  56%|█████▋    | 72/128 [1:53:41<1:25:41, 91.81s/it]epoch : 73, train loss : 0.003, valid loss : 0.017, train acc : 0.996, valid acc : 0.994, train f1 : 0.898, valid f1 : 0.841

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.89it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.41it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 346.27it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 347.66it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 346.48it/s][A100%|██████████| 196/196 [00:00<00:00, 345.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  57%|█████▋    | 73/128 [1:55:36<1:30:27, 98.68s/it]EarlyStopping counter : 10 out of 40
training process:  58%|█████▊    | 74/128 [1:57:06<1:26:28, 96.09s/it]EarlyStopping counter : 11 out of 40
training process:  59%|█████▊    | 75/128 [1:58:34<1:22:42, 93.63s/it]EarlyStopping counter : 12 out of 40
training process:  59%|█████▉    | 76/128 [2:00:02<1:19:41, 91.96s/it]epoch : 77, train loss : 0.003, valid loss : 0.016, train acc : 0.996, valid acc : 0.994, train f1 : 0.900, valid f1 : 0.827

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 297.62it/s][A
 31%|███       | 60/196 [00:00<00:00, 286.84it/s][A
 45%|████▌     | 89/196 [00:00<00:00, 283.61it/s][A
 60%|██████    | 118/196 [00:00<00:00, 281.48it/s][A
 75%|███████▌  | 147/196 [00:00<00:00, 275.36it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 275.41it/s][A100%|██████████| 196/196 [00:00<00:00, 279.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  60%|██████    | 77/128 [2:01:55<1:23:35, 98.35s/it]EarlyStopping counter : 14 out of 40
training process:  61%|██████    | 78/128 [2:03:21<1:18:56, 94.72s/it]EarlyStopping counter : 15 out of 40
training process:  62%|██████▏   | 79/128 [2:04:50<1:15:48, 92.83s/it]EarlyStopping counter : 16 out of 40
training process:  62%|██████▎   | 80/128 [2:06:16<1:12:38, 90.80s/it]epoch : 81, train loss : 0.003, valid loss : 0.019, train acc : 0.997, valid acc : 0.994, train f1 : 0.913, valid f1 : 0.831

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 263.54it/s][A
 30%|███       | 59/196 [00:00<00:00, 295.21it/s][A
 47%|████▋     | 92/196 [00:00<00:00, 309.02it/s][A
 63%|██████▎   | 123/196 [00:00<00:00, 295.32it/s][A
 78%|███████▊  | 153/196 [00:00<00:00, 243.37it/s][A
 93%|█████████▎| 183/196 [00:00<00:00, 259.54it/s][A100%|██████████| 196/196 [00:00<00:00, 272.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  63%|██████▎   | 81/128 [2:08:13<1:17:23, 98.80s/it]EarlyStopping counter : 18 out of 40
training process:  64%|██████▍   | 82/128 [2:09:40<1:13:02, 95.27s/it]EarlyStopping counter : 19 out of 40
training process:  65%|██████▍   | 83/128 [2:11:07<1:09:38, 92.86s/it]EarlyStopping counter : 20 out of 40
training process:  66%|██████▌   | 84/128 [2:12:36<1:07:04, 91.47s/it]epoch : 85, train loss : 0.003, valid loss : 0.020, train acc : 0.997, valid acc : 0.994, train f1 : 0.914, valid f1 : 0.840

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.41it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 333.39it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 335.63it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.52it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 332.03it/s][A100%|██████████| 196/196 [00:00<00:00, 333.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  66%|██████▋   | 85/128 [2:14:30<1:10:32, 98.42s/it]EarlyStopping counter : 22 out of 40
training process:  67%|██████▋   | 86/128 [2:16:00<1:07:07, 95.90s/it]EarlyStopping counter : 23 out of 40
training process:  68%|██████▊   | 87/128 [2:17:27<1:03:41, 93.20s/it]EarlyStopping counter : 24 out of 40
training process:  69%|██████▉   | 88/128 [2:18:57<1:01:22, 92.05s/it]epoch : 89, train loss : 0.002, valid loss : 0.027, train acc : 0.997, valid acc : 0.996, train f1 : 0.925, valid f1 : 0.855

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.17it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 334.04it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 331.76it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 334.82it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 336.30it/s][A100%|██████████| 196/196 [00:00<00:00, 335.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 25 out of 40
training process:  70%|██████▉   | 89/128 [2:20:51<1:04:15, 98.85s/it]EarlyStopping counter : 26 out of 40
training process:  70%|███████   | 90/128 [2:22:19<1:00:31, 95.56s/it]EarlyStopping counter : 27 out of 40
training process:  71%|███████   | 91/128 [2:23:49<57:52, 93.84s/it]  EarlyStopping counter : 28 out of 40
training process:  72%|███████▏  | 92/128 [2:25:18<55:22, 92.29s/it]epoch : 93, train loss : 0.002, valid loss : 0.022, train acc : 0.997, valid acc : 0.993, train f1 : 0.934, valid f1 : 0.809

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.96it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 339.97it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 341.02it/s][A
 71%|███████   | 139/196 [00:00<00:00, 341.28it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.66it/s][A100%|██████████| 196/196 [00:00<00:00, 341.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 29 out of 40
training process:  73%|███████▎  | 93/128 [2:27:12<57:38, 98.83s/it]EarlyStopping counter : 30 out of 40
training process:  73%|███████▎  | 94/128 [2:28:40<54:07, 95.52s/it]EarlyStopping counter : 31 out of 40
training process:  74%|███████▍  | 95/128 [2:30:06<51:05, 92.89s/it]EarlyStopping counter : 32 out of 40
training process:  75%|███████▌  | 96/128 [2:31:37<49:09, 92.16s/it]epoch : 97, train loss : 0.003, valid loss : 0.026, train acc : 0.997, valid acc : 0.994, train f1 : 0.928, valid f1 : 0.826

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 332.48it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.03it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 334.19it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 336.24it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 337.01it/s][A100%|██████████| 196/196 [00:00<00:00, 335.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 33 out of 40
training process:  76%|███████▌  | 97/128 [2:33:31<50:57, 98.62s/it]EarlyStopping counter : 34 out of 40
training process:  77%|███████▋  | 98/128 [2:34:57<47:26, 94.89s/it]EarlyStopping counter : 35 out of 40
training process:  77%|███████▋  | 99/128 [2:36:25<44:57, 93.01s/it]EarlyStopping counter : 36 out of 40
training process:  78%|███████▊  | 100/128 [2:37:55<42:58, 92.09s/it]epoch : 101, train loss : 0.002, valid loss : 0.029, train acc : 0.998, valid acc : 0.995, train f1 : 0.943, valid f1 : 0.849

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 316.06it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 334.85it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 262.82it/s][A
 66%|██████▌   | 129/196 [00:00<00:00, 238.78it/s][A
 79%|███████▊  | 154/196 [00:00<00:00, 228.19it/s][A
 92%|█████████▏| 181/196 [00:00<00:00, 240.15it/s][A100%|██████████| 196/196 [00:00<00:00, 252.36it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 37 out of 40
training process:  79%|███████▉  | 101/128 [2:39:51<44:39, 99.23s/it]EarlyStopping counter : 38 out of 40
training process:  80%|███████▉  | 102/128 [2:41:19<41:32, 95.86s/it]EarlyStopping counter : 39 out of 40
training process:  80%|████████  | 103/128 [2:42:48<39:02, 93.72s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 103, best f1 score : 0.868
training process:  80%|████████  | 103/128 [2:44:19<39:53, 95.73s/it]
training process finished, best loss : 0.020 and best acc : 0.996, best f1 : 0.868, best epoch : 63

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.70      0.57      0.63       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.85      0.78      0.81     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.81, test AUC : 0.78, test loss : 6.338

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:06, 11.68s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:54, 11.66s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:42, 11.59s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:29, 11.49s/it]processing for feature importance:  29%|██▉       | 5/17 [00:57<02:17, 11.42s/it]processing for feature importance:  35%|███▌      | 6/17 [01:09<02:08, 11.71s/it]processing for feature importance:  41%|████      | 7/17 [01:21<01:55, 11.59s/it]processing for feature importance:  47%|████▋     | 8/17 [01:32<01:42, 11.39s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:43<01:30, 11.36s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:54<01:19, 11.41s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:06<01:09, 11.62s/it]processing for feature importance:  71%|███████   | 12/17 [02:19<00:58, 11.77s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:30<00:46, 11.73s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:42<00:34, 11.64s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:53<00:23, 11.60s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:04<00:11, 11.47s/it]processing for feature importance: 100%|██████████| 17/17 [03:17<00:00, 11.74s/it]processing for feature importance: 100%|██████████| 17/17 [03:17<00:00, 11.60s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<11:41,  3.36s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<09:38,  2.78s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:13,  1.11s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<02:00,  1.83s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<12:27,  3.58s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:05<09:06,  2.63s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:22,  2.13s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:36,  1.46s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 16%|█▋        | 32/196 [00:00<00:00, 310.81it/s] 34%|███▍      | 67/196 [00:00<00:00, 333.41it/s] 53%|█████▎    | 103/196 [00:00<00:00, 341.43it/s] 71%|███████   | 139/196 [00:00<00:00, 345.12it/s] 89%|████████▉ | 174/196 [00:00<00:00, 346.07it/s]100%|██████████| 196/196 [00:00<00:00, 342.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_smoothing_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:03, 196.01it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 193.14it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 191.16it/s]remove invalid data : null / measurement error:  13%|█▎        | 80/616 [00:00<00:02, 192.81it/s]remove invalid data : null / measurement error:  16%|█▌        | 100/616 [00:00<00:02, 194.72it/s]remove invalid data : null / measurement error:  20%|█▉        | 121/616 [00:00<00:02, 197.67it/s]remove invalid data : null / measurement error:  23%|██▎       | 142/616 [00:00<00:02, 199.24it/s]remove invalid data : null / measurement error:  26%|██▋       | 163/616 [00:00<00:02, 201.55it/s]remove invalid data : null / measurement error:  30%|██▉       | 184/616 [00:00<00:02, 198.98it/s]remove invalid data : null / measurement error:  33%|███▎      | 204/616 [00:01<00:02, 197.31it/s]remove invalid data : null / measurement error:  36%|███▋      | 224/616 [00:01<00:01, 197.04it/s]remove invalid data : null / measurement error:  40%|███▉      | 244/616 [00:01<00:01, 197.45it/s]remove invalid data : null / measurement error:  43%|████▎     | 264/616 [00:01<00:01, 184.16it/s]remove invalid data : null / measurement error:  46%|████▌     | 283/616 [00:01<00:01, 172.02it/s]remove invalid data : null / measurement error:  49%|████▉     | 304/616 [00:01<00:01, 180.15it/s]remove invalid data : null / measurement error:  52%|█████▏    | 323/616 [00:01<00:01, 160.69it/s]remove invalid data : null / measurement error:  56%|█████▌    | 342/616 [00:01<00:01, 167.26it/s]remove invalid data : null / measurement error:  59%|█████▉    | 362/616 [00:01<00:01, 175.89it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:02<00:01, 194.23it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:02<00:00, 212.29it/s]remove invalid data : null / measurement error:  71%|███████   | 435/616 [00:02<00:00, 193.91it/s]remove invalid data : null / measurement error:  74%|███████▍  | 455/616 [00:02<00:00, 189.38it/s]remove invalid data : null / measurement error:  77%|███████▋  | 476/616 [00:02<00:00, 194.01it/s]remove invalid data : null / measurement error:  81%|████████  | 496/616 [00:02<00:00, 173.40it/s]remove invalid data : null / measurement error:  84%|████████▎ | 515/616 [00:02<00:00, 176.67it/s]remove invalid data : null / measurement error:  87%|████████▋ | 535/616 [00:02<00:00, 181.38it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 184.70it/s]remove invalid data : null / measurement error:  93%|█████████▎| 575/616 [00:03<00:00, 187.32it/s]remove invalid data : null / measurement error:  97%|█████████▋| 595/616 [00:03<00:00, 189.57it/s]remove invalid data : null / measurement error: 100%|█████████▉| 615/616 [00:03<00:00, 190.77it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 188.06it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/515 [00:00<00:02, 224.51it/s]replace nan value:   9%|▉         | 46/515 [00:00<00:02, 225.48it/s]replace nan value:  13%|█▎        | 69/515 [00:00<00:01, 225.22it/s]replace nan value:  18%|█▊        | 93/515 [00:00<00:01, 227.91it/s]replace nan value:  23%|██▎       | 117/515 [00:00<00:01, 228.70it/s]replace nan value:  27%|██▋       | 141/515 [00:00<00:01, 229.77it/s]replace nan value:  32%|███▏      | 165/515 [00:00<00:01, 230.89it/s]replace nan value:  37%|███▋      | 189/515 [00:00<00:01, 231.08it/s]replace nan value:  41%|████▏     | 213/515 [00:00<00:01, 231.25it/s]replace nan value:  46%|████▌     | 237/515 [00:01<00:01, 199.93it/s]replace nan value:  51%|█████     | 261/515 [00:01<00:01, 208.57it/s]replace nan value:  55%|█████▍    | 283/515 [00:01<00:01, 195.06it/s]replace nan value:  59%|█████▉    | 304/515 [00:01<00:01, 197.43it/s]replace nan value:  64%|██████▎   | 328/515 [00:01<00:00, 207.14it/s]replace nan value:  68%|██████▊   | 351/515 [00:01<00:00, 211.50it/s]replace nan value:  73%|███████▎  | 375/515 [00:01<00:00, 217.59it/s]replace nan value:  77%|███████▋  | 399/515 [00:01<00:00, 221.74it/s]replace nan value:  82%|████████▏ | 423/515 [00:01<00:00, 224.53it/s]replace nan value:  87%|████████▋ | 446/515 [00:02<00:00, 224.76it/s]replace nan value:  91%|█████████ | 469/515 [00:02<00:00, 225.50it/s]replace nan value:  96%|█████████▌| 492/515 [00:02<00:00, 203.80it/s]replace nan value: 100%|█████████▉| 513/515 [00:02<00:00, 201.89it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 214.83it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 3/515 [00:00<00:18, 27.94it/s]generate index:   1%|          | 6/515 [00:00<00:21, 24.07it/s]generate index:   3%|▎         | 13/515 [00:00<00:12, 39.52it/s]generate index:   5%|▍         | 24/515 [00:00<00:07, 62.48it/s]generate index:   6%|▌         | 31/515 [00:00<00:07, 63.30it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 68.81it/s]generate index:   9%|▉         | 48/515 [00:00<00:08, 54.46it/s]generate index:  11%|█         | 55/515 [00:01<00:08, 57.14it/s]generate index:  12%|█▏        | 62/515 [00:01<00:09, 46.93it/s]generate index:  14%|█▎        | 70/515 [00:01<00:08, 53.99it/s]generate index:  15%|█▍        | 77/515 [00:01<00:08, 53.92it/s]generate index:  17%|█▋        | 87/515 [00:01<00:06, 64.31it/s]generate index:  18%|█▊        | 94/515 [00:01<00:06, 63.56it/s]generate index:  20%|█▉        | 101/515 [00:01<00:06, 59.40it/s]generate index:  21%|██▏       | 110/515 [00:01<00:06, 65.62it/s]generate index:  23%|██▎       | 118/515 [00:02<00:06, 63.89it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.58it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.87it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.63it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.35it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 73.17it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.34it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.76it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.23it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 71.69it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.78it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.25it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.22it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 87.68it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 90.28it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.10it/s]generate index:  51%|█████     | 261/515 [00:03<00:03, 73.83it/s]generate index:  52%|█████▏    | 270/515 [00:04<00:03, 76.88it/s]generate index:  54%|█████▍    | 279/515 [00:04<00:03, 66.86it/s]generate index:  56%|█████▌    | 287/515 [00:04<00:03, 64.60it/s]generate index:  57%|█████▋    | 295/515 [00:04<00:03, 64.28it/s]generate index:  59%|█████▊    | 302/515 [00:04<00:03, 60.80it/s]generate index:  60%|██████    | 310/515 [00:04<00:03, 64.92it/s]generate index:  62%|██████▏   | 317/515 [00:04<00:03, 59.38it/s]generate index:  63%|██████▎   | 324/515 [00:04<00:03, 61.97it/s]generate index:  64%|██████▍   | 331/515 [00:05<00:02, 61.98it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 50.50it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 45.96it/s]generate index:  68%|██████▊   | 349/515 [00:05<00:04, 41.50it/s]generate index:  70%|██████▉   | 359/515 [00:05<00:02, 53.67it/s]generate index:  72%|███████▏  | 371/515 [00:05<00:02, 68.77it/s]generate index:  74%|███████▍  | 381/515 [00:05<00:01, 72.64it/s]generate index:  76%|███████▌  | 389/515 [00:06<00:01, 69.56it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 75.12it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 61.46it/s]generate index:  81%|████████  | 415/515 [00:06<00:01, 64.88it/s]generate index:  83%|████████▎ | 426/515 [00:06<00:01, 73.17it/s]generate index:  84%|████████▍ | 434/515 [00:06<00:01, 60.52it/s]generate index:  86%|████████▌ | 441/515 [00:07<00:01, 47.09it/s]generate index:  88%|████████▊ | 451/515 [00:07<00:01, 57.14it/s]generate index:  89%|████████▉ | 458/515 [00:07<00:00, 59.26it/s]generate index:  90%|█████████ | 466/515 [00:07<00:00, 62.67it/s]generate index:  92%|█████████▏| 473/515 [00:07<00:00, 57.03it/s]generate index:  94%|█████████▍| 485/515 [00:07<00:00, 69.40it/s]generate index:  96%|█████████▌| 493/515 [00:07<00:00, 65.29it/s]generate index:  97%|█████████▋| 500/515 [00:07<00:00, 65.42it/s]generate index:  99%|█████████▉| 509/515 [00:07<00:00, 67.39it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.41it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|          | 1/154 [00:00<00:24,  6.30it/s]remove invalid data : null / measurement error:  14%|█▍        | 22/154 [00:00<00:01, 102.32it/s]remove invalid data : null / measurement error:  28%|██▊       | 43/154 [00:00<00:00, 145.62it/s]remove invalid data : null / measurement error:  42%|████▏     | 64/154 [00:00<00:00, 168.15it/s]remove invalid data : null / measurement error:  56%|█████▌    | 86/154 [00:00<00:00, 183.36it/s]remove invalid data : null / measurement error:  71%|███████▏  | 110/154 [00:00<00:00, 199.53it/s]remove invalid data : null / measurement error:  86%|████████▌ | 132/154 [00:00<00:00, 203.01it/s]remove invalid data : null / measurement error:  99%|█████████▉| 153/154 [00:00<00:00, 204.27it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 174.98it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 246.01it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 247.19it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 247.03it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 242.96it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 244.78it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 245.13it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.76it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.29it/s]generate index:  16%|█▌        | 21/131 [00:00<00:01, 56.26it/s]generate index:  21%|██        | 27/131 [00:00<00:01, 57.12it/s]generate index:  26%|██▌       | 34/131 [00:00<00:01, 59.51it/s]generate index:  32%|███▏      | 42/131 [00:00<00:01, 61.05it/s]generate index:  37%|███▋      | 49/131 [00:00<00:01, 61.58it/s]generate index:  43%|████▎     | 56/131 [00:00<00:01, 61.09it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 63.11it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 63.32it/s]generate index:  59%|█████▉    | 77/131 [00:01<00:00, 54.19it/s]generate index:  63%|██████▎   | 83/131 [00:01<00:00, 53.76it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 42.47it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 42.50it/s]generate index:  76%|███████▌  | 99/131 [00:01<00:00, 42.02it/s]generate index:  80%|████████  | 105/131 [00:02<00:00, 45.08it/s]generate index:  85%|████████▌ | 112/131 [00:02<00:00, 49.44it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 63.17it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 56.25it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 6/193 [00:00<00:03, 58.72it/s]remove invalid data : null / measurement error:  14%|█▍        | 27/193 [00:00<00:01, 146.05it/s]remove invalid data : null / measurement error:  25%|██▍       | 48/193 [00:00<00:00, 173.58it/s]remove invalid data : null / measurement error:  36%|███▌      | 69/193 [00:00<00:00, 187.54it/s]remove invalid data : null / measurement error:  47%|████▋     | 91/193 [00:00<00:00, 196.43it/s]remove invalid data : null / measurement error:  58%|█████▊    | 111/193 [00:00<00:00, 165.13it/s]remove invalid data : null / measurement error:  67%|██████▋   | 129/193 [00:00<00:00, 167.55it/s]remove invalid data : null / measurement error:  76%|███████▌  | 147/193 [00:00<00:00, 149.40it/s]remove invalid data : null / measurement error:  84%|████████▍ | 163/193 [00:01<00:00, 151.21it/s]remove invalid data : null / measurement error:  95%|█████████▍| 183/193 [00:01<00:00, 164.40it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 164.26it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:   9%|▉         | 15/160 [00:00<00:00, 146.28it/s]replace nan value:  22%|██▏       | 35/160 [00:00<00:00, 173.98it/s]replace nan value:  38%|███▊      | 60/160 [00:00<00:00, 207.71it/s]replace nan value:  53%|█████▎    | 85/160 [00:00<00:00, 222.18it/s]replace nan value:  68%|██████▊   | 109/160 [00:00<00:00, 227.91it/s]replace nan value:  84%|████████▍ | 134/160 [00:00<00:00, 232.57it/s]replace nan value:  99%|█████████▉| 158/160 [00:00<00:00, 202.22it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 206.51it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 93.74it/s]generate index:  13%|█▎        | 21/160 [00:00<00:02, 48.97it/s]generate index:  17%|█▋        | 27/160 [00:00<00:02, 51.31it/s]generate index:  21%|██        | 33/160 [00:00<00:02, 53.37it/s]generate index:  27%|██▋       | 43/160 [00:00<00:01, 66.05it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 63.65it/s]generate index:  36%|███▋      | 58/160 [00:00<00:01, 62.19it/s]generate index:  42%|████▎     | 68/160 [00:01<00:01, 71.34it/s]generate index:  48%|████▊     | 76/160 [00:01<00:01, 66.15it/s]generate index:  52%|█████▏    | 83/160 [00:01<00:01, 58.33it/s]generate index:  56%|█████▋    | 90/160 [00:01<00:01, 54.16it/s]generate index:  60%|██████    | 96/160 [00:01<00:01, 54.71it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 49.57it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 46.40it/s]generate index:  71%|███████   | 113/160 [00:02<00:01, 44.72it/s]generate index:  76%|███████▌  | 121/160 [00:02<00:00, 52.37it/s]generate index:  79%|███████▉  | 127/160 [00:02<00:00, 50.39it/s]generate index:  84%|████████▍ | 134/160 [00:02<00:00, 53.49it/s]generate index:  88%|████████▊ | 140/160 [00:02<00:00, 51.37it/s]generate index:  92%|█████████▏| 147/160 [00:02<00:00, 56.01it/s]generate index:  97%|█████████▋| 155/160 [00:02<00:00, 56.77it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 55.73it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.145, valid loss : 0.001, train acc : 0.969, valid acc : 0.992, train f1 : 0.499, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 272.71it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 280.11it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 272.68it/s][A
 58%|█████▊    | 114/196 [00:00<00:00, 273.42it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 276.43it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 278.71it/s][A100%|██████████| 196/196 [00:00<00:00, 262.60it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.498
training process:   1%|          | 1/128 [01:58<4:11:10, 118.67s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:25<3:29:41, 99.86s/it] EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:52<3:15:47, 93.98s/it]EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:18<3:07:50, 90.89s/it]epoch : 5, train loss : -0.083, valid loss : -0.120, train acc : 0.991, valid acc : 0.992, train f1 : 0.498, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|█         | 20/196 [00:00<00:00, 193.80it/s][A
 25%|██▌       | 49/196 [00:00<00:00, 249.42it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 284.95it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 301.95it/s][A
 76%|███████▌  | 149/196 [00:00<00:00, 312.22it/s][A
 92%|█████████▏| 181/196 [00:00<00:00, 276.36it/s][A100%|██████████| 196/196 [00:00<00:00, 267.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:11<3:22:35, 98.83s/it]Best score increase :0.498 -> 0.506
training process:   5%|▍         | 6/128 [09:43<3:16:00, 96.39s/it]Best score increase :0.506 -> 0.520
training process:   5%|▌         | 7/128 [11:16<3:12:25, 95.42s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:48<3:08:24, 94.20s/it]epoch : 9, train loss : -0.212, valid loss : -0.279, train acc : 0.989, valid acc : 0.992, train f1 : 0.513, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 339.84it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 346.18it/s][A
 54%|█████▍    | 106/196 [00:00<00:00, 348.90it/s][A
 72%|███████▏  | 142/196 [00:00<00:00, 350.20it/s][A
 91%|█████████ | 178/196 [00:00<00:00, 351.02it/s][A100%|██████████| 196/196 [00:00<00:00, 349.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:50<3:24:05, 102.90s/it]EarlyStopping counter : 3 out of 40
training process:   8%|▊         | 10/128 [16:20<3:14:56, 99.12s/it]EarlyStopping counter : 4 out of 40
training process:   9%|▊         | 11/128 [17:49<3:07:14, 96.02s/it]EarlyStopping counter : 5 out of 40
training process:   9%|▉         | 12/128 [19:15<2:59:33, 92.87s/it]epoch : 13, train loss : -0.403, valid loss : -0.475, train acc : 0.991, valid acc : 0.991, train f1 : 0.517, valid f1 : 0.526

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 339.17it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 343.82it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 345.26it/s][A
 71%|███████   | 139/196 [00:00<00:00, 346.08it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 345.03it/s][A100%|██████████| 196/196 [00:00<00:00, 344.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.520 -> 0.526
training process:  10%|█         | 13/128 [21:06<3:08:36, 98.41s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [22:34<3:00:47, 95.15s/it]EarlyStopping counter : 2 out of 40
training process:  12%|█▏        | 15/128 [24:01<2:54:57, 92.90s/it]EarlyStopping counter : 3 out of 40
training process:  12%|█▎        | 16/128 [25:29<2:50:32, 91.36s/it]epoch : 17, train loss : -0.652, valid loss : -0.885, train acc : 0.989, valid acc : 0.992, train f1 : 0.514, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 334.46it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.76it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 340.36it/s][A
 71%|███████   | 139/196 [00:00<00:00, 341.30it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.90it/s][A100%|██████████| 196/196 [00:00<00:00, 340.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  13%|█▎        | 17/128 [27:24<3:01:54, 98.33s/it]EarlyStopping counter : 5 out of 40
training process:  14%|█▍        | 18/128 [28:51<2:54:09, 95.00s/it]EarlyStopping counter : 6 out of 40
training process:  15%|█▍        | 19/128 [30:17<2:47:48, 92.37s/it]EarlyStopping counter : 7 out of 40
training process:  16%|█▌        | 20/128 [31:43<2:42:39, 90.37s/it]epoch : 21, train loss : -0.995, valid loss : -1.142, train acc : 0.989, valid acc : 0.992, train f1 : 0.519, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 321.57it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 333.24it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.56it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.82it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 340.92it/s][A100%|██████████| 196/196 [00:00<00:00, 338.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  16%|█▋        | 21/128 [33:34<2:52:16, 96.60s/it]EarlyStopping counter : 9 out of 40
training process:  17%|█▋        | 22/128 [35:04<2:46:57, 94.50s/it]EarlyStopping counter : 10 out of 40
training process:  18%|█▊        | 23/128 [36:34<2:43:25, 93.39s/it]Best score increase :0.526 -> 0.552
training process:  19%|█▉        | 24/128 [38:06<2:40:45, 92.74s/it]epoch : 25, train loss : -1.313, valid loss : -1.563, train acc : 0.987, valid acc : 0.992, train f1 : 0.540, valid f1 : 0.521

  0%|          | 0/196 [00:00<?, ?it/s][A
 12%|█▏        | 23/196 [00:00<00:00, 222.02it/s][A
 23%|██▎       | 46/196 [00:00<00:00, 216.33it/s][A
 37%|███▋      | 73/196 [00:00<00:00, 237.53it/s][A
 51%|█████     | 100/196 [00:00<00:00, 248.42it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 251.95it/s][A
 78%|███████▊  | 152/196 [00:00<00:00, 232.14it/s][A
 91%|█████████ | 178/196 [00:00<00:00, 239.38it/s][A100%|██████████| 196/196 [00:00<00:00, 243.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  20%|█▉        | 25/128 [40:00<2:50:09, 99.12s/it]EarlyStopping counter : 2 out of 40
training process:  20%|██        | 26/128 [41:31<2:44:34, 96.81s/it]EarlyStopping counter : 3 out of 40
training process:  21%|██        | 27/128 [43:04<2:41:00, 95.65s/it]EarlyStopping counter : 4 out of 40
training process:  22%|██▏       | 28/128 [44:36<2:37:36, 94.57s/it]epoch : 29, train loss : -1.590, valid loss : -1.792, train acc : 0.985, valid acc : 0.992, train f1 : 0.538, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.30it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 341.66it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 341.67it/s][A
 71%|███████   | 139/196 [00:00<00:00, 338.68it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.82it/s][A100%|██████████| 196/196 [00:00<00:00, 341.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  23%|██▎       | 29/128 [46:35<2:48:12, 101.95s/it]EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 30/128 [48:02<2:38:59, 97.34s/it] EarlyStopping counter : 7 out of 40
training process:  24%|██▍       | 31/128 [49:27<2:31:35, 93.76s/it]EarlyStopping counter : 8 out of 40
training process:  25%|██▌       | 32/128 [50:56<2:27:27, 92.16s/it]epoch : 33, train loss : -1.945, valid loss : -2.300, train acc : 0.983, valid acc : 0.992, train f1 : 0.538, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 330.63it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.43it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 340.79it/s][A
 71%|███████   | 139/196 [00:00<00:00, 340.30it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.91it/s][A100%|██████████| 196/196 [00:00<00:00, 340.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  26%|██▌       | 33/128 [52:49<2:35:54, 98.47s/it]EarlyStopping counter : 10 out of 40
training process:  27%|██▋       | 34/128 [54:18<2:29:49, 95.63s/it]EarlyStopping counter : 11 out of 40
training process:  27%|██▋       | 35/128 [55:44<2:24:00, 92.91s/it]EarlyStopping counter : 12 out of 40
training process:  28%|██▊       | 36/128 [57:16<2:21:48, 92.48s/it]epoch : 37, train loss : -2.202, valid loss : -2.581, train acc : 0.983, valid acc : 0.992, train f1 : 0.532, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 279.81it/s][A
 31%|███       | 61/196 [00:00<00:00, 308.39it/s][A
 48%|████▊     | 94/196 [00:00<00:00, 318.12it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 255.67it/s][A
 80%|████████  | 157/196 [00:00<00:00, 272.24it/s][A
 97%|█████████▋| 190/196 [00:00<00:00, 287.77it/s][A100%|██████████| 196/196 [00:00<00:00, 286.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  29%|██▉       | 37/128 [59:10<2:30:09, 99.00s/it]EarlyStopping counter : 14 out of 40
training process:  30%|██▉       | 38/128 [1:00:37<2:23:14, 95.49s/it]Best score increase :0.552 -> 0.568
training process:  30%|███       | 39/128 [1:02:04<2:17:52, 92.95s/it]EarlyStopping counter : 1 out of 40
training process:  31%|███▏      | 40/128 [1:03:34<2:14:57, 92.02s/it]epoch : 41, train loss : -2.553, valid loss : -2.814, train acc : 0.984, valid acc : 0.991, train f1 : 0.548, valid f1 : 0.520

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 276.40it/s][A
 31%|███       | 61/196 [00:00<00:00, 306.85it/s][A
 48%|████▊     | 94/196 [00:00<00:00, 316.68it/s][A
 65%|██████▍   | 127/196 [00:00<00:00, 319.51it/s][A
 82%|████████▏ | 160/196 [00:00<00:00, 322.41it/s][A
 98%|█████████▊| 193/196 [00:00<00:00, 324.17it/s][A100%|██████████| 196/196 [00:00<00:00, 318.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  32%|███▏      | 41/128 [1:05:28<2:22:53, 98.55s/it]EarlyStopping counter : 3 out of 40
training process:  33%|███▎      | 42/128 [1:06:59<2:17:47, 96.13s/it]EarlyStopping counter : 4 out of 40
training process:  34%|███▎      | 43/128 [1:08:26<2:12:34, 93.58s/it]EarlyStopping counter : 5 out of 40
training process:  34%|███▍      | 44/128 [1:09:56<2:09:31, 92.52s/it]epoch : 45, train loss : -2.974, valid loss : -3.442, train acc : 0.986, valid acc : 0.991, train f1 : 0.557, valid f1 : 0.520

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 273.25it/s][A
 29%|██▊       | 56/196 [00:00<00:00, 276.65it/s][A
 43%|████▎     | 84/196 [00:00<00:00, 277.13it/s][A
 57%|█████▋    | 112/196 [00:00<00:00, 235.14it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 252.12it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 274.63it/s][A100%|██████████| 196/196 [00:00<00:00, 271.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  35%|███▌      | 45/128 [1:11:52<2:17:35, 99.47s/it]EarlyStopping counter : 7 out of 40
training process:  36%|███▌      | 46/128 [1:13:19<2:10:44, 95.67s/it]Best score increase :0.568 -> 0.643
training process:  37%|███▋      | 47/128 [1:14:46<2:05:55, 93.28s/it]EarlyStopping counter : 1 out of 40
training process:  38%|███▊      | 48/128 [1:16:13<2:01:45, 91.32s/it]epoch : 49, train loss : -3.358, valid loss : -3.754, train acc : 0.983, valid acc : 0.992, train f1 : 0.551, valid f1 : 0.608

  0%|          | 0/196 [00:00<?, ?it/s][A
 12%|█▏        | 23/196 [00:00<00:00, 217.45it/s][A
 23%|██▎       | 45/196 [00:00<00:00, 195.97it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 222.18it/s][A
 50%|█████     | 98/196 [00:00<00:00, 238.79it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 251.74it/s][A
 79%|███████▊  | 154/196 [00:00<00:00, 259.43it/s][A
 93%|█████████▎| 182/196 [00:00<00:00, 263.76it/s][A100%|██████████| 196/196 [00:00<00:00, 249.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  38%|███▊      | 49/128 [1:18:10<2:10:12, 98.90s/it]EarlyStopping counter : 3 out of 40
training process:  39%|███▉      | 50/128 [1:19:35<2:03:05, 94.69s/it]Best score increase :0.643 -> 0.664
training process:  40%|███▉      | 51/128 [1:21:01<1:58:27, 92.31s/it]EarlyStopping counter : 1 out of 40
training process:  41%|████      | 52/128 [1:22:29<1:55:02, 90.83s/it]epoch : 53, train loss : -3.813, valid loss : -4.169, train acc : 0.982, valid acc : 0.992, train f1 : 0.558, valid f1 : 0.551

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.07it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 337.37it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 342.94it/s][A
 70%|███████   | 138/196 [00:00<00:00, 345.33it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 346.55it/s][A100%|██████████| 196/196 [00:00<00:00, 344.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  41%|████▏     | 53/128 [1:24:22<2:02:06, 97.69s/it]EarlyStopping counter : 3 out of 40
training process:  42%|████▏     | 54/128 [1:25:50<1:56:52, 94.76s/it]EarlyStopping counter : 4 out of 40
training process:  43%|████▎     | 55/128 [1:27:19<1:52:54, 92.80s/it]EarlyStopping counter : 5 out of 40
training process:  44%|████▍     | 56/128 [1:28:46<1:49:19, 91.11s/it]epoch : 57, train loss : -4.054, valid loss : -4.636, train acc : 0.986, valid acc : 0.992, train f1 : 0.586, valid f1 : 0.571

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.32it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.90it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 338.82it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 339.13it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 339.75it/s][A100%|██████████| 196/196 [00:00<00:00, 339.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  45%|████▍     | 57/128 [1:30:37<1:54:55, 97.13s/it]EarlyStopping counter : 7 out of 40
training process:  45%|████▌     | 58/128 [1:32:05<1:50:15, 94.50s/it]Best score increase :0.664 -> 0.668
training process:  46%|████▌     | 59/128 [1:33:36<1:47:16, 93.28s/it]EarlyStopping counter : 1 out of 40
training process:  47%|████▋     | 60/128 [1:35:04<1:43:59, 91.75s/it]epoch : 61, train loss : -4.367, valid loss : -4.994, train acc : 0.987, valid acc : 0.992, train f1 : 0.606, valid f1 : 0.695

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 334.18it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 332.56it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 334.25it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 336.63it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 338.21it/s][A100%|██████████| 196/196 [00:00<00:00, 337.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.668 -> 0.695
training process:  48%|████▊     | 61/128 [1:36:59<1:50:15, 98.73s/it]EarlyStopping counter : 1 out of 40
training process:  48%|████▊     | 62/128 [1:38:29<1:45:46, 96.16s/it]EarlyStopping counter : 2 out of 40
training process:  49%|████▉     | 63/128 [1:40:02<1:42:59, 95.07s/it]EarlyStopping counter : 3 out of 40
training process:  50%|█████     | 64/128 [1:41:36<1:41:10, 94.85s/it]epoch : 65, train loss : -4.869, valid loss : -5.617, train acc : 0.984, valid acc : 0.993, train f1 : 0.594, valid f1 : 0.662

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.22it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.03it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 337.66it/s][A
 71%|███████   | 139/196 [00:00<00:00, 339.78it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.07it/s][A100%|██████████| 196/196 [00:00<00:00, 340.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  51%|█████     | 65/128 [1:43:33<1:46:38, 101.56s/it]EarlyStopping counter : 5 out of 40
training process:  52%|█████▏    | 66/128 [1:44:56<1:39:06, 95.91s/it] EarlyStopping counter : 6 out of 40
training process:  52%|█████▏    | 67/128 [1:46:21<1:34:12, 92.67s/it]EarlyStopping counter : 7 out of 40
training process:  53%|█████▎    | 68/128 [1:47:44<1:29:50, 89.85s/it]epoch : 69, train loss : -5.244, valid loss : -5.909, train acc : 0.974, valid acc : 0.993, train f1 : 0.564, valid f1 : 0.655

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|█         | 20/196 [00:00<00:00, 199.22it/s][A
 26%|██▌       | 51/196 [00:00<00:00, 260.42it/s][A
 43%|████▎     | 85/196 [00:00<00:00, 292.95it/s][A
 60%|██████    | 118/196 [00:00<00:00, 305.51it/s][A
 78%|███████▊  | 152/196 [00:00<00:00, 314.90it/s][A
 94%|█████████▍| 185/196 [00:00<00:00, 319.15it/s][A100%|██████████| 196/196 [00:00<00:00, 304.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  54%|█████▍    | 69/128 [1:49:34<1:34:04, 95.67s/it]EarlyStopping counter : 9 out of 40
training process:  55%|█████▍    | 70/128 [1:51:01<1:30:11, 93.30s/it]EarlyStopping counter : 10 out of 40
training process:  55%|█████▌    | 71/128 [1:52:31<1:27:41, 92.31s/it]EarlyStopping counter : 11 out of 40
training process:  56%|█████▋    | 72/128 [1:54:00<1:25:03, 91.13s/it]epoch : 73, train loss : -5.057, valid loss : -5.625, train acc : 0.991, valid acc : 0.993, train f1 : 0.603, valid f1 : 0.610

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.77it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 341.91it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 343.57it/s][A
 71%|███████   | 139/196 [00:00<00:00, 270.01it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 262.35it/s][A
100%|██████████| 196/196 [00:00<00:00, 241.96it/s][A100%|██████████| 196/196 [00:00<00:00, 268.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  57%|█████▋    | 73/128 [1:55:53<1:29:39, 97.81s/it]EarlyStopping counter : 13 out of 40
training process:  58%|█████▊    | 74/128 [1:57:23<1:25:49, 95.36s/it]EarlyStopping counter : 14 out of 40
training process:  59%|█████▊    | 75/128 [1:58:51<1:22:26, 93.32s/it]EarlyStopping counter : 15 out of 40
training process:  59%|█████▉    | 76/128 [2:00:20<1:19:48, 92.08s/it]epoch : 77, train loss : -5.576, valid loss : -6.633, train acc : 0.985, valid acc : 0.993, train f1 : 0.592, valid f1 : 0.674

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.18it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.31it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 339.41it/s][A
 71%|███████   | 139/196 [00:00<00:00, 339.87it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 340.22it/s][A100%|██████████| 196/196 [00:00<00:00, 339.62it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  60%|██████    | 77/128 [2:02:13<1:23:30, 98.24s/it]EarlyStopping counter : 17 out of 40
training process:  61%|██████    | 78/128 [2:03:46<1:20:36, 96.72s/it]EarlyStopping counter : 18 out of 40
training process:  62%|██████▏   | 79/128 [2:05:20<1:18:14, 95.81s/it]EarlyStopping counter : 19 out of 40
training process:  62%|██████▎   | 80/128 [2:06:51<1:15:31, 94.40s/it]epoch : 81, train loss : -5.895, valid loss : -6.563, train acc : 0.989, valid acc : 0.993, train f1 : 0.632, valid f1 : 0.663

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 311.25it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.70it/s][A
 51%|█████     | 99/196 [00:00<00:00, 325.79it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 326.76it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 327.12it/s][A100%|██████████| 196/196 [00:00<00:00, 326.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  63%|██████▎   | 81/128 [2:08:49<1:19:33, 101.56s/it]EarlyStopping counter : 21 out of 40
training process:  64%|██████▍   | 82/128 [2:10:24<1:16:21, 99.61s/it] EarlyStopping counter : 22 out of 40
training process:  65%|██████▍   | 83/128 [2:11:58<1:13:20, 97.78s/it]EarlyStopping counter : 23 out of 40
training process:  66%|██████▌   | 84/128 [2:13:30<1:10:33, 96.21s/it]epoch : 85, train loss : -6.339, valid loss : -7.417, train acc : 0.979, valid acc : 0.991, train f1 : 0.587, valid f1 : 0.685

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.33it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 339.47it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.09it/s][A
 70%|███████   | 138/196 [00:00<00:00, 340.23it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 337.82it/s][A100%|██████████| 196/196 [00:00<00:00, 338.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  66%|██████▋   | 85/128 [2:15:29<1:13:46, 102.94s/it]Best score increase :0.695 -> 0.704
training process:  67%|██████▋   | 86/128 [2:16:59<1:09:16, 98.95s/it] EarlyStopping counter : 1 out of 40
training process:  68%|██████▊   | 87/128 [2:18:28<1:05:38, 96.06s/it]EarlyStopping counter : 2 out of 40
training process:  69%|██████▉   | 88/128 [2:19:57<1:02:37, 93.94s/it]epoch : 89, train loss : -6.446, valid loss : -7.401, train acc : 0.986, valid acc : 0.993, train f1 : 0.622, valid f1 : 0.629

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 338.16it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 341.69it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 340.94it/s][A
 71%|███████   | 139/196 [00:00<00:00, 342.69it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 343.61it/s][A100%|██████████| 196/196 [00:00<00:00, 342.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  70%|██████▉   | 89/128 [2:21:50<1:04:48, 99.70s/it]EarlyStopping counter : 4 out of 40
training process:  70%|███████   | 90/128 [2:23:16<1:00:32, 95.60s/it]EarlyStopping counter : 5 out of 40
training process:  71%|███████   | 91/128 [2:24:44<57:31, 93.29s/it]  Best score increase :0.704 -> 0.710
training process:  72%|███████▏  | 92/128 [2:26:12<55:03, 91.75s/it]epoch : 93, train loss : -6.843, valid loss : -7.657, train acc : 0.991, valid acc : 0.993, train f1 : 0.640, valid f1 : 0.683

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.73it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.99it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.17it/s][A
 71%|███████   | 139/196 [00:00<00:00, 343.93it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 344.86it/s][A100%|██████████| 196/196 [00:00<00:00, 343.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  73%|███████▎  | 93/128 [2:28:03<56:52, 97.49s/it]EarlyStopping counter : 2 out of 40
training process:  73%|███████▎  | 94/128 [2:29:30<53:30, 94.43s/it]Best score increase :0.710 -> 0.723
training process:  74%|███████▍  | 95/128 [2:31:00<51:07, 92.97s/it]EarlyStopping counter : 1 out of 40
training process:  75%|███████▌  | 96/128 [2:32:29<48:54, 91.71s/it]epoch : 97, train loss : -6.958, valid loss : -8.465, train acc : 0.989, valid acc : 0.993, train f1 : 0.643, valid f1 : 0.711

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.20it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.27it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.41it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 336.71it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 333.95it/s][A100%|██████████| 196/196 [00:00<00:00, 334.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  76%|███████▌  | 97/128 [2:34:23<50:55, 98.58s/it]EarlyStopping counter : 3 out of 40
training process:  77%|███████▋  | 98/128 [2:35:49<47:21, 94.71s/it]EarlyStopping counter : 4 out of 40
training process:  77%|███████▋  | 99/128 [2:37:18<45:00, 93.11s/it]EarlyStopping counter : 5 out of 40
training process:  78%|███████▊  | 100/128 [2:38:48<42:58, 92.08s/it]epoch : 101, train loss : -7.140, valid loss : -8.160, train acc : 0.992, valid acc : 0.993, train f1 : 0.658, valid f1 : 0.634

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 258.06it/s][A
 30%|███       | 59/196 [00:00<00:00, 299.67it/s][A
 47%|████▋     | 92/196 [00:00<00:00, 310.29it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 318.68it/s][A
 81%|████████  | 159/196 [00:00<00:00, 320.86it/s][A
 98%|█████████▊| 193/196 [00:00<00:00, 324.45it/s][A100%|██████████| 196/196 [00:00<00:00, 316.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  79%|███████▉  | 101/128 [2:40:41<44:14, 98.31s/it]EarlyStopping counter : 7 out of 40
training process:  80%|███████▉  | 102/128 [2:42:08<41:11, 95.05s/it]EarlyStopping counter : 8 out of 40
training process:  80%|████████  | 103/128 [2:43:40<39:10, 94.04s/it]EarlyStopping counter : 9 out of 40
training process:  81%|████████▏ | 104/128 [2:45:10<37:03, 92.66s/it]epoch : 105, train loss : -7.482, valid loss : -8.657, train acc : 0.989, valid acc : 0.993, train f1 : 0.644, valid f1 : 0.646

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.76it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 332.05it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.27it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.85it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 341.24it/s][A100%|██████████| 196/196 [00:00<00:00, 339.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  82%|████████▏ | 105/128 [2:47:03<37:52, 98.82s/it]EarlyStopping counter : 11 out of 40
training process:  83%|████████▎ | 106/128 [2:48:30<34:57, 95.32s/it]EarlyStopping counter : 12 out of 40
training process:  84%|████████▎ | 107/128 [2:50:00<32:49, 93.79s/it]EarlyStopping counter : 13 out of 40
training process:  84%|████████▍ | 108/128 [2:51:29<30:46, 92.30s/it]epoch : 109, train loss : -7.837, valid loss : -9.203, train acc : 0.990, valid acc : 0.993, train f1 : 0.651, valid f1 : 0.698

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 334.54it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 337.83it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 336.94it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 335.69it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 337.89it/s][A100%|██████████| 196/196 [00:00<00:00, 337.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  85%|████████▌ | 109/128 [2:53:21<31:07, 98.28s/it]EarlyStopping counter : 15 out of 40
training process:  86%|████████▌ | 110/128 [2:54:48<28:24, 94.70s/it]EarlyStopping counter : 16 out of 40
training process:  87%|████████▋ | 111/128 [2:56:16<26:20, 92.96s/it]EarlyStopping counter : 17 out of 40
training process:  88%|████████▊ | 112/128 [2:57:45<24:24, 91.54s/it]epoch : 113, train loss : -7.975, valid loss : -9.252, train acc : 0.992, valid acc : 0.993, train f1 : 0.658, valid f1 : 0.678

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 338.49it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.49it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.97it/s][A
 71%|███████   | 139/196 [00:00<00:00, 341.61it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 339.40it/s][A100%|██████████| 196/196 [00:00<00:00, 340.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  88%|████████▊ | 113/128 [2:59:39<24:35, 98.39s/it]EarlyStopping counter : 19 out of 40
training process:  89%|████████▉ | 114/128 [3:01:12<22:33, 96.66s/it]EarlyStopping counter : 20 out of 40
training process:  90%|████████▉ | 115/128 [3:02:44<20:40, 95.39s/it]EarlyStopping counter : 21 out of 40
training process:  91%|█████████ | 116/128 [3:04:18<18:58, 94.90s/it]epoch : 117, train loss : -8.277, valid loss : -9.471, train acc : 0.991, valid acc : 0.993, train f1 : 0.666, valid f1 : 0.691

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.46it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 341.18it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 338.87it/s][A
 71%|███████   | 139/196 [00:00<00:00, 341.05it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 342.28it/s][A100%|██████████| 196/196 [00:00<00:00, 341.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  91%|█████████▏| 117/128 [3:06:17<18:43, 102.16s/it]EarlyStopping counter : 23 out of 40
training process:  92%|█████████▏| 118/128 [3:07:47<16:24, 98.41s/it] EarlyStopping counter : 24 out of 40
training process:  93%|█████████▎| 119/128 [3:09:14<14:17, 95.25s/it]EarlyStopping counter : 25 out of 40
training process:  94%|█████████▍| 120/128 [3:10:41<12:21, 92.68s/it]epoch : 121, train loss : -8.759, valid loss : -9.866, train acc : 0.992, valid acc : 0.993, train f1 : 0.690, valid f1 : 0.697

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 36/196 [00:00<00:00, 351.36it/s][A
 37%|███▋      | 72/196 [00:00<00:00, 354.95it/s][A
 55%|█████▌    | 108/196 [00:00<00:00, 355.82it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 356.73it/s][A
 92%|█████████▏| 180/196 [00:00<00:00, 357.13it/s][A100%|██████████| 196/196 [00:00<00:00, 356.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  95%|█████████▍| 121/128 [3:12:34<11:31, 98.79s/it]EarlyStopping counter : 27 out of 40
training process:  95%|█████████▌| 122/128 [3:14:03<09:35, 95.92s/it]EarlyStopping counter : 28 out of 40
training process:  96%|█████████▌| 123/128 [3:15:32<07:48, 93.72s/it]EarlyStopping counter : 29 out of 40
training process:  97%|█████████▋| 124/128 [3:17:00<06:08, 92.05s/it]epoch : 125, train loss : -9.061, valid loss : -10.025, train acc : 0.991, valid acc : 0.993, train f1 : 0.660, valid f1 : 0.670

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 317.28it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.27it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.82it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 337.96it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 338.59it/s][A100%|██████████| 196/196 [00:00<00:00, 335.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  98%|█████████▊| 125/128 [3:18:54<04:55, 98.61s/it]EarlyStopping counter : 31 out of 40
training process:  98%|█████████▊| 126/128 [3:20:21<03:10, 95.23s/it]EarlyStopping counter : 32 out of 40
training process:  99%|█████████▉| 127/128 [3:21:48<01:32, 92.70s/it]EarlyStopping counter : 33 out of 40
training process: 100%|██████████| 128/128 [3:23:18<00:00, 91.75s/it]training process: 100%|██████████| 128/128 [3:23:18<00:00, 95.30s/it]
training process finished, best loss : -8.297 and best acc : 0.994, best f1 : 0.723, best epoch : 94

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.78      0.26      0.39       152
           1       0.99      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.89      0.63      0.69     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.69, test AUC : 0.63, test loss : -1977.103

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:12, 12.00s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:01, 12.10s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:42, 11.58s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:28, 11.45s/it]processing for feature importance:  29%|██▉       | 5/17 [00:57<02:17, 11.48s/it]processing for feature importance:  35%|███▌      | 6/17 [01:10<02:08, 11.70s/it]processing for feature importance:  41%|████      | 7/17 [01:22<01:57, 11.80s/it]processing for feature importance:  47%|████▋     | 8/17 [01:33<01:46, 11.83s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:45<01:34, 11.83s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:57<01:22, 11.83s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:09<01:10, 11.80s/it]processing for feature importance:  71%|███████   | 12/17 [02:21<00:59, 11.81s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:32<00:46, 11.72s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:44<00:35, 11.85s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:56<00:23, 11.66s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:08<00:11, 11.99s/it]processing for feature importance: 100%|██████████| 17/17 [03:21<00:00, 12.11s/it]processing for feature importance: 100%|██████████| 17/17 [03:21<00:00, 11.83s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<12:55,  3.71s/it]visualize 2D latent space:   1%|          | 2/210 [00:04<06:06,  1.76s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<09:52,  2.85s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:33,  1.42s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<12:35,  3.61s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<06:50,  1.97s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:15,  2.03s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:34,  1.43s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 16%|█▋        | 32/196 [00:00<00:00, 311.47it/s] 34%|███▍      | 67/196 [00:00<00:00, 328.42it/s] 52%|█████▏    | 102/196 [00:00<00:00, 335.11it/s] 70%|██████▉   | 137/196 [00:00<00:00, 338.05it/s] 87%|████████▋ | 171/196 [00:00<00:00, 335.40it/s]100%|██████████| 196/196 [00:00<00:00, 334.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_smoothing_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 208.34it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 205.22it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 202.71it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 204.96it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 206.47it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 209.07it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 211.13it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 212.89it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 210.42it/s]remove invalid data : null / measurement error:  35%|███▍      | 215/616 [00:01<00:01, 209.81it/s]remove invalid data : null / measurement error:  38%|███▊      | 236/616 [00:01<00:01, 209.47it/s]remove invalid data : null / measurement error:  42%|████▏     | 257/616 [00:01<00:01, 208.73it/s]remove invalid data : null / measurement error:  45%|████▌     | 279/616 [00:01<00:01, 209.84it/s]remove invalid data : null / measurement error:  49%|████▊     | 300/616 [00:01<00:01, 209.38it/s]remove invalid data : null / measurement error:  52%|█████▏    | 321/616 [00:01<00:01, 208.20it/s]remove invalid data : null / measurement error:  56%|█████▌    | 342/616 [00:01<00:01, 207.69it/s]remove invalid data : null / measurement error:  59%|█████▉    | 364/616 [00:01<00:01, 210.41it/s]remove invalid data : null / measurement error:  63%|██████▎   | 390/616 [00:01<00:01, 223.48it/s]remove invalid data : null / measurement error:  68%|██████▊   | 418/616 [00:01<00:00, 238.35it/s]remove invalid data : null / measurement error:  72%|███████▏  | 442/616 [00:02<00:00, 232.84it/s]remove invalid data : null / measurement error:  76%|███████▌  | 466/616 [00:02<00:00, 232.41it/s]remove invalid data : null / measurement error:  80%|███████▉  | 490/616 [00:02<00:00, 225.28it/s]remove invalid data : null / measurement error:  83%|████████▎ | 513/616 [00:02<00:00, 220.35it/s]remove invalid data : null / measurement error:  87%|████████▋ | 536/616 [00:02<00:00, 215.29it/s]remove invalid data : null / measurement error:  91%|█████████ | 558/616 [00:02<00:00, 210.94it/s]remove invalid data : null / measurement error:  94%|█████████▍| 580/616 [00:02<00:00, 208.35it/s]remove invalid data : null / measurement error:  98%|█████████▊| 601/616 [00:02<00:00, 206.92it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 213.10it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 240.87it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 240.48it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 241.73it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 243.88it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 244.72it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 246.20it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 246.97it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 246.96it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 247.48it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 247.70it/s]replace nan value:  54%|█████▎    | 276/515 [00:01<00:00, 248.41it/s]replace nan value:  58%|█████▊    | 301/515 [00:01<00:00, 247.33it/s]replace nan value:  63%|██████▎   | 326/515 [00:01<00:00, 247.60it/s]replace nan value:  68%|██████▊   | 351/515 [00:01<00:00, 244.94it/s]replace nan value:  73%|███████▎  | 376/515 [00:01<00:00, 246.27it/s]replace nan value:  78%|███████▊  | 401/515 [00:01<00:00, 246.94it/s]replace nan value:  83%|████████▎ | 426/515 [00:01<00:00, 247.01it/s]replace nan value:  88%|████████▊ | 451/515 [00:01<00:00, 245.79it/s]replace nan value:  92%|█████████▏| 476/515 [00:01<00:00, 246.25it/s]replace nan value:  97%|█████████▋| 501/515 [00:02<00:00, 246.65it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 246.14it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.31it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 58.01it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.95it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 75.31it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 74.90it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 56.42it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 59.60it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 49.31it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 56.18it/s]generate index:  15%|█▌        | 78/515 [00:01<00:07, 55.14it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 63.19it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.79it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 60.57it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 66.53it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 65.06it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 72.93it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 73.00it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 73.65it/s]generate index:  30%|██▉       | 152/515 [00:02<00:04, 73.25it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 74.04it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 73.14it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 71.16it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 72.46it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.91it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 65.73it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 73.27it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 84.22it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 89.87it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 89.79it/s]generate index:  49%|████▉     | 253/515 [00:03<00:03, 74.85it/s]generate index:  51%|█████     | 262/515 [00:03<00:03, 77.67it/s]generate index:  53%|█████▎    | 272/515 [00:03<00:02, 81.74it/s]generate index:  55%|█████▍    | 281/515 [00:04<00:03, 65.79it/s]generate index:  56%|█████▌    | 289/515 [00:04<00:03, 67.38it/s]generate index:  58%|█████▊    | 297/515 [00:04<00:03, 65.15it/s]generate index:  59%|█████▉    | 304/515 [00:04<00:03, 64.85it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 66.22it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 62.65it/s]generate index:  63%|██████▎   | 327/515 [00:04<00:02, 66.54it/s]generate index:  65%|██████▍   | 334/515 [00:04<00:02, 60.43it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 48.46it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 46.48it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 52.67it/s]generate index:  71%|███████   | 364/515 [00:05<00:02, 60.94it/s]generate index:  73%|███████▎  | 376/515 [00:05<00:01, 74.36it/s]generate index:  75%|███████▍  | 385/515 [00:05<00:01, 78.03it/s]generate index:  77%|███████▋  | 394/515 [00:05<00:01, 78.50it/s]generate index:  78%|███████▊  | 403/515 [00:05<00:01, 73.42it/s]generate index:  80%|███████▉  | 411/515 [00:06<00:01, 65.59it/s]generate index:  82%|████████▏ | 422/515 [00:06<00:01, 76.00it/s]generate index:  84%|████████▎ | 431/515 [00:06<00:01, 73.39it/s]generate index:  85%|████████▌ | 439/515 [00:06<00:01, 52.40it/s]generate index:  87%|████████▋ | 446/515 [00:06<00:01, 52.38it/s]generate index:  89%|████████▊ | 456/515 [00:06<00:00, 61.54it/s]generate index:  90%|█████████ | 464/515 [00:06<00:00, 65.55it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.63it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.91it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.99it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.95it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 71.05it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 66.23it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 66.96it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 149.54it/s]remove invalid data : null / measurement error:  32%|███▏      | 50/154 [00:00<00:00, 178.29it/s]remove invalid data : null / measurement error:  47%|████▋     | 72/154 [00:00<00:00, 193.26it/s]remove invalid data : null / measurement error:  61%|██████    | 94/154 [00:00<00:00, 202.02it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 214.67it/s]remove invalid data : null / measurement error:  91%|█████████ | 140/154 [00:00<00:00, 212.58it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 196.58it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 256.02it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 256.91it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 255.56it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 249.93it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 252.38it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 252.88it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 71.19it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.49it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 57.09it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 59.46it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 65.51it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 66.22it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 62.71it/s]generate index:  48%|████▊     | 63/131 [00:00<00:01, 67.64it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 67.51it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 69.11it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 66.79it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 48.05it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 50.20it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 48.50it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 53.03it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 62.07it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 71.70it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 61.63it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▎         | 7/193 [00:00<00:02, 69.62it/s]remove invalid data : null / measurement error:  15%|█▌        | 29/193 [00:00<00:01, 155.76it/s]remove invalid data : null / measurement error:  26%|██▋       | 51/193 [00:00<00:00, 183.21it/s]remove invalid data : null / measurement error:  38%|███▊      | 74/193 [00:00<00:00, 197.98it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 204.00it/s]remove invalid data : null / measurement error:  61%|██████    | 118/193 [00:00<00:00, 208.69it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 220.76it/s]remove invalid data : null / measurement error:  86%|████████▌ | 166/193 [00:00<00:00, 216.62it/s]remove invalid data : null / measurement error:  97%|█████████▋| 188/193 [00:00<00:00, 214.22it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 202.25it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 257.24it/s]replace nan value:  33%|███▎      | 53/160 [00:00<00:00, 259.01it/s]replace nan value:  49%|████▉     | 79/160 [00:00<00:00, 257.01it/s]replace nan value:  66%|██████▌   | 105/160 [00:00<00:00, 254.69it/s]replace nan value:  82%|████████▏ | 131/160 [00:00<00:00, 254.53it/s]replace nan value:  98%|█████████▊| 157/160 [00:00<00:00, 254.74it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 255.30it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 106.83it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 65.63it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.96it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 76.96it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 83.80it/s]generate index:  38%|███▊      | 61/160 [00:00<00:01, 83.60it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 86.44it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 70.80it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.64it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 61.09it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.27it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.59it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.78it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 62.05it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 57.53it/s]generate index:  87%|████████▋ | 139/160 [00:02<00:00, 55.72it/s]generate index:  92%|█████████▏| 147/160 [00:02<00:00, 60.91it/s]generate index:  97%|█████████▋| 155/160 [00:02<00:00, 60.83it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 64.19it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.389, valid loss : 0.203, train acc : 0.748, valid acc : 0.841, train f1 : 0.748, valid f1 : 0.489

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.59it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 343.81it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 345.29it/s][A
 71%|███████   | 139/196 [00:00<00:00, 346.18it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 347.91it/s][A100%|██████████| 196/196 [00:00<00:00, 347.41it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.489
training process:   1%|          | 1/128 [02:00<4:14:22, 120.18s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:33<3:38:58, 104.27s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [05:04<3:24:50, 98.32s/it] Best score increase :0.489 -> 0.496
training process:   3%|▎         | 4/128 [06:35<3:16:52, 95.27s/it]epoch : 5, train loss : 0.081, valid loss : 0.311, train acc : 0.936, valid acc : 0.820, train f1 : 0.936, valid f1 : 0.488

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 324.70it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 337.07it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.79it/s][A
 70%|███████   | 138/196 [00:00<00:00, 343.48it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 344.72it/s][A100%|██████████| 196/196 [00:00<00:00, 342.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   4%|▍         | 5/128 [08:31<3:30:47, 102.82s/it]Best score increase :0.496 -> 0.538
training process:   5%|▍         | 6/128 [10:02<3:21:06, 98.90s/it] EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:32<3:13:27, 95.93s/it]Best score increase :0.538 -> 0.542
training process:   6%|▋         | 8/128 [13:05<3:09:51, 94.93s/it]epoch : 9, train loss : -0.051, valid loss : -0.094, train acc : 0.967, valid acc : 0.948, train f1 : 0.967, valid f1 : 0.585

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 316.84it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.19it/s][A
 51%|█████     | 100/196 [00:00<00:00, 330.28it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 332.91it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 333.79it/s][A100%|██████████| 196/196 [00:00<00:00, 331.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.542 -> 0.585
training process:   7%|▋         | 9/128 [15:00<3:20:45, 101.22s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:31<3:13:01, 98.14s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [18:04<3:08:00, 96.42s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▉         | 12/128 [19:35<3:03:36, 94.97s/it]epoch : 13, train loss : -0.222, valid loss : -0.315, train acc : 0.975, valid acc : 0.952, train f1 : 0.975, valid f1 : 0.591

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 318.28it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.44it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.79it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.49it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 337.98it/s][A100%|██████████| 196/196 [00:00<00:00, 335.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.585 -> 0.591
training process:  10%|█         | 13/128 [21:35<3:16:13, 102.38s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [23:07<3:08:29, 99.20s/it] EarlyStopping counter : 2 out of 40
training process:  12%|█▏        | 15/128 [24:38<3:02:42, 97.02s/it]EarlyStopping counter : 3 out of 40
training process:  12%|█▎        | 16/128 [26:09<2:57:11, 94.93s/it]epoch : 17, train loss : -0.477, valid loss : -0.301, train acc : 0.980, valid acc : 0.916, train f1 : 0.980, valid f1 : 0.549

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 311.04it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 324.88it/s][A
 51%|█████     | 100/196 [00:00<00:00, 330.02it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 332.95it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 332.63it/s][A100%|██████████| 196/196 [00:00<00:00, 330.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  13%|█▎        | 17/128 [28:07<3:08:55, 102.12s/it]EarlyStopping counter : 5 out of 40
training process:  14%|█▍        | 18/128 [29:38<3:00:48, 98.63s/it] EarlyStopping counter : 6 out of 40
training process:  15%|█▍        | 19/128 [31:10<2:55:23, 96.54s/it]EarlyStopping counter : 7 out of 40
training process:  16%|█▌        | 20/128 [32:41<2:50:52, 94.93s/it]epoch : 21, train loss : -0.754, valid loss : -0.651, train acc : 0.981, valid acc : 0.943, train f1 : 0.981, valid f1 : 0.580

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 318.48it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.00it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.69it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.69it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 338.31it/s][A100%|██████████| 196/196 [00:00<00:00, 336.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  16%|█▋        | 21/128 [34:37<3:00:28, 101.20s/it]Best score increase :0.591 -> 0.602
training process:  17%|█▋        | 22/128 [36:10<2:54:31, 98.78s/it] EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [37:44<2:50:45, 97.58s/it]EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [39:16<2:45:53, 95.70s/it]epoch : 25, train loss : -1.027, valid loss : -1.166, train acc : 0.986, valid acc : 0.955, train f1 : 0.986, valid f1 : 0.600

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 313.64it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.96it/s][A
 51%|█████     | 100/196 [00:00<00:00, 332.50it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.45it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 338.31it/s][A100%|██████████| 196/196 [00:00<00:00, 335.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [41:13<2:55:37, 102.30s/it]Best score increase :0.602 -> 0.621
training process:  20%|██        | 26/128 [42:49<2:50:17, 100.17s/it]EarlyStopping counter : 1 out of 40
training process:  21%|██        | 27/128 [44:24<2:45:56, 98.58s/it] EarlyStopping counter : 2 out of 40
training process:  22%|██▏       | 28/128 [45:57<2:41:53, 97.13s/it]epoch : 29, train loss : -1.316, valid loss : -0.568, train acc : 0.988, valid acc : 0.953, train f1 : 0.988, valid f1 : 0.597

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 307.32it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 323.02it/s][A
 51%|█████     | 99/196 [00:00<00:00, 329.31it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 333.37it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 335.62it/s][A100%|██████████| 196/196 [00:00<00:00, 332.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 29/128 [47:54<2:50:06, 103.09s/it]EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 30/128 [49:27<2:43:09, 99.90s/it] EarlyStopping counter : 5 out of 40
training process:  24%|██▍       | 31/128 [50:59<2:37:42, 97.55s/it]EarlyStopping counter : 6 out of 40
training process:  25%|██▌       | 32/128 [52:30<2:33:11, 95.75s/it]epoch : 33, train loss : -1.595, valid loss : -1.292, train acc : 0.989, valid acc : 0.974, train f1 : 0.989, valid f1 : 0.654

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 293.29it/s][A
 33%|███▎      | 64/196 [00:00<00:00, 315.36it/s][A
 50%|█████     | 98/196 [00:00<00:00, 323.03it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 326.59it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 328.28it/s][A100%|██████████| 196/196 [00:00<00:00, 324.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.621 -> 0.654
training process:  26%|██▌       | 33/128 [54:30<2:42:53, 102.88s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [56:02<2:36:05, 99.63s/it] EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [57:33<2:30:16, 96.95s/it]EarlyStopping counter : 3 out of 40
training process:  28%|██▊       | 36/128 [59:02<2:25:11, 94.69s/it]epoch : 37, train loss : -1.877, valid loss : -0.282, train acc : 0.993, valid acc : 0.957, train f1 : 0.993, valid f1 : 0.600

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 319.14it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.58it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.32it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 330.96it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 332.28it/s][A100%|██████████| 196/196 [00:00<00:00, 332.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  29%|██▉       | 37/128 [1:00:58<2:33:10, 101.00s/it]EarlyStopping counter : 5 out of 40
training process:  30%|██▉       | 38/128 [1:02:31<2:27:56, 98.63s/it] EarlyStopping counter : 6 out of 40
training process:  30%|███       | 39/128 [1:04:02<2:22:51, 96.31s/it]Best score increase :0.654 -> 0.662
training process:  31%|███▏      | 40/128 [1:05:33<2:19:08, 94.87s/it]epoch : 41, train loss : -2.156, valid loss : -0.448, train acc : 0.992, valid acc : 0.969, train f1 : 0.992, valid f1 : 0.632

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 309.36it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 323.30it/s][A
 51%|█████     | 99/196 [00:00<00:00, 326.48it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 330.26it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 332.12it/s][A100%|██████████| 196/196 [00:00<00:00, 328.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  32%|███▏      | 41/128 [1:07:32<2:27:52, 101.99s/it]EarlyStopping counter : 2 out of 40
training process:  33%|███▎      | 42/128 [1:09:03<2:21:43, 98.88s/it] Best score increase :0.662 -> 0.681
training process:  34%|███▎      | 43/128 [1:10:36<2:17:29, 97.05s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▍      | 44/128 [1:12:07<2:13:11, 95.13s/it]epoch : 45, train loss : -2.508, valid loss : -0.491, train acc : 0.995, valid acc : 0.957, train f1 : 0.995, valid f1 : 0.599

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 313.80it/s][A
 33%|███▎      | 64/196 [00:00<00:00, 287.75it/s][A
 47%|████▋     | 93/196 [00:00<00:00, 273.92it/s][A
 62%|██████▏   | 121/196 [00:00<00:00, 270.08it/s][A
 76%|███████▌  | 149/196 [00:00<00:00, 269.46it/s][A
 90%|████████▉ | 176/196 [00:00<00:00, 269.10it/s][A100%|██████████| 196/196 [00:00<00:00, 272.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  35%|███▌      | 45/128 [1:14:05<2:21:15, 102.12s/it]EarlyStopping counter : 3 out of 40
training process:  36%|███▌      | 46/128 [1:15:36<2:15:01, 98.80s/it] EarlyStopping counter : 4 out of 40
training process:  37%|███▋      | 47/128 [1:17:08<2:10:34, 96.73s/it]EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 48/128 [1:18:43<2:07:58, 95.99s/it]epoch : 49, train loss : -2.810, valid loss : -0.452, train acc : 0.996, valid acc : 0.973, train f1 : 0.996, valid f1 : 0.651

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 311.77it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 327.67it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.04it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 334.01it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 335.07it/s][A100%|██████████| 196/196 [00:00<00:00, 333.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 49/128 [1:20:41<2:15:16, 102.74s/it]EarlyStopping counter : 7 out of 40
training process:  39%|███▉      | 50/128 [1:22:12<2:09:04, 99.29s/it] EarlyStopping counter : 8 out of 40
training process:  40%|███▉      | 51/128 [1:23:47<2:05:50, 98.06s/it]EarlyStopping counter : 9 out of 40
training process:  41%|████      | 52/128 [1:25:18<2:01:18, 95.77s/it]epoch : 53, train loss : -3.046, valid loss : 1.352, train acc : 0.996, valid acc : 0.964, train f1 : 0.996, valid f1 : 0.626

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 288.71it/s][A
 32%|███▏      | 63/196 [00:00<00:00, 311.97it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 323.23it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 327.13it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 331.22it/s][A100%|██████████| 196/196 [00:00<00:00, 327.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  41%|████▏     | 53/128 [1:27:14<2:07:29, 102.00s/it]EarlyStopping counter : 11 out of 40
training process:  42%|████▏     | 54/128 [1:28:47<2:02:26, 99.28s/it] Best score increase :0.681 -> 0.690
training process:  43%|████▎     | 55/128 [1:30:18<1:57:46, 96.80s/it]EarlyStopping counter : 1 out of 40
training process:  44%|████▍     | 56/128 [1:31:50<1:54:10, 95.15s/it]epoch : 57, train loss : -3.362, valid loss : 0.437, train acc : 0.996, valid acc : 0.973, train f1 : 0.996, valid f1 : 0.648

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 322.01it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 332.05it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.93it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 339.29it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 338.92it/s][A100%|██████████| 196/196 [00:00<00:00, 337.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  45%|████▍     | 57/128 [1:33:46<2:00:16, 101.65s/it]EarlyStopping counter : 3 out of 40
training process:  45%|████▌     | 58/128 [1:35:18<1:54:57, 98.53s/it] EarlyStopping counter : 4 out of 40
training process:  46%|████▌     | 59/128 [1:36:49<1:50:45, 96.32s/it]EarlyStopping counter : 5 out of 40
training process:  47%|████▋     | 60/128 [1:38:22<1:48:02, 95.34s/it]epoch : 61, train loss : -3.769, valid loss : 2.100, train acc : 0.997, valid acc : 0.971, train f1 : 0.997, valid f1 : 0.643

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 315.65it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 328.12it/s][A
 51%|█████     | 100/196 [00:00<00:00, 332.83it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 334.13it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 336.72it/s][A100%|██████████| 196/196 [00:00<00:00, 334.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  48%|████▊     | 61/128 [1:40:24<1:55:28, 103.41s/it]EarlyStopping counter : 7 out of 40
training process:  48%|████▊     | 62/128 [1:41:56<1:49:56, 99.95s/it] Best score increase :0.690 -> 0.697
training process:  49%|████▉     | 63/128 [1:43:31<1:46:32, 98.34s/it]Best score increase :0.697 -> 0.709
training process:  50%|█████     | 64/128 [1:45:03<1:42:59, 96.56s/it]epoch : 65, train loss : -4.165, valid loss : -0.606, train acc : 0.998, valid acc : 0.982, train f1 : 0.998, valid f1 : 0.696

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 316.37it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 328.78it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.26it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 335.71it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 336.21it/s][A100%|██████████| 196/196 [00:00<00:00, 334.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  51%|█████     | 65/128 [1:47:05<1:49:19, 104.13s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 66/128 [1:48:36<1:43:29, 100.15s/it]EarlyStopping counter : 3 out of 40
training process:  52%|█████▏    | 67/128 [1:50:07<1:39:01, 97.40s/it] EarlyStopping counter : 4 out of 40
training process:  53%|█████▎    | 68/128 [1:51:38<1:35:29, 95.50s/it]epoch : 69, train loss : -4.443, valid loss : 1.260, train acc : 0.997, valid acc : 0.976, train f1 : 0.997, valid f1 : 0.660

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 322.84it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 333.97it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.94it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 338.49it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 340.04it/s][A100%|██████████| 196/196 [00:00<00:00, 338.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  54%|█████▍    | 69/128 [1:53:35<1:40:23, 102.10s/it]EarlyStopping counter : 6 out of 40
training process:  55%|█████▍    | 70/128 [1:55:06<1:35:24, 98.70s/it] EarlyStopping counter : 7 out of 40
training process:  55%|█████▌    | 71/128 [1:56:38<1:31:44, 96.57s/it]EarlyStopping counter : 8 out of 40
training process:  56%|█████▋    | 72/128 [1:58:11<1:29:17, 95.66s/it]epoch : 73, train loss : -4.825, valid loss : -1.770, train acc : 0.998, valid acc : 0.985, train f1 : 0.998, valid f1 : 0.723

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 328.00it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 335.37it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.93it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.46it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 339.88it/s][A100%|██████████| 196/196 [00:00<00:00, 338.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.709 -> 0.723
training process:  57%|█████▋    | 73/128 [2:00:11<1:34:23, 102.97s/it]EarlyStopping counter : 1 out of 40
training process:  58%|█████▊    | 74/128 [2:01:43<1:29:39, 99.63s/it] EarlyStopping counter : 2 out of 40
training process:  59%|█████▊    | 75/128 [2:03:14<1:25:41, 97.02s/it]EarlyStopping counter : 3 out of 40
training process:  59%|█████▉    | 76/128 [2:04:47<1:23:03, 95.84s/it]epoch : 77, train loss : -5.249, valid loss : 2.283, train acc : 0.998, valid acc : 0.973, train f1 : 0.998, valid f1 : 0.648

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 319.43it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.06it/s][A
 51%|█████     | 100/196 [00:00<00:00, 331.63it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 333.15it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 333.87it/s][A100%|██████████| 196/196 [00:00<00:00, 332.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  60%|██████    | 77/128 [2:06:44<1:26:52, 102.21s/it]EarlyStopping counter : 5 out of 40
training process:  61%|██████    | 78/128 [2:08:15<1:22:24, 98.88s/it] EarlyStopping counter : 6 out of 40
training process:  62%|██████▏   | 79/128 [2:09:47<1:19:03, 96.80s/it]Best score increase :0.723 -> 0.724
training process:  62%|██████▎   | 80/128 [2:11:22<1:16:55, 96.15s/it]epoch : 81, train loss : -5.537, valid loss : -1.851, train acc : 0.998, valid acc : 0.987, train f1 : 0.998, valid f1 : 0.731

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.49it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.04it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.54it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.65it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 342.89it/s][A100%|██████████| 196/196 [00:00<00:00, 341.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.724 -> 0.731
training process:  63%|██████▎   | 81/128 [2:13:23<1:21:07, 103.57s/it]EarlyStopping counter : 1 out of 40
training process:  64%|██████▍   | 82/128 [2:14:57<1:17:13, 100.72s/it]EarlyStopping counter : 2 out of 40
training process:  65%|██████▍   | 83/128 [2:16:29<1:13:38, 98.20s/it] EarlyStopping counter : 3 out of 40
training process:  66%|██████▌   | 84/128 [2:18:01<1:10:33, 96.22s/it]epoch : 85, train loss : -5.854, valid loss : 1.999, train acc : 0.998, valid acc : 0.976, train f1 : 0.998, valid f1 : 0.664

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 326.28it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 333.64it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 337.18it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 337.64it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 339.44it/s][A100%|██████████| 196/196 [00:00<00:00, 338.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  66%|██████▋   | 85/128 [2:20:00<1:13:57, 103.20s/it]EarlyStopping counter : 5 out of 40
training process:  67%|██████▋   | 86/128 [2:21:32<1:09:46, 99.67s/it] EarlyStopping counter : 6 out of 40
training process:  68%|██████▊   | 87/128 [2:23:03<1:06:24, 97.19s/it]EarlyStopping counter : 7 out of 40
training process:  69%|██████▉   | 88/128 [2:24:33<1:03:22, 95.07s/it]epoch : 89, train loss : -6.118, valid loss : 1.211, train acc : 0.998, valid acc : 0.976, train f1 : 0.998, valid f1 : 0.662

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 334.50it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.79it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 343.14it/s][A
 71%|███████   | 139/196 [00:00<00:00, 344.60it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 345.92it/s][A100%|██████████| 196/196 [00:00<00:00, 344.63it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  70%|██████▉   | 89/128 [2:26:30<1:06:07, 101.74s/it]EarlyStopping counter : 9 out of 40
training process:  70%|███████   | 90/128 [2:28:02<1:02:29, 98.66s/it] EarlyStopping counter : 10 out of 40
training process:  71%|███████   | 91/128 [2:29:34<59:39, 96.74s/it]  EarlyStopping counter : 11 out of 40
training process:  72%|███████▏  | 92/128 [2:31:07<57:25, 95.70s/it]epoch : 93, train loss : -6.582, valid loss : -1.391, train acc : 0.998, valid acc : 0.985, train f1 : 0.998, valid f1 : 0.714

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 324.34it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 333.78it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.29it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 337.12it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 337.20it/s][A100%|██████████| 196/196 [00:00<00:00, 336.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  73%|███████▎  | 93/128 [2:33:05<59:43, 102.40s/it]EarlyStopping counter : 13 out of 40
training process:  73%|███████▎  | 94/128 [2:34:40<56:40, 100.01s/it]EarlyStopping counter : 14 out of 40
training process:  74%|███████▍  | 95/128 [2:36:13<53:55, 98.05s/it] EarlyStopping counter : 15 out of 40
training process:  75%|███████▌  | 96/128 [2:37:46<51:23, 96.36s/it]epoch : 97, train loss : -7.084, valid loss : 1.230, train acc : 0.999, valid acc : 0.979, train f1 : 0.999, valid f1 : 0.676

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 341.55it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 344.75it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 346.15it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 347.20it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 347.77it/s][A100%|██████████| 196/196 [00:00<00:00, 347.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  76%|███████▌  | 97/128 [2:39:41<52:42, 102.02s/it]EarlyStopping counter : 17 out of 40
training process:  77%|███████▋  | 98/128 [2:41:14<49:35, 99.18s/it] EarlyStopping counter : 18 out of 40
training process:  77%|███████▋  | 99/128 [2:42:44<46:39, 96.54s/it]EarlyStopping counter : 19 out of 40
training process:  78%|███████▊  | 100/128 [2:44:17<44:33, 95.47s/it]epoch : 101, train loss : -7.331, valid loss : 4.434, train acc : 0.999, valid acc : 0.972, train f1 : 0.999, valid f1 : 0.648

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 332.78it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 337.76it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 339.81it/s][A
 71%|███████   | 139/196 [00:00<00:00, 340.97it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 339.68it/s][A100%|██████████| 196/196 [00:00<00:00, 339.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  79%|███████▉  | 101/128 [2:46:14<45:50, 101.89s/it]EarlyStopping counter : 21 out of 40
training process:  80%|███████▉  | 102/128 [2:47:44<42:35, 98.30s/it] EarlyStopping counter : 22 out of 40
training process:  80%|████████  | 103/128 [2:49:15<40:06, 96.26s/it]EarlyStopping counter : 23 out of 40
training process:  81%|████████▏ | 104/128 [2:50:46<37:53, 94.74s/it]epoch : 105, train loss : -7.630, valid loss : -0.866, train acc : 0.999, valid acc : 0.985, train f1 : 0.999, valid f1 : 0.716

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 323.86it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 332.57it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 336.04it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 337.44it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 338.77it/s][A100%|██████████| 196/196 [00:00<00:00, 337.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  82%|████████▏ | 105/128 [2:52:45<39:00, 101.75s/it]EarlyStopping counter : 25 out of 40
training process:  83%|████████▎ | 106/128 [2:54:15<36:03, 98.33s/it] EarlyStopping counter : 26 out of 40
training process:  84%|████████▎ | 107/128 [2:55:46<33:42, 96.31s/it]EarlyStopping counter : 27 out of 40
training process:  84%|████████▍ | 108/128 [2:57:20<31:49, 95.48s/it]epoch : 109, train loss : -8.040, valid loss : 0.733, train acc : 0.999, valid acc : 0.981, train f1 : 0.999, valid f1 : 0.683

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 325.68it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 332.20it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 335.37it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 337.47it/s][A
 87%|████████▋ | 171/196 [00:00<00:00, 339.05it/s][A100%|██████████| 196/196 [00:00<00:00, 337.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  85%|████████▌ | 109/128 [2:59:23<32:50, 103.70s/it]EarlyStopping counter : 29 out of 40
training process:  86%|████████▌ | 110/128 [3:00:55<30:01, 100.08s/it]EarlyStopping counter : 30 out of 40
training process:  87%|████████▋ | 111/128 [3:02:25<27:31, 97.15s/it] EarlyStopping counter : 31 out of 40
training process:  88%|████████▊ | 112/128 [3:03:56<25:25, 95.37s/it]epoch : 113, train loss : -8.333, valid loss : 4.926, train acc : 0.999, valid acc : 0.973, train f1 : 0.999, valid f1 : 0.653

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 339.78it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 345.28it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 348.56it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 350.43it/s][A
 90%|█████████ | 177/196 [00:00<00:00, 351.31it/s][A100%|██████████| 196/196 [00:00<00:00, 349.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  88%|████████▊ | 113/128 [3:05:56<25:42, 102.83s/it]EarlyStopping counter : 33 out of 40
training process:  89%|████████▉ | 114/128 [3:07:28<23:14, 99.60s/it] EarlyStopping counter : 34 out of 40
training process:  90%|████████▉ | 115/128 [3:09:02<21:10, 97.69s/it]EarlyStopping counter : 35 out of 40
training process:  91%|█████████ | 116/128 [3:10:33<19:09, 95.82s/it]epoch : 117, train loss : -8.545, valid loss : 1.910, train acc : 0.999, valid acc : 0.979, train f1 : 0.999, valid f1 : 0.672

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.83it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.08it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.25it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 336.42it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 338.79it/s][A100%|██████████| 196/196 [00:00<00:00, 338.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  91%|█████████▏| 117/128 [3:12:31<18:47, 102.46s/it]EarlyStopping counter : 37 out of 40
training process:  92%|█████████▏| 118/128 [3:14:02<16:30, 99.08s/it] EarlyStopping counter : 38 out of 40
training process:  93%|█████████▎| 119/128 [3:15:34<14:32, 96.93s/it]EarlyStopping counter : 39 out of 40
training process:  94%|█████████▍| 120/128 [3:17:05<12:40, 95.12s/it]epoch : 121, train loss : -8.856, valid loss : 3.540, train acc : 0.999, valid acc : 0.976, train f1 : 0.999, valid f1 : 0.656

  0%|          | 0/196 [00:00<?, ?it/s][A
  9%|▉         | 18/196 [00:00<00:00, 179.03it/s][A
 22%|██▏       | 44/196 [00:00<00:00, 225.38it/s][A
 37%|███▋      | 72/196 [00:00<00:00, 245.28it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 226.63it/s][A
 63%|██████▎   | 124/196 [00:00<00:00, 238.25it/s][A
 76%|███████▌  | 149/196 [00:00<00:00, 239.45it/s][A
 90%|████████▉ | 176/196 [00:00<00:00, 248.06it/s][A100%|██████████| 196/196 [00:00<00:00, 234.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 120, best f1 score : 0.731
training process:  94%|█████████▍| 120/128 [3:19:03<13:16, 99.53s/it]
training process finished, best loss : -1.851 and best acc : 0.987, best f1 : 0.731, best epoch : 80

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.58      0.59      0.59       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.79      0.79      0.79     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.79, test AUC : 0.79, test loss : -935.049

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:18, 12.38s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:00, 12.00s/it]processing for feature importance:  18%|█▊        | 3/17 [00:38<03:00, 12.91s/it]processing for feature importance:  24%|██▎       | 4/17 [00:52<02:55, 13.49s/it]processing for feature importance:  29%|██▉       | 5/17 [01:04<02:36, 13.07s/it]processing for feature importance:  35%|███▌      | 6/17 [01:18<02:27, 13.44s/it]processing for feature importance:  41%|████      | 7/17 [01:32<02:14, 13.40s/it]processing for feature importance:  47%|████▋     | 8/17 [01:45<01:58, 13.20s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:57<01:43, 13.00s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:09<01:29, 12.75s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:21<01:14, 12.46s/it]processing for feature importance:  71%|███████   | 12/17 [02:33<01:02, 12.41s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:46<00:49, 12.46s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:59<00:38, 12.77s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:12<00:25, 12.56s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:25<00:12, 12.71s/it]processing for feature importance: 100%|██████████| 17/17 [03:37<00:00, 12.69s/it]processing for feature importance: 100%|██████████| 17/17 [03:37<00:00, 12.81s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<11:02,  3.17s/it]visualize 2D latent space:   1%|          | 2/210 [00:03<06:24,  1.85s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:28,  1.33s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<10:30,  3.02s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<06:29,  1.87s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:10,  1.95s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:17,  1.17s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<01:49,  1.67s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s]  9%|▉         | 18/196 [00:00<00:01, 177.75it/s] 24%|██▍       | 47/196 [00:00<00:00, 242.44it/s] 41%|████      | 80/196 [00:00<00:00, 278.47it/s] 58%|█████▊    | 113/196 [00:00<00:00, 295.02it/s] 74%|███████▍  | 145/196 [00:00<00:00, 303.60it/s] 91%|█████████ | 178/196 [00:00<00:00, 309.46it/s]100%|██████████| 196/196 [00:00<00:00, 293.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_smoothing_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 202.71it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 201.05it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 199.60it/s]remove invalid data : null / measurement error:  14%|█▍        | 85/616 [00:00<00:02, 203.69it/s]remove invalid data : null / measurement error:  17%|█▋        | 106/616 [00:00<00:02, 205.43it/s]remove invalid data : null / measurement error:  21%|██        | 128/616 [00:00<00:02, 207.95it/s]remove invalid data : null / measurement error:  24%|██▍       | 150/616 [00:00<00:02, 210.22it/s]remove invalid data : null / measurement error:  28%|██▊       | 172/616 [00:00<00:02, 211.58it/s]remove invalid data : null / measurement error:  31%|███▏      | 194/616 [00:00<00:02, 209.05it/s]remove invalid data : null / measurement error:  35%|███▍      | 215/616 [00:01<00:01, 206.17it/s]remove invalid data : null / measurement error:  38%|███▊      | 236/616 [00:01<00:01, 206.35it/s]remove invalid data : null / measurement error:  42%|████▏     | 257/616 [00:01<00:01, 205.84it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 205.47it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 203.06it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 183.68it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 176.93it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 184.62it/s]remove invalid data : null / measurement error:  63%|██████▎   | 386/616 [00:01<00:01, 203.17it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:02<00:00, 221.71it/s]remove invalid data : null / measurement error:  71%|███████   | 436/616 [00:02<00:00, 221.73it/s]remove invalid data : null / measurement error:  75%|███████▍  | 459/616 [00:02<00:00, 219.27it/s]remove invalid data : null / measurement error:  78%|███████▊  | 482/616 [00:02<00:00, 207.91it/s]remove invalid data : null / measurement error:  82%|████████▏ | 504/616 [00:02<00:00, 208.14it/s]remove invalid data : null / measurement error:  85%|████████▌ | 526/616 [00:02<00:00, 209.08it/s]remove invalid data : null / measurement error:  89%|████████▉ | 548/616 [00:02<00:00, 207.23it/s]remove invalid data : null / measurement error:  92%|█████████▏| 569/616 [00:02<00:00, 207.24it/s]remove invalid data : null / measurement error:  96%|█████████▌| 591/616 [00:02<00:00, 208.09it/s]remove invalid data : null / measurement error:  99%|█████████▉| 612/616 [00:02<00:00, 208.50it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 205.43it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 244.87it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 240.16it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 242.61it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 244.42it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 244.87it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 246.07it/s]replace nan value:  34%|███▍      | 176/515 [00:00<00:01, 247.43it/s]replace nan value:  39%|███▉      | 201/515 [00:00<00:01, 247.55it/s]replace nan value:  44%|████▍     | 226/515 [00:00<00:01, 247.97it/s]replace nan value:  49%|████▊     | 251/515 [00:01<00:01, 248.04it/s]replace nan value:  54%|█████▍    | 277/515 [00:01<00:00, 249.64it/s]replace nan value:  59%|█████▊    | 302/515 [00:01<00:00, 249.65it/s]replace nan value:  64%|██████▎   | 328/515 [00:01<00:00, 250.31it/s]replace nan value:  69%|██████▊   | 354/515 [00:01<00:00, 246.29it/s]replace nan value:  74%|███████▍  | 380/515 [00:01<00:00, 248.18it/s]replace nan value:  79%|███████▊  | 405/515 [00:01<00:00, 247.78it/s]replace nan value:  83%|████████▎ | 430/515 [00:01<00:00, 247.58it/s]replace nan value:  88%|████████▊ | 455/515 [00:01<00:00, 245.69it/s]replace nan value:  93%|█████████▎| 481/515 [00:01<00:00, 247.14it/s]replace nan value:  98%|█████████▊| 507/515 [00:02<00:00, 248.89it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 247.28it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.81it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.89it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 78.01it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 75.49it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.91it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.35it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.48it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 49.02it/s]generate index:  14%|█▍        | 72/515 [00:01<00:08, 55.13it/s]generate index:  15%|█▌        | 78/515 [00:01<00:07, 54.98it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.74it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.04it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.50it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.10it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.26it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.83it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.95it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.56it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 71.00it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.79it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.01it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.10it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.40it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.94it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.30it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.57it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.35it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.89it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 89.34it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.69it/s]generate index:  51%|█████     | 261/515 [00:03<00:03, 74.40it/s]generate index:  52%|█████▏    | 270/515 [00:03<00:03, 78.24it/s]generate index:  54%|█████▍    | 279/515 [00:04<00:03, 68.90it/s]generate index:  56%|█████▌    | 287/515 [00:04<00:03, 66.63it/s]generate index:  57%|█████▋    | 295/515 [00:04<00:03, 66.42it/s]generate index:  59%|█████▊    | 302/515 [00:04<00:03, 62.96it/s]generate index:  60%|██████    | 310/515 [00:04<00:03, 66.98it/s]generate index:  62%|██████▏   | 317/515 [00:04<00:03, 61.00it/s]generate index:  63%|██████▎   | 325/515 [00:04<00:02, 63.78it/s]generate index:  64%|██████▍   | 332/515 [00:04<00:02, 64.81it/s]generate index:  66%|██████▌   | 339/515 [00:05<00:03, 49.63it/s]generate index:  67%|██████▋   | 345/515 [00:05<00:03, 48.43it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:04, 38.72it/s]generate index:  70%|███████   | 361/515 [00:05<00:03, 50.30it/s]generate index:  72%|███████▏  | 372/515 [00:05<00:02, 62.97it/s]generate index:  74%|███████▍  | 381/515 [00:05<00:01, 68.90it/s]generate index:  76%|███████▌  | 389/515 [00:05<00:01, 66.03it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 72.45it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 61.20it/s]generate index:  81%|████████  | 416/515 [00:06<00:01, 65.29it/s]generate index:  83%|████████▎ | 428/515 [00:06<00:01, 75.74it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 56.63it/s]generate index:  86%|████████▌ | 444/515 [00:06<00:01, 49.44it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:00, 60.44it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.52it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.44it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.23it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.81it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.28it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.62it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 64.31it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 4/154 [00:00<00:03, 39.77it/s]remove invalid data : null / measurement error:  16%|█▌        | 25/154 [00:00<00:00, 138.45it/s]remove invalid data : null / measurement error:  30%|██▉       | 46/154 [00:00<00:00, 170.61it/s]remove invalid data : null / measurement error:  44%|████▍     | 68/154 [00:00<00:00, 188.79it/s]remove invalid data : null / measurement error:  58%|█████▊    | 89/154 [00:00<00:00, 195.87it/s]remove invalid data : null / measurement error:  74%|███████▍  | 114/154 [00:00<00:00, 212.38it/s]remove invalid data : null / measurement error:  88%|████████▊ | 136/154 [00:00<00:00, 210.39it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 192.35it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 249.55it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 252.14it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 253.77it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 250.27it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 252.55it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 251.85it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.08it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.40it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.78it/s]generate index:  21%|██▏       | 28/131 [00:00<00:02, 47.86it/s]generate index:  25%|██▌       | 33/131 [00:00<00:02, 47.16it/s]generate index:  31%|███▏      | 41/131 [00:00<00:01, 56.23it/s]generate index:  36%|███▌      | 47/131 [00:00<00:01, 56.89it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 54.48it/s]generate index:  47%|████▋     | 62/131 [00:01<00:01, 64.17it/s]generate index:  53%|█████▎    | 69/131 [00:01<00:00, 65.29it/s]generate index:  58%|█████▊    | 76/131 [00:01<00:00, 63.52it/s]generate index:  63%|██████▎   | 83/131 [00:01<00:00, 62.95it/s]generate index:  69%|██████▊   | 90/131 [00:01<00:00, 45.94it/s]generate index:  73%|███████▎  | 96/131 [00:01<00:00, 48.29it/s]generate index:  78%|███████▊  | 102/131 [00:01<00:00, 49.01it/s]generate index:  82%|████████▏ | 108/131 [00:02<00:00, 50.76it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 55.23it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 65.54it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 56.94it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▎         | 7/193 [00:00<00:02, 68.20it/s]remove invalid data : null / measurement error:  15%|█▍        | 28/193 [00:00<00:01, 147.71it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 173.65it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 189.42it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 199.15it/s]remove invalid data : null / measurement error:  60%|█████▉    | 115/193 [00:00<00:00, 203.43it/s]remove invalid data : null / measurement error:  73%|███████▎  | 141/193 [00:00<00:00, 219.62it/s]remove invalid data : null / measurement error:  84%|████████▍ | 163/193 [00:00<00:00, 215.87it/s]remove invalid data : null / measurement error:  96%|█████████▌| 185/193 [00:00<00:00, 214.11it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 199.16it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 255.83it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 253.89it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 253.01it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 250.78it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 251.45it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 248.28it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 250.33it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 108.64it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 66.02it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.32it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 76.02it/s]generate index:  31%|███▏      | 50/160 [00:00<00:01, 77.55it/s]generate index:  37%|███▋      | 59/160 [00:00<00:01, 72.54it/s]generate index:  44%|████▍     | 70/160 [00:00<00:01, 82.48it/s]generate index:  49%|████▉     | 79/160 [00:01<00:01, 66.13it/s]generate index:  54%|█████▍    | 87/160 [00:01<00:01, 62.63it/s]generate index:  59%|█████▉    | 94/160 [00:01<00:01, 51.03it/s]generate index:  62%|██████▎   | 100/160 [00:01<00:01, 47.60it/s]generate index:  66%|██████▋   | 106/160 [00:01<00:01, 41.95it/s]generate index:  71%|███████   | 113/160 [00:01<00:01, 45.88it/s]generate index:  77%|███████▋  | 123/160 [00:02<00:00, 55.17it/s]generate index:  81%|████████  | 129/160 [00:02<00:00, 53.15it/s]generate index:  84%|████████▍ | 135/160 [00:02<00:00, 51.08it/s]generate index:  89%|████████▉ | 142/160 [00:02<00:00, 55.50it/s]generate index:  93%|█████████▎| 149/160 [00:02<00:00, 58.08it/s]generate index:  98%|█████████▊| 156/160 [00:02<00:00, 58.75it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 58.77it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.611, valid loss : -0.961, train acc : 0.548, valid acc : 0.593, train f1 : 0.360, valid f1 : 0.379

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 22/196 [00:00<00:00, 212.89it/s][A
 28%|██▊       | 54/196 [00:00<00:00, 273.01it/s][A
 45%|████▍     | 88/196 [00:00<00:00, 302.64it/s][A
 62%|██████▏   | 122/196 [00:00<00:00, 316.75it/s][A
 80%|███████▉  | 156/196 [00:00<00:00, 324.69it/s][A
 97%|█████████▋| 190/196 [00:00<00:00, 327.02it/s][A100%|██████████| 196/196 [00:00<00:00, 312.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.379
training process:   1%|          | 1/128 [02:00<4:15:07, 120.53s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:28<3:32:27, 101.17s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:56<3:18:34, 95.31s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:25<3:11:39, 92.74s/it]epoch : 5, train loss : -3.593, valid loss : -4.384, train acc : 0.451, valid acc : 0.495, train f1 : 0.318, valid f1 : 0.337

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 340.85it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 346.97it/s][A
 54%|█████▍    | 106/196 [00:00<00:00, 345.65it/s][A
 72%|███████▏  | 142/196 [00:00<00:00, 347.78it/s][A
 91%|█████████ | 178/196 [00:00<00:00, 348.93it/s][A100%|██████████| 196/196 [00:00<00:00, 347.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:22<3:28:11, 101.56s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:47<3:14:53, 95.85s/it] EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:13<3:06:58, 92.72s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:43<3:03:48, 91.90s/it]epoch : 9, train loss : -7.487, valid loss : -8.726, train acc : 0.301, valid acc : 0.268, train f1 : 0.239, valid f1 : 0.218

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.19it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.37it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 333.62it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 333.60it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 332.84it/s][A100%|██████████| 196/196 [00:00<00:00, 332.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:38<3:16:12, 98.93s/it]EarlyStopping counter : 9 out of 40
training process:   8%|▊         | 10/128 [16:07<3:09:03, 96.13s/it]EarlyStopping counter : 10 out of 40
training process:   9%|▊         | 11/128 [17:33<3:01:14, 92.94s/it]EarlyStopping counter : 11 out of 40
training process:   9%|▉         | 12/128 [19:01<2:56:48, 91.45s/it]epoch : 13, train loss : -12.165, valid loss : -14.998, train acc : 0.239, valid acc : 0.273, train f1 : 0.200, valid f1 : 0.221

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 341.36it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 341.89it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 339.44it/s][A
 71%|███████   | 139/196 [00:00<00:00, 338.34it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 342.79it/s][A100%|██████████| 196/196 [00:00<00:00, 342.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  10%|█         | 13/128 [20:52<3:06:42, 97.42s/it]EarlyStopping counter : 13 out of 40
training process:  11%|█         | 14/128 [22:21<3:00:11, 94.84s/it]EarlyStopping counter : 14 out of 40
training process:  12%|█▏        | 15/128 [23:51<2:55:38, 93.26s/it]EarlyStopping counter : 15 out of 40
training process:  12%|█▎        | 16/128 [25:19<2:51:21, 91.80s/it]epoch : 17, train loss : -17.842, valid loss : -20.813, train acc : 0.219, valid acc : 0.236, train f1 : 0.186, valid f1 : 0.197

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 273.34it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 280.30it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 282.90it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 284.52it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 285.45it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 284.03it/s][A100%|██████████| 196/196 [00:00<00:00, 283.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  13%|█▎        | 17/128 [27:13<3:02:00, 98.39s/it]EarlyStopping counter : 17 out of 40
training process:  14%|█▍        | 18/128 [28:42<2:55:18, 95.62s/it]EarlyStopping counter : 18 out of 40
training process:  15%|█▍        | 19/128 [30:09<2:49:06, 93.08s/it]EarlyStopping counter : 19 out of 40
training process:  16%|█▌        | 20/128 [31:36<2:44:10, 91.21s/it]epoch : 21, train loss : -23.887, valid loss : -26.200, train acc : 0.247, valid acc : 0.261, train f1 : 0.205, valid f1 : 0.214

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.55it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.64it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 338.09it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.80it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 340.73it/s][A100%|██████████| 196/196 [00:00<00:00, 339.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  16%|█▋        | 21/128 [33:29<2:54:06, 97.63s/it]EarlyStopping counter : 21 out of 40
training process:  17%|█▋        | 22/128 [34:57<2:47:28, 94.80s/it]EarlyStopping counter : 22 out of 40
training process:  18%|█▊        | 23/128 [36:23<2:41:33, 92.32s/it]EarlyStopping counter : 23 out of 40
training process:  19%|█▉        | 24/128 [37:51<2:37:42, 90.98s/it]epoch : 25, train loss : -29.613, valid loss : -31.868, train acc : 0.170, valid acc : 0.179, train f1 : 0.150, valid f1 : 0.156

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 279.03it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 282.36it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 283.62it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 284.45it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 284.88it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 285.18it/s][A100%|██████████| 196/196 [00:00<00:00, 284.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  20%|█▉        | 25/128 [39:47<2:48:57, 98.42s/it]EarlyStopping counter : 25 out of 40
training process:  20%|██        | 26/128 [41:16<2:42:38, 95.67s/it]EarlyStopping counter : 26 out of 40
training process:  21%|██        | 27/128 [42:45<2:37:44, 93.70s/it]EarlyStopping counter : 27 out of 40
training process:  22%|██▏       | 28/128 [44:13<2:32:53, 91.74s/it]epoch : 29, train loss : -37.101, valid loss : -37.844, train acc : 0.212, valid acc : 0.303, train f1 : 0.181, valid f1 : 0.239

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 278.76it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 282.87it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 284.35it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 284.89it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 283.95it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 284.98it/s][A100%|██████████| 196/196 [00:00<00:00, 284.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  23%|██▎       | 29/128 [46:06<2:42:13, 98.32s/it]EarlyStopping counter : 29 out of 40
training process:  23%|██▎       | 30/128 [47:33<2:35:00, 94.90s/it]EarlyStopping counter : 30 out of 40
training process:  24%|██▍       | 31/128 [49:02<2:30:32, 93.12s/it]EarlyStopping counter : 31 out of 40
training process:  25%|██▌       | 32/128 [50:31<2:27:02, 91.90s/it]epoch : 33, train loss : -43.891, valid loss : -45.136, train acc : 0.225, valid acc : 0.238, train f1 : 0.189, valid f1 : 0.198

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 332.24it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.62it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 343.38it/s][A
 71%|███████   | 139/196 [00:00<00:00, 345.15it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 345.76it/s][A100%|██████████| 196/196 [00:00<00:00, 343.73it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  26%|██▌       | 33/128 [52:23<2:35:08, 97.98s/it]EarlyStopping counter : 33 out of 40
training process:  27%|██▋       | 34/128 [53:53<2:29:32, 95.45s/it]EarlyStopping counter : 34 out of 40
training process:  27%|██▋       | 35/128 [55:23<2:25:16, 93.72s/it]EarlyStopping counter : 35 out of 40
training process:  28%|██▊       | 36/128 [56:51<2:21:20, 92.18s/it]epoch : 37, train loss : -50.168, valid loss : -59.257, train acc : 0.214, valid acc : 0.167, train f1 : 0.182, valid f1 : 0.148

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.85it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.77it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 344.71it/s][A
 71%|███████   | 139/196 [00:00<00:00, 345.95it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 347.00it/s][A100%|██████████| 196/196 [00:00<00:00, 344.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  29%|██▉       | 37/128 [58:46<2:29:52, 98.82s/it]EarlyStopping counter : 37 out of 40
training process:  30%|██▉       | 38/128 [1:00:15<2:23:53, 95.93s/it]EarlyStopping counter : 38 out of 40
training process:  30%|███       | 39/128 [1:01:43<2:19:02, 93.74s/it]EarlyStopping counter : 39 out of 40
training process:  31%|███▏      | 40/128 [1:03:13<2:15:38, 92.49s/it]epoch : 41, train loss : -57.267, valid loss : -67.883, train acc : 0.196, valid acc : 0.187, train f1 : 0.169, valid f1 : 0.162

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.63it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 341.36it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.68it/s][A
 71%|███████   | 139/196 [00:00<00:00, 337.90it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 339.28it/s][A100%|██████████| 196/196 [00:00<00:00, 339.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 40, best f1 score : 0.379
training process:  31%|███▏      | 40/128 [1:05:07<2:23:17, 97.70s/it]
training process finished, best loss : -0.961 and best acc : 0.593, best f1 : 0.379, best epoch : 0

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.01      0.39      0.01       152
           1       0.99      0.50      0.66     17031

    accuracy                           0.50     17183
   macro avg       0.50      0.45      0.34     17183
weighted avg       0.98      0.50      0.66     17183


# test acc : 0.50, test f1 : 0.34, test AUC : 0.45, test loss : -297.188

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:05, 11.62s/it]processing for feature importance:  12%|█▏        | 2/17 [00:21<02:41, 10.76s/it]processing for feature importance:  18%|█▊        | 3/17 [00:33<02:35, 11.10s/it]processing for feature importance:  24%|██▎       | 4/17 [00:44<02:25, 11.19s/it]processing for feature importance:  29%|██▉       | 5/17 [00:56<02:15, 11.28s/it]processing for feature importance:  35%|███▌      | 6/17 [01:06<02:02, 11.13s/it]processing for feature importance:  41%|████      | 7/17 [01:18<01:53, 11.31s/it]processing for feature importance:  47%|████▋     | 8/17 [01:30<01:42, 11.41s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:41<01:30, 11.32s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:53<01:20, 11.46s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:04<01:08, 11.44s/it]processing for feature importance:  71%|███████   | 12/17 [02:15<00:56, 11.21s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:26<00:45, 11.36s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:38<00:33, 11.30s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:49<00:22, 11.28s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:01<00:11, 11.72s/it]processing for feature importance: 100%|██████████| 17/17 [03:14<00:00, 11.88s/it]processing for feature importance: 100%|██████████| 17/17 [03:14<00:00, 11.43s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:02<09:15,  2.66s/it]visualize 2D latent space:   1%|          | 2/210 [00:03<05:27,  1.57s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<08:54,  2.57s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:06,  1.88s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:09,  1.06s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:41,  1.54s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<10:31,  3.02s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<05:18,  1.53s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:05<09:29,  2.74s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:14,  2.01s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:34,  1.42s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 12%|█▏        | 23/196 [00:00<00:00, 228.76it/s] 25%|██▌       | 49/196 [00:00<00:00, 244.71it/s] 39%|███▉      | 77/196 [00:00<00:00, 260.28it/s] 54%|█████▍    | 106/196 [00:00<00:00, 268.40it/s] 68%|██████▊   | 134/196 [00:00<00:00, 271.24it/s] 83%|████████▎ | 162/196 [00:00<00:00, 272.75it/s] 97%|█████████▋| 190/196 [00:00<00:00, 273.15it/s]100%|██████████| 196/196 [00:00<00:00, 267.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 14/616 [00:00<00:04, 132.90it/s]remove invalid data : null / measurement error:   5%|▍         | 29/616 [00:00<00:04, 141.17it/s]remove invalid data : null / measurement error:   8%|▊         | 49/616 [00:00<00:03, 166.30it/s]remove invalid data : null / measurement error:  11%|█         | 66/616 [00:00<00:03, 158.76it/s]remove invalid data : null / measurement error:  13%|█▎        | 82/616 [00:00<00:03, 152.33it/s]remove invalid data : null / measurement error:  16%|█▋        | 101/616 [00:00<00:03, 163.02it/s]remove invalid data : null / measurement error:  19%|█▉        | 120/616 [00:00<00:02, 170.33it/s]remove invalid data : null / measurement error:  23%|██▎       | 140/616 [00:00<00:02, 176.56it/s]remove invalid data : null / measurement error:  26%|██▌       | 160/616 [00:00<00:02, 182.69it/s]remove invalid data : null / measurement error:  29%|██▉       | 179/616 [00:01<00:02, 184.00it/s]remove invalid data : null / measurement error:  32%|███▏      | 198/616 [00:01<00:02, 184.75it/s]remove invalid data : null / measurement error:  35%|███▌      | 217/616 [00:01<00:02, 185.44it/s]remove invalid data : null / measurement error:  38%|███▊      | 236/616 [00:01<00:02, 185.61it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 186.67it/s]remove invalid data : null / measurement error:  45%|████▍     | 275/616 [00:01<00:01, 190.25it/s]remove invalid data : null / measurement error:  48%|████▊     | 295/616 [00:01<00:01, 190.87it/s]remove invalid data : null / measurement error:  51%|█████     | 315/616 [00:01<00:01, 189.16it/s]remove invalid data : null / measurement error:  54%|█████▍    | 334/616 [00:01<00:01, 188.66it/s]remove invalid data : null / measurement error:  57%|█████▋    | 353/616 [00:01<00:01, 186.72it/s]remove invalid data : null / measurement error:  60%|██████    | 372/616 [00:02<00:01, 175.85it/s]remove invalid data : null / measurement error:  64%|██████▎   | 392/616 [00:02<00:01, 181.70it/s]remove invalid data : null / measurement error:  68%|██████▊   | 419/616 [00:02<00:00, 206.84it/s]remove invalid data : null / measurement error:  71%|███████▏  | 440/616 [00:02<00:00, 178.12it/s]remove invalid data : null / measurement error:  75%|███████▍  | 461/616 [00:02<00:00, 184.14it/s]remove invalid data : null / measurement error:  78%|███████▊  | 481/616 [00:02<00:00, 185.30it/s]remove invalid data : null / measurement error:  81%|████████  | 500/616 [00:02<00:00, 182.15it/s]remove invalid data : null / measurement error:  84%|████████▍ | 519/616 [00:02<00:00, 177.52it/s]remove invalid data : null / measurement error:  88%|████████▊ | 540/616 [00:02<00:00, 185.08it/s]remove invalid data : null / measurement error:  91%|█████████ | 559/616 [00:03<00:00, 161.21it/s]remove invalid data : null / measurement error:  94%|█████████▍| 578/616 [00:03<00:00, 168.33it/s]remove invalid data : null / measurement error:  97%|█████████▋| 599/616 [00:03<00:00, 177.10it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 178.99it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/515 [00:00<00:03, 156.95it/s]replace nan value:   7%|▋         | 34/515 [00:00<00:02, 168.83it/s]replace nan value:  11%|█▏        | 58/515 [00:00<00:02, 197.57it/s]replace nan value:  16%|█▌        | 80/515 [00:00<00:02, 201.20it/s]replace nan value:  20%|█▉        | 101/515 [00:00<00:02, 197.47it/s]replace nan value:  24%|██▍       | 124/515 [00:00<00:01, 206.86it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 212.49it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 191.41it/s]replace nan value:  37%|███▋      | 190/515 [00:00<00:01, 196.61it/s]replace nan value:  42%|████▏     | 215/515 [00:01<00:01, 211.35it/s]replace nan value:  47%|████▋     | 240/515 [00:01<00:01, 222.32it/s]replace nan value:  51%|█████▏    | 265/515 [00:01<00:01, 229.82it/s]replace nan value:  56%|█████▌    | 289/515 [00:01<00:01, 195.78it/s]replace nan value:  61%|██████    | 313/515 [00:01<00:00, 205.33it/s]replace nan value:  65%|██████▌   | 337/515 [00:01<00:00, 214.32it/s]replace nan value:  70%|███████   | 361/515 [00:01<00:00, 219.40it/s]replace nan value:  75%|███████▍  | 386/515 [00:01<00:00, 227.43it/s]replace nan value:  80%|███████▉  | 410/515 [00:01<00:00, 230.18it/s]replace nan value:  84%|████████▍ | 434/515 [00:02<00:00, 232.77it/s]replace nan value:  89%|████████▉ | 458/515 [00:02<00:00, 233.06it/s]replace nan value:  94%|█████████▎| 482/515 [00:02<00:00, 234.58it/s]replace nan value:  98%|█████████▊| 506/515 [00:02<00:00, 206.23it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 211.23it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 3/515 [00:00<00:17, 29.08it/s]generate index:   1%|          | 6/515 [00:00<00:17, 29.05it/s]generate index:   3%|▎         | 13/515 [00:00<00:11, 43.92it/s]generate index:   5%|▍         | 24/515 [00:00<00:07, 64.53it/s]generate index:   6%|▌         | 31/515 [00:00<00:07, 62.95it/s]generate index:   8%|▊         | 41/515 [00:00<00:07, 60.45it/s]generate index:   9%|▉         | 48/515 [00:00<00:10, 43.99it/s]generate index:  10%|█         | 53/515 [00:01<00:10, 45.09it/s]generate index:  11%|█▏        | 58/515 [00:01<00:11, 40.58it/s]generate index:  12%|█▏        | 63/515 [00:01<00:11, 40.69it/s]generate index:  14%|█▎        | 70/515 [00:01<00:09, 47.23it/s]generate index:  15%|█▍        | 76/515 [00:01<00:09, 48.77it/s]generate index:  17%|█▋        | 85/515 [00:01<00:07, 59.14it/s]generate index:  18%|█▊        | 92/515 [00:01<00:07, 56.85it/s]generate index:  19%|█▉        | 98/515 [00:02<00:08, 48.24it/s]generate index:  21%|██        | 106/515 [00:02<00:07, 55.15it/s]generate index:  23%|██▎       | 116/515 [00:02<00:06, 63.81it/s]generate index:  24%|██▍       | 123/515 [00:02<00:06, 62.77it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 67.40it/s]generate index:  27%|██▋       | 139/515 [00:02<00:05, 68.04it/s]generate index:  28%|██▊       | 146/515 [00:02<00:05, 67.21it/s]generate index:  30%|██▉       | 154/515 [00:02<00:05, 68.93it/s]generate index:  32%|███▏      | 163/515 [00:02<00:04, 74.45it/s]generate index:  33%|███▎      | 171/515 [00:03<00:05, 68.06it/s]generate index:  35%|███▍      | 178/515 [00:03<00:05, 66.03it/s]generate index:  36%|███▋      | 187/515 [00:03<00:04, 72.37it/s]generate index:  38%|███▊      | 195/515 [00:03<00:04, 66.94it/s]generate index:  39%|███▉      | 202/515 [00:03<00:05, 60.28it/s]generate index:  42%|████▏     | 215/515 [00:03<00:03, 77.58it/s]generate index:  43%|████▎     | 224/515 [00:03<00:04, 71.62it/s]generate index:  46%|████▌     | 236/515 [00:03<00:03, 82.81it/s]generate index:  48%|████▊     | 246/515 [00:03<00:03, 86.91it/s]generate index:  50%|████▉     | 256/515 [00:04<00:04, 58.49it/s]generate index:  51%|█████▏    | 264/515 [00:04<00:04, 60.70it/s]generate index:  53%|█████▎    | 272/515 [00:04<00:03, 61.52it/s]generate index:  54%|█████▍    | 279/515 [00:04<00:04, 54.61it/s]generate index:  56%|█████▌    | 286/515 [00:04<00:04, 54.93it/s]generate index:  57%|█████▋    | 294/515 [00:04<00:03, 59.55it/s]generate index:  58%|█████▊    | 301/515 [00:05<00:03, 55.56it/s]generate index:  60%|█████▉    | 308/515 [00:05<00:03, 57.69it/s]generate index:  61%|██████    | 315/515 [00:05<00:03, 56.95it/s]generate index:  63%|██████▎   | 323/515 [00:05<00:03, 60.60it/s]generate index:  64%|██████▍   | 331/515 [00:05<00:03, 61.29it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 50.46it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 46.17it/s]generate index:  68%|██████▊   | 349/515 [00:06<00:03, 41.82it/s]generate index:  70%|██████▉   | 359/515 [00:06<00:02, 53.67it/s]generate index:  72%|███████▏  | 371/515 [00:06<00:02, 68.74it/s]generate index:  74%|███████▍  | 381/515 [00:06<00:01, 72.58it/s]generate index:  76%|███████▌  | 389/515 [00:06<00:01, 69.85it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 75.59it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 62.32it/s]generate index:  81%|████████  | 415/515 [00:06<00:01, 66.30it/s]generate index:  83%|████████▎ | 426/515 [00:07<00:01, 75.00it/s]generate index:  84%|████████▍ | 434/515 [00:07<00:01, 61.76it/s]generate index:  86%|████████▌ | 441/515 [00:07<00:01, 47.17it/s]generate index:  87%|████████▋ | 450/515 [00:07<00:01, 55.36it/s]generate index:  89%|████████▉ | 458/515 [00:07<00:00, 58.73it/s]generate index:  90%|█████████ | 466/515 [00:07<00:00, 61.50it/s]generate index:  92%|█████████▏| 473/515 [00:07<00:00, 54.72it/s]generate index:  93%|█████████▎| 480/515 [00:08<00:00, 58.04it/s]generate index:  95%|█████████▍| 488/515 [00:08<00:00, 62.27it/s]generate index:  96%|█████████▌| 495/515 [00:08<00:00, 61.96it/s]generate index:  97%|█████████▋| 502/515 [00:08<00:00, 63.86it/s]generate index:  99%|█████████▉| 509/515 [00:08<00:00, 63.73it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 59.45it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|          | 1/154 [00:00<00:15,  9.59it/s]remove invalid data : null / measurement error:   9%|▉         | 14/154 [00:00<00:01, 78.72it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:01, 114.02it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 149.13it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 165.23it/s]remove invalid data : null / measurement error:  58%|█████▊    | 90/154 [00:00<00:00, 173.06it/s]remove invalid data : null / measurement error:  73%|███████▎  | 113/154 [00:00<00:00, 189.06it/s]remove invalid data : null / measurement error:  86%|████████▋ | 133/154 [00:00<00:00, 191.06it/s]remove invalid data : null / measurement error:  99%|█████████▉| 153/154 [00:00<00:00, 190.12it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 164.96it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 243.41it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 251.84it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 249.21it/s]replace nan value:  78%|███████▊  | 102/131 [00:00<00:00, 242.38it/s]replace nan value:  97%|█████████▋| 127/131 [00:00<00:00, 222.39it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 232.40it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 62.55it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 46.29it/s]generate index:  16%|█▌        | 21/131 [00:00<00:02, 54.20it/s]generate index:  21%|██        | 27/131 [00:00<00:01, 54.63it/s]generate index:  25%|██▌       | 33/131 [00:00<00:01, 55.97it/s]generate index:  31%|███▏      | 41/131 [00:00<00:01, 63.39it/s]generate index:  37%|███▋      | 48/131 [00:00<00:01, 58.98it/s]generate index:  42%|████▏     | 55/131 [00:00<00:01, 58.01it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 61.27it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 61.45it/s]generate index:  59%|█████▉    | 77/131 [00:01<00:00, 63.04it/s]generate index:  64%|██████▍   | 84/131 [00:01<00:00, 62.77it/s]generate index:  69%|██████▉   | 91/131 [00:01<00:00, 40.84it/s]generate index:  74%|███████▍  | 97/131 [00:01<00:00, 40.69it/s]generate index:  78%|███████▊  | 102/131 [00:01<00:00, 41.22it/s]generate index:  82%|████████▏ | 107/131 [00:02<00:00, 42.10it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 50.76it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 62.79it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 54.92it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|          | 1/193 [00:00<00:19,  9.79it/s]remove invalid data : null / measurement error:  11%|█▏        | 22/193 [00:00<00:01, 125.23it/s]remove invalid data : null / measurement error:  22%|██▏       | 43/193 [00:00<00:00, 161.57it/s]remove invalid data : null / measurement error:  34%|███▎      | 65/193 [00:00<00:00, 180.92it/s]remove invalid data : null / measurement error:  45%|████▍     | 86/193 [00:00<00:00, 189.12it/s]remove invalid data : null / measurement error:  54%|█████▍    | 105/193 [00:00<00:00, 178.32it/s]remove invalid data : null / measurement error:  65%|██████▌   | 126/193 [00:00<00:00, 187.62it/s]remove invalid data : null / measurement error:  76%|███████▌  | 146/193 [00:00<00:00, 188.39it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 179.69it/s]remove invalid data : null / measurement error:  96%|█████████▌| 185/193 [00:01<00:00, 183.28it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 174.93it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 23/160 [00:00<00:00, 223.19it/s]replace nan value:  29%|██▉       | 46/160 [00:00<00:00, 205.26it/s]replace nan value:  42%|████▏     | 67/160 [00:00<00:00, 191.30it/s]replace nan value:  56%|█████▋    | 90/160 [00:00<00:00, 203.32it/s]replace nan value:  72%|███████▏  | 115/160 [00:00<00:00, 216.59it/s]replace nan value:  88%|████████▊ | 140/160 [00:00<00:00, 225.91it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 219.58it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 99.94it/s]generate index:  13%|█▎        | 21/160 [00:00<00:02, 62.75it/s]generate index:  18%|█▊        | 28/160 [00:00<00:02, 59.42it/s]generate index:  24%|██▍       | 38/160 [00:00<00:01, 71.03it/s]generate index:  29%|██▉       | 47/160 [00:00<00:01, 75.34it/s]generate index:  36%|███▌      | 57/160 [00:00<00:01, 82.08it/s]generate index:  41%|████▏     | 66/160 [00:00<00:01, 82.90it/s]generate index:  47%|████▋     | 75/160 [00:01<00:01, 76.00it/s]generate index:  52%|█████▏    | 83/160 [00:01<00:01, 63.59it/s]generate index:  56%|█████▋    | 90/160 [00:01<00:01, 58.03it/s]generate index:  61%|██████    | 97/160 [00:01<00:01, 58.90it/s]generate index:  65%|██████▌   | 104/160 [00:01<00:01, 47.96it/s]generate index:  69%|██████▉   | 111/160 [00:01<00:00, 52.08it/s]generate index:  76%|███████▌  | 121/160 [00:01<00:00, 60.59it/s]generate index:  80%|████████  | 128/160 [00:02<00:00, 55.18it/s]generate index:  84%|████████▍ | 135/160 [00:02<00:00, 54.55it/s]generate index:  89%|████████▉ | 142/160 [00:02<00:00, 57.97it/s]generate index:  93%|█████████▎| 149/160 [00:02<00:00, 59.99it/s]generate index:  98%|█████████▊| 156/160 [00:02<00:00, 59.48it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.67it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.035, valid loss : 0.015, train acc : 0.967, valid acc : 0.992, train f1 : 0.499, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.41it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 339.16it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 341.26it/s][A
 71%|███████   | 139/196 [00:00<00:00, 345.58it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 348.16it/s][A100%|██████████| 196/196 [00:00<00:00, 345.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.498
training process:   1%|          | 1/128 [01:56<4:07:02, 116.71s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:24<3:28:47, 99.42s/it] EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:49<3:13:49, 93.04s/it]EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:17<3:08:34, 91.25s/it]epoch : 5, train loss : 0.014, valid loss : 0.014, train acc : 0.991, valid acc : 0.992, train f1 : 0.498, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 25/196 [00:00<00:00, 242.91it/s][A
 27%|██▋       | 52/196 [00:00<00:00, 255.52it/s][A
 40%|███▉      | 78/196 [00:00<00:00, 256.50it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 259.29it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 266.94it/s][A
 83%|████████▎ | 163/196 [00:00<00:00, 271.56it/s][A
 97%|█████████▋| 191/196 [00:00<00:00, 272.60it/s][A100%|██████████| 196/196 [00:00<00:00, 265.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:11<3:23:27, 99.25s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:39<3:14:19, 95.57s/it]EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:07<3:07:19, 92.89s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:34<3:02:24, 91.20s/it]epoch : 9, train loss : 0.012, valid loss : 0.011, train acc : 0.991, valid acc : 0.992, train f1 : 0.531, valid f1 : 0.506

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.87it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 337.90it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 341.91it/s][A
 70%|███████   | 138/196 [00:00<00:00, 343.19it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 340.11it/s][A100%|██████████| 196/196 [00:00<00:00, 338.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.498 -> 0.506
training process:   7%|▋         | 9/128 [14:26<3:13:49, 97.73s/it]Best score increase :0.506 -> 0.542
training process:   8%|▊         | 10/128 [15:56<3:07:29, 95.33s/it]Best score increase :0.542 -> 0.627
training process:   9%|▊         | 11/128 [17:21<2:59:26, 92.02s/it]Best score increase :0.627 -> 0.695
training process:   9%|▉         | 12/128 [18:48<2:55:16, 90.66s/it]epoch : 13, train loss : 0.010, valid loss : 0.009, train acc : 0.992, valid acc : 0.993, train f1 : 0.662, valid f1 : 0.702

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 341.64it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 344.59it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 345.87it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 346.65it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 347.12it/s][A100%|██████████| 196/196 [00:00<00:00, 346.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.695 -> 0.702
training process:  10%|█         | 13/128 [20:39<3:05:28, 96.77s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [22:07<2:58:37, 94.02s/it]Best score increase :0.702 -> 0.706
training process:  12%|█▏        | 15/128 [23:33<2:52:43, 91.72s/it]Best score increase :0.706 -> 0.730
training process:  12%|█▎        | 16/128 [24:57<2:46:44, 89.33s/it]epoch : 17, train loss : 0.009, valid loss : 0.007, train acc : 0.993, valid acc : 0.994, train f1 : 0.748, valid f1 : 0.777

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.03it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 338.18it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 342.12it/s][A
 70%|███████   | 138/196 [00:00<00:00, 344.16it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 345.39it/s][A100%|██████████| 196/196 [00:00<00:00, 343.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.730 -> 0.777
training process:  13%|█▎        | 17/128 [26:48<2:57:16, 95.82s/it]Best score increase :0.777 -> 0.794
training process:  14%|█▍        | 18/128 [28:15<2:51:03, 93.30s/it]EarlyStopping counter : 1 out of 40
training process:  15%|█▍        | 19/128 [29:43<2:46:13, 91.50s/it]Best score increase :0.794 -> 0.798
training process:  16%|█▌        | 20/128 [31:09<2:41:49, 89.91s/it]epoch : 21, train loss : 0.008, valid loss : 0.008, train acc : 0.994, valid acc : 0.995, train f1 : 0.796, valid f1 : 0.805

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 341.67it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 340.63it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 342.45it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 343.21it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 343.60it/s][A100%|██████████| 196/196 [00:00<00:00, 343.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.798 -> 0.805
training process:  16%|█▋        | 21/128 [33:01<2:52:01, 96.46s/it]Best score increase :0.805 -> 0.849
training process:  17%|█▋        | 22/128 [34:30<2:46:32, 94.26s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [36:01<2:43:29, 93.43s/it]EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [37:30<2:39:34, 92.06s/it]epoch : 25, train loss : 0.007, valid loss : 0.008, train acc : 0.994, valid acc : 0.995, train f1 : 0.811, valid f1 : 0.842

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 343.29it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 347.54it/s][A
 54%|█████▍    | 106/196 [00:00<00:00, 346.88it/s][A
 72%|███████▏  | 142/196 [00:00<00:00, 348.31it/s][A
 90%|█████████ | 177/196 [00:00<00:00, 348.73it/s][A100%|██████████| 196/196 [00:00<00:00, 347.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [39:21<2:47:32, 97.60s/it]EarlyStopping counter : 4 out of 40
training process:  20%|██        | 26/128 [40:49<2:41:07, 94.78s/it]EarlyStopping counter : 5 out of 40
training process:  21%|██        | 27/128 [42:19<2:37:11, 93.39s/it]EarlyStopping counter : 6 out of 40
training process:  22%|██▏       | 28/128 [43:49<2:34:06, 92.47s/it]epoch : 29, train loss : 0.006, valid loss : 0.007, train acc : 0.995, valid acc : 0.996, train f1 : 0.827, valid f1 : 0.853

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 36/196 [00:00<00:00, 352.71it/s][A
 37%|███▋      | 73/196 [00:00<00:00, 357.65it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 358.82it/s][A
 75%|███████▌  | 147/196 [00:00<00:00, 359.45it/s][A
 94%|█████████▍| 184/196 [00:00<00:00, 360.14it/s][A100%|██████████| 196/196 [00:00<00:00, 359.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.849 -> 0.853
training process:  23%|██▎       | 29/128 [45:44<2:43:48, 99.28s/it]EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 30/128 [47:11<2:35:52, 95.43s/it]EarlyStopping counter : 2 out of 40
training process:  24%|██▍       | 31/128 [48:38<2:30:24, 93.04s/it]Best score increase :0.853 -> 0.858
training process:  25%|██▌       | 32/128 [50:06<2:26:25, 91.51s/it]epoch : 33, train loss : 0.006, valid loss : 0.007, train acc : 0.995, valid acc : 0.996, train f1 : 0.844, valid f1 : 0.876

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▍        | 29/196 [00:00<00:00, 280.49it/s][A
 30%|██▉       | 58/196 [00:00<00:00, 283.74it/s][A
 44%|████▍     | 87/196 [00:00<00:00, 284.23it/s][A
 59%|█████▉    | 116/196 [00:00<00:00, 283.65it/s][A
 74%|███████▍  | 145/196 [00:00<00:00, 283.57it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 283.51it/s][A100%|██████████| 196/196 [00:00<00:00, 283.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.858 -> 0.876
training process:  26%|██▌       | 33/128 [51:57<2:34:05, 97.33s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [53:24<2:27:39, 94.25s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [54:50<2:22:09, 91.72s/it]EarlyStopping counter : 3 out of 40
training process:  28%|██▊       | 36/128 [56:22<2:20:33, 91.67s/it]epoch : 37, train loss : 0.005, valid loss : 0.007, train acc : 0.996, valid acc : 0.997, train f1 : 0.861, valid f1 : 0.881

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.96it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.12it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 344.51it/s][A
 71%|███████   | 139/196 [00:00<00:00, 344.91it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 342.80it/s][A100%|██████████| 196/196 [00:00<00:00, 343.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.876 -> 0.881
training process:  29%|██▉       | 37/128 [58:15<2:28:39, 98.02s/it]EarlyStopping counter : 1 out of 40
training process:  30%|██▉       | 38/128 [59:41<2:21:46, 94.52s/it]EarlyStopping counter : 2 out of 40
training process:  30%|███       | 39/128 [1:01:10<2:17:55, 92.98s/it]EarlyStopping counter : 3 out of 40
training process:  31%|███▏      | 40/128 [1:02:40<2:14:50, 91.93s/it]epoch : 41, train loss : 0.005, valid loss : 0.008, train acc : 0.996, valid acc : 0.996, train f1 : 0.866, valid f1 : 0.875

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 273.59it/s][A
 29%|██▊       | 56/196 [00:00<00:00, 269.82it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 266.26it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 264.04it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 262.96it/s][A
 84%|████████▎ | 164/196 [00:00<00:00, 264.98it/s][A
 98%|█████████▊| 192/196 [00:00<00:00, 268.55it/s][A100%|██████████| 196/196 [00:00<00:00, 267.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  32%|███▏      | 41/128 [1:04:34<2:22:47, 98.48s/it]Best score increase :0.881 -> 0.882
training process:  33%|███▎      | 42/128 [1:06:01<2:16:25, 95.18s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▎      | 43/128 [1:07:30<2:12:11, 93.31s/it]EarlyStopping counter : 2 out of 40
training process:  34%|███▍      | 44/128 [1:08:57<2:07:54, 91.36s/it]epoch : 45, train loss : 0.005, valid loss : 0.008, train acc : 0.996, valid acc : 0.996, train f1 : 0.874, valid f1 : 0.878

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 346.95it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 351.05it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 352.10it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 352.39it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 352.78it/s][A100%|██████████| 196/196 [00:00<00:00, 350.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  35%|███▌      | 45/128 [1:10:49<2:14:58, 97.57s/it]EarlyStopping counter : 4 out of 40
training process:  36%|███▌      | 46/128 [1:12:19<2:10:18, 95.34s/it]EarlyStopping counter : 5 out of 40
training process:  37%|███▋      | 47/128 [1:13:47<2:05:44, 93.14s/it]EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 48/128 [1:15:18<2:03:28, 92.61s/it]epoch : 49, train loss : 0.005, valid loss : 0.009, train acc : 0.996, valid acc : 0.996, train f1 : 0.873, valid f1 : 0.864

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 338.18it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 343.64it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 345.58it/s][A
 71%|███████   | 139/196 [00:00<00:00, 347.23it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 345.74it/s][A100%|██████████| 196/196 [00:00<00:00, 345.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  38%|███▊      | 49/128 [1:17:11<2:09:54, 98.66s/it]EarlyStopping counter : 8 out of 40
training process:  39%|███▉      | 50/128 [1:18:40<2:04:32, 95.80s/it]EarlyStopping counter : 9 out of 40
training process:  40%|███▉      | 51/128 [1:20:10<2:00:43, 94.07s/it]EarlyStopping counter : 10 out of 40
training process:  41%|████      | 52/128 [1:21:39<1:56:58, 92.35s/it]epoch : 53, train loss : 0.005, valid loss : 0.009, train acc : 0.996, valid acc : 0.995, train f1 : 0.882, valid f1 : 0.854

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 22/196 [00:00<00:00, 215.21it/s][A
 28%|██▊       | 54/196 [00:00<00:00, 272.22it/s][A
 45%|████▍     | 88/196 [00:00<00:00, 301.51it/s][A
 62%|██████▏   | 122/196 [00:00<00:00, 314.91it/s][A
 80%|███████▉  | 156/196 [00:00<00:00, 322.22it/s][A
 97%|█████████▋| 190/196 [00:00<00:00, 326.72it/s][A100%|██████████| 196/196 [00:00<00:00, 312.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  41%|████▏     | 53/128 [1:23:33<2:03:44, 99.00s/it]EarlyStopping counter : 12 out of 40
training process:  42%|████▏     | 54/128 [1:25:01<1:58:06, 95.77s/it]EarlyStopping counter : 13 out of 40
training process:  43%|████▎     | 55/128 [1:26:30<1:53:58, 93.67s/it]EarlyStopping counter : 14 out of 40
training process:  44%|████▍     | 56/128 [1:28:01<1:51:17, 92.75s/it]epoch : 57, train loss : 0.004, valid loss : 0.010, train acc : 0.997, valid acc : 0.996, train f1 : 0.898, valid f1 : 0.864

  0%|          | 0/196 [00:00<?, ?it/s][A
 12%|█▏        | 24/196 [00:00<00:00, 237.82it/s][A
 27%|██▋       | 52/196 [00:00<00:00, 261.69it/s][A
 41%|████▏     | 81/196 [00:00<00:00, 271.63it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 276.36it/s][A
 70%|███████   | 138/196 [00:00<00:00, 275.28it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 271.08it/s][A
 99%|█████████▉| 194/196 [00:00<00:00, 269.47it/s][A100%|██████████| 196/196 [00:00<00:00, 269.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  45%|████▍     | 57/128 [1:29:54<1:56:59, 98.87s/it]EarlyStopping counter : 16 out of 40
training process:  45%|████▌     | 58/128 [1:31:24<1:52:16, 96.24s/it]EarlyStopping counter : 17 out of 40
training process:  46%|████▌     | 59/128 [1:32:51<1:47:34, 93.54s/it]EarlyStopping counter : 18 out of 40
training process:  47%|████▋     | 60/128 [1:34:17<1:43:30, 91.33s/it]epoch : 61, train loss : 0.004, valid loss : 0.011, train acc : 0.997, valid acc : 0.996, train f1 : 0.902, valid f1 : 0.863

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 259.26it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 272.95it/s][A
 43%|████▎     | 84/196 [00:00<00:00, 277.76it/s][A
 57%|█████▋    | 112/196 [00:00<00:00, 277.84it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 273.00it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 268.78it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 265.31it/s][A100%|██████████| 196/196 [00:00<00:00, 269.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  48%|████▊     | 61/128 [1:36:09<1:48:45, 97.39s/it]EarlyStopping counter : 20 out of 40
training process:  48%|████▊     | 62/128 [1:37:36<1:43:43, 94.30s/it]EarlyStopping counter : 21 out of 40
training process:  49%|████▉     | 63/128 [1:39:02<1:39:28, 91.83s/it]EarlyStopping counter : 22 out of 40
training process:  50%|█████     | 64/128 [1:40:30<1:36:43, 90.69s/it]epoch : 65, train loss : 0.004, valid loss : 0.011, train acc : 0.997, valid acc : 0.995, train f1 : 0.911, valid f1 : 0.832

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 328.27it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.07it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 346.36it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 348.71it/s][A
 90%|█████████ | 177/196 [00:00<00:00, 350.34it/s][A100%|██████████| 196/196 [00:00<00:00, 347.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  51%|█████     | 65/128 [1:42:21<1:41:30, 96.67s/it]EarlyStopping counter : 24 out of 40
training process:  52%|█████▏    | 66/128 [1:43:48<1:36:50, 93.71s/it]EarlyStopping counter : 25 out of 40
training process:  52%|█████▏    | 67/128 [1:45:18<1:34:13, 92.67s/it]EarlyStopping counter : 26 out of 40
training process:  53%|█████▎    | 68/128 [1:46:47<1:31:43, 91.73s/it]epoch : 69, train loss : 0.004, valid loss : 0.011, train acc : 0.997, valid acc : 0.995, train f1 : 0.907, valid f1 : 0.853

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 278.02it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 283.52it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 285.65it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 286.70it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 278.50it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 268.82it/s][A100%|██████████| 196/196 [00:00<00:00, 274.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  54%|█████▍    | 69/128 [1:48:41<1:36:43, 98.37s/it]EarlyStopping counter : 28 out of 40
training process:  55%|█████▍    | 70/128 [1:50:11<1:32:31, 95.71s/it]EarlyStopping counter : 29 out of 40
training process:  55%|█████▌    | 71/128 [1:51:40<1:29:04, 93.77s/it]EarlyStopping counter : 30 out of 40
training process:  56%|█████▋    | 72/128 [1:53:10<1:26:21, 92.52s/it]epoch : 73, train loss : 0.004, valid loss : 0.011, train acc : 0.997, valid acc : 0.996, train f1 : 0.921, valid f1 : 0.867

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 278.67it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 282.64it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 283.94it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 284.54it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 281.21it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 282.58it/s][A100%|██████████| 196/196 [00:00<00:00, 282.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  57%|█████▋    | 73/128 [1:55:05<1:31:12, 99.50s/it]EarlyStopping counter : 32 out of 40
training process:  58%|█████▊    | 74/128 [1:56:34<1:26:36, 96.24s/it]EarlyStopping counter : 33 out of 40
training process:  59%|█████▊    | 75/128 [1:58:04<1:23:14, 94.24s/it]EarlyStopping counter : 34 out of 40
training process:  59%|█████▉    | 76/128 [1:59:30<1:19:37, 91.88s/it]epoch : 77, train loss : 0.004, valid loss : 0.013, train acc : 0.998, valid acc : 0.995, train f1 : 0.926, valid f1 : 0.838

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 273.47it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 278.99it/s][A
 43%|████▎     | 85/196 [00:00<00:00, 275.26it/s][A
 58%|█████▊    | 113/196 [00:00<00:00, 269.39it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 264.00it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 262.47it/s][A
 99%|█████████▉| 194/196 [00:00<00:00, 263.99it/s][A100%|██████████| 196/196 [00:00<00:00, 266.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  60%|██████    | 77/128 [2:01:25<1:24:00, 98.82s/it]EarlyStopping counter : 36 out of 40
training process:  61%|██████    | 78/128 [2:02:53<1:19:34, 95.48s/it]EarlyStopping counter : 37 out of 40
training process:  62%|██████▏   | 79/128 [2:04:25<1:17:20, 94.70s/it]EarlyStopping counter : 38 out of 40
training process:  62%|██████▎   | 80/128 [2:05:53<1:14:08, 92.69s/it]epoch : 81, train loss : 0.003, valid loss : 0.014, train acc : 0.998, valid acc : 0.996, train f1 : 0.935, valid f1 : 0.852

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 25/196 [00:00<00:00, 248.08it/s][A
 27%|██▋       | 53/196 [00:00<00:00, 261.62it/s][A
 41%|████▏     | 81/196 [00:00<00:00, 268.01it/s][A
 56%|█████▌    | 109/196 [00:00<00:00, 271.64it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 273.91it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 273.25it/s][A
 98%|█████████▊| 193/196 [00:00<00:00, 274.51it/s][A100%|██████████| 196/196 [00:00<00:00, 271.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  63%|██████▎   | 81/128 [2:07:47<1:17:31, 98.97s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 81, best f1 score : 0.882
training process:  63%|██████▎   | 81/128 [2:09:12<1:14:58, 95.71s/it]
training process finished, best loss : 0.008 and best acc : 0.997, best f1 : 0.882, best epoch : 41

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.79      0.56      0.66       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.90      0.78      0.83     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.83, test AUC : 0.78, test loss : 2.646

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:10, 11.90s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:56, 11.79s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:44, 11.77s/it]processing for feature importance:  24%|██▎       | 4/17 [00:47<02:35, 11.97s/it]processing for feature importance:  29%|██▉       | 5/17 [00:58<02:20, 11.68s/it]processing for feature importance:  35%|███▌      | 6/17 [01:10<02:07, 11.59s/it]processing for feature importance:  41%|████      | 7/17 [01:23<02:00, 12.07s/it]processing for feature importance:  47%|████▋     | 8/17 [01:34<01:47, 11.90s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:45<01:33, 11.65s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:57<01:21, 11.63s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:08<01:08, 11.50s/it]processing for feature importance:  71%|███████   | 12/17 [02:21<00:59, 11.81s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:33<00:47, 11.91s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:44<00:35, 11.83s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:58<00:24, 12.21s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:09<00:12, 12.05s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 12.20s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 11.90s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<12:00,  3.45s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<09:38,  2.78s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:11,  1.96s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:26,  1.32s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<10:44,  3.08s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:05<09:30,  2.74s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:13,  2.00s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:31,  1.39s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 16%|█▌        | 31/196 [00:00<00:00, 304.56it/s] 33%|███▎      | 65/196 [00:00<00:00, 320.85it/s] 50%|█████     | 98/196 [00:00<00:00, 288.65it/s] 65%|██████▌   | 128/196 [00:00<00:00, 284.52it/s] 82%|████████▏ | 160/196 [00:00<00:00, 295.94it/s] 98%|█████████▊| 193/196 [00:00<00:00, 306.13it/s]100%|██████████| 196/196 [00:00<00:00, 301.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:03, 197.55it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 193.09it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 190.54it/s]remove invalid data : null / measurement error:  13%|█▎        | 80/616 [00:00<00:02, 193.20it/s]remove invalid data : null / measurement error:  16%|█▌        | 100/616 [00:00<00:02, 194.99it/s]remove invalid data : null / measurement error:  20%|█▉        | 121/616 [00:00<00:02, 197.29it/s]remove invalid data : null / measurement error:  23%|██▎       | 142/616 [00:00<00:02, 198.44it/s]remove invalid data : null / measurement error:  26%|██▋       | 163/616 [00:00<00:02, 200.50it/s]remove invalid data : null / measurement error:  30%|██▉       | 184/616 [00:00<00:02, 197.85it/s]remove invalid data : null / measurement error:  33%|███▎      | 204/616 [00:01<00:02, 195.88it/s]remove invalid data : null / measurement error:  36%|███▋      | 224/616 [00:01<00:02, 195.79it/s]remove invalid data : null / measurement error:  40%|███▉      | 245/616 [00:01<00:01, 197.96it/s]remove invalid data : null / measurement error:  43%|████▎     | 266/616 [00:01<00:01, 200.94it/s]remove invalid data : null / measurement error:  47%|████▋     | 287/616 [00:01<00:01, 201.16it/s]remove invalid data : null / measurement error:  50%|█████     | 308/616 [00:01<00:01, 201.05it/s]remove invalid data : null / measurement error:  53%|█████▎    | 329/616 [00:01<00:01, 201.23it/s]remove invalid data : null / measurement error:  57%|█████▋    | 350/616 [00:01<00:01, 201.29it/s]remove invalid data : null / measurement error:  61%|██████    | 373/616 [00:01<00:01, 209.46it/s]remove invalid data : null / measurement error:  65%|██████▍   | 399/616 [00:01<00:00, 223.92it/s]remove invalid data : null / measurement error:  69%|██████▉   | 425/616 [00:02<00:00, 233.50it/s]remove invalid data : null / measurement error:  73%|███████▎  | 449/616 [00:02<00:00, 231.40it/s]remove invalid data : null / measurement error:  77%|███████▋  | 473/616 [00:02<00:00, 225.50it/s]remove invalid data : null / measurement error:  81%|████████  | 496/616 [00:02<00:00, 219.28it/s]remove invalid data : null / measurement error:  84%|████████▍ | 518/616 [00:02<00:00, 214.33it/s]remove invalid data : null / measurement error:  88%|████████▊ | 540/616 [00:02<00:00, 209.83it/s]remove invalid data : null / measurement error:  91%|█████████ | 562/616 [00:02<00:00, 205.34it/s]remove invalid data : null / measurement error:  95%|█████████▍| 583/616 [00:02<00:00, 201.80it/s]remove invalid data : null / measurement error:  98%|█████████▊| 604/616 [00:02<00:00, 199.82it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 204.99it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 233.25it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 233.45it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 231.95it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 234.83it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 236.38it/s]replace nan value:  28%|██▊       | 144/515 [00:00<00:01, 236.65it/s]replace nan value:  33%|███▎      | 168/515 [00:00<00:01, 235.49it/s]replace nan value:  37%|███▋      | 192/515 [00:00<00:01, 234.93it/s]replace nan value:  42%|████▏     | 216/515 [00:00<00:01, 234.54it/s]replace nan value:  47%|████▋     | 240/515 [00:01<00:01, 234.62it/s]replace nan value:  51%|█████▏    | 265/515 [00:01<00:01, 237.00it/s]replace nan value:  56%|█████▋    | 290/515 [00:01<00:00, 237.98it/s]replace nan value:  61%|██████    | 315/515 [00:01<00:00, 238.99it/s]replace nan value:  66%|██████▌   | 339/515 [00:01<00:00, 238.61it/s]replace nan value:  70%|███████   | 363/515 [00:01<00:00, 236.72it/s]replace nan value:  75%|███████▌  | 387/515 [00:01<00:00, 236.97it/s]replace nan value:  80%|███████▉  | 411/515 [00:01<00:00, 235.29it/s]replace nan value:  84%|████████▍ | 435/515 [00:01<00:00, 233.90it/s]replace nan value:  89%|████████▉ | 459/515 [00:01<00:00, 234.24it/s]replace nan value:  94%|█████████▍| 484/515 [00:02<00:00, 236.80it/s]replace nan value:  99%|█████████▉| 509/515 [00:02<00:00, 238.20it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 236.19it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.17it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.77it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.71it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.02it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.58it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.06it/s]generate index:  11%|█         | 55/515 [00:00<00:09, 50.15it/s]generate index:  12%|█▏        | 61/515 [00:01<00:12, 35.71it/s]generate index:  13%|█▎        | 68/515 [00:01<00:10, 41.74it/s]generate index:  15%|█▍        | 75/515 [00:01<00:09, 45.89it/s]generate index:  16%|█▌        | 82/515 [00:01<00:08, 51.04it/s]generate index:  17%|█▋        | 89/515 [00:01<00:08, 51.79it/s]generate index:  19%|█▊        | 96/515 [00:01<00:07, 55.92it/s]generate index:  20%|██        | 103/515 [00:01<00:07, 57.20it/s]generate index:  22%|██▏       | 112/515 [00:02<00:06, 65.12it/s]generate index:  23%|██▎       | 119/515 [00:02<00:06, 63.16it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 69.42it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 69.77it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 70.61it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.31it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.40it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.64it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.66it/s]generate index:  36%|███▌      | 184/515 [00:03<00:04, 69.92it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 70.30it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.35it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.64it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.26it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.58it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.61it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.10it/s]generate index:  50%|█████     | 258/515 [00:04<00:03, 71.20it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 74.04it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.44it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.32it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.42it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.40it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.25it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.52it/s]generate index:  62%|██████▏   | 321/515 [00:05<00:03, 62.22it/s]generate index:  64%|██████▎   | 328/515 [00:05<00:02, 64.00it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.73it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.85it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 44.12it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 50.38it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.15it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.13it/s]generate index:  75%|███████▍  | 384/515 [00:06<00:01, 75.88it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 72.55it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.24it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.97it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.37it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.69it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.24it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 48.16it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.27it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.99it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.88it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.53it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.28it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.79it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 69.21it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.46it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 67.12it/s]remove invalid data : null / measurement error:  18%|█▊        | 27/154 [00:00<00:00, 143.30it/s]remove invalid data : null / measurement error:  31%|███       | 47/154 [00:00<00:00, 168.55it/s]remove invalid data : null / measurement error:  44%|████▍     | 68/154 [00:00<00:00, 184.50it/s]remove invalid data : null / measurement error:  58%|█████▊    | 89/154 [00:00<00:00, 192.62it/s]remove invalid data : null / measurement error:  74%|███████▍  | 114/154 [00:00<00:00, 209.87it/s]remove invalid data : null / measurement error:  88%|████████▊ | 135/154 [00:00<00:00, 208.09it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 191.16it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 243.06it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 244.17it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 246.45it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 243.84it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 244.13it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 244.24it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.88it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.63it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.06it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.28it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.47it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.66it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.86it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.11it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.21it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.17it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 62.96it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.73it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.65it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.32it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.88it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.86it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 67.66it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.22it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/193 [00:00<00:03, 49.89it/s]remove invalid data : null / measurement error:  13%|█▎        | 26/193 [00:00<00:01, 143.73it/s]remove invalid data : null / measurement error:  24%|██▍       | 47/193 [00:00<00:00, 172.73it/s]remove invalid data : null / measurement error:  36%|███▌      | 69/193 [00:00<00:00, 188.36it/s]remove invalid data : null / measurement error:  47%|████▋     | 91/193 [00:00<00:00, 198.20it/s]remove invalid data : null / measurement error:  58%|█████▊    | 112/193 [00:00<00:00, 199.44it/s]remove invalid data : null / measurement error:  71%|███████   | 137/193 [00:00<00:00, 213.97it/s]remove invalid data : null / measurement error:  82%|████████▏ | 159/193 [00:00<00:00, 212.54it/s]remove invalid data : null / measurement error:  94%|█████████▍| 181/193 [00:00<00:00, 207.04it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 194.28it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 244.51it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 249.80it/s]replace nan value:  48%|████▊     | 76/160 [00:00<00:00, 249.79it/s]replace nan value:  63%|██████▎   | 101/160 [00:00<00:00, 246.74it/s]replace nan value:  79%|███████▉  | 126/160 [00:00<00:00, 245.52it/s]replace nan value:  94%|█████████▍| 151/160 [00:00<00:00, 246.45it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 246.75it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 103.63it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.40it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.61it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.95it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.69it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.73it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.20it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.42it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.89it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.96it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.78it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.90it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.70it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.63it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.98it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.74it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.84it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.10it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.59it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.127, valid loss : 0.082, train acc : 0.749, valid acc : 0.834, train f1 : 0.749, valid f1 : 0.487

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 338.21it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 338.14it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.75it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.47it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 345.06it/s][A100%|██████████| 196/196 [00:00<00:00, 344.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.487
training process:   1%|          | 1/128 [01:55<4:04:30, 115.52s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:28<3:35:17, 102.52s/it]Best score increase :0.487 -> 0.496
training process:   2%|▏         | 3/128 [04:58<3:21:33, 96.75s/it] Best score increase :0.496 -> 0.510
training process:   3%|▎         | 4/128 [06:28<3:14:21, 94.04s/it]epoch : 5, train loss : 0.043, valid loss : 0.103, train acc : 0.940, valid acc : 0.863, train f1 : 0.940, valid f1 : 0.508

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 25/196 [00:00<00:00, 243.15it/s][A
 26%|██▌       | 50/196 [00:00<00:00, 245.26it/s][A
 38%|███▊      | 75/196 [00:00<00:00, 246.59it/s][A
 51%|█████     | 100/196 [00:00<00:00, 247.04it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 248.70it/s][A
 78%|███████▊  | 153/196 [00:00<00:00, 255.38it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 255.64it/s][A100%|██████████| 196/196 [00:00<00:00, 251.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   4%|▍         | 5/128 [08:28<3:32:04, 103.45s/it]Best score increase :0.510 -> 0.549
training process:   5%|▍         | 6/128 [10:02<3:23:52, 100.26s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:35<3:17:24, 97.89s/it] Best score increase :0.549 -> 0.567
training process:   6%|▋         | 8/128 [13:07<3:11:46, 95.88s/it]epoch : 9, train loss : 0.023, valid loss : 0.062, train acc : 0.972, valid acc : 0.930, train f1 : 0.972, valid f1 : 0.557

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 325.72it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.01it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 330.18it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 330.94it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 333.98it/s][A100%|██████████| 196/196 [00:00<00:00, 333.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [15:05<3:23:58, 102.84s/it]Best score increase :0.567 -> 0.581
training process:   8%|▊         | 10/128 [16:37<3:15:38, 99.48s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [18:11<3:10:52, 97.89s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▉         | 12/128 [19:45<3:06:26, 96.44s/it]epoch : 13, train loss : 0.016, valid loss : 0.047, train acc : 0.981, valid acc : 0.950, train f1 : 0.981, valid f1 : 0.585

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 317.69it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.99it/s][A
 51%|█████     | 100/196 [00:00<00:00, 334.32it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.80it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 336.77it/s][A100%|██████████| 196/196 [00:00<00:00, 333.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.581 -> 0.585
training process:  10%|█         | 13/128 [21:42<3:16:58, 102.77s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [23:12<3:08:06, 99.00s/it] Best score increase :0.585 -> 0.587
training process:  12%|█▏        | 15/128 [24:45<3:03:00, 97.17s/it]Best score increase :0.587 -> 0.629
training process:  12%|█▎        | 16/128 [26:19<2:59:18, 96.06s/it]epoch : 17, train loss : 0.012, valid loss : 0.036, train acc : 0.986, valid acc : 0.960, train f1 : 0.986, valid f1 : 0.607

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 313.54it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.92it/s][A
 51%|█████     | 100/196 [00:00<00:00, 332.23it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 334.96it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 336.60it/s][A100%|██████████| 196/196 [00:00<00:00, 332.63it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:14<3:08:41, 101.99s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [29:47<3:02:02, 99.30s/it] EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [31:17<2:54:59, 96.32s/it]EarlyStopping counter : 4 out of 40
training process:  16%|█▌        | 20/128 [32:49<2:51:08, 95.08s/it]epoch : 21, train loss : 0.010, valid loss : 0.048, train acc : 0.989, valid acc : 0.948, train f1 : 0.989, valid f1 : 0.580

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 295.23it/s][A
 32%|███▏      | 63/196 [00:00<00:00, 315.24it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 324.55it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 329.26it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 330.89it/s][A100%|██████████| 196/196 [00:00<00:00, 327.06it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  16%|█▋        | 21/128 [34:49<3:02:43, 102.46s/it]EarlyStopping counter : 6 out of 40
training process:  17%|█▋        | 22/128 [36:20<2:55:00, 99.06s/it] Best score increase :0.629 -> 0.656
training process:  18%|█▊        | 23/128 [37:52<2:49:54, 97.09s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [39:23<2:44:48, 95.08s/it]epoch : 25, train loss : 0.008, valid loss : 0.031, train acc : 0.992, valid acc : 0.971, train f1 : 0.992, valid f1 : 0.634

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 318.33it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.07it/s][A
 51%|█████     | 100/196 [00:00<00:00, 332.81it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 333.53it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 335.47it/s][A100%|██████████| 196/196 [00:00<00:00, 333.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  20%|█▉        | 25/128 [41:22<2:55:41, 102.35s/it]EarlyStopping counter : 3 out of 40
training process:  20%|██        | 26/128 [42:54<2:48:50, 99.32s/it] EarlyStopping counter : 4 out of 40
training process:  21%|██        | 27/128 [44:26<2:43:12, 96.96s/it]EarlyStopping counter : 5 out of 40
training process:  22%|██▏       | 28/128 [45:56<2:38:27, 95.08s/it]epoch : 29, train loss : 0.007, valid loss : 0.033, train acc : 0.993, valid acc : 0.966, train f1 : 0.993, valid f1 : 0.619

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 321.91it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.85it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.24it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.96it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 340.60it/s][A100%|██████████| 196/196 [00:00<00:00, 339.62it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 29/128 [47:53<2:47:31, 101.53s/it]EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 30/128 [49:25<2:41:27, 98.85s/it] EarlyStopping counter : 8 out of 40
training process:  24%|██▍       | 31/128 [50:58<2:36:47, 96.99s/it]EarlyStopping counter : 9 out of 40
training process:  25%|██▌       | 32/128 [52:30<2:32:35, 95.37s/it]epoch : 33, train loss : 0.006, valid loss : 0.036, train acc : 0.994, valid acc : 0.969, train f1 : 0.994, valid f1 : 0.633

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 320.63it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.22it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 331.32it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 328.77it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 328.75it/s][A100%|██████████| 196/196 [00:00<00:00, 328.36it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  26%|██▌       | 33/128 [54:28<2:41:47, 102.18s/it]EarlyStopping counter : 11 out of 40
training process:  27%|██▋       | 34/128 [56:00<2:35:22, 99.17s/it] EarlyStopping counter : 12 out of 40
training process:  27%|██▋       | 35/128 [57:30<2:29:34, 96.50s/it]EarlyStopping counter : 13 out of 40
training process:  28%|██▊       | 36/128 [59:04<2:26:30, 95.55s/it]epoch : 37, train loss : 0.005, valid loss : 0.032, train acc : 0.995, valid acc : 0.980, train f1 : 0.995, valid f1 : 0.677

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 250.82it/s][A
 28%|██▊       | 54/196 [00:00<00:00, 262.63it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 266.08it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 268.95it/s][A
 70%|███████   | 138/196 [00:00<00:00, 270.75it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 272.11it/s][A
 99%|█████████▉| 194/196 [00:00<00:00, 273.36it/s][A100%|██████████| 196/196 [00:00<00:00, 269.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.656 -> 0.677
training process:  29%|██▉       | 37/128 [1:01:04<2:36:04, 102.91s/it]EarlyStopping counter : 1 out of 40
training process:  30%|██▉       | 38/128 [1:02:34<2:28:39, 99.11s/it] EarlyStopping counter : 2 out of 40
training process:  30%|███       | 39/128 [1:04:04<2:22:58, 96.39s/it]EarlyStopping counter : 3 out of 40
training process:  31%|███▏      | 40/128 [1:05:39<2:20:48, 96.01s/it]epoch : 41, train loss : 0.006, valid loss : 0.031, train acc : 0.995, valid acc : 0.974, train f1 : 0.995, valid f1 : 0.648

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.11it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 335.49it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.69it/s][A
 70%|███████   | 138/196 [00:00<00:00, 338.69it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 339.91it/s][A100%|██████████| 196/196 [00:00<00:00, 338.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  32%|███▏      | 41/128 [1:07:36<2:28:26, 102.38s/it]Best score increase :0.677 -> 0.681
training process:  33%|███▎      | 42/128 [1:09:08<2:22:14, 99.23s/it] EarlyStopping counter : 1 out of 40
training process:  34%|███▎      | 43/128 [1:10:37<2:16:14, 96.17s/it]EarlyStopping counter : 2 out of 40
training process:  34%|███▍      | 44/128 [1:12:07<2:12:08, 94.39s/it]epoch : 45, train loss : 0.004, valid loss : 0.037, train acc : 0.996, valid acc : 0.977, train f1 : 0.996, valid f1 : 0.658

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 332.12it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.04it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 345.78it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 347.70it/s][A
 90%|█████████ | 177/196 [00:00<00:00, 348.64it/s][A100%|██████████| 196/196 [00:00<00:00, 346.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  35%|███▌      | 45/128 [1:14:07<2:20:57, 101.90s/it]EarlyStopping counter : 4 out of 40
training process:  36%|███▌      | 46/128 [1:15:39<2:15:04, 98.83s/it] EarlyStopping counter : 5 out of 40
training process:  37%|███▋      | 47/128 [1:17:08<2:09:49, 96.17s/it]EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 48/128 [1:18:42<2:06:57, 95.22s/it]epoch : 49, train loss : 0.004, valid loss : 0.042, train acc : 0.996, valid acc : 0.975, train f1 : 0.996, valid f1 : 0.660

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 323.33it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.85it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 338.97it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.11it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 343.00it/s][A100%|██████████| 196/196 [00:00<00:00, 340.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  38%|███▊      | 49/128 [1:20:38<2:13:47, 101.61s/it]Best score increase :0.681 -> 0.690
training process:  39%|███▉      | 50/128 [1:22:10<2:08:15, 98.65s/it] EarlyStopping counter : 1 out of 40
training process:  40%|███▉      | 51/128 [1:23:41<2:03:39, 96.36s/it]EarlyStopping counter : 2 out of 40
training process:  41%|████      | 52/128 [1:25:13<2:00:38, 95.25s/it]epoch : 53, train loss : 0.003, valid loss : 0.043, train acc : 0.997, valid acc : 0.980, train f1 : 0.997, valid f1 : 0.690

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 264.40it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 270.68it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 272.82it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 274.01it/s][A
 71%|███████   | 139/196 [00:00<00:00, 274.92it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 275.48it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 275.76it/s][A100%|██████████| 196/196 [00:00<00:00, 274.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  41%|████▏     | 53/128 [1:27:12<2:07:45, 102.21s/it]EarlyStopping counter : 4 out of 40
training process:  42%|████▏     | 54/128 [1:28:43<2:01:48, 98.76s/it] EarlyStopping counter : 5 out of 40
training process:  43%|████▎     | 55/128 [1:30:15<1:57:45, 96.79s/it]Best score increase :0.690 -> 0.711
training process:  44%|████▍     | 56/128 [1:31:48<1:54:47, 95.66s/it]epoch : 57, train loss : 0.004, valid loss : 0.034, train acc : 0.997, valid acc : 0.985, train f1 : 0.997, valid f1 : 0.716

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 262.22it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 267.65it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 265.88it/s][A
 56%|█████▌    | 109/196 [00:00<00:00, 267.11it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 264.61it/s][A
 84%|████████▎ | 164/196 [00:00<00:00, 266.72it/s][A
 98%|█████████▊| 192/196 [00:00<00:00, 267.98it/s][A100%|██████████| 196/196 [00:00<00:00, 266.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.711 -> 0.716
training process:  45%|████▍     | 57/128 [1:33:46<2:01:02, 102.29s/it]EarlyStopping counter : 1 out of 40
training process:  45%|████▌     | 58/128 [1:35:18<1:55:43, 99.19s/it] EarlyStopping counter : 2 out of 40
training process:  46%|████▌     | 59/128 [1:36:51<1:52:08, 97.51s/it]EarlyStopping counter : 3 out of 40
training process:  47%|████▋     | 60/128 [1:38:26<1:49:33, 96.67s/it]epoch : 61, train loss : 0.004, valid loss : 0.049, train acc : 0.997, valid acc : 0.975, train f1 : 0.997, valid f1 : 0.652

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 325.88it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.65it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 286.58it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 271.42it/s][A
 82%|████████▏ | 160/196 [00:00<00:00, 270.56it/s][A
 96%|█████████▌| 188/196 [00:00<00:00, 269.87it/s][A100%|██████████| 196/196 [00:00<00:00, 279.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  48%|████▊     | 61/128 [1:40:28<1:56:20, 104.18s/it]EarlyStopping counter : 5 out of 40
training process:  48%|████▊     | 62/128 [1:42:03<1:51:43, 101.57s/it]EarlyStopping counter : 6 out of 40
training process:  49%|████▉     | 63/128 [1:43:34<1:46:40, 98.46s/it] EarlyStopping counter : 7 out of 40
training process:  50%|█████     | 64/128 [1:45:05<1:42:37, 96.21s/it]epoch : 65, train loss : 0.003, valid loss : 0.043, train acc : 0.998, valid acc : 0.985, train f1 : 0.998, valid f1 : 0.714

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 328.50it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 334.95it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 338.38it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 340.00it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 341.10it/s][A100%|██████████| 196/196 [00:00<00:00, 339.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  51%|█████     | 65/128 [1:46:59<1:46:42, 101.62s/it]EarlyStopping counter : 9 out of 40
training process:  52%|█████▏    | 66/128 [1:48:29<1:41:21, 98.08s/it] EarlyStopping counter : 10 out of 40
training process:  52%|█████▏    | 67/128 [1:49:59<1:37:06, 95.51s/it]Best score increase :0.716 -> 0.725
training process:  53%|█████▎    | 68/128 [1:51:31<1:34:22, 94.37s/it]epoch : 69, train loss : 0.004, valid loss : 0.044, train acc : 0.998, valid acc : 0.985, train f1 : 0.998, valid f1 : 0.719

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.86it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 335.07it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 337.15it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 338.14it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 338.62it/s][A100%|██████████| 196/196 [00:00<00:00, 337.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  54%|█████▍    | 69/128 [1:53:26<1:39:10, 100.86s/it]EarlyStopping counter : 2 out of 40
training process:  55%|█████▍    | 70/128 [1:54:56<1:34:17, 97.54s/it] Best score increase :0.725 -> 0.738
training process:  55%|█████▌    | 71/128 [1:56:27<1:30:44, 95.52s/it]EarlyStopping counter : 1 out of 40
training process:  56%|█████▋    | 72/128 [1:57:59<1:28:05, 94.39s/it]epoch : 73, train loss : 0.003, valid loss : 0.041, train acc : 0.998, valid acc : 0.989, train f1 : 0.998, valid f1 : 0.753

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 325.90it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 334.13it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 337.15it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 331.80it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 329.66it/s][A100%|██████████| 196/196 [00:00<00:00, 331.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.738 -> 0.753
training process:  57%|█████▋    | 73/128 [1:59:54<1:32:20, 100.73s/it]EarlyStopping counter : 1 out of 40
training process:  58%|█████▊    | 74/128 [2:01:24<1:27:34, 97.31s/it] EarlyStopping counter : 2 out of 40
training process:  59%|█████▊    | 75/128 [2:02:56<1:24:35, 95.76s/it]EarlyStopping counter : 3 out of 40
training process:  59%|█████▉    | 76/128 [2:04:28<1:22:07, 94.76s/it]epoch : 77, train loss : 0.003, valid loss : 0.052, train acc : 0.998, valid acc : 0.979, train f1 : 0.998, valid f1 : 0.679

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 268.57it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 272.89it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 274.21it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 275.07it/s][A
 71%|███████   | 139/196 [00:00<00:00, 275.88it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 273.78it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 269.96it/s][A100%|██████████| 196/196 [00:00<00:00, 272.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  60%|██████    | 77/128 [2:06:25<1:26:13, 101.45s/it]EarlyStopping counter : 5 out of 40
training process:  61%|██████    | 78/128 [2:07:57<1:22:01, 98.44s/it] EarlyStopping counter : 6 out of 40
training process:  62%|██████▏   | 79/128 [2:09:27<1:18:21, 95.95s/it]EarlyStopping counter : 7 out of 40
training process:  62%|██████▎   | 80/128 [2:11:00<1:15:59, 94.99s/it]epoch : 81, train loss : 0.003, valid loss : 0.038, train acc : 0.998, valid acc : 0.989, train f1 : 0.998, valid f1 : 0.747

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 294.77it/s][A
 32%|███▏      | 63/196 [00:00<00:00, 311.79it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 323.54it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 329.36it/s][A
 84%|████████▎ | 164/196 [00:00<00:00, 327.96it/s][A100%|██████████| 196/196 [00:00<00:00, 325.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  63%|██████▎   | 81/128 [2:12:58<1:19:52, 101.97s/it]EarlyStopping counter : 9 out of 40
training process:  64%|██████▍   | 82/128 [2:14:30<1:16:01, 99.16s/it] EarlyStopping counter : 10 out of 40
training process:  65%|██████▍   | 83/128 [2:16:03<1:12:58, 97.31s/it]EarlyStopping counter : 11 out of 40
training process:  66%|██████▌   | 84/128 [2:17:36<1:10:15, 95.81s/it]epoch : 85, train loss : 0.002, valid loss : 0.056, train acc : 0.998, valid acc : 0.980, train f1 : 0.998, valid f1 : 0.680

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 301.78it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 319.83it/s][A
 50%|█████     | 98/196 [00:00<00:00, 321.07it/s][A
 67%|██████▋   | 132/196 [00:00<00:00, 325.11it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 327.16it/s][A100%|██████████| 196/196 [00:00<00:00, 325.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  66%|██████▋   | 85/128 [2:19:33<1:13:19, 102.30s/it]EarlyStopping counter : 13 out of 40
training process:  67%|██████▋   | 86/128 [2:21:05<1:09:25, 99.18s/it] EarlyStopping counter : 14 out of 40
training process:  68%|██████▊   | 87/128 [2:22:35<1:05:54, 96.46s/it]EarlyStopping counter : 15 out of 40
training process:  69%|██████▉   | 88/128 [2:24:07<1:03:24, 95.11s/it]epoch : 89, train loss : 0.002, valid loss : 0.064, train acc : 0.999, valid acc : 0.979, train f1 : 0.999, valid f1 : 0.666

  0%|          | 0/196 [00:00<?, ?it/s][A
  8%|▊         | 16/196 [00:00<00:01, 157.16it/s][A
 21%|██        | 41/196 [00:00<00:00, 210.14it/s][A
 37%|███▋      | 72/196 [00:00<00:00, 254.50it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 279.53it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 293.80it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 258.73it/s][A
 98%|█████████▊| 193/196 [00:00<00:00, 249.20it/s][A100%|██████████| 196/196 [00:00<00:00, 252.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  70%|██████▉   | 89/128 [2:26:09<1:07:00, 103.10s/it]EarlyStopping counter : 17 out of 40
training process:  70%|███████   | 90/128 [2:27:42<1:03:20, 100.01s/it]EarlyStopping counter : 18 out of 40
training process:  71%|███████   | 91/128 [2:29:12<59:52, 97.10s/it]   EarlyStopping counter : 19 out of 40
training process:  72%|███████▏  | 92/128 [2:30:45<57:31, 95.88s/it]epoch : 93, train loss : 0.003, valid loss : 0.054, train acc : 0.999, valid acc : 0.986, train f1 : 0.999, valid f1 : 0.720

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 294.50it/s][A
 32%|███▏      | 63/196 [00:00<00:00, 313.43it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 323.49it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 328.52it/s][A
 84%|████████▎ | 164/196 [00:00<00:00, 312.92it/s][A
100%|██████████| 196/196 [00:00<00:00, 274.75it/s][A100%|██████████| 196/196 [00:00<00:00, 294.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  73%|███████▎  | 93/128 [2:32:43<59:45, 102.44s/it]EarlyStopping counter : 21 out of 40
training process:  73%|███████▎  | 94/128 [2:34:14<56:10, 99.13s/it] EarlyStopping counter : 22 out of 40
training process:  74%|███████▍  | 95/128 [2:35:47<53:27, 97.18s/it]EarlyStopping counter : 23 out of 40
training process:  75%|███████▌  | 96/128 [2:37:17<50:44, 95.15s/it]epoch : 97, train loss : 0.002, valid loss : 0.048, train acc : 0.999, valid acc : 0.988, train f1 : 0.999, valid f1 : 0.739

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 313.75it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 325.95it/s][A
 51%|█████     | 100/196 [00:00<00:00, 326.13it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 329.20it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 331.89it/s][A100%|██████████| 196/196 [00:00<00:00, 330.06it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  76%|███████▌  | 97/128 [2:39:15<52:38, 101.89s/it]EarlyStopping counter : 25 out of 40
training process:  77%|███████▋  | 98/128 [2:40:45<49:11, 98.39s/it] EarlyStopping counter : 26 out of 40
training process:  77%|███████▋  | 99/128 [2:42:18<46:42, 96.65s/it]EarlyStopping counter : 27 out of 40
training process:  78%|███████▊  | 100/128 [2:43:48<44:16, 94.86s/it]epoch : 101, train loss : 0.002, valid loss : 0.056, train acc : 0.999, valid acc : 0.986, train f1 : 0.999, valid f1 : 0.723

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 303.66it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 324.72it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.13it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 333.79it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 337.63it/s][A100%|██████████| 196/196 [00:00<00:00, 334.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  79%|███████▉  | 101/128 [2:45:46<45:48, 101.79s/it]EarlyStopping counter : 29 out of 40
training process:  80%|███████▉  | 102/128 [2:47:17<42:38, 98.41s/it] EarlyStopping counter : 30 out of 40
training process:  80%|████████  | 103/128 [2:48:49<40:16, 96.64s/it]EarlyStopping counter : 31 out of 40
training process:  81%|████████▏ | 104/128 [2:50:22<38:12, 95.53s/it]epoch : 105, train loss : 0.002, valid loss : 0.050, train acc : 0.999, valid acc : 0.986, train f1 : 0.999, valid f1 : 0.724

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 307.75it/s][A
 33%|███▎      | 64/196 [00:00<00:00, 318.17it/s][A
 50%|█████     | 98/196 [00:00<00:00, 327.57it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 333.03it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 275.47it/s][A
100%|██████████| 196/196 [00:00<00:00, 262.83it/s][A100%|██████████| 196/196 [00:00<00:00, 284.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  82%|████████▏ | 105/128 [2:52:28<40:05, 104.59s/it]EarlyStopping counter : 33 out of 40
training process:  83%|████████▎ | 106/128 [2:53:59<36:53, 100.63s/it]EarlyStopping counter : 34 out of 40
training process:  84%|████████▎ | 107/128 [2:55:31<34:14, 97.84s/it] EarlyStopping counter : 35 out of 40
training process:  84%|████████▍ | 108/128 [2:57:03<32:04, 96.22s/it]epoch : 109, train loss : 0.001, valid loss : 0.061, train acc : 0.999, valid acc : 0.986, train f1 : 0.999, valid f1 : 0.722

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 264.02it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 272.34it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 272.79it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 275.42it/s][A
 71%|███████   | 139/196 [00:00<00:00, 277.03it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 278.12it/s][A100%|██████████| 196/196 [00:00<00:00, 276.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  85%|████████▌ | 109/128 [2:59:00<32:27, 102.52s/it]EarlyStopping counter : 37 out of 40
training process:  86%|████████▌ | 110/128 [3:00:31<29:38, 98.79s/it] EarlyStopping counter : 38 out of 40
training process:  87%|████████▋ | 111/128 [3:02:04<27:30, 97.07s/it]EarlyStopping counter : 39 out of 40
training process:  88%|████████▊ | 112/128 [3:03:33<25:16, 94.79s/it]epoch : 113, train loss : 0.001, valid loss : 0.077, train acc : 0.999, valid acc : 0.977, train f1 : 0.999, valid f1 : 0.666

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.00it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.37it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 338.26it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.93it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 341.34it/s][A100%|██████████| 196/196 [00:00<00:00, 340.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 112, best f1 score : 0.753
training process:  88%|████████▊ | 112/128 [3:05:30<26:30, 99.38s/it]
training process finished, best loss : 0.041 and best acc : 0.989, best f1 : 0.753, best epoch : 72

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.56      0.57       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.79      0.78      0.78     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.78, test AUC : 0.78, test loss : 9.585

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:24, 12.77s/it]processing for feature importance:  12%|█▏        | 2/17 [00:25<03:12, 12.83s/it]processing for feature importance:  18%|█▊        | 3/17 [00:37<02:53, 12.41s/it]processing for feature importance:  24%|██▎       | 4/17 [00:50<02:44, 12.62s/it]processing for feature importance:  29%|██▉       | 5/17 [01:04<02:38, 13.22s/it]processing for feature importance:  35%|███▌      | 6/17 [01:17<02:23, 13.07s/it]processing for feature importance:  41%|████      | 7/17 [01:30<02:08, 12.90s/it]processing for feature importance:  47%|████▋     | 8/17 [01:42<01:53, 12.58s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:54<01:40, 12.53s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:09<01:32, 13.24s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:21<01:17, 12.84s/it]processing for feature importance:  71%|███████   | 12/17 [02:33<01:02, 12.58s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:45<00:49, 12.42s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:58<00:37, 12.54s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:10<00:25, 12.64s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:23<00:12, 12.78s/it]processing for feature importance: 100%|██████████| 17/17 [03:36<00:00, 12.65s/it]processing for feature importance: 100%|██████████| 17/17 [03:36<00:00, 12.73s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<12:12,  3.51s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<08:57,  2.59s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:03,  1.84s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:25,  1.29s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<10:36,  3.04s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<06:21,  1.83s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:07,  1.90s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:28,  1.34s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 16%|█▋        | 32/196 [00:00<00:00, 315.73it/s] 34%|███▍      | 67/196 [00:00<00:00, 334.16it/s] 52%|█████▏    | 102/196 [00:00<00:00, 340.28it/s] 70%|██████▉   | 137/196 [00:00<00:00, 343.14it/s] 88%|████████▊ | 172/196 [00:00<00:00, 343.01it/s]100%|██████████| 196/196 [00:00<00:00, 339.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:03, 196.29it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 193.24it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 191.64it/s]remove invalid data : null / measurement error:  13%|█▎        | 80/616 [00:00<00:02, 193.13it/s]remove invalid data : null / measurement error:  16%|█▌        | 100/616 [00:00<00:02, 195.52it/s]remove invalid data : null / measurement error:  20%|█▉        | 121/616 [00:00<00:02, 200.29it/s]remove invalid data : null / measurement error:  23%|██▎       | 142/616 [00:00<00:02, 201.33it/s]remove invalid data : null / measurement error:  26%|██▋       | 163/616 [00:00<00:02, 203.09it/s]remove invalid data : null / measurement error:  30%|██▉       | 184/616 [00:00<00:02, 199.87it/s]remove invalid data : null / measurement error:  33%|███▎      | 205/616 [00:01<00:02, 197.90it/s]remove invalid data : null / measurement error:  37%|███▋      | 225/616 [00:01<00:01, 198.06it/s]remove invalid data : null / measurement error:  40%|███▉      | 246/616 [00:01<00:01, 200.38it/s]remove invalid data : null / measurement error:  43%|████▎     | 267/616 [00:01<00:01, 202.78it/s]remove invalid data : null / measurement error:  47%|████▋     | 288/616 [00:01<00:01, 200.82it/s]remove invalid data : null / measurement error:  50%|█████     | 309/616 [00:01<00:01, 198.86it/s]remove invalid data : null / measurement error:  53%|█████▎    | 329/616 [00:01<00:01, 197.67it/s]remove invalid data : null / measurement error:  57%|█████▋    | 349/616 [00:01<00:01, 197.90it/s]remove invalid data : null / measurement error:  60%|██████    | 372/616 [00:01<00:01, 205.78it/s]remove invalid data : null / measurement error:  65%|██████▍   | 399/616 [00:01<00:00, 222.39it/s]remove invalid data : null / measurement error:  69%|██████▉   | 425/616 [00:02<00:00, 233.41it/s]remove invalid data : null / measurement error:  73%|███████▎  | 449/616 [00:02<00:00, 233.01it/s]remove invalid data : null / measurement error:  77%|███████▋  | 473/616 [00:02<00:00, 228.19it/s]remove invalid data : null / measurement error:  81%|████████  | 496/616 [00:02<00:00, 222.76it/s]remove invalid data : null / measurement error:  84%|████████▍ | 519/616 [00:02<00:00, 218.52it/s]remove invalid data : null / measurement error:  88%|████████▊ | 541/616 [00:02<00:00, 214.50it/s]remove invalid data : null / measurement error:  91%|█████████▏| 563/616 [00:02<00:00, 212.23it/s]remove invalid data : null / measurement error:  95%|█████████▍| 585/616 [00:02<00:00, 210.72it/s]remove invalid data : null / measurement error:  99%|█████████▊| 607/616 [00:02<00:00, 209.62it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.59it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 240.94it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 240.16it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 241.02it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 243.04it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 244.17it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 245.44it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 246.09it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 245.97it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 246.43it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 246.73it/s]replace nan value:  53%|█████▎    | 275/515 [00:01<00:00, 247.60it/s]replace nan value:  58%|█████▊    | 300/515 [00:01<00:00, 246.64it/s]replace nan value:  63%|██████▎   | 325/515 [00:01<00:00, 246.73it/s]replace nan value:  68%|██████▊   | 350/515 [00:01<00:00, 244.15it/s]replace nan value:  73%|███████▎  | 375/515 [00:01<00:00, 245.40it/s]replace nan value:  78%|███████▊  | 400/515 [00:01<00:00, 246.10it/s]replace nan value:  83%|████████▎ | 425/515 [00:01<00:00, 245.94it/s]replace nan value:  87%|████████▋ | 450/515 [00:01<00:00, 244.33it/s]replace nan value:  92%|█████████▏| 475/515 [00:01<00:00, 245.02it/s]replace nan value:  97%|█████████▋| 500/515 [00:02<00:00, 245.88it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 245.29it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.25it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.70it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.48it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.77it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 74.24it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.88it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 59.07it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 49.20it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 55.97it/s]generate index:  15%|█▌        | 78/515 [00:01<00:07, 54.86it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.85it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.45it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 60.19it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 66.05it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 64.58it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 72.34it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 72.40it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 73.06it/s]generate index:  30%|██▉       | 152/515 [00:02<00:04, 72.62it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 73.40it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.39it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.43it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.27it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.83it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.92it/s]generate index:  40%|████      | 207/515 [00:03<00:05, 59.44it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 76.06it/s]generate index:  44%|████▍     | 228/515 [00:03<00:03, 73.11it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 75.33it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 78.70it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 64.95it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 71.53it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 74.96it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.49it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.72it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.52it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 61.57it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 61.53it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 61.20it/s]generate index:  64%|██████▎   | 328/515 [00:04<00:02, 64.96it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 57.62it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 46.88it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 45.11it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 51.18it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.80it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.60it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 76.11it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 72.72it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.36it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.95it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.41it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.94it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.49it/s]generate index:  86%|████████▌ | 444/515 [00:06<00:01, 48.27it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.44it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.44it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.18it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.96it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 56.00it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 50.74it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 59.09it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 53.36it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.02it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 8/154 [00:00<00:01, 79.17it/s]remove invalid data : null / measurement error:  19%|█▉        | 29/154 [00:00<00:00, 154.54it/s]remove invalid data : null / measurement error:  32%|███▏      | 50/154 [00:00<00:00, 178.91it/s]remove invalid data : null / measurement error:  47%|████▋     | 72/154 [00:00<00:00, 192.81it/s]remove invalid data : null / measurement error:  61%|██████    | 94/154 [00:00<00:00, 200.90it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 213.03it/s]remove invalid data : null / measurement error:  91%|█████████ | 140/154 [00:00<00:00, 210.61it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 196.27it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 246.30it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 247.84it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 248.66it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 242.62it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 244.97it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 245.55it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.74it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.53it/s]generate index:  16%|█▌        | 21/131 [00:00<00:01, 57.02it/s]generate index:  21%|██▏       | 28/131 [00:00<00:01, 57.58it/s]generate index:  27%|██▋       | 35/131 [00:00<00:01, 60.52it/s]generate index:  32%|███▏      | 42/131 [00:00<00:01, 62.34it/s]generate index:  37%|███▋      | 49/131 [00:00<00:01, 62.79it/s]generate index:  43%|████▎     | 56/131 [00:00<00:01, 63.01it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 64.99it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 64.74it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 66.54it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 64.22it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 45.79it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 47.99it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 46.49it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 50.96it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 59.77it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 69.17it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.47it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|          | 1/193 [00:00<00:19,  9.64it/s]remove invalid data : null / measurement error:  12%|█▏        | 23/193 [00:00<00:01, 130.28it/s]remove invalid data : null / measurement error:  23%|██▎       | 45/193 [00:00<00:00, 167.31it/s]remove invalid data : null / measurement error:  35%|███▍      | 67/193 [00:00<00:00, 186.49it/s]remove invalid data : null / measurement error:  46%|████▌     | 89/193 [00:00<00:00, 198.23it/s]remove invalid data : null / measurement error:  57%|█████▋    | 110/193 [00:00<00:00, 199.83it/s]remove invalid data : null / measurement error:  70%|██████▉   | 135/193 [00:00<00:00, 214.19it/s]remove invalid data : null / measurement error:  81%|████████▏ | 157/193 [00:00<00:00, 210.29it/s]remove invalid data : null / measurement error:  93%|█████████▎| 179/193 [00:00<00:00, 207.21it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 191.98it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 245.23it/s]replace nan value:  31%|███▏      | 50/160 [00:00<00:00, 247.76it/s]replace nan value:  47%|████▋     | 75/160 [00:00<00:00, 245.01it/s]replace nan value:  62%|██████▎   | 100/160 [00:00<00:00, 240.90it/s]replace nan value:  78%|███████▊  | 125/160 [00:00<00:00, 237.33it/s]replace nan value:  94%|█████████▍| 150/160 [00:00<00:00, 240.01it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 241.46it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.49it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.81it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.82it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.50it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.29it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.36it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.09it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.59it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.94it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.91it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.55it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.60it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.79it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.86it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 54.87it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 53.51it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 57.33it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 61.57it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.60it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.003, valid loss : 0.003, train acc : 0.659, valid acc : 0.953, train f1 : 0.410, valid f1 : 0.512

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▌        | 30/196 [00:00<00:00, 293.15it/s][A
 33%|███▎      | 64/196 [00:00<00:00, 316.12it/s][A
 49%|████▉     | 97/196 [00:00<00:00, 321.69it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 327.34it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 330.65it/s][A100%|██████████| 196/196 [00:00<00:00, 326.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.512
training process:   1%|          | 1/128 [01:58<4:09:54, 118.07s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:26<3:31:26, 100.69s/it]Best score increase :0.512 -> 0.548
training process:   2%|▏         | 3/128 [04:52<3:16:05, 94.12s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:22<3:10:41, 92.27s/it]epoch : 5, train loss : 0.003, valid loss : 0.002, train acc : 0.846, valid acc : 0.859, train f1 : 0.490, valid f1 : 0.497

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 343.60it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 347.02it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 348.20it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 348.61it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 348.06it/s][A100%|██████████| 196/196 [00:00<00:00, 347.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   4%|▍         | 5/128 [08:13<3:23:27, 99.25s/it]EarlyStopping counter : 3 out of 40
training process:   5%|▍         | 6/128 [09:42<3:14:36, 95.71s/it]EarlyStopping counter : 4 out of 40
training process:   5%|▌         | 7/128 [11:08<3:06:38, 92.55s/it]EarlyStopping counter : 5 out of 40
training process:   6%|▋         | 8/128 [12:37<3:02:27, 91.23s/it]epoch : 9, train loss : 0.002, valid loss : 0.003, train acc : 0.897, valid acc : 0.954, train f1 : 0.523, valid f1 : 0.561

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.38it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 343.27it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 346.60it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 347.77it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 346.85it/s][A100%|██████████| 196/196 [00:00<00:00, 346.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.548 -> 0.561
training process:   7%|▋         | 9/128 [14:28<3:13:18, 97.47s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [15:56<3:06:01, 94.59s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [17:22<2:59:23, 91.99s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▉         | 12/128 [18:51<2:56:05, 91.08s/it]epoch : 13, train loss : 0.002, valid loss : 0.002, train acc : 0.921, valid acc : 0.919, train f1 : 0.546, valid f1 : 0.537

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.21it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 344.68it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 346.88it/s][A
 71%|███████   | 139/196 [00:00<00:00, 347.68it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 347.98it/s][A100%|██████████| 196/196 [00:00<00:00, 346.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  10%|█         | 13/128 [20:42<3:06:19, 97.21s/it]Best score increase :0.561 -> 0.669
training process:  11%|█         | 14/128 [22:10<2:58:57, 94.19s/it]EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [23:38<2:54:00, 92.39s/it]EarlyStopping counter : 2 out of 40
training process:  12%|█▎        | 16/128 [25:06<2:50:09, 91.16s/it]epoch : 17, train loss : 0.002, valid loss : 0.002, train acc : 0.951, valid acc : 0.952, train f1 : 0.585, valid f1 : 0.586

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 261.48it/s][A
 28%|██▊       | 54/196 [00:00<00:00, 263.44it/s][A
 41%|████▏     | 81/196 [00:00<00:00, 263.13it/s][A
 55%|█████▌    | 108/196 [00:00<00:00, 264.85it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 250.48it/s][A
 82%|████████▏ | 161/196 [00:00<00:00, 240.13it/s][A
 98%|█████████▊| 193/196 [00:00<00:00, 262.60it/s][A100%|██████████| 196/196 [00:00<00:00, 259.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  13%|█▎        | 17/128 [27:01<3:01:36, 98.17s/it]EarlyStopping counter : 4 out of 40
training process:  14%|█▍        | 18/128 [28:24<2:51:33, 93.58s/it]EarlyStopping counter : 5 out of 40
training process:  15%|█▍        | 19/128 [29:53<2:47:43, 92.33s/it]EarlyStopping counter : 6 out of 40
training process:  16%|█▌        | 20/128 [31:21<2:43:48, 91.00s/it]epoch : 21, train loss : 0.002, valid loss : 0.002, train acc : 0.971, valid acc : 0.951, train f1 : 0.642, valid f1 : 0.585

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 270.31it/s][A
 29%|██▊       | 56/196 [00:00<00:00, 274.93it/s][A
 43%|████▎     | 84/196 [00:00<00:00, 276.74it/s][A
 57%|█████▋    | 112/196 [00:00<00:00, 277.54it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 277.95it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 278.04it/s][A
100%|██████████| 196/196 [00:00<00:00, 278.12it/s][A100%|██████████| 196/196 [00:00<00:00, 277.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  16%|█▋        | 21/128 [33:15<2:54:37, 97.92s/it]EarlyStopping counter : 8 out of 40
training process:  17%|█▋        | 22/128 [34:43<2:47:47, 94.98s/it]Best score increase :0.669 -> 0.691
training process:  18%|█▊        | 23/128 [36:10<2:41:44, 92.42s/it]Best score increase :0.691 -> 0.799
training process:  19%|█▉        | 24/128 [37:38<2:38:12, 91.27s/it]epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.975, valid acc : 0.978, train f1 : 0.662, valid f1 : 0.677

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 276.16it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 280.01it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 281.37it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 282.08it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 282.09it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 282.95it/s][A100%|██████████| 196/196 [00:00<00:00, 282.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  20%|█▉        | 25/128 [39:29<2:46:59, 97.28s/it]EarlyStopping counter : 2 out of 40
training process:  20%|██        | 26/128 [40:51<2:37:32, 92.67s/it]EarlyStopping counter : 3 out of 40
training process:  21%|██        | 27/128 [42:16<2:31:48, 90.19s/it]EarlyStopping counter : 4 out of 40
training process:  22%|██▏       | 28/128 [43:43<2:28:56, 89.36s/it]epoch : 29, train loss : 0.002, valid loss : 0.002, train acc : 0.982, valid acc : 0.985, train f1 : 0.707, valid f1 : 0.723

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 322.94it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.56it/s][A
 51%|█████     | 100/196 [00:00<00:00, 328.75it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 329.75it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 329.88it/s][A100%|██████████| 196/196 [00:00<00:00, 329.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  23%|██▎       | 29/128 [45:38<2:40:17, 97.15s/it]EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 30/128 [47:03<2:32:26, 93.34s/it]EarlyStopping counter : 7 out of 40
training process:  24%|██▍       | 31/128 [48:27<2:26:25, 90.58s/it]EarlyStopping counter : 8 out of 40
training process:  25%|██▌       | 32/128 [49:53<2:22:49, 89.27s/it]epoch : 33, train loss : 0.001, valid loss : 0.003, train acc : 0.986, valid acc : 0.979, train f1 : 0.748, valid f1 : 0.690

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.73it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 343.31it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 345.10it/s][A
 71%|███████   | 139/196 [00:00<00:00, 345.72it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 343.32it/s][A100%|██████████| 196/196 [00:00<00:00, 341.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  26%|██▌       | 33/128 [51:47<2:32:55, 96.58s/it]EarlyStopping counter : 10 out of 40
training process:  27%|██▋       | 34/128 [53:16<2:27:51, 94.38s/it]EarlyStopping counter : 11 out of 40
training process:  27%|██▋       | 35/128 [54:45<2:23:50, 92.81s/it]EarlyStopping counter : 12 out of 40
training process:  28%|██▊       | 36/128 [56:15<2:20:41, 91.75s/it]epoch : 37, train loss : 0.001, valid loss : 0.002, train acc : 0.988, valid acc : 0.974, train f1 : 0.773, valid f1 : 0.668

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 343.01it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 348.32it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 350.25it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 349.23it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 350.48it/s][A100%|██████████| 196/196 [00:00<00:00, 349.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  29%|██▉       | 37/128 [58:08<2:28:53, 98.17s/it]EarlyStopping counter : 14 out of 40
training process:  30%|██▉       | 38/128 [59:34<2:21:45, 94.50s/it]EarlyStopping counter : 15 out of 40
training process:  30%|███       | 39/128 [1:01:04<2:18:11, 93.16s/it]EarlyStopping counter : 16 out of 40
training process:  31%|███▏      | 40/128 [1:02:30<2:13:37, 91.11s/it]epoch : 41, train loss : 0.001, valid loss : 0.003, train acc : 0.990, valid acc : 0.993, train f1 : 0.797, valid f1 : 0.815

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.95it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 343.27it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 344.85it/s][A
 71%|███████   | 139/196 [00:00<00:00, 345.62it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 346.57it/s][A100%|██████████| 196/196 [00:00<00:00, 344.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.799 -> 0.815
training process:  32%|███▏      | 41/128 [1:04:22<2:21:15, 97.42s/it]EarlyStopping counter : 1 out of 40
training process:  33%|███▎      | 42/128 [1:05:49<2:15:04, 94.24s/it]Best score increase :0.815 -> 0.831
training process:  34%|███▎      | 43/128 [1:07:15<2:09:58, 91.75s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▍      | 44/128 [1:08:43<2:06:48, 90.57s/it]epoch : 45, train loss : 0.001, valid loss : 0.003, train acc : 0.991, valid acc : 0.992, train f1 : 0.815, valid f1 : 0.815

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 340.70it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 346.24it/s][A
 54%|█████▍    | 106/196 [00:00<00:00, 347.85it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 346.54it/s][A
 90%|█████████ | 177/196 [00:00<00:00, 347.83it/s][A100%|██████████| 196/196 [00:00<00:00, 347.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  35%|███▌      | 45/128 [1:10:35<2:14:09, 96.98s/it]EarlyStopping counter : 3 out of 40
training process:  36%|███▌      | 46/128 [1:12:03<2:08:51, 94.28s/it]EarlyStopping counter : 4 out of 40
training process:  37%|███▋      | 47/128 [1:13:30<2:04:36, 92.30s/it]EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 48/128 [1:14:59<2:01:36, 91.20s/it]epoch : 49, train loss : 0.001, valid loss : 0.004, train acc : 0.992, valid acc : 0.989, train f1 : 0.826, valid f1 : 0.770

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 36/196 [00:00<00:00, 354.25it/s][A
 37%|███▋      | 73/196 [00:00<00:00, 360.02it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 361.55it/s][A
 75%|███████▌  | 147/196 [00:00<00:00, 361.60it/s][A
 94%|█████████▍| 184/196 [00:00<00:00, 361.65it/s][A100%|██████████| 196/196 [00:00<00:00, 360.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 49/128 [1:16:46<2:06:20, 95.96s/it]EarlyStopping counter : 7 out of 40
training process:  39%|███▉      | 50/128 [1:18:11<2:00:15, 92.51s/it]Best score increase :0.831 -> 0.848
training process:  40%|███▉      | 51/128 [1:19:39<1:57:05, 91.25s/it]EarlyStopping counter : 1 out of 40
training process:  41%|████      | 52/128 [1:21:05<1:53:45, 89.82s/it]epoch : 53, train loss : 0.001, valid loss : 0.004, train acc : 0.992, valid acc : 0.992, train f1 : 0.833, valid f1 : 0.816

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 275.21it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 280.17it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 282.65it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 282.21it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 283.57it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 284.24it/s][A100%|██████████| 196/196 [00:00<00:00, 283.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  41%|████▏     | 53/128 [1:23:01<2:01:59, 97.60s/it]EarlyStopping counter : 3 out of 40
training process:  42%|████▏     | 54/128 [1:24:30<1:57:05, 94.94s/it]EarlyStopping counter : 4 out of 40
training process:  43%|████▎     | 55/128 [1:25:58<1:53:03, 92.92s/it]EarlyStopping counter : 5 out of 40
training process:  44%|████▍     | 56/128 [1:27:28<1:50:34, 92.15s/it]epoch : 57, train loss : 0.001, valid loss : 0.005, train acc : 0.994, valid acc : 0.987, train f1 : 0.859, valid f1 : 0.745

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 344.41it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 347.77it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 349.06it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 349.87it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 350.05it/s][A100%|██████████| 196/196 [00:00<00:00, 349.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  45%|████▍     | 57/128 [1:29:21<1:56:23, 98.36s/it]EarlyStopping counter : 7 out of 40
training process:  45%|████▌     | 58/128 [1:30:48<1:50:43, 94.91s/it]EarlyStopping counter : 8 out of 40
training process:  46%|████▌     | 59/128 [1:32:14<1:46:07, 92.29s/it]EarlyStopping counter : 9 out of 40
training process:  47%|████▋     | 60/128 [1:33:41<1:42:44, 90.65s/it]epoch : 61, train loss : 0.001, valid loss : 0.006, train acc : 0.994, valid acc : 0.987, train f1 : 0.863, valid f1 : 0.744

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 269.43it/s][A
 29%|██▊       | 56/196 [00:00<00:00, 277.26it/s][A
 43%|████▎     | 85/196 [00:00<00:00, 280.44it/s][A
 58%|█████▊    | 114/196 [00:00<00:00, 282.15it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 283.11it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 280.82it/s][A100%|██████████| 196/196 [00:00<00:00, 280.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  48%|████▊     | 61/128 [1:35:35<1:48:57, 97.57s/it]EarlyStopping counter : 11 out of 40
training process:  48%|████▊     | 62/128 [1:37:02<1:43:53, 94.45s/it]EarlyStopping counter : 12 out of 40
training process:  49%|████▉     | 63/128 [1:38:29<1:39:55, 92.24s/it]EarlyStopping counter : 13 out of 40
training process:  50%|█████     | 64/128 [1:39:56<1:36:36, 90.57s/it]epoch : 65, train loss : 0.001, valid loss : 0.006, train acc : 0.994, valid acc : 0.993, train f1 : 0.868, valid f1 : 0.818

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 279.23it/s][A
 29%|██▉       | 57/196 [00:00<00:00, 283.12it/s][A
 44%|████▍     | 86/196 [00:00<00:00, 284.70it/s][A
 59%|█████▊    | 115/196 [00:00<00:00, 285.50it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 285.99it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 286.26it/s][A100%|██████████| 196/196 [00:00<00:00, 285.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  51%|█████     | 65/128 [1:41:50<1:42:37, 97.74s/it]EarlyStopping counter : 15 out of 40
training process:  52%|█████▏    | 66/128 [1:43:19<1:38:15, 95.09s/it]EarlyStopping counter : 16 out of 40
training process:  52%|█████▏    | 67/128 [1:44:48<1:34:53, 93.33s/it]EarlyStopping counter : 17 out of 40
training process:  53%|█████▎    | 68/128 [1:46:16<1:31:37, 91.62s/it]epoch : 69, train loss : 0.001, valid loss : 0.006, train acc : 0.995, valid acc : 0.994, train f1 : 0.888, valid f1 : 0.842

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.05it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 346.55it/s][A
 54%|█████▍    | 106/196 [00:00<00:00, 350.08it/s][A
 72%|███████▏  | 142/196 [00:00<00:00, 351.96it/s][A
 91%|█████████ | 178/196 [00:00<00:00, 350.28it/s][A100%|██████████| 196/196 [00:00<00:00, 349.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  54%|█████▍    | 69/128 [1:48:07<1:35:58, 97.59s/it]EarlyStopping counter : 19 out of 40
training process:  55%|█████▍    | 70/128 [1:49:37<1:32:02, 95.22s/it]EarlyStopping counter : 20 out of 40
training process:  55%|█████▌    | 71/128 [1:51:04<1:28:08, 92.77s/it]EarlyStopping counter : 21 out of 40
training process:  56%|█████▋    | 72/128 [1:52:30<1:24:42, 90.76s/it]epoch : 73, train loss : 0.001, valid loss : 0.006, train acc : 0.996, valid acc : 0.992, train f1 : 0.894, valid f1 : 0.797

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 341.45it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 346.78it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 348.57it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 349.32it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 349.91it/s][A100%|██████████| 196/196 [00:00<00:00, 348.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  57%|█████▋    | 73/128 [1:54:24<1:29:29, 97.63s/it]EarlyStopping counter : 23 out of 40
training process:  58%|█████▊    | 74/128 [1:55:50<1:24:51, 94.29s/it]EarlyStopping counter : 24 out of 40
training process:  59%|█████▊    | 75/128 [1:57:19<1:21:46, 92.58s/it]EarlyStopping counter : 25 out of 40
training process:  59%|█████▉    | 76/128 [1:58:47<1:19:02, 91.20s/it]epoch : 77, train loss : 0.001, valid loss : 0.005, train acc : 0.996, valid acc : 0.984, train f1 : 0.898, valid f1 : 0.720

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 346.50it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 350.14it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 351.70it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 352.50it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 352.66it/s][A100%|██████████| 196/196 [00:00<00:00, 351.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  60%|██████    | 77/128 [2:00:42<1:23:28, 98.20s/it]EarlyStopping counter : 27 out of 40
training process:  61%|██████    | 78/128 [2:02:08<1:18:57, 94.75s/it]EarlyStopping counter : 28 out of 40
training process:  62%|██████▏   | 79/128 [2:03:35<1:15:23, 92.32s/it]EarlyStopping counter : 29 out of 40
training process:  62%|██████▎   | 80/128 [2:05:03<1:12:53, 91.11s/it]epoch : 81, train loss : 0.000, valid loss : 0.007, train acc : 0.996, valid acc : 0.988, train f1 : 0.909, valid f1 : 0.753

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▍        | 29/196 [00:00<00:00, 281.20it/s][A
 30%|██▉       | 58/196 [00:00<00:00, 284.33it/s][A
 44%|████▍     | 87/196 [00:00<00:00, 285.19it/s][A
 59%|█████▉    | 116/196 [00:00<00:00, 285.13it/s][A
 74%|███████▍  | 145/196 [00:00<00:00, 284.80it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 284.71it/s][A100%|██████████| 196/196 [00:00<00:00, 284.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  63%|██████▎   | 81/128 [2:07:01<1:17:39, 99.14s/it]EarlyStopping counter : 31 out of 40
training process:  64%|██████▍   | 82/128 [2:08:29<1:13:22, 95.72s/it]EarlyStopping counter : 32 out of 40
training process:  65%|██████▍   | 83/128 [2:09:57<1:10:10, 93.57s/it]EarlyStopping counter : 33 out of 40
training process:  66%|██████▌   | 84/128 [2:11:26<1:07:33, 92.14s/it]epoch : 85, train loss : 0.000, valid loss : 0.008, train acc : 0.996, valid acc : 0.993, train f1 : 0.911, valid f1 : 0.816

  0%|          | 0/196 [00:00<?, ?it/s][A
 15%|█▍        | 29/196 [00:00<00:00, 281.81it/s][A
 30%|██▉       | 58/196 [00:00<00:00, 284.65it/s][A
 44%|████▍     | 87/196 [00:00<00:00, 283.19it/s][A
 59%|█████▉    | 116/196 [00:00<00:00, 284.57it/s][A
 74%|███████▍  | 145/196 [00:00<00:00, 285.42it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 285.90it/s][A100%|██████████| 196/196 [00:00<00:00, 285.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 34 out of 40
training process:  66%|██████▋   | 85/128 [2:13:19<1:10:35, 98.51s/it]EarlyStopping counter : 35 out of 40
training process:  67%|██████▋   | 86/128 [2:14:48<1:06:51, 95.51s/it]EarlyStopping counter : 36 out of 40
training process:  68%|██████▊   | 87/128 [2:16:18<1:04:13, 93.99s/it]EarlyStopping counter : 37 out of 40
training process:  69%|██████▉   | 88/128 [2:17:47<1:01:34, 92.36s/it]epoch : 89, train loss : 0.000, valid loss : 0.008, train acc : 0.996, valid acc : 0.995, train f1 : 0.914, valid f1 : 0.857

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 343.26it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 347.13it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 348.07it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 345.87it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 347.28it/s][A100%|██████████| 196/196 [00:00<00:00, 347.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.848 -> 0.857
training process:  70%|██████▉   | 89/128 [2:19:41<1:04:19, 98.96s/it]EarlyStopping counter : 1 out of 40
training process:  70%|███████   | 90/128 [2:21:10<1:00:45, 95.94s/it]EarlyStopping counter : 2 out of 40
training process:  71%|███████   | 91/128 [2:22:39<57:54, 93.91s/it]  EarlyStopping counter : 3 out of 40
training process:  72%|███████▏  | 92/128 [2:24:07<55:17, 92.16s/it]epoch : 93, train loss : 0.001, valid loss : 0.007, train acc : 0.997, valid acc : 0.988, train f1 : 0.926, valid f1 : 0.750

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 269.14it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 275.36it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 276.45it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 277.16it/s][A
 71%|███████   | 139/196 [00:00<00:00, 277.48it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 277.60it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 277.61it/s][A100%|██████████| 196/196 [00:00<00:00, 276.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  73%|███████▎  | 93/128 [2:26:01<57:29, 98.57s/it]EarlyStopping counter : 5 out of 40
training process:  73%|███████▎  | 94/128 [2:27:29<54:01, 95.33s/it]EarlyStopping counter : 6 out of 40
training process:  74%|███████▍  | 95/128 [2:28:59<51:36, 93.83s/it]EarlyStopping counter : 7 out of 40
training process:  75%|███████▌  | 96/128 [2:30:28<49:15, 92.37s/it]epoch : 97, train loss : 0.000, valid loss : 0.009, train acc : 0.997, valid acc : 0.992, train f1 : 0.930, valid f1 : 0.804

  0%|          | 0/196 [00:00<?, ?it/s][A
 11%|█         | 21/196 [00:00<00:00, 205.04it/s][A
 24%|██▍       | 48/196 [00:00<00:00, 241.90it/s][A
 39%|███▉      | 76/196 [00:00<00:00, 255.25it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 258.77it/s][A
 67%|██████▋   | 131/196 [00:00<00:00, 264.17it/s][A
 81%|████████  | 159/196 [00:00<00:00, 267.69it/s][A
 95%|█████████▍| 186/196 [00:00<00:00, 268.39it/s][A100%|██████████| 196/196 [00:00<00:00, 261.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  76%|███████▌  | 97/128 [2:32:23<51:16, 99.23s/it]EarlyStopping counter : 9 out of 40
training process:  77%|███████▋  | 98/128 [2:33:52<48:01, 96.07s/it]EarlyStopping counter : 10 out of 40
training process:  77%|███████▋  | 99/128 [2:35:22<45:36, 94.35s/it]EarlyStopping counter : 11 out of 40
training process:  78%|███████▊  | 100/128 [2:36:49<43:01, 92.19s/it]epoch : 101, train loss : 0.000, valid loss : 0.010, train acc : 0.998, valid acc : 0.995, train f1 : 0.937, valid f1 : 0.842

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 340.34it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 347.32it/s][A
 54%|█████▍    | 106/196 [00:00<00:00, 347.45it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 347.70it/s][A
 90%|████████▉ | 176/196 [00:00<00:00, 347.98it/s][A100%|██████████| 196/196 [00:00<00:00, 347.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  79%|███████▉  | 101/128 [2:38:39<43:49, 97.40s/it]EarlyStopping counter : 13 out of 40
training process:  80%|███████▉  | 102/128 [2:40:08<41:05, 94.81s/it]EarlyStopping counter : 14 out of 40
training process:  80%|████████  | 103/128 [2:41:35<38:30, 92.43s/it]EarlyStopping counter : 15 out of 40
training process:  81%|████████▏ | 104/128 [2:43:03<36:28, 91.18s/it]epoch : 105, train loss : 0.001, valid loss : 0.009, train acc : 0.997, valid acc : 0.986, train f1 : 0.931, valid f1 : 0.732

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 345.96it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 349.44it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 350.39it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 351.20it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 349.89it/s][A100%|██████████| 196/196 [00:00<00:00, 349.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  82%|████████▏ | 105/128 [2:44:55<37:21, 97.45s/it]EarlyStopping counter : 17 out of 40
training process:  83%|████████▎ | 106/128 [2:46:24<34:44, 94.75s/it]EarlyStopping counter : 18 out of 40
training process:  84%|████████▎ | 107/128 [2:47:53<32:34, 93.06s/it]EarlyStopping counter : 19 out of 40
training process:  84%|████████▍ | 108/128 [2:49:22<30:39, 91.96s/it]epoch : 109, train loss : 0.000, valid loss : 0.010, train acc : 0.998, valid acc : 0.993, train f1 : 0.942, valid f1 : 0.812

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 272.77it/s][A
 29%|██▊       | 56/196 [00:00<00:00, 276.24it/s][A
 43%|████▎     | 84/196 [00:00<00:00, 277.32it/s][A
 57%|█████▋    | 112/196 [00:00<00:00, 277.16it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 276.98it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 277.08it/s][A
100%|██████████| 196/196 [00:00<00:00, 277.14it/s][A100%|██████████| 196/196 [00:00<00:00, 276.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  85%|████████▌ | 109/128 [2:51:17<31:20, 98.96s/it]EarlyStopping counter : 21 out of 40
training process:  86%|████████▌ | 110/128 [2:52:44<28:35, 95.29s/it]EarlyStopping counter : 22 out of 40
training process:  87%|████████▋ | 111/128 [2:54:11<26:16, 92.71s/it]EarlyStopping counter : 23 out of 40
training process:  88%|████████▊ | 112/128 [2:55:40<24:29, 91.83s/it]epoch : 113, train loss : 0.000, valid loss : 0.010, train acc : 0.998, valid acc : 0.994, train f1 : 0.948, valid f1 : 0.831

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 255.00it/s][A
 31%|███       | 60/196 [00:00<00:00, 300.66it/s][A
 48%|████▊     | 95/196 [00:00<00:00, 318.75it/s][A
 66%|██████▋   | 130/196 [00:00<00:00, 327.40it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 332.16it/s][A100%|██████████| 196/196 [00:00<00:00, 324.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  88%|████████▊ | 113/128 [2:57:34<24:35, 98.39s/it]EarlyStopping counter : 25 out of 40
training process:  89%|████████▉ | 114/128 [2:59:03<22:17, 95.53s/it]EarlyStopping counter : 26 out of 40
training process:  90%|████████▉ | 115/128 [3:00:32<20:16, 93.55s/it]EarlyStopping counter : 27 out of 40
training process:  91%|█████████ | 116/128 [3:02:01<18:26, 92.19s/it]epoch : 117, train loss : 0.000, valid loss : 0.010, train acc : 0.998, valid acc : 0.991, train f1 : 0.949, valid f1 : 0.775

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 346.26it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 349.72it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 351.11it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 351.59it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 351.70it/s][A100%|██████████| 196/196 [00:00<00:00, 351.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  91%|█████████▏| 117/128 [3:03:53<18:00, 98.19s/it]EarlyStopping counter : 29 out of 40
training process:  92%|█████████▏| 118/128 [3:05:23<15:55, 95.58s/it]EarlyStopping counter : 30 out of 40
training process:  93%|█████████▎| 119/128 [3:06:53<14:05, 93.90s/it]EarlyStopping counter : 31 out of 40
training process:  94%|█████████▍| 120/128 [3:08:22<12:21, 92.68s/it]epoch : 121, train loss : 0.000, valid loss : 0.009, train acc : 0.998, valid acc : 0.991, train f1 : 0.949, valid f1 : 0.783

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.70it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 339.14it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 341.67it/s][A
 71%|███████   | 139/196 [00:00<00:00, 342.85it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 340.41it/s][A100%|██████████| 196/196 [00:00<00:00, 340.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  95%|█████████▍| 121/128 [3:10:14<11:28, 98.33s/it]EarlyStopping counter : 33 out of 40
training process:  95%|█████████▌| 122/128 [3:11:43<09:33, 95.55s/it]EarlyStopping counter : 34 out of 40
training process:  96%|█████████▌| 123/128 [3:13:14<07:50, 94.16s/it]EarlyStopping counter : 35 out of 40
training process:  97%|█████████▋| 124/128 [3:14:42<06:09, 92.44s/it]epoch : 125, train loss : 0.000, valid loss : 0.013, train acc : 0.998, valid acc : 0.989, train f1 : 0.948, valid f1 : 0.752

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 348.15it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 351.88it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 353.17it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 353.65it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 354.02it/s][A100%|██████████| 196/196 [00:00<00:00, 351.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  98%|█████████▊| 125/128 [3:16:37<04:57, 99.16s/it]EarlyStopping counter : 37 out of 40
training process:  98%|█████████▊| 126/128 [3:18:05<03:11, 95.71s/it]EarlyStopping counter : 38 out of 40
training process:  99%|█████████▉| 127/128 [3:19:34<01:33, 93.74s/it]EarlyStopping counter : 39 out of 40
training process: 100%|██████████| 128/128 [3:21:02<00:00, 91.89s/it]training process: 100%|██████████| 128/128 [3:21:02<00:00, 94.24s/it]
training process finished, best loss : 0.008 and best acc : 0.995, best f1 : 0.857, best epoch : 88

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.66      0.59      0.62       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.83      0.79      0.81     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.81, test AUC : 0.79, test loss : 2.623

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:18, 12.42s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:58, 11.87s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:45, 11.84s/it]processing for feature importance:  24%|██▎       | 4/17 [00:47<02:34, 11.90s/it]processing for feature importance:  29%|██▉       | 5/17 [00:59<02:20, 11.71s/it]processing for feature importance:  35%|███▌      | 6/17 [01:10<02:06, 11.51s/it]processing for feature importance:  41%|████      | 7/17 [01:21<01:54, 11.44s/it]processing for feature importance:  47%|████▋     | 8/17 [01:33<01:43, 11.50s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:44<01:32, 11.57s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:56<01:20, 11.51s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:08<01:09, 11.65s/it]processing for feature importance:  71%|███████   | 12/17 [02:19<00:57, 11.60s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:31<00:46, 11.61s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:42<00:34, 11.58s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:54<00:23, 11.54s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:06<00:11, 11.87s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.91s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.70s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:02<09:02,  2.60s/it]visualize 2D latent space:   1%|          | 2/210 [00:03<05:29,  1.59s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<09:28,  2.74s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:50,  2.55s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:16,  1.16s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:51,  1.69s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:02<08:51,  2.55s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<05:40,  1.64s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:05<09:12,  2.66s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:23,  2.14s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<01:39,  1.50s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 15%|█▌        | 30/196 [00:00<00:00, 299.66it/s] 33%|███▎      | 64/196 [00:00<00:00, 323.34it/s] 51%|█████     | 99/196 [00:00<00:00, 331.09it/s] 68%|██████▊   | 134/196 [00:00<00:00, 334.89it/s] 86%|████████▌ | 168/196 [00:00<00:00, 336.68it/s]100%|██████████| 196/196 [00:00<00:00, 332.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_smoothing_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:03, 194.87it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 193.97it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 192.35it/s]remove invalid data : null / measurement error:  13%|█▎        | 80/616 [00:00<00:03, 171.70it/s]remove invalid data : null / measurement error:  16%|█▋        | 101/616 [00:00<00:02, 182.41it/s]remove invalid data : null / measurement error:  20%|█▉        | 123/616 [00:00<00:02, 192.47it/s]remove invalid data : null / measurement error:  24%|██▎       | 145/616 [00:00<00:02, 198.75it/s]remove invalid data : null / measurement error:  27%|██▋       | 167/616 [00:00<00:02, 204.30it/s]remove invalid data : null / measurement error:  31%|███       | 188/616 [00:00<00:02, 204.29it/s]remove invalid data : null / measurement error:  34%|███▍      | 209/616 [00:01<00:01, 204.42it/s]remove invalid data : null / measurement error:  37%|███▋      | 230/616 [00:01<00:01, 205.98it/s]remove invalid data : null / measurement error:  41%|████      | 251/616 [00:01<00:01, 205.98it/s]remove invalid data : null / measurement error:  44%|████▍     | 273/616 [00:01<00:01, 207.70it/s]remove invalid data : null / measurement error:  48%|████▊     | 294/616 [00:01<00:01, 207.28it/s]remove invalid data : null / measurement error:  51%|█████     | 315/616 [00:01<00:01, 206.45it/s]remove invalid data : null / measurement error:  55%|█████▍    | 336/616 [00:01<00:01, 206.27it/s]remove invalid data : null / measurement error:  58%|█████▊    | 357/616 [00:01<00:01, 205.95it/s]remove invalid data : null / measurement error:  62%|██████▏   | 383/616 [00:01<00:01, 220.51it/s]remove invalid data : null / measurement error:  67%|██████▋   | 410/616 [00:01<00:00, 232.67it/s]remove invalid data : null / measurement error:  70%|███████   | 434/616 [00:02<00:00, 230.66it/s]remove invalid data : null / measurement error:  74%|███████▍  | 458/616 [00:02<00:00, 233.31it/s]remove invalid data : null / measurement error:  78%|███████▊  | 482/616 [00:02<00:00, 223.90it/s]remove invalid data : null / measurement error:  82%|████████▏ | 505/616 [00:02<00:00, 213.99it/s]remove invalid data : null / measurement error:  86%|████████▌ | 527/616 [00:02<00:00, 210.63it/s]remove invalid data : null / measurement error:  89%|████████▉ | 549/616 [00:02<00:00, 206.30it/s]remove invalid data : null / measurement error:  93%|█████████▎| 570/616 [00:02<00:00, 204.30it/s]remove invalid data : null / measurement error:  96%|█████████▌| 591/616 [00:02<00:00, 201.97it/s]remove invalid data : null / measurement error:  99%|█████████▉| 612/616 [00:02<00:00, 199.47it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 206.12it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 231.46it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 231.29it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 232.03it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 234.93it/s]replace nan value:  23%|██▎       | 121/515 [00:00<00:01, 238.16it/s]replace nan value:  28%|██▊       | 146/515 [00:00<00:01, 240.75it/s]replace nan value:  33%|███▎      | 171/515 [00:00<00:01, 242.55it/s]replace nan value:  38%|███▊      | 196/515 [00:00<00:01, 243.21it/s]replace nan value:  43%|████▎     | 221/515 [00:00<00:01, 243.63it/s]replace nan value:  48%|████▊     | 246/515 [00:01<00:01, 244.44it/s]replace nan value:  53%|█████▎    | 271/515 [00:01<00:00, 244.90it/s]replace nan value:  57%|█████▋    | 296/515 [00:01<00:00, 244.25it/s]replace nan value:  62%|██████▏   | 321/515 [00:01<00:00, 244.45it/s]replace nan value:  67%|██████▋   | 346/515 [00:01<00:00, 240.48it/s]replace nan value:  72%|███████▏  | 371/515 [00:01<00:00, 241.54it/s]replace nan value:  77%|███████▋  | 396/515 [00:01<00:00, 243.04it/s]replace nan value:  82%|████████▏ | 421/515 [00:01<00:00, 243.01it/s]replace nan value:  87%|████████▋ | 446/515 [00:01<00:00, 241.87it/s]replace nan value:  91%|█████████▏| 471/515 [00:01<00:00, 242.85it/s]replace nan value:  96%|█████████▋| 496/515 [00:02<00:00, 243.86it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 241.61it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.03it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.61it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.37it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 71.72it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.35it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 53.79it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.73it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.27it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 53.80it/s]generate index:  15%|█▍        | 77/515 [00:01<00:08, 52.18it/s]generate index:  17%|█▋        | 87/515 [00:01<00:06, 62.93it/s]generate index:  18%|█▊        | 94/515 [00:01<00:06, 62.55it/s]generate index:  20%|█▉        | 101/515 [00:01<00:07, 58.62it/s]generate index:  21%|██▏       | 110/515 [00:01<00:06, 64.99it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.47it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 70.20it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 71.00it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 72.43it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 71.60it/s]generate index:  31%|███       | 159/515 [00:02<00:04, 71.59it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 72.86it/s]generate index:  34%|███▍      | 175/515 [00:02<00:04, 69.55it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.86it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.11it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.35it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.11it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.29it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.49it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.38it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 71.97it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 70.87it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 73.42it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.37it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.51it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.77it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.78it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 62.16it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 62.27it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 58.62it/s]generate index:  63%|██████▎   | 326/515 [00:04<00:03, 54.16it/s]generate index:  64%|██████▍   | 332/515 [00:05<00:03, 55.15it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:04, 38.37it/s]generate index:  67%|██████▋   | 343/515 [00:05<00:04, 37.28it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:04, 36.58it/s]generate index:  70%|██████▉   | 358/515 [00:05<00:03, 48.49it/s]generate index:  72%|███████▏  | 370/515 [00:05<00:02, 64.67it/s]generate index:  74%|███████▍  | 380/515 [00:05<00:01, 72.65it/s]generate index:  76%|███████▌  | 389/515 [00:06<00:01, 68.32it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 74.15it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 55.47it/s]generate index:  81%|████████  | 415/515 [00:06<00:01, 59.45it/s]generate index:  82%|████████▏ | 422/515 [00:06<00:01, 60.79it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 58.83it/s]generate index:  85%|████████▍ | 436/515 [00:07<00:01, 47.30it/s]generate index:  86%|████████▌ | 442/515 [00:07<00:01, 40.92it/s]generate index:  88%|████████▊ | 453/515 [00:07<00:01, 53.37it/s]generate index:  90%|████████▉ | 462/515 [00:07<00:00, 61.20it/s]generate index:  91%|█████████▏| 470/515 [00:07<00:00, 54.14it/s]generate index:  93%|█████████▎| 480/515 [00:07<00:00, 62.74it/s]generate index:  95%|█████████▍| 488/515 [00:07<00:00, 66.45it/s]generate index:  96%|█████████▋| 496/515 [00:08<00:00, 66.37it/s]generate index:  98%|█████████▊| 504/515 [00:08<00:00, 69.55it/s]generate index:  99%|█████████▉| 512/515 [00:08<00:00, 69.40it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 61.80it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:03, 48.70it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 142.15it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 173.96it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 190.48it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 198.11it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 213.30it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 210.50it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 193.30it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 245.91it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 248.42it/s]replace nan value:  58%|█████▊    | 76/131 [00:00<00:00, 249.02it/s]replace nan value:  77%|███████▋  | 101/131 [00:00<00:00, 246.52it/s]replace nan value:  97%|█████████▋| 127/131 [00:00<00:00, 248.24it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 247.86it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:02, 55.60it/s]generate index:  10%|▉         | 13/131 [00:00<00:02, 40.48it/s]generate index:  15%|█▍        | 19/131 [00:00<00:02, 45.87it/s]generate index:  18%|█▊        | 24/131 [00:00<00:02, 44.80it/s]generate index:  24%|██▍       | 32/131 [00:00<00:01, 54.80it/s]generate index:  31%|███       | 40/131 [00:00<00:01, 62.10it/s]generate index:  36%|███▌      | 47/131 [00:00<00:01, 63.64it/s]generate index:  41%|████      | 54/131 [00:00<00:01, 61.13it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 64.45it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 64.80it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 66.89it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 65.02it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 46.74it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 49.01it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 47.43it/s]generate index:  85%|████████▍ | 111/131 [00:02<00:00, 52.04it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 61.05it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 70.70it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.27it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 9/193 [00:00<00:02, 89.03it/s]remove invalid data : null / measurement error:  16%|█▌        | 30/193 [00:00<00:01, 159.65it/s]remove invalid data : null / measurement error:  27%|██▋       | 52/193 [00:00<00:00, 183.96it/s]remove invalid data : null / measurement error:  38%|███▊      | 74/193 [00:00<00:00, 196.62it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 201.56it/s]remove invalid data : null / measurement error:  61%|██████    | 118/193 [00:00<00:00, 205.43it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 217.59it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 213.15it/s]remove invalid data : null / measurement error:  97%|█████████▋| 187/193 [00:00<00:00, 210.35it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 200.33it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 250.59it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 252.78it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 251.78it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 248.17it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 249.11it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 250.92it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 250.45it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.20it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.77it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.13it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 76.15it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.98it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.96it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 85.09it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.90it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.07it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.88it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 46.03it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 44.22it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 54.35it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 56.50it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 53.33it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 52.75it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 57.14it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 61.64it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 60.96it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.037, valid loss : -0.045, train acc : 0.966, valid acc : 0.992, train f1 : 0.499, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 336.22it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 347.16it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 346.89it/s][A
 72%|███████▏  | 141/196 [00:00<00:00, 350.11it/s][A
 90%|█████████ | 177/196 [00:00<00:00, 351.93it/s][A100%|██████████| 196/196 [00:00<00:00, 349.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.498
training process:   1%|          | 1/128 [01:58<4:10:00, 118.11s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:22<3:26:19, 98.25s/it] EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:49<3:14:04, 93.16s/it]EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:15<3:06:59, 90.48s/it]epoch : 5, train loss : -0.046, valid loss : -0.046, train acc : 0.991, valid acc : 0.992, train f1 : 0.498, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 320.70it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 334.53it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.06it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.34it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 341.24it/s][A100%|██████████| 196/196 [00:00<00:00, 339.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:10<3:23:38, 99.33s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:40<3:14:54, 95.85s/it]EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:10<3:09:39, 94.05s/it]Best score increase :0.498 -> 0.520
training process:   6%|▋         | 8/128 [12:39<3:05:13, 92.62s/it]epoch : 9, train loss : -0.046, valid loss : -0.046, train acc : 0.991, valid acc : 0.992, train f1 : 0.508, valid f1 : 0.498

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 313.73it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 332.97it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 267.40it/s][A
 66%|██████▋   | 130/196 [00:00<00:00, 263.22it/s][A
 81%|████████  | 158/196 [00:00<00:00, 265.70it/s][A
 96%|█████████▌| 188/196 [00:00<00:00, 274.87it/s][A100%|██████████| 196/196 [00:00<00:00, 279.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [14:36<3:18:17, 99.98s/it]Best score increase :0.520 -> 0.557
training process:   8%|▊         | 10/128 [16:06<3:10:31, 96.88s/it]Best score increase :0.557 -> 0.593
training process:   9%|▊         | 11/128 [17:35<3:04:16, 94.50s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [19:04<2:59:38, 92.92s/it]epoch : 13, train loss : -0.047, valid loss : -0.047, train acc : 0.992, valid acc : 0.993, train f1 : 0.659, valid f1 : 0.694

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 261.34it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 270.70it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 273.79it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 274.70it/s][A
 71%|███████   | 139/196 [00:00<00:00, 275.86it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 276.42it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 277.15it/s][A100%|██████████| 196/196 [00:00<00:00, 275.06it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.593 -> 0.694
training process:  10%|█         | 13/128 [21:01<3:12:12, 100.28s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [22:28<3:02:58, 96.30s/it] Best score increase :0.694 -> 0.709
training process:  12%|█▏        | 15/128 [23:56<2:56:32, 93.74s/it]Best score increase :0.709 -> 0.728
training process:  12%|█▎        | 16/128 [25:26<2:53:02, 92.70s/it]epoch : 17, train loss : -0.048, valid loss : -0.048, train acc : 0.994, valid acc : 0.994, train f1 : 0.750, valid f1 : 0.758

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 264.89it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 272.79it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 275.08it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 276.23it/s][A
 71%|███████   | 139/196 [00:00<00:00, 277.42it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 278.56it/s][A100%|██████████| 196/196 [00:00<00:00, 277.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.728 -> 0.758
training process:  13%|█▎        | 17/128 [27:22<3:04:10, 99.55s/it]Best score increase :0.758 -> 0.784
training process:  14%|█▍        | 18/128 [28:52<2:57:08, 96.62s/it]Best score increase :0.784 -> 0.803
training process:  15%|█▍        | 19/128 [30:23<2:52:38, 95.03s/it]EarlyStopping counter : 1 out of 40
training process:  16%|█▌        | 20/128 [31:55<2:49:28, 94.16s/it]epoch : 21, train loss : -0.048, valid loss : -0.048, train acc : 0.994, valid acc : 0.995, train f1 : 0.793, valid f1 : 0.808

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 332.76it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.57it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 343.26it/s][A
 71%|███████   | 139/196 [00:00<00:00, 344.72it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.80it/s][A100%|██████████| 196/196 [00:00<00:00, 342.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.803 -> 0.808
training process:  16%|█▋        | 21/128 [33:48<2:58:00, 99.82s/it]Best score increase :0.808 -> 0.809
training process:  17%|█▋        | 22/128 [35:17<2:50:35, 96.56s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [36:46<2:45:05, 94.34s/it]Best score increase :0.809 -> 0.815
training process:  19%|█▉        | 24/128 [38:16<2:41:23, 93.11s/it]epoch : 25, train loss : -0.048, valid loss : -0.048, train acc : 0.995, valid acc : 0.995, train f1 : 0.810, valid f1 : 0.818

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 266.21it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 272.63it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 273.39it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 274.96it/s][A
 71%|███████   | 139/196 [00:00<00:00, 275.93it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 276.58it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 277.03it/s][A100%|██████████| 196/196 [00:00<00:00, 275.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.815 -> 0.818
training process:  20%|█▉        | 25/128 [40:10<2:50:18, 99.21s/it]Best score increase :0.818 -> 0.837
training process:  20%|██        | 26/128 [41:40<2:43:48, 96.36s/it]Best score increase :0.837 -> 0.839
training process:  21%|██        | 27/128 [43:07<2:37:48, 93.74s/it]EarlyStopping counter : 1 out of 40
training process:  22%|██▏       | 28/128 [44:38<2:34:54, 92.94s/it]epoch : 29, train loss : -0.048, valid loss : -0.048, train acc : 0.995, valid acc : 0.996, train f1 : 0.827, valid f1 : 0.839

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 28/196 [00:00<00:00, 271.83it/s][A
 29%|██▊       | 56/196 [00:00<00:00, 270.68it/s][A
 43%|████▎     | 84/196 [00:00<00:00, 274.00it/s][A
 57%|█████▋    | 112/196 [00:00<00:00, 275.48it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 276.21it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 273.59it/s][A
100%|██████████| 196/196 [00:00<00:00, 275.17it/s][A100%|██████████| 196/196 [00:00<00:00, 274.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 29/128 [46:34<2:44:27, 99.68s/it]EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 30/128 [48:03<2:37:34, 96.47s/it]Best score increase :0.839 -> 0.845
training process:  24%|██▍       | 31/128 [49:32<2:32:21, 94.24s/it]EarlyStopping counter : 1 out of 40
training process:  25%|██▌       | 32/128 [51:01<2:28:23, 92.75s/it]epoch : 33, train loss : -0.048, valid loss : -0.049, train acc : 0.995, valid acc : 0.996, train f1 : 0.841, valid f1 : 0.847

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.58it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 339.09it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 341.51it/s][A
 71%|███████   | 139/196 [00:00<00:00, 342.57it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 342.89it/s][A100%|██████████| 196/196 [00:00<00:00, 341.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.845 -> 0.847
training process:  26%|██▌       | 33/128 [52:49<2:34:18, 97.46s/it]Best score increase :0.847 -> 0.852
training process:  27%|██▋       | 34/128 [54:19<2:29:02, 95.13s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 35/128 [55:47<2:24:13, 93.04s/it]EarlyStopping counter : 2 out of 40
training process:  28%|██▊       | 36/128 [57:16<2:20:31, 91.65s/it]epoch : 37, train loss : -0.048, valid loss : -0.048, train acc : 0.995, valid acc : 0.996, train f1 : 0.842, valid f1 : 0.848

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 330.54it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 337.61it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 339.84it/s][A
 71%|███████   | 139/196 [00:00<00:00, 340.88it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.36it/s][A100%|██████████| 196/196 [00:00<00:00, 340.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  29%|██▉       | 37/128 [59:10<2:29:26, 98.54s/it]EarlyStopping counter : 4 out of 40
training process:  30%|██▉       | 38/128 [1:00:40<2:23:38, 95.76s/it]Best score increase :0.852 -> 0.855
training process:  30%|███       | 39/128 [1:02:11<2:20:06, 94.45s/it]EarlyStopping counter : 1 out of 40
training process:  31%|███▏      | 40/128 [1:03:41<2:16:45, 93.24s/it]epoch : 41, train loss : -0.049, valid loss : -0.048, train acc : 0.996, valid acc : 0.995, train f1 : 0.849, valid f1 : 0.825

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.12it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 335.99it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.98it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.12it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 339.78it/s][A100%|██████████| 196/196 [00:00<00:00, 337.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  32%|███▏      | 41/128 [1:05:33<2:23:13, 98.78s/it]EarlyStopping counter : 3 out of 40
training process:  33%|███▎      | 42/128 [1:07:04<2:18:05, 96.35s/it]EarlyStopping counter : 4 out of 40
training process:  34%|███▎      | 43/128 [1:08:33<2:13:24, 94.17s/it]EarlyStopping counter : 5 out of 40
training process:  34%|███▍      | 44/128 [1:10:01<2:09:15, 92.32s/it]epoch : 45, train loss : -0.049, valid loss : -0.049, train acc : 0.996, valid acc : 0.996, train f1 : 0.867, valid f1 : 0.858

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.46it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.43it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 344.16it/s][A
 71%|███████   | 139/196 [00:00<00:00, 344.97it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 345.40it/s][A100%|██████████| 196/196 [00:00<00:00, 344.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.855 -> 0.858
training process:  35%|███▌      | 45/128 [1:11:58<2:17:57, 99.72s/it]EarlyStopping counter : 1 out of 40
training process:  36%|███▌      | 46/128 [1:13:28<2:12:29, 96.94s/it]EarlyStopping counter : 2 out of 40
training process:  37%|███▋      | 47/128 [1:15:00<2:08:47, 95.40s/it]EarlyStopping counter : 3 out of 40
training process:  38%|███▊      | 48/128 [1:16:30<2:04:56, 93.71s/it]epoch : 49, train loss : -0.049, valid loss : -0.048, train acc : 0.996, valid acc : 0.996, train f1 : 0.867, valid f1 : 0.872

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 344.10it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 344.96it/s][A
 54%|█████▍    | 106/196 [00:00<00:00, 350.20it/s][A
 72%|███████▏  | 142/196 [00:00<00:00, 352.65it/s][A
 91%|█████████ | 178/196 [00:00<00:00, 353.85it/s][A100%|██████████| 196/196 [00:00<00:00, 351.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.858 -> 0.872
training process:  38%|███▊      | 49/128 [1:18:22<2:10:41, 99.25s/it]EarlyStopping counter : 1 out of 40
training process:  39%|███▉      | 50/128 [1:19:51<2:05:05, 96.22s/it]EarlyStopping counter : 2 out of 40
training process:  40%|███▉      | 51/128 [1:21:17<1:59:36, 93.20s/it]EarlyStopping counter : 3 out of 40
training process:  41%|████      | 52/128 [1:22:46<1:56:24, 91.90s/it]epoch : 53, train loss : -0.049, valid loss : -0.048, train acc : 0.996, valid acc : 0.995, train f1 : 0.871, valid f1 : 0.827

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.62it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.61it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 340.85it/s][A
 71%|███████   | 139/196 [00:00<00:00, 341.93it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 342.61it/s][A100%|██████████| 196/196 [00:00<00:00, 340.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  41%|████▏     | 53/128 [1:24:40<2:03:02, 98.44s/it]EarlyStopping counter : 5 out of 40
training process:  42%|████▏     | 54/128 [1:26:07<1:57:21, 95.16s/it]EarlyStopping counter : 6 out of 40
training process:  43%|████▎     | 55/128 [1:27:36<1:53:17, 93.11s/it]EarlyStopping counter : 7 out of 40
training process:  44%|████▍     | 56/128 [1:29:04<1:50:07, 91.77s/it]epoch : 57, train loss : -0.049, valid loss : -0.048, train acc : 0.996, valid acc : 0.996, train f1 : 0.881, valid f1 : 0.844

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.56it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 333.63it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 338.81it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.47it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 343.08it/s][A100%|██████████| 196/196 [00:00<00:00, 341.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  45%|████▍     | 57/128 [1:31:00<1:56:53, 98.78s/it]EarlyStopping counter : 9 out of 40
training process:  45%|████▌     | 58/128 [1:32:29<1:51:48, 95.83s/it]EarlyStopping counter : 10 out of 40
training process:  46%|████▌     | 59/128 [1:33:56<1:47:19, 93.33s/it]EarlyStopping counter : 11 out of 40
training process:  47%|████▋     | 60/128 [1:35:26<1:44:30, 92.21s/it]epoch : 61, train loss : -0.049, valid loss : -0.048, train acc : 0.997, valid acc : 0.996, train f1 : 0.889, valid f1 : 0.850

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.23it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 335.38it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.47it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.42it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 342.41it/s][A100%|██████████| 196/196 [00:00<00:00, 341.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  48%|████▊     | 61/128 [1:37:18<1:49:41, 98.23s/it]EarlyStopping counter : 13 out of 40
training process:  48%|████▊     | 62/128 [1:38:47<1:45:06, 95.55s/it]EarlyStopping counter : 14 out of 40
training process:  49%|████▉     | 63/128 [1:40:17<1:41:38, 93.83s/it]EarlyStopping counter : 15 out of 40
training process:  50%|█████     | 64/128 [1:41:45<1:38:18, 92.17s/it]epoch : 65, train loss : -0.049, valid loss : -0.048, train acc : 0.996, valid acc : 0.996, train f1 : 0.886, valid f1 : 0.842

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 319.66it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 328.22it/s][A
 51%|█████     | 100/196 [00:00<00:00, 330.87it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 332.19it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 333.06it/s][A100%|██████████| 196/196 [00:00<00:00, 329.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  51%|█████     | 65/128 [1:43:42<1:44:22, 99.41s/it]EarlyStopping counter : 17 out of 40
training process:  52%|█████▏    | 66/128 [1:45:12<1:39:51, 96.64s/it]EarlyStopping counter : 18 out of 40
training process:  52%|█████▏    | 67/128 [1:46:41<1:35:50, 94.28s/it]EarlyStopping counter : 19 out of 40
training process:  53%|█████▎    | 68/128 [1:48:10<1:32:46, 92.78s/it]epoch : 69, train loss : -0.049, valid loss : -0.048, train acc : 0.997, valid acc : 0.995, train f1 : 0.897, valid f1 : 0.835

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 321.73it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 329.09it/s][A
 51%|█████     | 100/196 [00:00<00:00, 327.74it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 330.45it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 331.95it/s][A100%|██████████| 196/196 [00:00<00:00, 330.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  54%|█████▍    | 69/128 [1:50:04<1:37:25, 99.07s/it]EarlyStopping counter : 21 out of 40
training process:  55%|█████▍    | 70/128 [1:51:31<1:32:31, 95.71s/it]EarlyStopping counter : 22 out of 40
training process:  55%|█████▌    | 71/128 [1:52:59<1:28:37, 93.29s/it]EarlyStopping counter : 23 out of 40
training process:  56%|█████▋    | 72/128 [1:54:30<1:26:22, 92.55s/it]epoch : 73, train loss : -0.049, valid loss : -0.048, train acc : 0.997, valid acc : 0.996, train f1 : 0.902, valid f1 : 0.843

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 327.36it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 338.82it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 343.18it/s][A
 70%|███████   | 138/196 [00:00<00:00, 345.41it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 343.50it/s][A100%|██████████| 196/196 [00:00<00:00, 343.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  57%|█████▋    | 73/128 [1:56:24<1:30:44, 98.99s/it]EarlyStopping counter : 25 out of 40
training process:  58%|█████▊    | 74/128 [1:57:54<1:26:36, 96.23s/it]EarlyStopping counter : 26 out of 40
training process:  59%|█████▊    | 75/128 [1:59:23<1:23:11, 94.18s/it]EarlyStopping counter : 27 out of 40
training process:  59%|█████▉    | 76/128 [2:00:52<1:20:13, 92.56s/it]epoch : 77, train loss : -0.049, valid loss : -0.048, train acc : 0.997, valid acc : 0.996, train f1 : 0.906, valid f1 : 0.845

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 345.63it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 349.39it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 350.64it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 349.99it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 350.84it/s][A100%|██████████| 196/196 [00:00<00:00, 350.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  60%|██████    | 77/128 [2:02:46<1:24:06, 98.96s/it]EarlyStopping counter : 29 out of 40
training process:  61%|██████    | 78/128 [2:04:14<1:19:44, 95.70s/it]EarlyStopping counter : 30 out of 40
training process:  62%|██████▏   | 79/128 [2:05:45<1:17:01, 94.31s/it]EarlyStopping counter : 31 out of 40
training process:  62%|██████▎   | 80/128 [2:07:10<1:13:18, 91.63s/it]epoch : 81, train loss : -0.049, valid loss : -0.048, train acc : 0.997, valid acc : 0.995, train f1 : 0.910, valid f1 : 0.846

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 326.22it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 329.89it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 334.92it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 337.32it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 338.68it/s][A100%|██████████| 196/196 [00:00<00:00, 336.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  63%|██████▎   | 81/128 [2:09:04<1:17:01, 98.33s/it]EarlyStopping counter : 33 out of 40
training process:  64%|██████▍   | 82/128 [2:10:31<1:12:46, 94.92s/it]EarlyStopping counter : 34 out of 40
training process:  65%|██████▍   | 83/128 [2:12:01<1:10:03, 93.41s/it]EarlyStopping counter : 35 out of 40
training process:  66%|██████▌   | 84/128 [2:13:29<1:07:10, 91.60s/it]epoch : 85, train loss : -0.049, valid loss : -0.048, train acc : 0.997, valid acc : 0.995, train f1 : 0.912, valid f1 : 0.844

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.29it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.26it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 340.14it/s][A
 71%|███████   | 139/196 [00:00<00:00, 340.97it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 341.47it/s][A100%|██████████| 196/196 [00:00<00:00, 340.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  66%|██████▋   | 85/128 [2:15:22<1:10:22, 98.20s/it]EarlyStopping counter : 37 out of 40
training process:  67%|██████▋   | 86/128 [2:16:52<1:07:02, 95.77s/it]EarlyStopping counter : 38 out of 40
training process:  68%|██████▊   | 87/128 [2:18:21<1:04:05, 93.80s/it]EarlyStopping counter : 39 out of 40
training process:  69%|██████▉   | 88/128 [2:19:48<1:01:00, 91.52s/it]epoch : 89, train loss : -0.049, valid loss : -0.048, train acc : 0.997, valid acc : 0.996, train f1 : 0.916, valid f1 : 0.855

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 264.61it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 271.84it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 274.85it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 275.51it/s][A
 71%|███████   | 139/196 [00:00<00:00, 275.93it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 276.23it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 276.53it/s][A100%|██████████| 196/196 [00:00<00:00, 275.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 88, best f1 score : 0.872
training process:  69%|██████▉   | 88/128 [2:21:42<1:04:24, 96.62s/it]
training process finished, best loss : -0.048 and best acc : 0.996, best f1 : 0.872, best epoch : 48

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.74      0.52      0.61       152
           1       1.00      1.00      1.00     17031

    accuracy                           0.99     17183
   macro avg       0.87      0.76      0.80     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.80, test AUC : 0.76, test loss : -11.971

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:13<03:37, 13.59s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:02, 12.18s/it]processing for feature importance:  18%|█▊        | 3/17 [00:36<02:45, 11.83s/it]processing for feature importance:  24%|██▎       | 4/17 [00:49<02:39, 12.24s/it]processing for feature importance:  29%|██▉       | 5/17 [01:01<02:28, 12.36s/it]processing for feature importance:  35%|███▌      | 6/17 [01:13<02:13, 12.09s/it]processing for feature importance:  41%|████      | 7/17 [01:25<02:00, 12.01s/it]processing for feature importance:  47%|████▋     | 8/17 [01:36<01:45, 11.78s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:47<01:31, 11.48s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:58<01:20, 11.52s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:09<01:07, 11.33s/it]processing for feature importance:  71%|███████   | 12/17 [02:21<00:58, 11.61s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:33<00:46, 11.67s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:45<00:34, 11.64s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:57<00:23, 11.74s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:08<00:11, 11.67s/it]processing for feature importance: 100%|██████████| 17/17 [03:19<00:00, 11.46s/it]processing for feature importance: 100%|██████████| 17/17 [03:19<00:00, 11.75s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<11:39,  3.35s/it]visualize 2D latent space:   1%|          | 2/210 [00:03<05:30,  1.59s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<09:50,  2.84s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:10,  1.95s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:29,  1.36s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<13:38,  3.92s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:05<09:33,  2.76s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:17,  2.05s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<01:59,  1.80s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 16%|█▌        | 31/196 [00:00<00:00, 302.73it/s] 33%|███▎      | 65/196 [00:00<00:00, 324.14it/s] 51%|█████     | 99/196 [00:00<00:00, 331.05it/s] 68%|██████▊   | 133/196 [00:00<00:00, 334.47it/s] 85%|████████▌ | 167/196 [00:00<00:00, 336.30it/s]100%|██████████| 196/196 [00:00<00:00, 333.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_smoothing_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 206.38it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 203.42it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 201.57it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 203.90it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 205.67it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 208.54it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 210.76it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 212.23it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 209.73it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 209.08it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 208.74it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 207.48it/s]remove invalid data : null / measurement error:  45%|████▍     | 277/616 [00:01<00:01, 207.69it/s]remove invalid data : null / measurement error:  48%|████▊     | 298/616 [00:01<00:01, 207.07it/s]remove invalid data : null / measurement error:  52%|█████▏    | 319/616 [00:01<00:01, 206.29it/s]remove invalid data : null / measurement error:  55%|█████▌    | 340/616 [00:01<00:01, 205.90it/s]remove invalid data : null / measurement error:  59%|█████▊    | 361/616 [00:01<00:01, 206.41it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:01<00:01, 221.05it/s]remove invalid data : null / measurement error:  67%|██████▋   | 415/616 [00:01<00:00, 236.62it/s]remove invalid data : null / measurement error:  71%|███████▏  | 439/616 [00:02<00:00, 231.97it/s]remove invalid data : null / measurement error:  75%|███████▌  | 463/616 [00:02<00:00, 232.23it/s]remove invalid data : null / measurement error:  79%|███████▉  | 487/616 [00:02<00:00, 223.80it/s]remove invalid data : null / measurement error:  83%|████████▎ | 510/616 [00:02<00:00, 217.81it/s]remove invalid data : null / measurement error:  86%|████████▋ | 532/616 [00:02<00:00, 213.01it/s]remove invalid data : null / measurement error:  90%|████████▉ | 554/616 [00:02<00:00, 209.32it/s]remove invalid data : null / measurement error:  93%|█████████▎| 575/616 [00:02<00:00, 208.06it/s]remove invalid data : null / measurement error:  97%|█████████▋| 596/616 [00:02<00:00, 207.51it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.90it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 240.59it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 240.18it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 241.37it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 243.34it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 244.39it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 243.12it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 244.54it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 245.08it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 245.79it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 246.47it/s]replace nan value:  53%|█████▎    | 275/515 [00:01<00:00, 247.46it/s]replace nan value:  58%|█████▊    | 300/515 [00:01<00:00, 246.62it/s]replace nan value:  63%|██████▎   | 325/515 [00:01<00:00, 246.77it/s]replace nan value:  68%|██████▊   | 350/515 [00:01<00:00, 244.30it/s]replace nan value:  73%|███████▎  | 375/515 [00:01<00:00, 245.57it/s]replace nan value:  78%|███████▊  | 400/515 [00:01<00:00, 245.40it/s]replace nan value:  83%|████████▎ | 425/515 [00:01<00:00, 244.12it/s]replace nan value:  87%|████████▋ | 450/515 [00:01<00:00, 243.14it/s]replace nan value:  92%|█████████▏| 475/515 [00:01<00:00, 244.25it/s]replace nan value:  97%|█████████▋| 500/515 [00:02<00:00, 245.33it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 244.78it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.14it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.82it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.84it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.53it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.26it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.45it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.60it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.56it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.30it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.26it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.24it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.81it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.65it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.47it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 64.01it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.82it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.93it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.60it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.04it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.71it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.86it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.98it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.30it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.79it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.77it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.23it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.13it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 88.87it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 88.75it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.63it/s]generate index:  50%|█████     | 260/515 [00:03<00:03, 73.91it/s]generate index:  52%|█████▏    | 269/515 [00:03<00:03, 77.26it/s]generate index:  54%|█████▍    | 277/515 [00:04<00:03, 74.28it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 64.10it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 66.87it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 63.01it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 63.27it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 61.72it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 63.62it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 67.36it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 55.79it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.78it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 43.16it/s]generate index:  69%|██████▉   | 356/515 [00:05<00:03, 51.04it/s]generate index:  71%|███████▏  | 367/515 [00:05<00:02, 63.63it/s]generate index:  73%|███████▎  | 378/515 [00:05<00:01, 74.35it/s]generate index:  75%|███████▌  | 387/515 [00:05<00:01, 77.40it/s]generate index:  77%|███████▋  | 396/515 [00:05<00:01, 77.52it/s]generate index:  79%|███████▊  | 405/515 [00:06<00:01, 66.84it/s]generate index:  80%|████████  | 413/515 [00:06<00:01, 63.66it/s]generate index:  83%|████████▎ | 425/515 [00:06<00:01, 74.66it/s]generate index:  84%|████████▍ | 433/515 [00:06<00:01, 65.38it/s]generate index:  85%|████████▌ | 440/515 [00:06<00:01, 52.30it/s]generate index:  87%|████████▋ | 446/515 [00:06<00:01, 50.72it/s]generate index:  88%|████████▊ | 455/515 [00:06<00:01, 59.05it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.29it/s]generate index:  91%|█████████▏| 471/515 [00:07<00:00, 56.50it/s]generate index:  94%|█████████▎| 482/515 [00:07<00:00, 68.06it/s]generate index:  95%|█████████▌| 490/515 [00:07<00:00, 68.03it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 62.77it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.52it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 65.05it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   9%|▉         | 14/154 [00:00<00:01, 135.35it/s]remove invalid data : null / measurement error:  23%|██▎       | 35/154 [00:00<00:00, 177.30it/s]remove invalid data : null / measurement error:  37%|███▋      | 57/154 [00:00<00:00, 192.54it/s]remove invalid data : null / measurement error:  51%|█████▏    | 79/154 [00:00<00:00, 201.45it/s]remove invalid data : null / measurement error:  67%|██████▋   | 103/154 [00:00<00:00, 211.64it/s]remove invalid data : null / measurement error:  82%|████████▏ | 126/154 [00:00<00:00, 215.38it/s]remove invalid data : null / measurement error:  96%|█████████▌| 148/154 [00:00<00:00, 212.95it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 204.19it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 252.95it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 254.09it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 254.84it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 252.02it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 252.44it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 252.61it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 67.05it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.30it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.93it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.26it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.52it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.33it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.36it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.79it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 68.04it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 70.02it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.75it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.54it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.38it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.41it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 49.17it/s]generate index:  89%|████████▊ | 116/131 [00:02<00:00, 58.55it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 70.76it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.18it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   7%|▋         | 13/193 [00:00<00:01, 128.69it/s]remove invalid data : null / measurement error:  18%|█▊        | 34/193 [00:00<00:00, 174.83it/s]remove invalid data : null / measurement error:  29%|██▉       | 56/193 [00:00<00:00, 191.65it/s]remove invalid data : null / measurement error:  40%|████      | 78/193 [00:00<00:00, 201.16it/s]remove invalid data : null / measurement error:  52%|█████▏    | 100/193 [00:00<00:00, 205.22it/s]remove invalid data : null / measurement error:  64%|██████▍   | 124/193 [00:00<00:00, 214.61it/s]remove invalid data : null / measurement error:  76%|███████▌  | 147/193 [00:00<00:00, 219.36it/s]remove invalid data : null / measurement error:  88%|████████▊ | 169/193 [00:00<00:00, 215.03it/s]remove invalid data : null / measurement error:  99%|█████████▉| 191/193 [00:00<00:00, 212.31it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 205.56it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 250.39it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 254.08it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 254.44it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 252.38it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 252.75it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 253.25it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 253.00it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.76it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.27it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.44it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.93it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.83it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.05it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.68it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.10it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.44it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.36it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.01it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.31it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.07it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.81it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.33it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.06it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.34it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.71it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.97it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : -0.010, train acc : 0.748, valid acc : 0.832, train f1 : 0.748, valid f1 : 0.483

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 344.61it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 346.69it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 347.67it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 347.47it/s][A
 90%|████████▉ | 176/196 [00:00<00:00, 349.30it/s][A100%|██████████| 196/196 [00:00<00:00, 349.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.483
training process:   1%|          | 1/128 [01:59<4:12:18, 119.20s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:30<3:35:17, 102.52s/it]Best score increase :0.483 -> 0.506
training process:   2%|▏         | 3/128 [05:01<3:23:21, 97.61s/it] Best score increase :0.506 -> 0.512
training process:   3%|▎         | 4/128 [06:33<3:16:50, 95.24s/it]epoch : 5, train loss : -0.032, valid loss : -0.009, train acc : 0.945, valid acc : 0.897, train f1 : 0.945, valid f1 : 0.527

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.86it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.68it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.90it/s][A
 70%|███████   | 138/196 [00:00<00:00, 341.92it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 342.67it/s][A100%|██████████| 196/196 [00:00<00:00, 341.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.512 -> 0.527
training process:   4%|▍         | 5/128 [08:33<3:33:15, 104.03s/it]Best score increase :0.527 -> 0.547
training process:   5%|▍         | 6/128 [10:06<3:24:11, 100.42s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:41<3:18:55, 98.64s/it] Best score increase :0.547 -> 0.549
training process:   6%|▋         | 8/128 [13:11<3:12:07, 96.06s/it]epoch : 9, train loss : -0.040, valid loss : -0.021, train acc : 0.975, valid acc : 0.935, train f1 : 0.975, valid f1 : 0.562

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 317.86it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.34it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 334.53it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 333.04it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 334.28it/s][A100%|██████████| 196/196 [00:00<00:00, 333.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.549 -> 0.562
training process:   7%|▋         | 9/128 [15:11<3:24:46, 103.25s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:41<3:15:06, 99.21s/it]Best score increase :0.562 -> 0.585
training process:   9%|▊         | 11/128 [18:14<3:10:13, 97.55s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [19:46<3:04:54, 95.64s/it]epoch : 13, train loss : -0.044, valid loss : -0.031, train acc : 0.983, valid acc : 0.952, train f1 : 0.983, valid f1 : 0.584

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.90it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.43it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 340.68it/s][A
 71%|███████   | 139/196 [00:00<00:00, 342.22it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 343.38it/s][A100%|██████████| 196/196 [00:00<00:00, 341.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  10%|█         | 13/128 [21:44<3:16:14, 102.39s/it]EarlyStopping counter : 3 out of 40
training process:  11%|█         | 14/128 [23:17<3:09:26, 99.71s/it] EarlyStopping counter : 4 out of 40
training process:  12%|█▏        | 15/128 [24:50<3:03:54, 97.65s/it]Best score increase :0.585 -> 0.630
training process:  12%|█▎        | 16/128 [26:25<3:00:51, 96.89s/it]epoch : 17, train loss : -0.045, valid loss : -0.036, train acc : 0.988, valid acc : 0.961, train f1 : 0.988, valid f1 : 0.605

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 318.29it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 332.74it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 338.07it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 341.01it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 343.30it/s][A100%|██████████| 196/196 [00:00<00:00, 340.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:23<3:10:50, 103.16s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [29:56<3:03:22, 100.02s/it]EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [31:28<2:57:47, 97.87s/it] EarlyStopping counter : 4 out of 40
training process:  16%|█▌        | 20/128 [33:02<2:53:32, 96.41s/it]epoch : 21, train loss : -0.046, valid loss : -0.028, train acc : 0.991, valid acc : 0.951, train f1 : 0.991, valid f1 : 0.581

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 333.81it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.28it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 339.12it/s][A
 71%|███████   | 139/196 [00:00<00:00, 339.70it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 340.11it/s][A100%|██████████| 196/196 [00:00<00:00, 339.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  16%|█▋        | 21/128 [35:00<3:03:40, 103.00s/it]EarlyStopping counter : 6 out of 40
training process:  17%|█▋        | 22/128 [36:34<2:57:02, 100.21s/it]EarlyStopping counter : 7 out of 40
training process:  18%|█▊        | 23/128 [38:08<2:52:17, 98.45s/it] EarlyStopping counter : 8 out of 40
training process:  19%|█▉        | 24/128 [39:41<2:47:40, 96.73s/it]epoch : 25, train loss : -0.047, valid loss : -0.037, train acc : 0.993, valid acc : 0.971, train f1 : 0.993, valid f1 : 0.632

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 306.30it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 325.80it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.13it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.96it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 338.76it/s][A100%|██████████| 196/196 [00:00<00:00, 335.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.630 -> 0.632
training process:  20%|█▉        | 25/128 [41:38<2:56:42, 102.93s/it]EarlyStopping counter : 1 out of 40
training process:  20%|██        | 26/128 [43:09<2:48:48, 99.30s/it] EarlyStopping counter : 2 out of 40
training process:  21%|██        | 27/128 [44:44<2:44:57, 97.99s/it]EarlyStopping counter : 3 out of 40
training process:  22%|██▏       | 28/128 [46:19<2:41:47, 97.07s/it]epoch : 29, train loss : -0.048, valid loss : -0.036, train acc : 0.994, valid acc : 0.961, train f1 : 0.994, valid f1 : 0.606

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 321.92it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 333.15it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.42it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 336.60it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 338.62it/s][A100%|██████████| 196/196 [00:00<00:00, 337.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 29/128 [48:16<2:50:05, 103.08s/it]EarlyStopping counter : 5 out of 40
training process:  23%|██▎       | 30/128 [49:47<2:42:32, 99.51s/it] EarlyStopping counter : 6 out of 40
training process:  24%|██▍       | 31/128 [51:18<2:36:57, 97.09s/it]EarlyStopping counter : 7 out of 40
training process:  25%|██▌       | 32/128 [52:52<2:33:37, 96.02s/it]epoch : 33, train loss : -0.048, valid loss : -0.037, train acc : 0.995, valid acc : 0.968, train f1 : 0.995, valid f1 : 0.630

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 314.55it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 326.88it/s][A
 51%|█████     | 100/196 [00:00<00:00, 331.82it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 334.32it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 335.68it/s][A100%|██████████| 196/196 [00:00<00:00, 333.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  26%|██▌       | 33/128 [54:51<2:43:08, 103.04s/it]EarlyStopping counter : 9 out of 40
training process:  27%|██▋       | 34/128 [56:23<2:36:00, 99.58s/it] Best score increase :0.632 -> 0.642
training process:  27%|██▋       | 35/128 [57:56<2:31:28, 97.72s/it]EarlyStopping counter : 1 out of 40
training process:  28%|██▊       | 36/128 [59:29<2:27:23, 96.12s/it]epoch : 37, train loss : -0.049, valid loss : -0.044, train acc : 0.996, valid acc : 0.981, train f1 : 0.996, valid f1 : 0.691

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 331.27it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 338.07it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 341.08it/s][A
 71%|███████   | 139/196 [00:00<00:00, 342.67it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 343.98it/s][A100%|██████████| 196/196 [00:00<00:00, 342.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.642 -> 0.691
training process:  29%|██▉       | 37/128 [1:01:29<2:36:40, 103.30s/it]EarlyStopping counter : 1 out of 40
training process:  30%|██▉       | 38/128 [1:03:03<2:30:55, 100.62s/it]EarlyStopping counter : 2 out of 40
training process:  30%|███       | 39/128 [1:04:37<2:26:24, 98.70s/it] EarlyStopping counter : 3 out of 40
training process:  31%|███▏      | 40/128 [1:06:10<2:22:14, 96.99s/it]epoch : 41, train loss : -0.049, valid loss : -0.041, train acc : 0.995, valid acc : 0.974, train f1 : 0.995, valid f1 : 0.646

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.66it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.67it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.38it/s][A
 70%|███████   | 138/196 [00:00<00:00, 340.66it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 341.56it/s][A100%|██████████| 196/196 [00:00<00:00, 340.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  32%|███▏      | 41/128 [1:08:11<2:30:57, 104.10s/it]EarlyStopping counter : 5 out of 40
training process:  33%|███▎      | 42/128 [1:09:45<2:24:41, 100.95s/it]EarlyStopping counter : 6 out of 40
training process:  34%|███▎      | 43/128 [1:11:18<2:19:51, 98.72s/it] EarlyStopping counter : 7 out of 40
training process:  34%|███▍      | 44/128 [1:12:49<2:14:47, 96.28s/it]epoch : 45, train loss : -0.049, valid loss : -0.039, train acc : 0.997, valid acc : 0.971, train f1 : 0.997, valid f1 : 0.634

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 340.85it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 346.83it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 349.51it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 351.29it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 352.37it/s][A100%|██████████| 196/196 [00:00<00:00, 350.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  35%|███▌      | 45/128 [1:14:47<2:22:29, 103.00s/it]EarlyStopping counter : 9 out of 40
training process:  36%|███▌      | 46/128 [1:16:21<2:16:49, 100.11s/it]EarlyStopping counter : 10 out of 40
training process:  37%|███▋      | 47/128 [1:17:53<2:11:59, 97.77s/it] EarlyStopping counter : 11 out of 40
training process:  38%|███▊      | 48/128 [1:19:25<2:08:11, 96.15s/it]epoch : 49, train loss : -0.049, valid loss : -0.032, train acc : 0.997, valid acc : 0.957, train f1 : 0.997, valid f1 : 0.599

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 323.80it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.49it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 331.68it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 334.47it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 335.86it/s][A100%|██████████| 196/196 [00:00<00:00, 334.36it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  38%|███▊      | 49/128 [1:21:23<2:15:10, 102.66s/it]EarlyStopping counter : 13 out of 40
training process:  39%|███▉      | 50/128 [1:22:56<2:09:38, 99.73s/it] EarlyStopping counter : 14 out of 40
training process:  40%|███▉      | 51/128 [1:24:27<2:04:43, 97.19s/it]EarlyStopping counter : 15 out of 40
training process:  41%|████      | 52/128 [1:26:00<2:01:19, 95.78s/it]epoch : 53, train loss : -0.049, valid loss : -0.040, train acc : 0.997, valid acc : 0.974, train f1 : 0.997, valid f1 : 0.651

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 339.58it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 344.57it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 346.43it/s][A
 71%|███████   | 139/196 [00:00<00:00, 346.90it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 346.91it/s][A100%|██████████| 196/196 [00:00<00:00, 346.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  41%|████▏     | 53/128 [1:28:00<2:08:53, 103.11s/it]EarlyStopping counter : 17 out of 40
training process:  42%|████▏     | 54/128 [1:29:32<2:03:06, 99.82s/it] EarlyStopping counter : 18 out of 40
training process:  43%|████▎     | 55/128 [1:31:03<1:58:01, 97.01s/it]EarlyStopping counter : 19 out of 40
training process:  44%|████▍     | 56/128 [1:32:35<1:54:45, 95.64s/it]epoch : 57, train loss : -0.049, valid loss : -0.042, train acc : 0.997, valid acc : 0.980, train f1 : 0.997, valid f1 : 0.678

  0%|          | 0/196 [00:00<?, ?it/s][A
 10%|▉         | 19/196 [00:00<00:00, 188.92it/s][A
 25%|██▌       | 49/196 [00:00<00:00, 252.21it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 287.09it/s][A
 59%|█████▉    | 116/196 [00:00<00:00, 304.31it/s][A
 77%|███████▋  | 150/196 [00:00<00:00, 313.91it/s][A
 94%|█████████▍| 184/196 [00:00<00:00, 319.82it/s][A100%|██████████| 196/196 [00:00<00:00, 302.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  45%|████▍     | 57/128 [1:34:34<2:01:17, 102.50s/it]EarlyStopping counter : 21 out of 40
training process:  45%|████▌     | 58/128 [1:36:04<1:55:15, 98.79s/it] EarlyStopping counter : 22 out of 40
training process:  46%|████▌     | 59/128 [1:37:35<1:50:49, 96.37s/it]EarlyStopping counter : 23 out of 40
training process:  47%|████▋     | 60/128 [1:39:09<1:48:23, 95.64s/it]epoch : 61, train loss : -0.050, valid loss : -0.035, train acc : 0.998, valid acc : 0.966, train f1 : 0.998, valid f1 : 0.624

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 317.98it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 330.10it/s][A
 51%|█████     | 100/196 [00:00<00:00, 334.41it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 336.45it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 337.47it/s][A100%|██████████| 196/196 [00:00<00:00, 335.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  48%|████▊     | 61/128 [1:41:06<1:54:07, 102.20s/it]EarlyStopping counter : 25 out of 40
training process:  48%|████▊     | 62/128 [1:42:39<1:49:17, 99.35s/it] EarlyStopping counter : 26 out of 40
training process:  49%|████▉     | 63/128 [1:44:11<1:45:29, 97.38s/it]Best score increase :0.691 -> 0.726
training process:  50%|█████     | 64/128 [1:45:45<1:42:38, 96.23s/it]epoch : 65, train loss : -0.049, valid loss : -0.040, train acc : 0.997, valid acc : 0.975, train f1 : 0.997, valid f1 : 0.655

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 322.35it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 327.21it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 332.29it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 335.15it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 336.73it/s][A100%|██████████| 196/196 [00:00<00:00, 334.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  51%|█████     | 65/128 [1:47:42<1:47:34, 102.45s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 66/128 [1:49:14<1:42:33, 99.25s/it] EarlyStopping counter : 3 out of 40
training process:  52%|█████▏    | 67/128 [1:50:45<1:38:21, 96.75s/it]EarlyStopping counter : 4 out of 40
training process:  53%|█████▎    | 68/128 [1:52:17<1:35:33, 95.55s/it]epoch : 69, train loss : -0.050, valid loss : -0.043, train acc : 0.998, valid acc : 0.981, train f1 : 0.998, valid f1 : 0.688

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 251.90it/s][A
 28%|██▊       | 54/196 [00:00<00:00, 263.53it/s][A
 42%|████▏     | 82/196 [00:00<00:00, 267.90it/s][A
 56%|█████▌    | 110/196 [00:00<00:00, 270.68it/s][A
 70%|███████   | 138/196 [00:00<00:00, 272.37it/s][A
 85%|████████▍ | 166/196 [00:00<00:00, 271.97it/s][A
 99%|█████████▉| 194/196 [00:00<00:00, 272.86it/s][A100%|██████████| 196/196 [00:00<00:00, 270.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  54%|█████▍    | 69/128 [1:54:18<1:41:11, 102.91s/it]EarlyStopping counter : 6 out of 40
training process:  55%|█████▍    | 70/128 [1:55:50<1:36:33, 99.90s/it] EarlyStopping counter : 7 out of 40
training process:  55%|█████▌    | 71/128 [1:57:21<1:32:11, 97.05s/it]EarlyStopping counter : 8 out of 40
training process:  56%|█████▋    | 72/128 [1:58:54<1:29:28, 95.86s/it]epoch : 73, train loss : -0.050, valid loss : -0.042, train acc : 0.998, valid acc : 0.978, train f1 : 0.998, valid f1 : 0.667

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 329.49it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 334.14it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 337.21it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 339.29it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 340.72it/s][A100%|██████████| 196/196 [00:00<00:00, 339.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  57%|█████▋    | 73/128 [2:00:56<1:35:03, 103.70s/it]EarlyStopping counter : 10 out of 40
training process:  58%|█████▊    | 74/128 [2:02:27<1:30:02, 100.05s/it]EarlyStopping counter : 11 out of 40
training process:  59%|█████▊    | 75/128 [2:03:59<1:26:06, 97.49s/it] Best score increase :0.726 -> 0.739
training process:  59%|█████▉    | 76/128 [2:05:32<1:23:22, 96.20s/it]epoch : 77, train loss : -0.050, valid loss : -0.043, train acc : 0.998, valid acc : 0.980, train f1 : 0.998, valid f1 : 0.686

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 325.01it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 335.58it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 339.75it/s][A
 70%|███████   | 138/196 [00:00<00:00, 342.04it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 343.25it/s][A100%|██████████| 196/196 [00:00<00:00, 341.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  60%|██████    | 77/128 [2:07:31<1:27:31, 102.98s/it]EarlyStopping counter : 2 out of 40
training process:  61%|██████    | 78/128 [2:09:02<1:22:53, 99.47s/it] EarlyStopping counter : 3 out of 40
training process:  62%|██████▏   | 79/128 [2:10:36<1:19:50, 97.76s/it]EarlyStopping counter : 4 out of 40
training process:  62%|██████▎   | 80/128 [2:12:06<1:16:19, 95.41s/it]epoch : 81, train loss : -0.050, valid loss : -0.045, train acc : 0.998, valid acc : 0.989, train f1 : 0.998, valid f1 : 0.755

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 334.25it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.33it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 343.00it/s][A
 71%|███████   | 139/196 [00:00<00:00, 344.48it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 345.37it/s][A100%|██████████| 196/196 [00:00<00:00, 344.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.739 -> 0.755
training process:  63%|██████▎   | 81/128 [2:14:03<1:19:46, 101.84s/it]EarlyStopping counter : 1 out of 40
training process:  64%|██████▍   | 82/128 [2:15:34<1:15:41, 98.72s/it] EarlyStopping counter : 2 out of 40
training process:  65%|██████▍   | 83/128 [2:17:07<1:12:45, 97.02s/it]EarlyStopping counter : 3 out of 40
training process:  66%|██████▌   | 84/128 [2:18:39<1:10:01, 95.49s/it]epoch : 85, train loss : -0.050, valid loss : -0.040, train acc : 0.999, valid acc : 0.979, train f1 : 0.999, valid f1 : 0.674

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 324.11it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 332.39it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 335.01it/s][A
 69%|██████▉   | 135/196 [00:00<00:00, 336.51it/s][A
 86%|████████▌ | 169/196 [00:00<00:00, 337.23it/s][A100%|██████████| 196/196 [00:00<00:00, 336.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  66%|██████▋   | 85/128 [2:20:37<1:13:12, 102.15s/it]EarlyStopping counter : 5 out of 40
training process:  67%|██████▋   | 86/128 [2:22:09<1:09:19, 99.04s/it] EarlyStopping counter : 6 out of 40
training process:  68%|██████▊   | 87/128 [2:23:42<1:06:35, 97.45s/it]EarlyStopping counter : 7 out of 40
training process:  69%|██████▉   | 88/128 [2:25:14<1:03:48, 95.72s/it]epoch : 89, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.988, train f1 : 0.999, valid f1 : 0.739

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 326.90it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 335.57it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 337.32it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 339.87it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 341.33it/s][A100%|██████████| 196/196 [00:00<00:00, 339.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  70%|██████▉   | 89/128 [2:27:10<1:06:07, 101.73s/it]EarlyStopping counter : 9 out of 40
training process:  70%|███████   | 90/128 [2:28:42<1:02:37, 98.88s/it] EarlyStopping counter : 10 out of 40
training process:  71%|███████   | 91/128 [2:30:15<59:57, 97.22s/it]  EarlyStopping counter : 11 out of 40
training process:  72%|███████▏  | 92/128 [2:31:47<57:20, 95.57s/it]epoch : 93, train loss : -0.050, valid loss : -0.037, train acc : 0.999, valid acc : 0.972, train f1 : 0.999, valid f1 : 0.645

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 319.44it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 329.11it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.03it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 335.05it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 336.18it/s][A100%|██████████| 196/196 [00:00<00:00, 329.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  73%|███████▎  | 93/128 [2:33:47<59:57, 102.77s/it]EarlyStopping counter : 13 out of 40
training process:  73%|███████▎  | 94/128 [2:35:17<56:11, 99.15s/it] EarlyStopping counter : 14 out of 40
training process:  74%|███████▍  | 95/128 [2:36:49<53:14, 96.82s/it]EarlyStopping counter : 15 out of 40
training process:  75%|███████▌  | 96/128 [2:38:20<50:49, 95.28s/it]epoch : 97, train loss : -0.050, valid loss : -0.042, train acc : 0.999, valid acc : 0.983, train f1 : 0.999, valid f1 : 0.699

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 307.77it/s][A
 33%|███▎      | 65/196 [00:00<00:00, 322.33it/s][A
 51%|█████     | 99/196 [00:00<00:00, 326.53it/s][A
 68%|██████▊   | 133/196 [00:00<00:00, 330.53it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 330.21it/s][A100%|██████████| 196/196 [00:00<00:00, 326.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  76%|███████▌  | 97/128 [2:40:21<53:11, 102.96s/it]EarlyStopping counter : 17 out of 40
training process:  77%|███████▋  | 98/128 [2:41:55<50:03, 100.12s/it]EarlyStopping counter : 18 out of 40
training process:  77%|███████▋  | 99/128 [2:43:28<47:23, 98.04s/it] EarlyStopping counter : 19 out of 40
training process:  78%|███████▊  | 100/128 [2:45:01<45:02, 96.51s/it]epoch : 101, train loss : -0.050, valid loss : -0.038, train acc : 0.999, valid acc : 0.973, train f1 : 0.999, valid f1 : 0.647

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 321.16it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 332.72it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 337.35it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.51it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 340.55it/s][A100%|██████████| 196/196 [00:00<00:00, 338.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  79%|███████▉  | 101/128 [2:47:01<46:32, 103.44s/it]EarlyStopping counter : 21 out of 40
training process:  80%|███████▉  | 102/128 [2:48:36<43:48, 101.10s/it]EarlyStopping counter : 22 out of 40
training process:  80%|████████  | 103/128 [2:50:07<40:52, 98.08s/it] EarlyStopping counter : 23 out of 40
training process:  81%|████████▏ | 104/128 [2:51:39<38:28, 96.20s/it]epoch : 105, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.987, train f1 : 0.999, valid f1 : 0.731

  0%|          | 0/196 [00:00<?, ?it/s][A
 14%|█▍        | 27/196 [00:00<00:00, 267.66it/s][A
 28%|██▊       | 55/196 [00:00<00:00, 272.06it/s][A
 42%|████▏     | 83/196 [00:00<00:00, 272.79it/s][A
 57%|█████▋    | 111/196 [00:00<00:00, 273.19it/s][A
 71%|███████   | 139/196 [00:00<00:00, 273.36it/s][A
 85%|████████▌ | 167/196 [00:00<00:00, 273.39it/s][A
 99%|█████████▉| 195/196 [00:00<00:00, 273.72it/s][A100%|██████████| 196/196 [00:00<00:00, 273.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  82%|████████▏ | 105/128 [2:53:36<39:14, 102.36s/it]EarlyStopping counter : 25 out of 40
training process:  83%|████████▎ | 106/128 [2:55:07<36:20, 99.09s/it] EarlyStopping counter : 26 out of 40
training process:  84%|████████▎ | 107/128 [2:56:39<33:52, 96.80s/it]EarlyStopping counter : 27 out of 40
training process:  84%|████████▍ | 108/128 [2:58:13<31:58, 95.93s/it]epoch : 109, train loss : -0.050, valid loss : -0.044, train acc : 0.999, valid acc : 0.983, train f1 : 0.999, valid f1 : 0.699

  0%|          | 0/196 [00:00<?, ?it/s][A
 13%|█▎        | 26/196 [00:00<00:00, 258.65it/s][A
 27%|██▋       | 53/196 [00:00<00:00, 262.21it/s][A
 41%|████▏     | 81/196 [00:00<00:00, 267.72it/s][A
 56%|█████▌    | 109/196 [00:00<00:00, 271.14it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 273.84it/s][A
 84%|████████▍ | 165/196 [00:00<00:00, 275.46it/s][A
 98%|█████████▊| 193/196 [00:00<00:00, 276.64it/s][A100%|██████████| 196/196 [00:00<00:00, 272.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  85%|████████▌ | 109/128 [3:00:08<32:13, 101.78s/it]EarlyStopping counter : 29 out of 40
training process:  86%|████████▌ | 110/128 [3:01:40<29:39, 98.84s/it] EarlyStopping counter : 30 out of 40
training process:  87%|████████▋ | 111/128 [3:03:10<27:16, 96.28s/it]EarlyStopping counter : 31 out of 40
training process:  88%|████████▊ | 112/128 [3:04:42<25:20, 95.02s/it]epoch : 113, train loss : -0.050, valid loss : -0.044, train acc : 0.999, valid acc : 0.984, train f1 : 0.999, valid f1 : 0.705

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 315.32it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 328.02it/s][A
 51%|█████     | 100/196 [00:00<00:00, 333.06it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 335.58it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 337.16it/s][A100%|██████████| 196/196 [00:00<00:00, 334.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  88%|████████▊ | 113/128 [3:06:43<25:41, 102.79s/it]EarlyStopping counter : 33 out of 40
training process:  89%|████████▉ | 114/128 [3:08:15<23:10, 99.35s/it] EarlyStopping counter : 34 out of 40
training process:  90%|████████▉ | 115/128 [3:09:46<21:01, 97.03s/it]EarlyStopping counter : 35 out of 40
training process:  91%|█████████ | 116/128 [3:11:19<19:10, 95.86s/it]epoch : 117, train loss : -0.050, valid loss : -0.042, train acc : 0.999, valid acc : 0.984, train f1 : 0.999, valid f1 : 0.707

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▋        | 32/196 [00:00<00:00, 312.93it/s][A
 34%|███▎      | 66/196 [00:00<00:00, 328.42it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 334.08it/s][A
 69%|██████▉   | 136/196 [00:00<00:00, 336.85it/s][A
 87%|████████▋ | 170/196 [00:00<00:00, 335.36it/s][A100%|██████████| 196/196 [00:00<00:00, 334.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  91%|█████████▏| 117/128 [3:13:17<18:47, 102.48s/it]EarlyStopping counter : 37 out of 40
training process:  92%|█████████▏| 118/128 [3:14:49<16:30, 99.10s/it] EarlyStopping counter : 38 out of 40
training process:  93%|█████████▎| 119/128 [3:16:21<14:34, 97.17s/it]EarlyStopping counter : 39 out of 40
training process:  94%|█████████▍| 120/128 [3:17:54<12:46, 95.80s/it]epoch : 121, train loss : -0.050, valid loss : -0.044, train acc : 0.999, valid acc : 0.986, train f1 : 0.999, valid f1 : 0.721

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 323.74it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 333.39it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 336.77it/s][A
 70%|███████   | 138/196 [00:00<00:00, 338.88it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 339.92it/s][A100%|██████████| 196/196 [00:00<00:00, 338.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 120, best f1 score : 0.755
training process:  94%|█████████▍| 120/128 [3:19:56<13:19, 99.97s/it]
training process finished, best loss : -0.045 and best acc : 0.989, best f1 : 0.755, best epoch : 80

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.44      0.53      0.48       152
           1       1.00      0.99      0.99     17031

    accuracy                           0.99     17183
   macro avg       0.72      0.76      0.74     17183
weighted avg       0.99      0.99      0.99     17183


# test acc : 0.99, test f1 : 0.74, test AUC : 0.76, test loss : -11.659

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:09, 11.86s/it]processing for feature importance:  12%|█▏        | 2/17 [00:25<03:12, 12.83s/it]processing for feature importance:  18%|█▊        | 3/17 [00:38<03:02, 13.02s/it]processing for feature importance:  24%|██▎       | 4/17 [00:50<02:45, 12.76s/it]processing for feature importance:  29%|██▉       | 5/17 [01:03<02:33, 12.82s/it]processing for feature importance:  35%|███▌      | 6/17 [01:17<02:24, 13.10s/it]processing for feature importance:  41%|████      | 7/17 [01:29<02:08, 12.86s/it]processing for feature importance:  47%|████▋     | 8/17 [01:42<01:55, 12.85s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:55<01:42, 12.76s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:10<01:33, 13.37s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:23<01:19, 13.26s/it]processing for feature importance:  71%|███████   | 12/17 [02:35<01:05, 13.04s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:47<00:51, 12.84s/it]processing for feature importance:  82%|████████▏ | 14/17 [03:00<00:37, 12.66s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:13<00:25, 12.84s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:26<00:12, 12.83s/it]processing for feature importance: 100%|██████████| 17/17 [03:40<00:00, 13.15s/it]processing for feature importance: 100%|██████████| 17/17 [03:40<00:00, 12.95s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<12:19,  3.54s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<09:00,  2.60s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:01,  1.81s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:44,  1.58s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:03<11:18,  3.25s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<04:59,  1.44s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:05<08:55,  2.57s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:30,  1.37s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 16%|█▋        | 32/196 [00:00<00:00, 312.38it/s] 34%|███▍      | 67/196 [00:00<00:00, 331.55it/s] 52%|█████▏    | 102/196 [00:00<00:00, 338.17it/s] 70%|██████▉   | 137/196 [00:00<00:00, 341.30it/s] 88%|████████▊ | 172/196 [00:00<00:00, 343.23it/s]100%|██████████| 196/196 [00:00<00:00, 339.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_smoothing_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 199.91it/s]remove invalid data : null / measurement error:   7%|▋         | 41/616 [00:00<00:02, 198.14it/s]remove invalid data : null / measurement error:  10%|▉         | 61/616 [00:00<00:02, 196.40it/s]remove invalid data : null / measurement error:  13%|█▎        | 82/616 [00:00<00:02, 198.52it/s]remove invalid data : null / measurement error:  17%|█▋        | 103/616 [00:00<00:02, 200.68it/s]remove invalid data : null / measurement error:  20%|██        | 125/616 [00:00<00:02, 203.86it/s]remove invalid data : null / measurement error:  24%|██▎       | 146/616 [00:00<00:02, 205.67it/s]remove invalid data : null / measurement error:  27%|██▋       | 168/616 [00:00<00:02, 207.96it/s]remove invalid data : null / measurement error:  31%|███       | 189/616 [00:00<00:02, 205.60it/s]remove invalid data : null / measurement error:  34%|███▍      | 210/616 [00:01<00:01, 204.47it/s]remove invalid data : null / measurement error:  38%|███▊      | 231/616 [00:01<00:01, 205.16it/s]remove invalid data : null / measurement error:  41%|████      | 252/616 [00:01<00:01, 204.41it/s]remove invalid data : null / measurement error:  44%|████▍     | 273/616 [00:01<00:01, 205.41it/s]remove invalid data : null / measurement error:  48%|████▊     | 294/616 [00:01<00:01, 204.25it/s]remove invalid data : null / measurement error:  51%|█████     | 315/616 [00:01<00:01, 202.79it/s]remove invalid data : null / measurement error:  55%|█████▍    | 336/616 [00:01<00:01, 202.26it/s]remove invalid data : null / measurement error:  58%|█████▊    | 357/616 [00:01<00:01, 201.72it/s]remove invalid data : null / measurement error:  62%|██████▏   | 382/616 [00:01<00:01, 215.59it/s]remove invalid data : null / measurement error:  66%|██████▌   | 408/616 [00:01<00:00, 227.64it/s]remove invalid data : null / measurement error:  70%|███████   | 432/616 [00:02<00:00, 228.68it/s]remove invalid data : null / measurement error:  74%|███████▍  | 456/616 [00:02<00:00, 231.34it/s]remove invalid data : null / measurement error:  78%|███████▊  | 480/616 [00:02<00:00, 223.36it/s]remove invalid data : null / measurement error:  82%|████████▏ | 503/616 [00:02<00:00, 216.27it/s]remove invalid data : null / measurement error:  85%|████████▌ | 525/616 [00:02<00:00, 213.37it/s]remove invalid data : null / measurement error:  89%|████████▉ | 547/616 [00:02<00:00, 209.96it/s]remove invalid data : null / measurement error:  92%|█████████▏| 569/616 [00:02<00:00, 208.50it/s]remove invalid data : null / measurement error:  96%|█████████▌| 590/616 [00:02<00:00, 207.71it/s]remove invalid data : null / measurement error:  99%|█████████▉| 611/616 [00:02<00:00, 206.62it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 208.92it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 234.43it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 233.86it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 234.24it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 236.47it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 237.66it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 239.13it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 239.95it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 240.07it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 240.23it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 240.87it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:01, 241.64it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 241.74it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 241.52it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 238.67it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 239.25it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 240.02it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 239.48it/s]replace nan value:  87%|████████▋ | 446/515 [00:01<00:00, 237.83it/s]replace nan value:  91%|█████████▏| 470/515 [00:01<00:00, 238.43it/s]replace nan value:  96%|█████████▌| 495/515 [00:02<00:00, 239.17it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 239.09it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.71it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.03it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.60it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 71.45it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.53it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.06it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.86it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.09it/s]generate index:  14%|█▎        | 70/515 [00:01<00:08, 52.07it/s]generate index:  15%|█▍        | 76/515 [00:01<00:08, 52.46it/s]generate index:  17%|█▋        | 86/515 [00:01<00:06, 63.56it/s]generate index:  18%|█▊        | 93/515 [00:01<00:07, 59.76it/s]generate index:  19%|█▉        | 100/515 [00:01<00:07, 56.71it/s]generate index:  21%|██        | 107/515 [00:01<00:06, 58.65it/s]generate index:  23%|██▎       | 116/515 [00:01<00:06, 65.98it/s]generate index:  24%|██▍       | 123/515 [00:02<00:06, 64.15it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 68.36it/s]generate index:  27%|██▋       | 139/515 [00:02<00:05, 68.57it/s]generate index:  28%|██▊       | 146/515 [00:02<00:05, 67.43it/s]generate index:  30%|██▉       | 154/515 [00:02<00:05, 68.80it/s]generate index:  32%|███▏      | 163/515 [00:02<00:04, 73.92it/s]generate index:  33%|███▎      | 171/515 [00:02<00:05, 67.39it/s]generate index:  35%|███▍      | 178/515 [00:02<00:05, 65.42it/s]generate index:  37%|███▋      | 188/515 [00:02<00:04, 69.64it/s]generate index:  38%|███▊      | 196/515 [00:03<00:04, 67.97it/s]generate index:  39%|███▉      | 203/515 [00:03<00:04, 63.12it/s]generate index:  42%|████▏     | 215/515 [00:03<00:03, 77.47it/s]generate index:  43%|████▎     | 224/515 [00:03<00:04, 70.96it/s]generate index:  46%|████▌     | 236/515 [00:03<00:03, 83.16it/s]generate index:  48%|████▊     | 246/515 [00:03<00:03, 87.46it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 67.96it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 73.19it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 75.67it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 62.89it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.10it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 61.66it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 60.60it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 60.38it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 59.71it/s]generate index:  64%|██████▎   | 328/515 [00:05<00:02, 63.28it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.20it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.34it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 45.42it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.34it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.39it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 71.41it/s]generate index:  74%|███████▍  | 383/515 [00:06<00:01, 73.30it/s]generate index:  76%|███████▌  | 391/515 [00:06<00:01, 69.18it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 73.56it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.25it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 63.74it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.60it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.31it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.92it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.58it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.19it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.13it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 65.67it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 63.46it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 60.86it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 68.12it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.77it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 69.28it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 149.53it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 175.56it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 190.00it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 196.06it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 210.87it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 208.23it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 193.28it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 245.99it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 247.86it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 248.28it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 245.55it/s]replace nan value:  96%|█████████▌| 126/131 [00:00<00:00, 247.80it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 247.50it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.89it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.86it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.45it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.20it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.02it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.11it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.31it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 62.42it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.36it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.20it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 62.62it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.26it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.29it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 45.86it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.29it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 54.93it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 63.45it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.71it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 98.26it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:01, 160.52it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 184.62it/s]remove invalid data : null / measurement error:  38%|███▊      | 74/193 [00:00<00:00, 193.57it/s]remove invalid data : null / measurement error:  49%|████▉     | 95/193 [00:00<00:00, 198.18it/s]remove invalid data : null / measurement error:  60%|██████    | 116/193 [00:00<00:00, 201.06it/s]remove invalid data : null / measurement error:  73%|███████▎  | 141/193 [00:00<00:00, 214.96it/s]remove invalid data : null / measurement error:  84%|████████▍ | 163/193 [00:00<00:00, 212.56it/s]remove invalid data : null / measurement error:  96%|█████████▌| 185/193 [00:00<00:00, 210.53it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 199.53it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 254.27it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 255.07it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 252.55it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 248.39it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 247.96it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 247.87it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.06it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 101.90it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.27it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 60.65it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 72.98it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 79.49it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 81.48it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 81.81it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 67.09it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 57.69it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 58.51it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.25it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 48.54it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.15it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.21it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 54.70it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 53.64it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.01it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 62.37it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.40it/s]
================= Dataset information =================
train data : 53566, disrupt : 481, non-disrupt : 53085
valid data : 14883, disrupt : 125, non-disrupt : 14758
test data : 17183, disrupt : 152, non-disrupt : 17031

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.615, valid loss : -0.940, train acc : 0.546, valid acc : 0.590, train f1 : 0.359, valid f1 : 0.377

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 345.43it/s][A
 36%|███▌      | 71/196 [00:00<00:00, 352.64it/s][A
 55%|█████▍    | 107/196 [00:00<00:00, 354.92it/s][A
 73%|███████▎  | 143/196 [00:00<00:00, 354.06it/s][A
 91%|█████████▏| 179/196 [00:00<00:00, 355.26it/s][A100%|██████████| 196/196 [00:00<00:00, 354.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.377
training process:   1%|          | 1/128 [01:58<4:10:50, 118.51s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:29<3:34:25, 102.11s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:59<3:21:35, 96.76s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:28<3:13:17, 93.53s/it]epoch : 5, train loss : -3.505, valid loss : -4.350, train acc : 0.410, valid acc : 0.232, train f1 : 0.300, valid f1 : 0.194

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 328.12it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.09it/s][A
 53%|█████▎    | 103/196 [00:00<00:00, 338.94it/s][A
 70%|███████   | 138/196 [00:00<00:00, 339.52it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 340.29it/s][A100%|██████████| 196/196 [00:00<00:00, 339.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:22<3:26:52, 100.92s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:50<3:16:35, 96.69s/it] EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:21<3:11:05, 94.76s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:50<3:05:46, 92.88s/it]epoch : 9, train loss : -7.513, valid loss : -9.472, train acc : 0.289, valid acc : 0.271, train f1 : 0.232, valid f1 : 0.220

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 36/196 [00:00<00:00, 351.84it/s][A
 37%|███▋      | 72/196 [00:00<00:00, 356.44it/s][A
 55%|█████▌    | 108/196 [00:00<00:00, 357.90it/s][A
 73%|███████▎  | 144/196 [00:00<00:00, 358.37it/s][A
 92%|█████████▏| 180/196 [00:00<00:00, 358.84it/s][A100%|██████████| 196/196 [00:00<00:00, 358.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:43<3:16:35, 99.12s/it]EarlyStopping counter : 9 out of 40
training process:   8%|▊         | 10/128 [16:08<3:06:46, 94.97s/it]EarlyStopping counter : 10 out of 40
training process:   9%|▊         | 11/128 [17:37<3:01:10, 92.91s/it]EarlyStopping counter : 11 out of 40
training process:   9%|▉         | 12/128 [19:02<2:55:13, 90.63s/it]epoch : 13, train loss : -12.629, valid loss : -15.360, train acc : 0.261, valid acc : 0.274, train f1 : 0.214, valid f1 : 0.222

  0%|          | 0/196 [00:00<?, ?it/s][A
 18%|█▊        | 35/196 [00:00<00:00, 340.21it/s][A
 36%|███▌      | 70/196 [00:00<00:00, 344.09it/s][A
 54%|█████▎    | 105/196 [00:00<00:00, 344.75it/s][A
 71%|███████▏  | 140/196 [00:00<00:00, 345.76it/s][A
 89%|████████▉ | 175/196 [00:00<00:00, 346.23it/s][A100%|██████████| 196/196 [00:00<00:00, 345.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  10%|█         | 13/128 [20:54<3:06:24, 97.26s/it]EarlyStopping counter : 13 out of 40
training process:  11%|█         | 14/128 [22:21<2:58:46, 94.09s/it]EarlyStopping counter : 14 out of 40
training process:  12%|█▏        | 15/128 [23:47<2:52:20, 91.51s/it]EarlyStopping counter : 15 out of 40
training process:  12%|█▎        | 16/128 [25:15<2:48:42, 90.38s/it]epoch : 17, train loss : -18.914, valid loss : -21.458, train acc : 0.258, valid acc : 0.270, train f1 : 0.212, valid f1 : 0.219

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.06it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 332.47it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.81it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 337.60it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 338.59it/s][A100%|██████████| 196/196 [00:00<00:00, 337.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  13%|█▎        | 17/128 [27:07<2:59:30, 97.04s/it]EarlyStopping counter : 17 out of 40
training process:  14%|█▍        | 18/128 [28:35<2:52:41, 94.19s/it]EarlyStopping counter : 18 out of 40
training process:  15%|█▍        | 19/128 [30:01<2:46:39, 91.74s/it]EarlyStopping counter : 19 out of 40
training process:  16%|█▌        | 20/128 [31:24<2:40:51, 89.36s/it]epoch : 21, train loss : -25.945, valid loss : -27.661, train acc : 0.284, valid acc : 0.309, train f1 : 0.229, valid f1 : 0.244

  0%|          | 0/196 [00:00<?, ?it/s][A
 16%|█▌        | 31/196 [00:00<00:00, 292.42it/s][A
 31%|███       | 61/196 [00:00<00:00, 235.76it/s][A
 47%|████▋     | 93/196 [00:00<00:00, 265.92it/s][A
 64%|██████▍   | 126/196 [00:00<00:00, 287.20it/s][A
 80%|███████▉  | 156/196 [00:00<00:00, 263.81it/s][A
 94%|█████████▍| 184/196 [00:00<00:00, 262.53it/s][A100%|██████████| 196/196 [00:00<00:00, 267.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  16%|█▋        | 21/128 [33:19<2:52:58, 96.99s/it]EarlyStopping counter : 21 out of 40
training process:  17%|█▋        | 22/128 [34:49<2:47:19, 94.71s/it]EarlyStopping counter : 22 out of 40
training process:  18%|█▊        | 23/128 [36:18<2:42:53, 93.08s/it]EarlyStopping counter : 23 out of 40
training process:  19%|█▉        | 24/128 [37:47<2:39:26, 91.99s/it]epoch : 25, train loss : -33.317, valid loss : -37.401, train acc : 0.232, valid acc : 0.253, train f1 : 0.195, valid f1 : 0.208

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 326.80it/s][A
 35%|███▍      | 68/196 [00:00<00:00, 336.14it/s][A
 52%|█████▏    | 102/196 [00:00<00:00, 335.48it/s][A
 70%|██████▉   | 137/196 [00:00<00:00, 338.46it/s][A
 88%|████████▊ | 172/196 [00:00<00:00, 340.13it/s][A100%|██████████| 196/196 [00:00<00:00, 338.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  20%|█▉        | 25/128 [39:45<2:51:04, 99.65s/it]EarlyStopping counter : 25 out of 40
training process:  20%|██        | 26/128 [41:13<2:43:25, 96.13s/it]EarlyStopping counter : 26 out of 40
training process:  21%|██        | 27/128 [42:40<2:37:32, 93.59s/it]EarlyStopping counter : 27 out of 40
training process:  22%|██▏       | 28/128 [44:07<2:32:43, 91.63s/it]epoch : 29, train loss : -40.211, valid loss : -43.341, train acc : 0.188, valid acc : 0.206, train f1 : 0.164, valid f1 : 0.176

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 33/196 [00:00<00:00, 328.48it/s][A
 34%|███▍      | 67/196 [00:00<00:00, 331.19it/s][A
 52%|█████▏    | 101/196 [00:00<00:00, 327.94it/s][A
 68%|██████▊   | 134/196 [00:00<00:00, 323.07it/s][A
 86%|████████▌ | 168/196 [00:00<00:00, 328.26it/s][A100%|██████████| 196/196 [00:00<00:00, 329.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  23%|██▎       | 29/128 [46:01<2:41:58, 98.17s/it]EarlyStopping counter : 29 out of 40
training process:  23%|██▎       | 30/128 [47:30<2:35:45, 95.37s/it]EarlyStopping counter : 30 out of 40
training process:  24%|██▍       | 31/128 [48:57<2:30:26, 93.06s/it]EarlyStopping counter : 31 out of 40
training process:  25%|██▌       | 32/128 [50:26<2:26:48, 91.76s/it]epoch : 33, train loss : -47.687, valid loss : -51.286, train acc : 0.171, valid acc : 0.241, train f1 : 0.151, valid f1 : 0.200

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 337.39it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 341.58it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.90it/s][A
 71%|███████   | 139/196 [00:00<00:00, 339.68it/s][A
 88%|████████▊ | 173/196 [00:00<00:00, 336.32it/s][A100%|██████████| 196/196 [00:00<00:00, 338.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  26%|██▌       | 33/128 [52:19<2:35:23, 98.15s/it]EarlyStopping counter : 33 out of 40
training process:  27%|██▋       | 34/128 [53:46<2:28:34, 94.83s/it]EarlyStopping counter : 34 out of 40
training process:  27%|██▋       | 35/128 [55:16<2:24:30, 93.23s/it]EarlyStopping counter : 35 out of 40
training process:  28%|██▊       | 36/128 [56:42<2:19:42, 91.11s/it]epoch : 37, train loss : -55.835, valid loss : -61.629, train acc : 0.209, valid acc : 0.224, train f1 : 0.179, valid f1 : 0.189

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 335.95it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 342.16it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 344.37it/s][A
 71%|███████   | 139/196 [00:00<00:00, 346.32it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 347.53it/s][A100%|██████████| 196/196 [00:00<00:00, 346.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  29%|██▉       | 37/128 [58:35<2:28:12, 97.72s/it]EarlyStopping counter : 37 out of 40
training process:  30%|██▉       | 38/128 [1:00:04<2:22:33, 95.04s/it]EarlyStopping counter : 38 out of 40
training process:  30%|███       | 39/128 [1:01:32<2:18:02, 93.06s/it]EarlyStopping counter : 39 out of 40
training process:  31%|███▏      | 40/128 [1:03:01<2:14:24, 91.64s/it]epoch : 41, train loss : -63.043, valid loss : -67.550, train acc : 0.232, valid acc : 0.222, train f1 : 0.195, valid f1 : 0.187

  0%|          | 0/196 [00:00<?, ?it/s][A
 17%|█▋        | 34/196 [00:00<00:00, 334.67it/s][A
 35%|███▌      | 69/196 [00:00<00:00, 340.97it/s][A
 53%|█████▎    | 104/196 [00:00<00:00, 342.95it/s][A
 71%|███████   | 139/196 [00:00<00:00, 343.46it/s][A
 89%|████████▉ | 174/196 [00:00<00:00, 343.75it/s][A100%|██████████| 196/196 [00:00<00:00, 342.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 40, best f1 score : 0.377
training process:  31%|███▏      | 40/128 [1:04:53<2:22:45, 97.34s/it]
training process finished, best loss : -0.940 and best acc : 0.590, best f1 : 0.377, best epoch : 0

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.01      0.38      0.01       152
           1       0.99      0.50      0.67     17031

    accuracy                           0.50     17183
   macro avg       0.50      0.44      0.34     17183
weighted avg       0.98      0.50      0.66     17183


# test acc : 0.50, test f1 : 0.34, test AUC : 0.44, test loss : -286.632

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:04, 11.52s/it]processing for feature importance:  12%|█▏        | 2/17 [00:22<02:50, 11.38s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:38, 11.31s/it]processing for feature importance:  24%|██▎       | 4/17 [00:45<02:30, 11.56s/it]processing for feature importance:  29%|██▉       | 5/17 [00:57<02:18, 11.52s/it]processing for feature importance:  35%|███▌      | 6/17 [01:08<02:05, 11.39s/it]processing for feature importance:  41%|████      | 7/17 [01:19<01:53, 11.37s/it]processing for feature importance:  47%|████▋     | 8/17 [01:32<01:46, 11.88s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:44<01:33, 11.66s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:54<01:20, 11.43s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:06<01:08, 11.38s/it]processing for feature importance:  71%|███████   | 12/17 [02:17<00:57, 11.43s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:29<00:45, 11.42s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:40<00:33, 11.24s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:51<00:22, 11.22s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:03<00:11, 11.42s/it]processing for feature importance: 100%|██████████| 17/17 [03:15<00:00, 11.64s/it]processing for feature importance: 100%|██████████| 17/17 [03:15<00:00, 11.48s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/210 [00:03<12:45,  3.66s/it]visualize 2D latent space:   1%|          | 2/210 [00:05<09:19,  2.69s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:16,  2.03s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:30,  1.37s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/210 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/210 [00:02<09:16,  2.66s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:03<04:58,  1.44s/it]visualize 2D latent space with decision boundary:   1%|          | 2/210 [00:04<07:12,  2.08s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
Transformer_clip_10_dist_0_Focal_smoothing_RW_Robust_TQ_seed_42 : visualize 2D latent space doesn't work due to stability error

====================== Probability curve generation process ======================

  0%|          | 0/196 [00:00<?, ?it/s] 16%|█▋        | 32/196 [00:00<00:00, 314.19it/s] 34%|███▍      | 67/196 [00:00<00:00, 333.51it/s] 52%|█████▏    | 102/196 [00:00<00:00, 339.77it/s] 70%|██████▉   | 137/196 [00:00<00:00, 342.58it/s] 88%|████████▊ | 172/196 [00:00<00:00, 343.93it/s]100%|██████████| 196/196 [00:00<00:00, 340.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:03, 196.70it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 195.42it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 194.20it/s]remove invalid data : null / measurement error:  13%|█▎        | 80/616 [00:00<00:02, 196.36it/s]remove invalid data : null / measurement error:  16%|█▋        | 101/616 [00:00<00:02, 199.37it/s]remove invalid data : null / measurement error:  20%|█▉        | 122/616 [00:00<00:02, 202.85it/s]remove invalid data : null / measurement error:  23%|██▎       | 144/616 [00:00<00:02, 205.17it/s]remove invalid data : null / measurement error:  27%|██▋       | 166/616 [00:00<00:02, 208.26it/s]remove invalid data : null / measurement error:  30%|███       | 187/616 [00:00<00:02, 206.44it/s]remove invalid data : null / measurement error:  34%|███▍      | 208/616 [00:01<00:01, 205.12it/s]remove invalid data : null / measurement error:  37%|███▋      | 229/616 [00:01<00:01, 206.28it/s]remove invalid data : null / measurement error:  41%|████      | 250/616 [00:01<00:01, 205.14it/s]remove invalid data : null / measurement error:  44%|████▍     | 271/616 [00:01<00:01, 205.89it/s]remove invalid data : null / measurement error:  47%|████▋     | 292/616 [00:01<00:01, 203.83it/s]remove invalid data : null / measurement error:  51%|█████     | 313/616 [00:01<00:01, 202.67it/s]remove invalid data : null / measurement error:  54%|█████▍    | 334/616 [00:01<00:01, 202.92it/s]remove invalid data : null / measurement error:  58%|█████▊    | 355/616 [00:01<00:01, 203.19it/s]remove invalid data : null / measurement error:  62%|██████▏   | 380/616 [00:01<00:01, 215.75it/s]remove invalid data : null / measurement error:  66%|██████▌   | 406/616 [00:01<00:00, 228.27it/s]remove invalid data : null / measurement error:  70%|██████▉   | 430/616 [00:02<00:00, 231.02it/s]remove invalid data : null / measurement error:  74%|███████▎  | 454/616 [00:02<00:00, 232.74it/s]remove invalid data : null / measurement error:  78%|███████▊  | 478/616 [00:02<00:00, 225.79it/s]remove invalid data : null / measurement error:  81%|████████▏ | 501/616 [00:02<00:00, 218.75it/s]remove invalid data : null / measurement error:  85%|████████▍ | 523/616 [00:02<00:00, 215.20it/s]remove invalid data : null / measurement error:  88%|████████▊ | 545/616 [00:02<00:00, 210.72it/s]remove invalid data : null / measurement error:  92%|█████████▏| 567/616 [00:02<00:00, 208.81it/s]remove invalid data : null / measurement error:  95%|█████████▌| 588/616 [00:02<00:00, 207.26it/s]remove invalid data : null / measurement error:  99%|█████████▉| 609/616 [00:02<00:00, 205.42it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 209.05it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 239.62it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 239.82it/s]replace nan value:  14%|█▍        | 73/515 [00:00<00:01, 240.90it/s]replace nan value:  19%|█▉        | 98/515 [00:00<00:01, 242.72it/s]replace nan value:  24%|██▍       | 123/515 [00:00<00:01, 244.20it/s]replace nan value:  29%|██▊       | 148/515 [00:00<00:01, 245.07it/s]replace nan value:  34%|███▎      | 173/515 [00:00<00:01, 244.42it/s]replace nan value:  38%|███▊      | 198/515 [00:00<00:01, 244.83it/s]replace nan value:  43%|████▎     | 223/515 [00:00<00:01, 245.57it/s]replace nan value:  48%|████▊     | 248/515 [00:01<00:01, 246.27it/s]replace nan value:  53%|█████▎    | 273/515 [00:01<00:00, 247.05it/s]replace nan value:  58%|█████▊    | 298/515 [00:01<00:00, 246.08it/s]replace nan value:  63%|██████▎   | 323/515 [00:01<00:00, 245.88it/s]replace nan value:  68%|██████▊   | 348/515 [00:01<00:00, 242.00it/s]replace nan value:  72%|███████▏  | 373/515 [00:01<00:00, 242.39it/s]replace nan value:  77%|███████▋  | 398/515 [00:01<00:00, 240.88it/s]replace nan value:  82%|████████▏ | 423/515 [00:01<00:00, 242.10it/s]replace nan value:  87%|████████▋ | 448/515 [00:01<00:00, 241.08it/s]replace nan value:  92%|█████████▏| 473/515 [00:01<00:00, 242.33it/s]replace nan value:  97%|█████████▋| 498/515 [00:02<00:00, 243.79it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 243.55it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.78it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.30it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.05it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.56it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 74.20it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.22it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.01it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.02it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.49it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.29it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.20it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.68it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.53it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.61it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.36it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.35it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.74it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.57it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.32it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 73.11it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.21it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.37it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.71it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.17it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.43it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.33it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.89it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.36it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 89.02it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.31it/s]generate index:  51%|█████     | 261/515 [00:03<00:03, 74.59it/s]generate index:  52%|█████▏    | 270/515 [00:03<00:03, 77.64it/s]generate index:  54%|█████▍    | 279/515 [00:04<00:03, 67.35it/s]generate index:  56%|█████▌    | 287/515 [00:04<00:03, 65.39it/s]generate index:  57%|█████▋    | 295/515 [00:04<00:03, 65.44it/s]generate index:  59%|█████▊    | 302/515 [00:04<00:03, 62.29it/s]generate index:  60%|██████    | 311/515 [00:04<00:03, 65.95it/s]generate index:  62%|██████▏   | 318/515 [00:04<00:03, 60.91it/s]generate index:  63%|██████▎   | 326/515 [00:04<00:02, 65.13it/s]generate index:  65%|██████▍   | 333/515 [00:04<00:02, 66.15it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:04, 41.28it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:04, 41.48it/s]generate index:  68%|██████▊   | 352/515 [00:05<00:03, 41.57it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 54.10it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:02, 68.75it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 73.63it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 73.31it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 73.38it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.31it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.84it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.80it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 54.81it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 50.92it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:00, 60.48it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.64it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.53it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.77it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.16it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 65.01it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.95it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 64.35it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 68.79it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 148.90it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 175.22it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 189.92it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 196.26it/s]remove invalid data : null / measurement error:  75%|███████▌  | 116/154 [00:00<00:00, 209.06it/s]remove invalid data : null / measurement error:  89%|████████▉ | 137/154 [00:00<00:00, 206.98it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 192.50it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 251.99it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 253.62it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 254.36it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 251.23it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 251.90it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 252.00it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:02, 60.13it/s]generate index:  11%|█         | 14/131 [00:00<00:03, 38.21it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 47.36it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 55.61it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 59.61it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 59.13it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.57it/s]generate index:  45%|████▌     | 59/131 [00:01<00:01, 65.87it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.04it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.64it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.10it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.08it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 44.32it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 40.21it/s]generate index:  81%|████████  | 106/131 [00:02<00:00, 42.51it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 50.68it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 59.89it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 55.85it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 39.01it/s]remove invalid data : null / measurement error:  13%|█▎        | 25/193 [00:00<00:01, 137.88it/s]remove invalid data : null / measurement error:  23%|██▎       | 45/193 [00:00<00:00, 165.04it/s]remove invalid data : null / measurement error:  35%|███▍      | 67/193 [00:00<00:00, 183.15it/s]remove invalid data : null / measurement error:  46%|████▌     | 88/193 [00:00<00:00, 191.83it/s]remove invalid data : null / measurement error:  56%|█████▋    | 109/193 [00:00<00:00, 194.91it/s]remove invalid data : null / measurement error:  69%|██████▉   | 134/193 [00:00<00:00, 210.37it/s]remove invalid data : null / measurement error:  81%|████████  | 156/193 [00:00<00:00, 208.47it/s]remove invalid data : null / measurement error:  92%|█████████▏| 177/193 [00:00<00:00, 206.20it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 191.15it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 250.28it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 245.52it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 247.08it/s]replace nan value:  64%|██████▍   | 102/160 [00:00<00:00, 244.39it/s]replace nan value:  79%|███████▉  | 127/160 [00:00<00:00, 242.76it/s]replace nan value:  95%|█████████▌| 152/160 [00:00<00:00, 244.06it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 244.53it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 103.62it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.37it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.99it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.87it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.99it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.38it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.97it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.99it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.23it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.64it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.29it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.67it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.73it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.73it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.19it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.82it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.02it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.57it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.87it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:10<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1204, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:02, 199.29it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 196.88it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 195.06it/s]remove invalid data : null / measurement error:  13%|█▎        | 81/616 [00:00<00:02, 197.07it/s]remove invalid data : null / measurement error:  17%|█▋        | 102/616 [00:00<00:02, 199.00it/s]remove invalid data : null / measurement error:  20%|█▉        | 123/616 [00:00<00:02, 202.57it/s]remove invalid data : null / measurement error:  24%|██▎       | 145/616 [00:00<00:02, 205.21it/s]remove invalid data : null / measurement error:  27%|██▋       | 167/616 [00:00<00:02, 208.20it/s]remove invalid data : null / measurement error:  31%|███       | 188/616 [00:00<00:02, 206.37it/s]remove invalid data : null / measurement error:  34%|███▍      | 209/616 [00:01<00:01, 205.28it/s]remove invalid data : null / measurement error:  37%|███▋      | 230/616 [00:01<00:01, 205.69it/s]remove invalid data : null / measurement error:  41%|████      | 251/616 [00:01<00:01, 204.36it/s]remove invalid data : null / measurement error:  44%|████▍     | 272/616 [00:01<00:01, 205.07it/s]remove invalid data : null / measurement error:  48%|████▊     | 293/616 [00:01<00:01, 203.54it/s]remove invalid data : null / measurement error:  51%|█████     | 314/616 [00:01<00:01, 202.27it/s]remove invalid data : null / measurement error:  54%|█████▍    | 335/616 [00:01<00:01, 201.30it/s]remove invalid data : null / measurement error:  58%|█████▊    | 356/616 [00:01<00:01, 200.45it/s]remove invalid data : null / measurement error:  62%|██████▏   | 381/616 [00:01<00:01, 213.44it/s]remove invalid data : null / measurement error:  66%|██████▌   | 407/616 [00:01<00:00, 225.60it/s]remove invalid data : null / measurement error:  70%|██████▉   | 431/616 [00:02<00:00, 227.37it/s]remove invalid data : null / measurement error:  74%|███████▍  | 455/616 [00:02<00:00, 229.19it/s]remove invalid data : null / measurement error:  78%|███████▊  | 478/616 [00:02<00:00, 222.12it/s]remove invalid data : null / measurement error:  81%|████████▏ | 501/616 [00:02<00:00, 215.00it/s]remove invalid data : null / measurement error:  85%|████████▍ | 523/616 [00:02<00:00, 211.24it/s]remove invalid data : null / measurement error:  88%|████████▊ | 545/616 [00:02<00:00, 207.39it/s]remove invalid data : null / measurement error:  92%|█████████▏| 566/616 [00:02<00:00, 205.46it/s]remove invalid data : null / measurement error:  95%|█████████▌| 587/616 [00:02<00:00, 203.98it/s]remove invalid data : null / measurement error:  99%|█████████▊| 608/616 [00:02<00:00, 202.88it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.37it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   3%|▎         | 14/515 [00:00<00:03, 136.86it/s]replace nan value:   6%|▌         | 32/515 [00:00<00:03, 158.52it/s]replace nan value:  10%|█         | 54/515 [00:00<00:02, 184.21it/s]replace nan value:  14%|█▍        | 73/515 [00:00<00:02, 163.45it/s]replace nan value:  18%|█▊        | 95/515 [00:00<00:02, 180.03it/s]replace nan value:  23%|██▎       | 119/515 [00:00<00:01, 198.79it/s]replace nan value:  28%|██▊       | 144/515 [00:00<00:01, 213.42it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 223.66it/s]replace nan value:  38%|███▊      | 194/515 [00:00<00:01, 230.39it/s]replace nan value:  43%|████▎     | 219/515 [00:01<00:01, 235.39it/s]replace nan value:  47%|████▋     | 244/515 [00:01<00:01, 238.41it/s]replace nan value:  52%|█████▏    | 269/515 [00:01<00:01, 239.83it/s]replace nan value:  57%|█████▋    | 294/515 [00:01<00:00, 239.92it/s]replace nan value:  62%|██████▏   | 319/515 [00:01<00:00, 239.94it/s]replace nan value:  67%|██████▋   | 344/515 [00:01<00:00, 238.33it/s]replace nan value:  71%|███████▏  | 368/515 [00:01<00:00, 238.59it/s]replace nan value:  76%|███████▋  | 393/515 [00:01<00:00, 239.83it/s]replace nan value:  81%|████████  | 417/515 [00:01<00:00, 239.37it/s]replace nan value:  86%|████████▌ | 441/515 [00:01<00:00, 238.26it/s]replace nan value:  90%|█████████ | 466/515 [00:02<00:00, 239.15it/s]replace nan value:  95%|█████████▌| 491/515 [00:02<00:00, 239.95it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 239.64it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 225.10it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.75it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 55.90it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.13it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.54it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.20it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.43it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 51.06it/s]generate index:  12%|█▏        | 62/515 [00:01<00:10, 43.52it/s]generate index:  14%|█▎        | 70/515 [00:01<00:08, 50.80it/s]generate index:  15%|█▍        | 76/515 [00:01<00:08, 51.93it/s]generate index:  17%|█▋        | 87/515 [00:01<00:06, 61.78it/s]generate index:  18%|█▊        | 94/515 [00:01<00:06, 61.80it/s]generate index:  20%|█▉        | 101/515 [00:01<00:07, 58.32it/s]generate index:  21%|██▏       | 110/515 [00:01<00:06, 64.85it/s]generate index:  23%|██▎       | 118/515 [00:02<00:06, 63.12it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.56it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 70.04it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.22it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.43it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 70.83it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 72.12it/s]generate index:  34%|███▍      | 175/515 [00:02<00:04, 68.95it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.95it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 70.91it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.89it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.44it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.12it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.77it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 88.95it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 74.16it/s]generate index:  50%|█████     | 260/515 [00:03<00:03, 72.52it/s]generate index:  52%|█████▏    | 269/515 [00:04<00:03, 75.81it/s]generate index:  54%|█████▍    | 277/515 [00:04<00:03, 72.95it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 62.50it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 65.23it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 61.50it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 61.95it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.90it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 63.22it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 66.52it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 55.25it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.31it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 43.16it/s]generate index:  70%|██████▉   | 358/515 [00:05<00:02, 53.43it/s]generate index:  72%|███████▏  | 371/515 [00:05<00:02, 69.79it/s]generate index:  74%|███████▍  | 381/515 [00:05<00:01, 74.11it/s]generate index:  76%|███████▌  | 389/515 [00:05<00:01, 71.24it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 76.70it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 63.56it/s]generate index:  81%|████████  | 415/515 [00:06<00:01, 66.98it/s]generate index:  83%|████████▎ | 426/515 [00:06<00:01, 75.36it/s]generate index:  84%|████████▍ | 434/515 [00:06<00:01, 62.06it/s]generate index:  86%|████████▌ | 441/515 [00:06<00:01, 47.65it/s]generate index:  88%|████████▊ | 451/515 [00:07<00:01, 57.39it/s]generate index:  89%|████████▉ | 458/515 [00:07<00:00, 59.14it/s]generate index:  90%|█████████ | 466/515 [00:07<00:00, 62.21it/s]generate index:  92%|█████████▏| 473/515 [00:07<00:00, 56.75it/s]generate index:  94%|█████████▍| 485/515 [00:07<00:00, 69.42it/s]generate index:  96%|█████████▌| 493/515 [00:07<00:00, 65.20it/s]generate index:  97%|█████████▋| 500/515 [00:07<00:00, 65.57it/s]generate index:  99%|█████████▉| 509/515 [00:07<00:00, 68.42it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 64.07it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 67.67it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 147.87it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 174.22it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 188.88it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 195.19it/s]remove invalid data : null / measurement error:  75%|███████▌  | 116/154 [00:00<00:00, 210.11it/s]remove invalid data : null / measurement error:  90%|████████▉ | 138/154 [00:00<00:00, 205.67it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 191.52it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.48it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.48it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 252.08it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 251.26it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 254.16it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 252.56it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 72.92it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.32it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 56.39it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 58.30it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 63.50it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 64.14it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 60.69it/s]generate index:  47%|████▋     | 62/131 [00:00<00:01, 68.38it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 64.44it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 66.25it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 64.20it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 46.48it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 48.55it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 46.95it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 51.31it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 60.08it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 69.48it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.89it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|          | 2/193 [00:00<00:09, 19.57it/s]remove invalid data : null / measurement error:  12%|█▏        | 23/193 [00:00<00:01, 130.18it/s]remove invalid data : null / measurement error:  23%|██▎       | 44/193 [00:00<00:00, 164.89it/s]remove invalid data : null / measurement error:  34%|███▎      | 65/193 [00:00<00:00, 180.95it/s]remove invalid data : null / measurement error:  45%|████▌     | 87/193 [00:00<00:00, 193.34it/s]remove invalid data : null / measurement error:  56%|█████▌    | 108/193 [00:00<00:00, 196.25it/s]remove invalid data : null / measurement error:  69%|██████▉   | 133/193 [00:00<00:00, 212.11it/s]remove invalid data : null / measurement error:  80%|████████  | 155/193 [00:00<00:00, 212.29it/s]remove invalid data : null / measurement error:  92%|█████████▏| 177/193 [00:00<00:00, 209.84it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 192.17it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 255.51it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 255.66it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 253.46it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 249.74it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 249.37it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 249.39it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 250.36it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.10it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.58it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.96it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.60it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.27it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.31it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.07it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.32it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.32it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.03it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.61it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.04it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.05it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.06it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.29it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.94it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.19it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.79it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.03it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:26<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 186, in train
    valid_loss, valid_acc, valid_f1 = valid_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 103, in valid_per_epoch
    for batch_idx, (data, target) in enumerate(valid_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-4:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 513, in Client
    answer_challenge(c, authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 757, in answer_challenge
    message = connection.recv_bytes(256)         # reject large message
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 388, in _recv
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 206.80it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 204.08it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 201.67it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 204.04it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 205.88it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 208.71it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 211.01it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 212.45it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 209.90it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 209.27it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 209.08it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 208.50it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 209.41it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 208.95it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 207.65it/s]remove invalid data : null / measurement error:  55%|█████▌    | 341/616 [00:01<00:01, 207.06it/s]remove invalid data : null / measurement error:  59%|█████▉    | 362/616 [00:01<00:01, 207.63it/s]remove invalid data : null / measurement error:  63%|██████▎   | 388/616 [00:01<00:01, 221.02it/s]remove invalid data : null / measurement error:  67%|██████▋   | 415/616 [00:01<00:00, 235.21it/s]remove invalid data : null / measurement error:  71%|███████▏  | 439/616 [00:02<00:00, 231.43it/s]remove invalid data : null / measurement error:  75%|███████▌  | 463/616 [00:02<00:00, 232.81it/s]remove invalid data : null / measurement error:  79%|███████▉  | 487/616 [00:02<00:00, 225.51it/s]remove invalid data : null / measurement error:  83%|████████▎ | 510/616 [00:02<00:00, 220.20it/s]remove invalid data : null / measurement error:  87%|████████▋ | 533/616 [00:02<00:00, 215.18it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 210.83it/s]remove invalid data : null / measurement error:  94%|█████████▎| 577/616 [00:02<00:00, 209.00it/s]remove invalid data : null / measurement error:  97%|█████████▋| 598/616 [00:02<00:00, 208.27it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 212.64it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 238.02it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 237.32it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 235.94it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 237.18it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 237.71it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 240.11it/s]replace nan value:  33%|███▎      | 170/515 [00:00<00:01, 241.74it/s]replace nan value:  38%|███▊      | 195/515 [00:00<00:01, 242.42it/s]replace nan value:  43%|████▎     | 220/515 [00:00<00:01, 243.28it/s]replace nan value:  48%|████▊     | 245/515 [00:01<00:01, 244.03it/s]replace nan value:  52%|█████▏    | 270/515 [00:01<00:01, 244.38it/s]replace nan value:  57%|█████▋    | 295/515 [00:01<00:00, 243.97it/s]replace nan value:  62%|██████▏   | 320/515 [00:01<00:00, 244.09it/s]replace nan value:  67%|██████▋   | 345/515 [00:01<00:00, 242.47it/s]replace nan value:  72%|███████▏  | 370/515 [00:01<00:00, 242.67it/s]replace nan value:  77%|███████▋  | 395/515 [00:01<00:00, 243.61it/s]replace nan value:  82%|████████▏ | 420/515 [00:01<00:00, 243.42it/s]replace nan value:  86%|████████▋ | 445/515 [00:01<00:00, 240.32it/s]replace nan value:  91%|█████████▏| 470/515 [00:01<00:00, 238.27it/s]replace nan value:  96%|█████████▌| 495/515 [00:02<00:00, 238.85it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 240.89it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.08it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.35it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.18it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.94it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.93it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.50it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.61it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.26it/s]generate index:  14%|█▎        | 70/515 [00:01<00:08, 53.05it/s]generate index:  15%|█▍        | 76/515 [00:01<00:08, 53.34it/s]generate index:  17%|█▋        | 86/515 [00:01<00:06, 64.53it/s]generate index:  18%|█▊        | 93/515 [00:01<00:06, 60.54it/s]generate index:  19%|█▉        | 100/515 [00:01<00:07, 57.49it/s]generate index:  21%|██        | 107/515 [00:01<00:06, 59.48it/s]generate index:  23%|██▎       | 116/515 [00:01<00:05, 66.90it/s]generate index:  24%|██▍       | 123/515 [00:02<00:06, 65.01it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 69.11it/s]generate index:  27%|██▋       | 140/515 [00:02<00:05, 68.48it/s]generate index:  29%|██▊       | 147/515 [00:02<00:05, 68.05it/s]generate index:  30%|███       | 156/515 [00:02<00:05, 70.59it/s]generate index:  32%|███▏      | 165/515 [00:02<00:04, 73.08it/s]generate index:  34%|███▎      | 173/515 [00:02<00:05, 66.79it/s]generate index:  35%|███▌      | 182/515 [00:02<00:04, 71.90it/s]generate index:  37%|███▋      | 190/515 [00:02<00:04, 69.52it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 68.76it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 66.92it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 86.61it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 83.15it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 79.63it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 81.45it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 66.96it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 73.04it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.48it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.94it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 66.32it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 63.73it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 63.40it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 61.40it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 63.16it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 66.96it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 55.88it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 46.07it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 43.87it/s]generate index:  70%|██████▉   | 358/515 [00:05<00:02, 54.19it/s]generate index:  72%|███████▏  | 371/515 [00:05<00:02, 70.41it/s]generate index:  74%|███████▍  | 381/515 [00:05<00:01, 74.57it/s]generate index:  76%|███████▌  | 389/515 [00:05<00:01, 72.05it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 77.76it/s]generate index:  79%|███████▉  | 408/515 [00:06<00:01, 63.50it/s]generate index:  81%|████████  | 416/515 [00:06<00:01, 66.92it/s]generate index:  83%|████████▎ | 427/515 [00:06<00:01, 76.49it/s]generate index:  85%|████████▍ | 436/515 [00:06<00:01, 57.70it/s]generate index:  86%|████████▌ | 443/515 [00:06<00:01, 47.55it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.22it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.83it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.93it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.67it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.03it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 63.70it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.16it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 64.28it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 86.51it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 157.42it/s]remove invalid data : null / measurement error:  34%|███▍      | 52/154 [00:00<00:00, 182.26it/s]remove invalid data : null / measurement error:  48%|████▊     | 74/154 [00:00<00:00, 195.68it/s]remove invalid data : null / measurement error:  63%|██████▎   | 97/154 [00:00<00:00, 206.25it/s]remove invalid data : null / measurement error:  78%|███████▊  | 120/154 [00:00<00:00, 214.08it/s]remove invalid data : null / measurement error:  92%|█████████▏| 142/154 [00:00<00:00, 211.59it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 198.32it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 244.27it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.39it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 252.10it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 250.25it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 251.89it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 250.74it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.69it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 42.68it/s]generate index:  15%|█▍        | 19/131 [00:00<00:02, 44.60it/s]generate index:  18%|█▊        | 24/131 [00:00<00:02, 42.19it/s]generate index:  24%|██▍       | 32/131 [00:00<00:01, 52.66it/s]generate index:  29%|██▉       | 38/131 [00:00<00:01, 52.52it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 44.60it/s]generate index:  37%|███▋      | 49/131 [00:01<00:01, 44.42it/s]generate index:  42%|████▏     | 55/131 [00:01<00:01, 46.96it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 54.08it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:01, 57.51it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 61.85it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 61.15it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 44.79it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 47.52it/s]generate index:  79%|███████▉  | 104/131 [00:02<00:00, 46.49it/s]generate index:  85%|████████▍ | 111/131 [00:02<00:00, 51.34it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 60.23it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 69.61it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 53.74it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/193 [00:00<00:03, 47.86it/s]remove invalid data : null / measurement error:  14%|█▍        | 27/193 [00:00<00:01, 145.78it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 177.32it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 193.81it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 203.14it/s]remove invalid data : null / measurement error:  59%|█████▉    | 114/193 [00:00<00:00, 205.06it/s]remove invalid data : null / measurement error:  72%|███████▏  | 139/193 [00:00<00:00, 217.14it/s]remove invalid data : null / measurement error:  83%|████████▎ | 161/193 [00:00<00:00, 213.15it/s]remove invalid data : null / measurement error:  95%|█████████▍| 183/193 [00:00<00:00, 210.68it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 197.73it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 242.08it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 249.12it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 249.88it/s]replace nan value:  64%|██████▍   | 102/160 [00:00<00:00, 246.24it/s]replace nan value:  79%|███████▉  | 127/160 [00:00<00:00, 244.79it/s]replace nan value:  95%|█████████▌| 152/160 [00:00<00:00, 245.93it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 246.20it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.73it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 65.02it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.48it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.91it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.27it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.35it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.63it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.80it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.08it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 61.06it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.58it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.66it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.76it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.99it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 57.39it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 56.06it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.99it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.97it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.74it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:10<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-3:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 514, in Client
    deliver_challenge(c, authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 745, in deliver_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 384, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_smoothing_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 207.08it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 204.05it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 202.10it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 203.97it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.79it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 206.90it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 208.61it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 209.69it/s]remove invalid data : null / measurement error:  31%|███       | 192/616 [00:00<00:02, 206.39it/s]remove invalid data : null / measurement error:  35%|███▍      | 213/616 [00:01<00:01, 204.30it/s]remove invalid data : null / measurement error:  38%|███▊      | 234/616 [00:01<00:01, 203.16it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 203.06it/s]remove invalid data : null / measurement error:  45%|████▍     | 276/616 [00:01<00:01, 204.51it/s]remove invalid data : null / measurement error:  48%|████▊     | 297/616 [00:01<00:01, 204.30it/s]remove invalid data : null / measurement error:  52%|█████▏    | 318/616 [00:01<00:01, 203.52it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 202.64it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 201.89it/s]remove invalid data : null / measurement error:  63%|██████▎   | 386/616 [00:01<00:01, 217.10it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:01<00:00, 231.57it/s]remove invalid data : null / measurement error:  71%|███████   | 437/616 [00:02<00:00, 228.33it/s]remove invalid data : null / measurement error:  75%|███████▍  | 461/616 [00:02<00:00, 231.39it/s]remove invalid data : null / measurement error:  79%|███████▊  | 485/616 [00:02<00:00, 224.15it/s]remove invalid data : null / measurement error:  82%|████████▏ | 508/616 [00:02<00:00, 218.68it/s]remove invalid data : null / measurement error:  86%|████████▌ | 530/616 [00:02<00:00, 214.09it/s]remove invalid data : null / measurement error:  90%|████████▉ | 552/616 [00:02<00:00, 209.71it/s]remove invalid data : null / measurement error:  93%|█████████▎| 574/616 [00:02<00:00, 207.33it/s]remove invalid data : null / measurement error:  97%|█████████▋| 595/616 [00:02<00:00, 206.10it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 204.88it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 209.76it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 236.34it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 238.34it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 238.58it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 239.82it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 240.57it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 241.67it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 242.48it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 242.51it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 227.38it/s]replace nan value:  48%|████▊     | 246/515 [00:01<00:01, 230.37it/s]replace nan value:  52%|█████▏    | 270/515 [00:01<00:01, 225.13it/s]replace nan value:  57%|█████▋    | 294/515 [00:01<00:00, 227.39it/s]replace nan value:  62%|██████▏   | 317/515 [00:01<00:00, 202.80it/s]replace nan value:  66%|██████▌   | 338/515 [00:01<00:00, 204.40it/s]replace nan value:  70%|██████▉   | 359/515 [00:01<00:00, 190.37it/s]replace nan value:  74%|███████▎  | 379/515 [00:01<00:00, 192.43it/s]replace nan value:  78%|███████▊  | 404/515 [00:01<00:00, 206.91it/s]replace nan value:  83%|████████▎ | 429/515 [00:01<00:00, 217.93it/s]replace nan value:  88%|████████▊ | 453/515 [00:02<00:00, 224.16it/s]replace nan value:  93%|█████████▎| 478/515 [00:02<00:00, 230.54it/s]replace nan value:  98%|█████████▊| 503/515 [00:02<00:00, 235.29it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 224.90it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.96it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.98it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 76.39it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.51it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.02it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.84it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.92it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.26it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.91it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.79it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.68it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.24it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.95it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.59it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.08it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.69it/s]generate index:  26%|██▋       | 136/515 [00:02<00:06, 62.80it/s]generate index:  28%|██▊       | 143/515 [00:02<00:06, 56.35it/s]generate index:  29%|██▉       | 149/515 [00:02<00:06, 52.73it/s]generate index:  30%|███       | 156/515 [00:02<00:06, 55.11it/s]generate index:  32%|███▏      | 165/515 [00:02<00:05, 60.97it/s]generate index:  33%|███▎      | 172/515 [00:02<00:05, 62.09it/s]generate index:  35%|███▍      | 179/515 [00:02<00:05, 63.37it/s]generate index:  37%|███▋      | 188/515 [00:03<00:04, 68.32it/s]generate index:  38%|███▊      | 195/515 [00:03<00:04, 67.62it/s]generate index:  39%|███▉      | 202/515 [00:03<00:05, 61.16it/s]generate index:  42%|████▏     | 216/515 [00:03<00:03, 81.28it/s]generate index:  44%|████▎     | 225/515 [00:03<00:03, 74.55it/s]generate index:  46%|████▌     | 237/515 [00:03<00:03, 85.80it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 84.00it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 69.88it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 75.47it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 78.60it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 65.83it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 68.04it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 62.70it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 63.19it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 60.59it/s]generate index:  63%|██████▎   | 323/515 [00:05<00:03, 63.73it/s]generate index:  64%|██████▍   | 331/515 [00:05<00:02, 63.77it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 51.94it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 47.23it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 42.55it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 58.36it/s]generate index:  73%|███████▎  | 374/515 [00:05<00:01, 71.04it/s]generate index:  74%|███████▍  | 382/515 [00:05<00:01, 73.05it/s]generate index:  76%|███████▌  | 390/515 [00:06<00:01, 68.05it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 75.36it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 64.29it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.51it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.89it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 55.30it/s]generate index:  86%|████████▋ | 445/515 [00:07<00:01, 51.31it/s]generate index:  89%|████████▊ | 456/515 [00:07<00:00, 62.18it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 66.01it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.38it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.23it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.73it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.25it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.00it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.34it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 87.26it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 157.63it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 181.09it/s]remove invalid data : null / measurement error:  47%|████▋     | 73/154 [00:00<00:00, 194.48it/s]remove invalid data : null / measurement error:  62%|██████▏   | 96/154 [00:00<00:00, 204.90it/s]remove invalid data : null / measurement error:  78%|███████▊  | 120/154 [00:00<00:00, 215.03it/s]remove invalid data : null / measurement error:  92%|█████████▏| 142/154 [00:00<00:00, 213.08it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 198.90it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 256.11it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 255.74it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 255.66it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 252.22it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 254.43it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 254.23it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 71.48it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 49.83it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 56.56it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 59.07it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 65.22it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 66.15it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 62.73it/s]generate index:  48%|████▊     | 63/131 [00:00<00:01, 67.62it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 67.13it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 68.26it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 65.66it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 47.04it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 49.08it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 47.38it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 51.69it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 60.47it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 69.87it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.68it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 99.50it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:00, 163.73it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 188.89it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 197.48it/s]remove invalid data : null / measurement error:  50%|█████     | 97/193 [00:00<00:00, 202.49it/s]remove invalid data : null / measurement error:  62%|██████▏   | 119/193 [00:00<00:00, 207.62it/s]remove invalid data : null / measurement error:  75%|███████▍  | 144/193 [00:00<00:00, 218.62it/s]remove invalid data : null / measurement error:  86%|████████▌ | 166/193 [00:00<00:00, 214.86it/s]remove invalid data : null / measurement error:  97%|█████████▋| 188/193 [00:00<00:00, 211.96it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 202.51it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 254.18it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 257.03it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 255.99it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 253.04it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 254.64it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 255.89it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 255.27it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 108.53it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 65.80it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.66it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.97it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.39it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.09it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.03it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 63.27it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 51.41it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 54.06it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 48.99it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 46.56it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 56.46it/s]generate index:  78%|███████▊  | 125/160 [00:02<00:00, 57.93it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 53.87it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 52.86it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 57.00it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 61.36it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 60.23it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:10<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1204, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-3:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 514, in Client
    deliver_challenge(c, authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 745, in deliver_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 384, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_smoothing_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 206.75it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 203.71it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 201.72it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 203.85it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 205.61it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 208.51it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 210.66it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 211.89it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 209.35it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 208.78it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 208.50it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 207.89it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 208.94it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 208.42it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 175.20it/s]remove invalid data : null / measurement error:  55%|█████▌    | 340/616 [00:01<00:01, 180.87it/s]remove invalid data : null / measurement error:  59%|█████▊    | 361/616 [00:01<00:01, 187.52it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:01<00:01, 205.81it/s]remove invalid data : null / measurement error:  67%|██████▋   | 414/616 [00:02<00:00, 223.73it/s]remove invalid data : null / measurement error:  71%|███████   | 437/616 [00:02<00:00, 222.25it/s]remove invalid data : null / measurement error:  75%|███████▍  | 461/616 [00:02<00:00, 227.02it/s]remove invalid data : null / measurement error:  79%|███████▊  | 484/616 [00:02<00:00, 220.77it/s]remove invalid data : null / measurement error:  82%|████████▏ | 507/616 [00:02<00:00, 216.12it/s]remove invalid data : null / measurement error:  86%|████████▌ | 529/616 [00:02<00:00, 212.18it/s]remove invalid data : null / measurement error:  89%|████████▉ | 551/616 [00:02<00:00, 208.12it/s]remove invalid data : null / measurement error:  93%|█████████▎| 572/616 [00:02<00:00, 206.99it/s]remove invalid data : null / measurement error:  96%|█████████▋| 593/616 [00:02<00:00, 206.65it/s]remove invalid data : null / measurement error: 100%|█████████▉| 614/616 [00:02<00:00, 206.16it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.02it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 240.09it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 239.77it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 240.65it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 242.61it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 243.54it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 244.88it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 245.48it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 245.37it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 245.81it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 246.21it/s]replace nan value:  53%|█████▎    | 275/515 [00:01<00:00, 246.93it/s]replace nan value:  58%|█████▊    | 300/515 [00:01<00:00, 245.46it/s]replace nan value:  63%|██████▎   | 325/515 [00:01<00:00, 245.03it/s]replace nan value:  68%|██████▊   | 350/515 [00:01<00:00, 242.07it/s]replace nan value:  73%|███████▎  | 375/515 [00:01<00:00, 241.18it/s]replace nan value:  78%|███████▊  | 400/515 [00:01<00:00, 242.54it/s]replace nan value:  83%|████████▎ | 425/515 [00:01<00:00, 242.74it/s]replace nan value:  87%|████████▋ | 450/515 [00:01<00:00, 238.78it/s]replace nan value:  92%|█████████▏| 475/515 [00:01<00:00, 240.39it/s]replace nan value:  97%|█████████▋| 500/515 [00:02<00:00, 242.13it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 243.14it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.36it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.57it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.20it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.47it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.67it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.57it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.44it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.75it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 55.51it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.38it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.36it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.76it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.53it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.36it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.89it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.27it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.53it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.26it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 71.97it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.77it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.98it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.67it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.00it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.45it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.51it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.90it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.62it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.13it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 87.08it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.37it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.39it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.21it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.34it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.12it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.32it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.20it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.49it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.92it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 62.61it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 66.22it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 55.04it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.11it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 42.62it/s]generate index:  69%|██████▉   | 356/515 [00:05<00:03, 50.61it/s]generate index:  71%|███████▏  | 367/515 [00:05<00:02, 63.59it/s]generate index:  73%|███████▎  | 378/515 [00:05<00:01, 74.79it/s]generate index:  75%|███████▌  | 387/515 [00:05<00:01, 77.78it/s]generate index:  77%|███████▋  | 396/515 [00:05<00:01, 77.91it/s]generate index:  79%|███████▊  | 405/515 [00:06<00:01, 67.48it/s]generate index:  80%|████████  | 413/515 [00:06<00:01, 64.45it/s]generate index:  82%|████████▏ | 424/515 [00:06<00:01, 75.17it/s]generate index:  84%|████████▍ | 433/515 [00:06<00:01, 64.80it/s]generate index:  86%|████████▌ | 441/515 [00:06<00:01, 47.44it/s]generate index:  87%|████████▋ | 450/515 [00:06<00:01, 55.28it/s]generate index:  89%|████████▉ | 458/515 [00:07<00:00, 58.54it/s]generate index:  90%|█████████ | 466/515 [00:07<00:00, 61.49it/s]generate index:  92%|█████████▏| 473/515 [00:07<00:00, 56.26it/s]generate index:  94%|█████████▍| 485/515 [00:07<00:00, 69.26it/s]generate index:  96%|█████████▌| 493/515 [00:07<00:00, 65.06it/s]generate index:  97%|█████████▋| 500/515 [00:07<00:00, 64.93it/s]generate index:  99%|█████████▉| 509/515 [00:07<00:00, 67.26it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.47it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 59.95it/s]remove invalid data : null / measurement error:  18%|█▊        | 27/154 [00:00<00:00, 144.53it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 173.56it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 189.83it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 197.18it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 212.17it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 209.78it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 193.50it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.43it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.03it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 250.75it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 248.26it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 250.74it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 249.89it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 67.46it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 41.54it/s]generate index:  16%|█▌        | 21/131 [00:00<00:02, 50.37it/s]generate index:  21%|██        | 27/131 [00:00<00:01, 52.74it/s]generate index:  25%|██▌       | 33/131 [00:00<00:01, 54.97it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 55.04it/s]generate index:  34%|███▍      | 45/131 [00:00<00:01, 49.86it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 51.48it/s]generate index:  44%|████▎     | 57/131 [00:01<00:01, 47.04it/s]generate index:  49%|████▉     | 64/131 [00:01<00:01, 52.11it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:01, 53.73it/s]generate index:  59%|█████▉    | 77/131 [00:01<00:00, 58.14it/s]generate index:  64%|██████▍   | 84/131 [00:01<00:00, 60.92it/s]generate index:  69%|██████▉   | 91/131 [00:01<00:00, 43.57it/s]generate index:  74%|███████▍  | 97/131 [00:01<00:00, 46.47it/s]generate index:  79%|███████▊  | 103/131 [00:02<00:00, 45.80it/s]generate index:  83%|████████▎ | 109/131 [00:02<00:00, 48.78it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 59.06it/s]generate index:  98%|█████████▊| 129/131 [00:02<00:00, 72.26it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 54.18it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 38.60it/s]remove invalid data : null / measurement error:  13%|█▎        | 26/193 [00:00<00:01, 139.83it/s]remove invalid data : null / measurement error:  24%|██▍       | 47/193 [00:00<00:00, 170.17it/s]remove invalid data : null / measurement error:  36%|███▌      | 69/193 [00:00<00:00, 187.52it/s]remove invalid data : null / measurement error:  47%|████▋     | 91/193 [00:00<00:00, 197.99it/s]remove invalid data : null / measurement error:  58%|█████▊    | 111/193 [00:00<00:00, 197.49it/s]remove invalid data : null / measurement error:  70%|███████   | 136/193 [00:00<00:00, 213.11it/s]remove invalid data : null / measurement error:  82%|████████▏ | 158/193 [00:00<00:00, 212.92it/s]remove invalid data : null / measurement error:  93%|█████████▎| 180/193 [00:00<00:00, 208.57it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 194.05it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 252.71it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 254.24it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 250.36it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 247.09it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 248.95it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 250.30it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 250.00it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   5%|▌         | 8/160 [00:00<00:02, 73.19it/s]generate index:  10%|█         | 16/160 [00:00<00:02, 58.10it/s]generate index:  14%|█▍        | 23/160 [00:00<00:02, 56.33it/s]generate index:  18%|█▊        | 29/160 [00:00<00:02, 52.18it/s]generate index:  23%|██▎       | 37/160 [00:00<00:02, 57.32it/s]generate index:  28%|██▊       | 45/160 [00:00<00:01, 63.25it/s]generate index:  35%|███▌      | 56/160 [00:00<00:01, 74.06it/s]generate index:  41%|████▏     | 66/160 [00:00<00:01, 78.62it/s]generate index:  46%|████▋     | 74/160 [00:01<00:01, 75.55it/s]generate index:  51%|█████▏    | 82/160 [00:01<00:01, 67.21it/s]generate index:  56%|█████▌    | 89/160 [00:01<00:01, 55.84it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 53.53it/s]generate index:  63%|██████▎   | 101/160 [00:01<00:01, 49.93it/s]generate index:  67%|██████▋   | 107/160 [00:01<00:01, 45.72it/s]generate index:  72%|███████▎  | 116/160 [00:01<00:00, 54.35it/s]generate index:  78%|███████▊  | 124/160 [00:02<00:00, 59.43it/s]generate index:  82%|████████▏ | 131/160 [00:02<00:00, 55.23it/s]generate index:  86%|████████▌ | 137/160 [00:02<00:00, 52.42it/s]generate index:  91%|█████████ | 145/160 [00:02<00:00, 58.00it/s]generate index:  95%|█████████▌| 152/160 [00:02<00:00, 59.93it/s]generate index:  99%|█████████▉| 159/160 [00:02<00:00, 59.02it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 58.45it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:28<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 186, in train
    valid_loss, valid_acc, valid_f1 = valid_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 103, in valid_per_epoch
    for batch_idx, (data, target) in enumerate(valid_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-4:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 513, in Client
    answer_challenge(c, authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 757, in answer_challenge
    message = connection.recv_bytes(256)         # reject large message
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 388, in _recv
    raise EOFError
EOFError
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_CE_smoothing_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:02, 199.65it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 197.37it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 195.47it/s]remove invalid data : null / measurement error:  13%|█▎        | 81/616 [00:00<00:02, 197.39it/s]remove invalid data : null / measurement error:  17%|█▋        | 102/616 [00:00<00:02, 199.36it/s]remove invalid data : null / measurement error:  20%|█▉        | 123/616 [00:00<00:02, 202.63it/s]remove invalid data : null / measurement error:  23%|██▎       | 144/616 [00:00<00:02, 204.40it/s]remove invalid data : null / measurement error:  27%|██▋       | 166/616 [00:00<00:02, 206.80it/s]remove invalid data : null / measurement error:  30%|███       | 187/616 [00:00<00:02, 204.37it/s]remove invalid data : null / measurement error:  34%|███▍      | 208/616 [00:01<00:02, 203.02it/s]remove invalid data : null / measurement error:  37%|███▋      | 229/616 [00:01<00:01, 204.85it/s]remove invalid data : null / measurement error:  41%|████      | 250/616 [00:01<00:01, 204.78it/s]remove invalid data : null / measurement error:  44%|████▍     | 271/616 [00:01<00:01, 206.26it/s]remove invalid data : null / measurement error:  47%|████▋     | 292/616 [00:01<00:01, 204.79it/s]remove invalid data : null / measurement error:  51%|█████     | 313/616 [00:01<00:01, 203.15it/s]remove invalid data : null / measurement error:  54%|█████▍    | 334/616 [00:01<00:01, 202.22it/s]remove invalid data : null / measurement error:  58%|█████▊    | 355/616 [00:01<00:01, 201.53it/s]remove invalid data : null / measurement error:  62%|██████▏   | 380/616 [00:01<00:01, 213.47it/s]remove invalid data : null / measurement error:  66%|██████▌   | 406/616 [00:01<00:00, 225.91it/s]remove invalid data : null / measurement error:  70%|██████▉   | 430/616 [00:02<00:00, 228.87it/s]remove invalid data : null / measurement error:  74%|███████▎  | 454/616 [00:02<00:00, 230.15it/s]remove invalid data : null / measurement error:  78%|███████▊  | 478/616 [00:02<00:00, 223.04it/s]remove invalid data : null / measurement error:  81%|████████▏ | 501/616 [00:02<00:00, 215.75it/s]remove invalid data : null / measurement error:  85%|████████▍ | 523/616 [00:02<00:00, 211.94it/s]remove invalid data : null / measurement error:  88%|████████▊ | 545/616 [00:02<00:00, 207.07it/s]remove invalid data : null / measurement error:  92%|█████████▏| 566/616 [00:02<00:00, 206.34it/s]remove invalid data : null / measurement error:  95%|█████████▌| 587/616 [00:02<00:00, 205.75it/s]remove invalid data : null / measurement error:  99%|█████████▊| 608/616 [00:02<00:00, 204.84it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.91it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 232.33it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 231.86it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 232.56it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 235.23it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 236.24it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 237.73it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 238.24it/s]replace nan value:  37%|███▋      | 193/515 [00:00<00:01, 238.64it/s]replace nan value:  42%|████▏     | 217/515 [00:00<00:01, 238.87it/s]replace nan value:  47%|████▋     | 241/515 [00:01<00:01, 239.20it/s]replace nan value:  52%|█████▏    | 266/515 [00:01<00:01, 239.53it/s]replace nan value:  56%|█████▋    | 290/515 [00:01<00:00, 238.75it/s]replace nan value:  61%|██████    | 315/515 [00:01<00:00, 240.01it/s]replace nan value:  66%|██████▌   | 340/515 [00:01<00:00, 239.25it/s]replace nan value:  71%|███████   | 364/515 [00:01<00:00, 238.13it/s]replace nan value:  76%|███████▌  | 389/515 [00:01<00:00, 238.89it/s]replace nan value:  80%|████████  | 413/515 [00:01<00:00, 238.36it/s]replace nan value:  85%|████████▍ | 437/515 [00:01<00:00, 237.28it/s]replace nan value:  90%|████████▉ | 461/515 [00:01<00:00, 237.52it/s]replace nan value:  94%|█████████▍| 485/515 [00:02<00:00, 238.14it/s]replace nan value:  99%|█████████▉| 509/515 [00:02<00:00, 238.29it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 237.78it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.53it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.28it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.26it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.49it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.29it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.04it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.97it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.09it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.57it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.40it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.17it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.69it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.40it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 63.95it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.46it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.53it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 70.11it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.81it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.97it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 70.57it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 71.55it/s]generate index:  34%|███▍      | 175/515 [00:02<00:04, 68.07it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.12it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 69.89it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.14it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.21it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 80.95it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.38it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.39it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.13it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.68it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.82it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.74it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.34it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.43it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.44it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.32it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.69it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 62.27it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 65.71it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 54.83it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.07it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 44.38it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 51.13it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 58.06it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 73.18it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 76.60it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 74.70it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.08it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.70it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.17it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.83it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.31it/s]generate index:  86%|████████▌ | 444/515 [00:06<00:01, 48.21it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.78it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.04it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.52it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.22it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.89it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 63.50it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.24it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 64.06it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 68.63it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 148.33it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 174.32it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 188.92it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 195.25it/s]remove invalid data : null / measurement error:  75%|███████▍  | 115/154 [00:00<00:00, 206.19it/s]remove invalid data : null / measurement error:  88%|████████▊ | 136/154 [00:00<00:00, 204.27it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 190.83it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 244.71it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 244.55it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 243.84it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 241.21it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 243.72it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 243.62it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.06it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.62it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.83it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.88it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.91it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.09it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.39it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.65it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 68.17it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 70.42it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.69it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.30it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.00it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 47.96it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 48.62it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.18it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 67.37it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.82it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 98.53it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:01, 160.21it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 183.99it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 195.89it/s]remove invalid data : null / measurement error:  50%|█████     | 97/193 [00:00<00:00, 201.16it/s]remove invalid data : null / measurement error:  62%|██████▏   | 119/193 [00:00<00:00, 205.99it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 216.40it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 211.75it/s]remove invalid data : null / measurement error:  97%|█████████▋| 187/193 [00:00<00:00, 208.86it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 199.69it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 247.00it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 249.83it/s]replace nan value:  48%|████▊     | 76/160 [00:00<00:00, 248.85it/s]replace nan value:  63%|██████▎   | 101/160 [00:00<00:00, 246.13it/s]replace nan value:  79%|███████▉  | 126/160 [00:00<00:00, 245.37it/s]replace nan value:  94%|█████████▍| 151/160 [00:00<00:00, 245.45it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 246.10it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 103.87it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.38it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.11it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.64it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.01it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.71it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.74it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.62it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.00it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.80it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.43it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.58it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.42it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.90it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.73it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.29it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.31it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.43it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.93it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:07<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-3:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 513, in Client
    answer_challenge(c, authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 762, in answer_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 384, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 14/616 [00:00<00:04, 137.96it/s]remove invalid data : null / measurement error:   5%|▌         | 33/616 [00:00<00:03, 164.98it/s]remove invalid data : null / measurement error:   9%|▊         | 53/616 [00:00<00:03, 179.18it/s]remove invalid data : null / measurement error:  12%|█▏        | 74/616 [00:00<00:02, 188.10it/s]remove invalid data : null / measurement error:  15%|█▌        | 95/616 [00:00<00:02, 195.75it/s]remove invalid data : null / measurement error:  19%|█▉        | 117/616 [00:00<00:02, 201.80it/s]remove invalid data : null / measurement error:  23%|██▎       | 139/616 [00:00<00:02, 204.62it/s]remove invalid data : null / measurement error:  26%|██▌       | 161/616 [00:00<00:02, 208.90it/s]remove invalid data : null / measurement error:  30%|██▉       | 182/616 [00:00<00:02, 207.26it/s]remove invalid data : null / measurement error:  33%|███▎      | 203/616 [00:01<00:02, 205.97it/s]remove invalid data : null / measurement error:  36%|███▋      | 224/616 [00:01<00:01, 206.12it/s]remove invalid data : null / measurement error:  40%|███▉      | 245/616 [00:01<00:01, 206.70it/s]remove invalid data : null / measurement error:  43%|████▎     | 267/616 [00:01<00:01, 208.12it/s]remove invalid data : null / measurement error:  47%|████▋     | 288/616 [00:01<00:01, 206.89it/s]remove invalid data : null / measurement error:  50%|█████     | 309/616 [00:01<00:01, 205.88it/s]remove invalid data : null / measurement error:  54%|█████▎    | 330/616 [00:01<00:01, 205.45it/s]remove invalid data : null / measurement error:  57%|█████▋    | 351/616 [00:01<00:01, 205.14it/s]remove invalid data : null / measurement error:  61%|██████    | 375/616 [00:01<00:01, 213.76it/s]remove invalid data : null / measurement error:  65%|██████▌   | 401/616 [00:01<00:00, 227.20it/s]remove invalid data : null / measurement error:  69%|██████▉   | 427/616 [00:02<00:00, 234.42it/s]remove invalid data : null / measurement error:  73%|███████▎  | 451/616 [00:02<00:00, 233.83it/s]remove invalid data : null / measurement error:  77%|███████▋  | 475/616 [00:02<00:00, 228.05it/s]remove invalid data : null / measurement error:  81%|████████  | 498/616 [00:02<00:00, 220.73it/s]remove invalid data : null / measurement error:  85%|████████▍ | 521/616 [00:02<00:00, 216.56it/s]remove invalid data : null / measurement error:  88%|████████▊ | 543/616 [00:02<00:00, 212.05it/s]remove invalid data : null / measurement error:  92%|█████████▏| 565/616 [00:02<00:00, 209.99it/s]remove invalid data : null / measurement error:  95%|█████████▌| 587/616 [00:02<00:00, 208.45it/s]remove invalid data : null / measurement error:  99%|█████████▊| 608/616 [00:02<00:00, 206.95it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 208.35it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 236.04it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 237.73it/s]replace nan value:  14%|█▍        | 73/515 [00:00<00:01, 239.22it/s]replace nan value:  19%|█▉        | 98/515 [00:00<00:01, 241.33it/s]replace nan value:  24%|██▍       | 123/515 [00:00<00:01, 239.60it/s]replace nan value:  29%|██▊       | 148/515 [00:00<00:01, 242.08it/s]replace nan value:  34%|███▎      | 173/515 [00:00<00:01, 243.23it/s]replace nan value:  38%|███▊      | 198/515 [00:00<00:01, 243.80it/s]replace nan value:  43%|████▎     | 223/515 [00:00<00:01, 244.36it/s]replace nan value:  48%|████▊     | 248/515 [00:01<00:01, 245.05it/s]replace nan value:  53%|█████▎    | 273/515 [00:01<00:00, 245.92it/s]replace nan value:  58%|█████▊    | 298/515 [00:01<00:00, 244.93it/s]replace nan value:  63%|██████▎   | 323/515 [00:01<00:00, 245.29it/s]replace nan value:  68%|██████▊   | 348/515 [00:01<00:00, 241.51it/s]replace nan value:  72%|███████▏  | 373/515 [00:01<00:00, 241.66it/s]replace nan value:  77%|███████▋  | 398/515 [00:01<00:00, 241.40it/s]replace nan value:  82%|████████▏ | 423/515 [00:01<00:00, 241.80it/s]replace nan value:  87%|████████▋ | 448/515 [00:01<00:00, 240.56it/s]replace nan value:  92%|█████████▏| 473/515 [00:01<00:00, 241.76it/s]replace nan value:  97%|█████████▋| 498/515 [00:02<00:00, 243.12it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 242.47it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.16it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.55it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.30it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.61it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 74.18it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.22it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.30it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.62it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.40it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.42it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.49it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.76it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.60it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.42it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.97it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.85it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.85it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.28it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.03it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.83it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.89it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.97it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.27it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.71it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.05it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.14it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.25it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 87.00it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 89.64it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.31it/s]generate index:  51%|█████     | 261/515 [00:03<00:03, 74.01it/s]generate index:  52%|█████▏    | 270/515 [00:03<00:03, 77.21it/s]generate index:  54%|█████▍    | 279/515 [00:04<00:03, 67.68it/s]generate index:  56%|█████▌    | 287/515 [00:04<00:03, 65.84it/s]generate index:  57%|█████▋    | 295/515 [00:04<00:03, 65.77it/s]generate index:  59%|█████▊    | 302/515 [00:04<00:03, 62.43it/s]generate index:  60%|██████    | 311/515 [00:04<00:03, 65.97it/s]generate index:  62%|██████▏   | 318/515 [00:04<00:03, 60.80it/s]generate index:  63%|██████▎   | 326/515 [00:04<00:02, 65.01it/s]generate index:  65%|██████▍   | 333/515 [00:04<00:02, 66.10it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 48.66it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 46.39it/s]generate index:  68%|██████▊   | 352/515 [00:05<00:03, 45.46it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.98it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.43it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 76.48it/s]generate index:  76%|███████▋  | 393/515 [00:05<00:01, 74.98it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.61it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.83it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.54it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 77.14it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 54.38it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 50.21it/s]generate index:  88%|████████▊ | 455/515 [00:06<00:00, 60.07it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.27it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.19it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.45it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.27it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 65.06it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.94it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 65.17it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 58.43it/s]remove invalid data : null / measurement error:  18%|█▊        | 27/154 [00:00<00:00, 145.22it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 173.81it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 189.49it/s]remove invalid data : null / measurement error:  59%|█████▉    | 91/154 [00:00<00:00, 196.72it/s]remove invalid data : null / measurement error:  75%|███████▌  | 116/154 [00:00<00:00, 212.01it/s]remove invalid data : null / measurement error:  90%|████████▉ | 138/154 [00:00<00:00, 209.67it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 193.32it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 253.30it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 254.17it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 254.95it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 252.18it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 254.12it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 253.68it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 72.30it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.56it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 56.58it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 58.31it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 64.32it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 65.17it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 61.85it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 66.78it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 66.65it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 68.37it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 66.13it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 47.52it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 49.68it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 47.89it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 52.21it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 61.14it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 70.79it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.89it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/193 [00:00<00:03, 47.71it/s]remove invalid data : null / measurement error:  14%|█▍        | 27/193 [00:00<00:01, 144.00it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 174.50it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 190.10it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 197.76it/s]remove invalid data : null / measurement error:  59%|█████▉    | 114/193 [00:00<00:00, 200.79it/s]remove invalid data : null / measurement error:  72%|███████▏  | 139/193 [00:00<00:00, 215.27it/s]remove invalid data : null / measurement error:  83%|████████▎ | 161/193 [00:00<00:00, 213.94it/s]remove invalid data : null / measurement error:  95%|█████████▍| 183/193 [00:00<00:00, 211.38it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 196.36it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 255.06it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 254.60it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 252.12it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 250.16it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 250.77it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 251.50it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 251.59it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.48it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.98it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.33it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.90it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.46it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.63it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.95it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.89it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.10it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.98it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.53it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.61it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.52it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.58it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 57.04it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.79it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 60.11it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 64.51it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.82it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:07<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.79it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:03, 149.07it/s]remove invalid data : null / measurement error:  10%|▉         | 61/616 [00:00<00:03, 160.95it/s]remove invalid data : null / measurement error:  13%|█▎        | 78/616 [00:00<00:03, 149.04it/s]remove invalid data : null / measurement error:  16%|█▌        | 98/616 [00:00<00:03, 162.38it/s]remove invalid data : null / measurement error:  19%|█▉        | 118/616 [00:00<00:02, 173.07it/s]remove invalid data : null / measurement error:  22%|██▏       | 138/616 [00:00<00:02, 179.79it/s]remove invalid data : null / measurement error:  25%|██▌       | 157/616 [00:00<00:02, 168.04it/s]remove invalid data : null / measurement error:  28%|██▊       | 175/616 [00:01<00:02, 165.71it/s]remove invalid data : null / measurement error:  32%|███▏      | 196/616 [00:01<00:02, 175.94it/s]remove invalid data : null / measurement error:  35%|███▌      | 217/616 [00:01<00:02, 184.71it/s]remove invalid data : null / measurement error:  39%|███▊      | 238/616 [00:01<00:01, 190.98it/s]remove invalid data : null / measurement error:  42%|████▏     | 259/616 [00:01<00:01, 195.67it/s]remove invalid data : null / measurement error:  45%|████▌     | 280/616 [00:01<00:01, 198.82it/s]remove invalid data : null / measurement error:  49%|████▉     | 301/616 [00:01<00:01, 200.53it/s]remove invalid data : null / measurement error:  52%|█████▏    | 322/616 [00:01<00:01, 200.33it/s]remove invalid data : null / measurement error:  56%|█████▌    | 343/616 [00:01<00:01, 201.11it/s]remove invalid data : null / measurement error:  59%|█████▉    | 365/616 [00:01<00:01, 204.31it/s]remove invalid data : null / measurement error:  63%|██████▎   | 391/616 [00:02<00:01, 219.11it/s]remove invalid data : null / measurement error:  68%|██████▊   | 418/616 [00:02<00:00, 233.75it/s]remove invalid data : null / measurement error:  72%|███████▏  | 442/616 [00:02<00:00, 228.98it/s]remove invalid data : null / measurement error:  75%|███████▌  | 465/616 [00:02<00:00, 229.08it/s]remove invalid data : null / measurement error:  79%|███████▉  | 488/616 [00:02<00:00, 222.34it/s]remove invalid data : null / measurement error:  83%|████████▎ | 511/616 [00:02<00:00, 216.73it/s]remove invalid data : null / measurement error:  87%|████████▋ | 533/616 [00:02<00:00, 211.74it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 207.05it/s]remove invalid data : null / measurement error:  94%|█████████▎| 576/616 [00:02<00:00, 204.47it/s]remove invalid data : null / measurement error:  97%|█████████▋| 597/616 [00:03<00:00, 202.98it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 195.73it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 231.66it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 189.27it/s]replace nan value:  13%|█▎        | 68/515 [00:00<00:02, 179.00it/s]replace nan value:  18%|█▊        | 91/515 [00:00<00:02, 194.94it/s]replace nan value:  22%|██▏       | 114/515 [00:00<00:01, 205.53it/s]replace nan value:  27%|██▋       | 137/515 [00:00<00:01, 212.39it/s]replace nan value:  31%|███       | 160/515 [00:00<00:01, 216.84it/s]replace nan value:  36%|███▌      | 183/515 [00:00<00:01, 219.79it/s]replace nan value:  40%|████      | 206/515 [00:01<00:01, 193.36it/s]replace nan value:  44%|████▍     | 229/515 [00:01<00:01, 202.19it/s]replace nan value:  49%|████▉     | 254/515 [00:01<00:01, 213.97it/s]replace nan value:  54%|█████▍    | 279/515 [00:01<00:01, 223.01it/s]replace nan value:  59%|█████▉    | 304/515 [00:01<00:00, 228.92it/s]replace nan value:  64%|██████▍   | 329/515 [00:01<00:00, 233.57it/s]replace nan value:  69%|██████▊   | 353/515 [00:01<00:00, 233.76it/s]replace nan value:  73%|███████▎  | 377/515 [00:01<00:00, 224.09it/s]replace nan value:  78%|███████▊  | 401/515 [00:01<00:00, 228.26it/s]replace nan value:  83%|████████▎ | 425/515 [00:01<00:00, 230.90it/s]replace nan value:  87%|████████▋ | 449/515 [00:02<00:00, 232.76it/s]replace nan value:  92%|█████████▏| 474/515 [00:02<00:00, 236.03it/s]replace nan value:  97%|█████████▋| 499/515 [00:02<00:00, 238.77it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 220.96it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.22it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.39it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.83it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.06it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.10it/s]generate index:  10%|▉         | 49/515 [00:00<00:10, 45.01it/s]generate index:  11%|█         | 55/515 [00:01<00:09, 47.05it/s]generate index:  12%|█▏        | 61/515 [00:01<00:12, 36.97it/s]generate index:  13%|█▎        | 69/515 [00:01<00:10, 44.18it/s]generate index:  15%|█▍        | 76/515 [00:01<00:09, 47.33it/s]generate index:  16%|█▌        | 82/515 [00:01<00:09, 46.95it/s]generate index:  17%|█▋        | 88/515 [00:01<00:08, 48.80it/s]generate index:  18%|█▊        | 95/515 [00:01<00:08, 51.52it/s]generate index:  20%|█▉        | 101/515 [00:01<00:07, 51.99it/s]generate index:  21%|██▏       | 110/515 [00:02<00:06, 60.20it/s]generate index:  23%|██▎       | 118/515 [00:02<00:06, 60.08it/s]generate index:  24%|██▍       | 125/515 [00:02<00:06, 60.32it/s]generate index:  26%|██▌       | 133/515 [00:02<00:05, 64.16it/s]generate index:  27%|██▋       | 140/515 [00:02<00:05, 64.90it/s]generate index:  29%|██▊       | 147/515 [00:02<00:05, 65.29it/s]generate index:  30%|███       | 156/515 [00:02<00:05, 68.67it/s]generate index:  32%|███▏      | 165/515 [00:02<00:04, 71.55it/s]generate index:  34%|███▎      | 173/515 [00:03<00:05, 65.72it/s]generate index:  35%|███▌      | 182/515 [00:03<00:04, 71.35it/s]generate index:  37%|███▋      | 190/515 [00:03<00:04, 69.02it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 68.17it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 66.35it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 85.77it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 82.26it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 78.88it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 80.73it/s]generate index:  50%|████▉     | 256/515 [00:04<00:03, 66.47it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 72.37it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 73.11it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 59.40it/s]generate index:  57%|█████▋    | 291/515 [00:04<00:03, 58.28it/s]generate index:  58%|█████▊    | 298/515 [00:04<00:04, 51.22it/s]generate index:  59%|█████▉    | 305/515 [00:05<00:03, 54.50it/s]generate index:  61%|██████    | 312/515 [00:05<00:03, 58.03it/s]generate index:  62%|██████▏   | 319/515 [00:05<00:03, 56.27it/s]generate index:  63%|██████▎   | 327/515 [00:05<00:03, 61.45it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 56.58it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 47.05it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 45.08it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.32it/s]generate index:  70%|███████   | 363/515 [00:06<00:02, 57.12it/s]generate index:  73%|███████▎  | 374/515 [00:06<00:02, 66.68it/s]generate index:  74%|███████▍  | 382/515 [00:06<00:02, 62.09it/s]generate index:  76%|███████▌  | 389/515 [00:06<00:02, 60.62it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 68.22it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 58.04it/s]generate index:  81%|████████  | 415/515 [00:06<00:01, 62.71it/s]generate index:  82%|████████▏ | 424/515 [00:07<00:01, 65.35it/s]generate index:  84%|████████▎ | 431/515 [00:07<00:01, 52.57it/s]generate index:  85%|████████▍ | 437/515 [00:07<00:01, 40.75it/s]generate index:  86%|████████▌ | 442/515 [00:07<00:01, 37.03it/s]generate index:  88%|████████▊ | 452/515 [00:07<00:01, 48.94it/s]generate index:  89%|████████▉ | 458/515 [00:07<00:01, 49.40it/s]generate index:  90%|█████████ | 464/515 [00:08<00:01, 50.34it/s]generate index:  91%|█████████▏| 470/515 [00:08<00:01, 44.78it/s]generate index:  93%|█████████▎| 480/515 [00:08<00:00, 55.85it/s]generate index:  95%|█████████▍| 488/515 [00:08<00:00, 61.41it/s]generate index:  96%|█████████▌| 495/515 [00:08<00:00, 62.30it/s]generate index:  98%|█████████▊| 503/515 [00:08<00:00, 66.07it/s]generate index:  99%|█████████▉| 510/515 [00:08<00:00, 64.18it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 58.15it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|▏         | 2/154 [00:00<00:08, 18.83it/s]remove invalid data : null / measurement error:  16%|█▌        | 24/154 [00:00<00:00, 131.32it/s]remove invalid data : null / measurement error:  30%|██▉       | 46/154 [00:00<00:00, 167.21it/s]remove invalid data : null / measurement error:  44%|████▍     | 68/154 [00:00<00:00, 186.00it/s]remove invalid data : null / measurement error:  58%|█████▊    | 89/154 [00:00<00:00, 193.70it/s]remove invalid data : null / measurement error:  74%|███████▍  | 114/154 [00:00<00:00, 210.47it/s]remove invalid data : null / measurement error:  88%|████████▊ | 136/154 [00:00<00:00, 208.49it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 188.73it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 16/131 [00:00<00:00, 150.13it/s]replace nan value:  27%|██▋       | 35/131 [00:00<00:00, 172.75it/s]replace nan value:  46%|████▌     | 60/131 [00:00<00:00, 204.89it/s]replace nan value:  66%|██████▌   | 86/131 [00:00<00:00, 222.77it/s]replace nan value:  83%|████████▎ | 109/131 [00:00<00:00, 189.68it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 197.87it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   4%|▍         | 5/131 [00:00<00:02, 46.69it/s]generate index:   8%|▊         | 10/131 [00:00<00:02, 48.30it/s]generate index:  11%|█▏        | 15/131 [00:00<00:02, 46.99it/s]generate index:  16%|█▌        | 21/131 [00:00<00:02, 51.89it/s]generate index:  21%|██        | 27/131 [00:00<00:02, 46.17it/s]generate index:  24%|██▍       | 32/131 [00:00<00:02, 44.68it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 51.92it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 56.18it/s]generate index:  40%|███▉      | 52/131 [00:01<00:01, 55.00it/s]generate index:  46%|████▌     | 60/131 [00:01<00:01, 61.91it/s]generate index:  51%|█████     | 67/131 [00:01<00:01, 53.13it/s]generate index:  56%|█████▌    | 73/131 [00:01<00:01, 54.44it/s]generate index:  60%|██████    | 79/131 [00:01<00:00, 52.76it/s]generate index:  66%|██████▌   | 86/131 [00:01<00:00, 51.94it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 42.60it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 45.57it/s]generate index:  79%|███████▊  | 103/131 [00:02<00:00, 45.48it/s]generate index:  83%|████████▎ | 109/131 [00:02<00:00, 48.31it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 58.50it/s]generate index:  98%|█████████▊| 129/131 [00:02<00:00, 72.06it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 53.59it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 39.23it/s]remove invalid data : null / measurement error:  13%|█▎        | 26/193 [00:00<00:01, 142.16it/s]remove invalid data : null / measurement error:  25%|██▍       | 48/193 [00:00<00:00, 174.22it/s]remove invalid data : null / measurement error:  36%|███▋      | 70/193 [00:00<00:00, 190.09it/s]remove invalid data : null / measurement error:  46%|████▌     | 89/193 [00:00<00:00, 166.97it/s]remove invalid data : null / measurement error:  55%|█████▌    | 107/193 [00:00<00:00, 168.06it/s]remove invalid data : null / measurement error:  68%|██████▊   | 132/193 [00:00<00:00, 191.10it/s]remove invalid data : null / measurement error:  80%|███████▉  | 154/193 [00:00<00:00, 196.88it/s]remove invalid data : null / measurement error:  91%|█████████ | 175/193 [00:00<00:00, 198.25it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 175.74it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 22/160 [00:00<00:00, 215.50it/s]replace nan value:  30%|███       | 48/160 [00:00<00:00, 238.77it/s]replace nan value:  46%|████▋     | 74/160 [00:00<00:00, 245.94it/s]replace nan value:  62%|██████▏   | 99/160 [00:00<00:00, 247.24it/s]replace nan value:  78%|███████▊  | 124/160 [00:00<00:00, 244.85it/s]replace nan value:  93%|█████████▎| 149/160 [00:00<00:00, 245.93it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 244.12it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 100.64it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.63it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.64it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.50it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.53it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.60it/s]generate index:  43%|████▎     | 69/160 [00:00<00:01, 72.66it/s]generate index:  48%|████▊     | 77/160 [00:01<00:01, 63.54it/s]generate index:  52%|█████▎    | 84/160 [00:01<00:01, 57.77it/s]generate index:  57%|█████▋    | 91/160 [00:01<00:01, 52.36it/s]generate index:  61%|██████▏   | 98/160 [00:01<00:01, 55.65it/s]generate index:  65%|██████▌   | 104/160 [00:01<00:01, 45.51it/s]generate index:  69%|██████▉   | 111/160 [00:01<00:00, 50.12it/s]generate index:  75%|███████▌  | 120/160 [00:01<00:00, 59.37it/s]generate index:  79%|███████▉  | 127/160 [00:02<00:00, 53.83it/s]generate index:  83%|████████▎ | 133/160 [00:02<00:00, 54.70it/s]generate index:  87%|████████▋ | 139/160 [00:02<00:00, 51.02it/s]generate index:  92%|█████████▏| 147/160 [00:02<00:00, 57.27it/s]generate index:  97%|█████████▋| 155/160 [00:02<00:00, 57.67it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 59.70it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:26<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 186, in train
    valid_loss, valid_acc, valid_f1 = valid_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 103, in valid_per_epoch
    for batch_idx, (data, target) in enumerate(valid_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:02, 199.85it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 197.80it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 195.99it/s]remove invalid data : null / measurement error:  13%|█▎        | 81/616 [00:00<00:02, 197.71it/s]remove invalid data : null / measurement error:  17%|█▋        | 102/616 [00:00<00:02, 199.80it/s]remove invalid data : null / measurement error:  20%|█▉        | 123/616 [00:00<00:02, 203.11it/s]remove invalid data : null / measurement error:  23%|██▎       | 144/616 [00:00<00:02, 204.72it/s]remove invalid data : null / measurement error:  27%|██▋       | 166/616 [00:00<00:02, 207.07it/s]remove invalid data : null / measurement error:  30%|███       | 187/616 [00:00<00:02, 204.51it/s]remove invalid data : null / measurement error:  34%|███▍      | 208/616 [00:01<00:02, 203.23it/s]remove invalid data : null / measurement error:  37%|███▋      | 229/616 [00:01<00:01, 205.05it/s]remove invalid data : null / measurement error:  41%|████      | 250/616 [00:01<00:01, 204.93it/s]remove invalid data : null / measurement error:  44%|████▍     | 272/616 [00:01<00:01, 206.72it/s]remove invalid data : null / measurement error:  48%|████▊     | 293/616 [00:01<00:01, 206.12it/s]remove invalid data : null / measurement error:  51%|█████     | 314/616 [00:01<00:01, 205.43it/s]remove invalid data : null / measurement error:  54%|█████▍    | 335/616 [00:01<00:01, 204.79it/s]remove invalid data : null / measurement error:  58%|█████▊    | 356/616 [00:01<00:01, 203.49it/s]remove invalid data : null / measurement error:  62%|██████▏   | 381/616 [00:01<00:01, 216.19it/s]remove invalid data : null / measurement error:  66%|██████▌   | 406/616 [00:01<00:00, 226.01it/s]remove invalid data : null / measurement error:  70%|██████▉   | 430/616 [00:02<00:00, 226.75it/s]remove invalid data : null / measurement error:  74%|███████▎  | 454/616 [00:02<00:00, 228.23it/s]remove invalid data : null / measurement error:  77%|███████▋  | 477/616 [00:02<00:00, 222.49it/s]remove invalid data : null / measurement error:  81%|████████  | 500/616 [00:02<00:00, 215.54it/s]remove invalid data : null / measurement error:  85%|████████▍ | 522/616 [00:02<00:00, 211.82it/s]remove invalid data : null / measurement error:  88%|████████▊ | 544/616 [00:02<00:00, 207.72it/s]remove invalid data : null / measurement error:  92%|█████████▏| 565/616 [00:02<00:00, 206.73it/s]remove invalid data : null / measurement error:  95%|█████████▌| 586/616 [00:02<00:00, 205.44it/s]remove invalid data : null / measurement error:  99%|█████████▊| 607/616 [00:02<00:00, 204.09it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 208.13it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.24it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 234.22it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.44it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 235.54it/s]replace nan value:  23%|██▎       | 121/515 [00:00<00:01, 237.76it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 236.85it/s]replace nan value:  33%|███▎      | 170/515 [00:00<00:01, 238.95it/s]replace nan value:  38%|███▊      | 195/515 [00:00<00:01, 239.65it/s]replace nan value:  43%|████▎     | 219/515 [00:00<00:01, 237.76it/s]replace nan value:  47%|████▋     | 244/515 [00:01<00:01, 239.23it/s]replace nan value:  52%|█████▏    | 269/515 [00:01<00:01, 240.59it/s]replace nan value:  57%|█████▋    | 294/515 [00:01<00:00, 240.30it/s]replace nan value:  62%|██████▏   | 319/515 [00:01<00:00, 240.61it/s]replace nan value:  67%|██████▋   | 344/515 [00:01<00:00, 238.80it/s]replace nan value:  71%|███████▏  | 368/515 [00:01<00:00, 237.57it/s]replace nan value:  76%|███████▋  | 393/515 [00:01<00:00, 239.25it/s]replace nan value:  81%|████████  | 417/515 [00:01<00:00, 239.20it/s]replace nan value:  86%|████████▌ | 441/515 [00:01<00:00, 236.90it/s]replace nan value:  90%|█████████ | 466/515 [00:01<00:00, 237.86it/s]replace nan value:  95%|█████████▌| 490/515 [00:02<00:00, 237.50it/s]replace nan value: 100%|█████████▉| 514/515 [00:02<00:00, 235.70it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 237.80it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.60it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.42it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.49it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.56it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.56it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 53.94it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.99it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.23it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 53.75it/s]generate index:  15%|█▍        | 77/515 [00:01<00:08, 51.77it/s]generate index:  17%|█▋        | 87/515 [00:01<00:06, 62.07it/s]generate index:  18%|█▊        | 94/515 [00:01<00:06, 61.41it/s]generate index:  20%|█▉        | 101/515 [00:01<00:07, 57.27it/s]generate index:  21%|██▏       | 110/515 [00:01<00:06, 63.29it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.08it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.07it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.05it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 70.53it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.04it/s]generate index:  31%|███       | 160/515 [00:02<00:05, 70.63it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 69.79it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 67.87it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 68.62it/s]generate index:  37%|███▋      | 191/515 [00:03<00:04, 67.52it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 66.43it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 65.16it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 85.83it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 82.39it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 79.24it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 80.97it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 66.64it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 72.70it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 75.71it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.68it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.72it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.32it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 61.27it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 60.76it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 60.15it/s]generate index:  64%|██████▎   | 328/515 [00:05<00:02, 63.87it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.80it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.90it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 45.97it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.90it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 58.21it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.40it/s]generate index:  74%|███████▍  | 383/515 [00:05<00:01, 74.29it/s]generate index:  76%|███████▌  | 391/515 [00:06<00:01, 69.95it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.24it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.95it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.21it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.03it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.44it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.89it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.88it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.66it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.65it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.41it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.23it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.61it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.04it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.36it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:03, 47.76it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 138.96it/s]remove invalid data : null / measurement error:  31%|███       | 47/154 [00:00<00:00, 169.14it/s]remove invalid data : null / measurement error:  45%|████▍     | 69/154 [00:00<00:00, 185.59it/s]remove invalid data : null / measurement error:  58%|█████▊    | 90/154 [00:00<00:00, 192.29it/s]remove invalid data : null / measurement error:  75%|███████▍  | 115/154 [00:00<00:00, 209.04it/s]remove invalid data : null / measurement error:  88%|████████▊ | 136/154 [00:00<00:00, 204.62it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 188.61it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 242.26it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 243.83it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 246.11it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 244.65it/s]replace nan value:  96%|█████████▌| 126/131 [00:00<00:00, 247.54it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 246.28it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.37it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.59it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.68it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.68it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.81it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.94it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.21it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.31it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.28it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.68it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.17it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.78it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.75it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.50it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.97it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 55.74it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 64.32it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.36it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 39.99it/s]remove invalid data : null / measurement error:  13%|█▎        | 25/193 [00:00<00:01, 139.93it/s]remove invalid data : null / measurement error:  24%|██▍       | 46/193 [00:00<00:00, 169.57it/s]remove invalid data : null / measurement error:  35%|███▍      | 67/193 [00:00<00:00, 183.70it/s]remove invalid data : null / measurement error:  46%|████▌     | 89/193 [00:00<00:00, 193.46it/s]remove invalid data : null / measurement error:  57%|█████▋    | 110/193 [00:00<00:00, 196.27it/s]remove invalid data : null / measurement error:  69%|██████▉   | 134/193 [00:00<00:00, 210.10it/s]remove invalid data : null / measurement error:  81%|████████  | 156/193 [00:00<00:00, 209.75it/s]remove invalid data : null / measurement error:  92%|█████████▏| 177/193 [00:00<00:00, 207.50it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 192.68it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 255.87it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 255.83it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 253.72it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 249.41it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 249.19it/s]replace nan value:  97%|█████████▋| 155/160 [00:00<00:00, 249.22it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 250.44it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 100.85it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.58it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.19it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.69it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.37it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.38it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.98it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.15it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.52it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.36it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.97it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.22it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.87it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.89it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.45it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.25it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.42it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 58.73it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 47.87it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 60.15it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:08<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-3:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/reduction.py", line 189, in recv_handle
    return recvfds(s, 1)[0]
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/reduction.py", line 157, in recvfds
    msg, ancdata, flags, addr = sock.recvmsg(1, socket.CMSG_SPACE(bytes_size))
ConnectionResetError: [Errno 104] Connection reset by peer
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_smoothing_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 201.72it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 199.36it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 196.95it/s]remove invalid data : null / measurement error:  13%|█▎        | 83/616 [00:00<00:02, 199.12it/s]remove invalid data : null / measurement error:  17%|█▋        | 104/616 [00:00<00:02, 201.18it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 204.14it/s]remove invalid data : null / measurement error:  24%|██▍       | 148/616 [00:00<00:02, 206.20it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 209.64it/s]remove invalid data : null / measurement error:  31%|███       | 191/616 [00:00<00:02, 208.15it/s]remove invalid data : null / measurement error:  34%|███▍      | 212/616 [00:01<00:01, 207.86it/s]remove invalid data : null / measurement error:  38%|███▊      | 233/616 [00:01<00:01, 208.06it/s]remove invalid data : null / measurement error:  41%|████      | 254/616 [00:01<00:01, 207.77it/s]remove invalid data : null / measurement error:  45%|████▍     | 276/616 [00:01<00:01, 209.05it/s]remove invalid data : null / measurement error:  48%|████▊     | 297/616 [00:01<00:01, 208.20it/s]remove invalid data : null / measurement error:  52%|█████▏    | 318/616 [00:01<00:01, 205.98it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 204.70it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 203.71it/s]remove invalid data : null / measurement error:  63%|██████▎   | 386/616 [00:01<00:01, 218.89it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:01<00:00, 233.66it/s]remove invalid data : null / measurement error:  71%|███████   | 437/616 [00:02<00:00, 230.55it/s]remove invalid data : null / measurement error:  75%|███████▌  | 462/616 [00:02<00:00, 233.14it/s]remove invalid data : null / measurement error:  79%|███████▉  | 486/616 [00:02<00:00, 225.74it/s]remove invalid data : null / measurement error:  83%|████████▎ | 509/616 [00:02<00:00, 220.41it/s]remove invalid data : null / measurement error:  86%|████████▋ | 532/616 [00:02<00:00, 216.01it/s]remove invalid data : null / measurement error:  90%|████████▉ | 554/616 [00:02<00:00, 212.31it/s]remove invalid data : null / measurement error:  94%|█████████▎| 576/616 [00:02<00:00, 210.19it/s]remove invalid data : null / measurement error:  97%|█████████▋| 598/616 [00:02<00:00, 208.30it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.11it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.88it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.33it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.09it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 238.57it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 239.46it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 240.86it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 241.62it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 241.85it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 241.98it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 242.53it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 243.05it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 242.92it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 244.25it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 242.98it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 244.29it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 245.70it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 245.84it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 244.62it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 244.77it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 244.66it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 242.65it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.67it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.49it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.57it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.80it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.42it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.53it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.50it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.90it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.47it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.41it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.28it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.85it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.13it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 63.82it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.45it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.07it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.41it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.63it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 71.81it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.96it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.37it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.53it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.93it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.47it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 65.43it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.96it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.45it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 87.43it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 88.03it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 73.06it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 72.11it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 75.18it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 78.01it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 63.69it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 66.03it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 61.19it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 62.01it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 60.15it/s]generate index:  63%|██████▎   | 323/515 [00:04<00:03, 63.47it/s]generate index:  64%|██████▍   | 331/515 [00:04<00:02, 63.58it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 51.92it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 47.19it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 42.59it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 58.97it/s]generate index:  73%|███████▎  | 374/515 [00:05<00:01, 71.96it/s]generate index:  74%|███████▍  | 383/515 [00:05<00:01, 74.00it/s]generate index:  76%|███████▌  | 392/515 [00:05<00:01, 72.55it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.22it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.34it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.28it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.68it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 56.09it/s]generate index:  86%|████████▌ | 444/515 [00:06<00:01, 49.26it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:00, 60.49it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.68it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.34it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.07it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.58it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.61it/s]generate index:  99%|█████████▉| 509/515 [00:07<00:00, 68.71it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.70it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 67.20it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 149.38it/s]remove invalid data : null / measurement error:  32%|███▏      | 50/154 [00:00<00:00, 177.78it/s]remove invalid data : null / measurement error:  47%|████▋     | 72/154 [00:00<00:00, 192.61it/s]remove invalid data : null / measurement error:  61%|██████    | 94/154 [00:00<00:00, 201.19it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 213.69it/s]remove invalid data : null / measurement error:  91%|█████████ | 140/154 [00:00<00:00, 211.52it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 195.80it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 256.30it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 257.07it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 257.30it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 254.40it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 256.26it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 255.98it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 72.07it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.80it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 57.40it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 59.69it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 65.74it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 66.49it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 62.91it/s]generate index:  48%|████▊     | 63/131 [00:00<00:01, 67.79it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 67.58it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 69.19it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 66.88it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 48.00it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 50.19it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 48.54it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 53.06it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 62.12it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 71.83it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 61.76it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 77.51it/s]remove invalid data : null / measurement error:  16%|█▌        | 30/193 [00:00<00:01, 157.38it/s]remove invalid data : null / measurement error:  27%|██▋       | 52/193 [00:00<00:00, 183.30it/s]remove invalid data : null / measurement error:  38%|███▊      | 74/193 [00:00<00:00, 197.19it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 202.95it/s]remove invalid data : null / measurement error:  61%|██████    | 118/193 [00:00<00:00, 207.48it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 219.63it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 215.37it/s]remove invalid data : null / measurement error:  97%|█████████▋| 187/193 [00:00<00:00, 212.93it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 201.38it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 256.80it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 258.48it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 257.54it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 254.75it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 254.75it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 254.95it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 255.38it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 107.13it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 65.86it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 64.21it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 77.22it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 83.53it/s]generate index:  38%|███▊      | 61/160 [00:00<00:01, 83.51it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 86.28it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 70.80it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.74it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 61.67it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.82it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.65it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.64it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.75it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.94it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.54it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.67it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.89it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.99it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:10<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-3:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 514, in Client
    deliver_challenge(c, authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 745, in deliver_challenge
    response = connection.recv_bytes(256)        # reject large message
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 384, in _recv
    chunk = read(handle, remaining)
ConnectionResetError: [Errno 104] Connection reset by peer
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_smoothing_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 202.79it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 200.09it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 197.73it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 199.93it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 201.51it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 204.31it/s]remove invalid data : null / measurement error:  24%|██▍       | 147/616 [00:00<00:02, 205.97it/s]remove invalid data : null / measurement error:  27%|██▋       | 169/616 [00:00<00:02, 208.24it/s]remove invalid data : null / measurement error:  31%|███       | 190/616 [00:00<00:02, 206.44it/s]remove invalid data : null / measurement error:  34%|███▍      | 211/616 [00:01<00:01, 206.27it/s]remove invalid data : null / measurement error:  38%|███▊      | 232/616 [00:01<00:01, 206.68it/s]remove invalid data : null / measurement error:  41%|████      | 253/616 [00:01<00:01, 206.25it/s]remove invalid data : null / measurement error:  44%|████▍     | 274/616 [00:01<00:01, 207.09it/s]remove invalid data : null / measurement error:  48%|████▊     | 295/616 [00:01<00:01, 205.86it/s]remove invalid data : null / measurement error:  51%|█████▏    | 316/616 [00:01<00:01, 204.14it/s]remove invalid data : null / measurement error:  55%|█████▍    | 337/616 [00:01<00:01, 203.27it/s]remove invalid data : null / measurement error:  58%|█████▊    | 358/616 [00:01<00:01, 202.47it/s]remove invalid data : null / measurement error:  62%|██████▏   | 383/616 [00:01<00:01, 216.30it/s]remove invalid data : null / measurement error:  66%|██████▌   | 408/616 [00:01<00:00, 225.43it/s]remove invalid data : null / measurement error:  70%|██████▉   | 431/616 [00:02<00:00, 225.08it/s]remove invalid data : null / measurement error:  74%|███████▍  | 455/616 [00:02<00:00, 227.93it/s]remove invalid data : null / measurement error:  78%|███████▊  | 478/616 [00:02<00:00, 221.70it/s]remove invalid data : null / measurement error:  81%|████████▏ | 501/616 [00:02<00:00, 215.07it/s]remove invalid data : null / measurement error:  85%|████████▍ | 523/616 [00:02<00:00, 211.71it/s]remove invalid data : null / measurement error:  88%|████████▊ | 545/616 [00:02<00:00, 207.59it/s]remove invalid data : null / measurement error:  92%|█████████▏| 566/616 [00:02<00:00, 203.99it/s]remove invalid data : null / measurement error:  95%|█████████▌| 587/616 [00:02<00:00, 200.96it/s]remove invalid data : null / measurement error:  99%|█████████▊| 608/616 [00:02<00:00, 173.35it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 203.51it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.84it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 236.92it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 237.05it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 237.28it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 210.19it/s]replace nan value:  28%|██▊       | 142/515 [00:00<00:01, 204.91it/s]replace nan value:  32%|███▏      | 165/515 [00:00<00:01, 212.17it/s]replace nan value:  37%|███▋      | 188/515 [00:00<00:01, 217.26it/s]replace nan value:  41%|████      | 211/515 [00:00<00:01, 220.35it/s]replace nan value:  46%|████▌     | 235/515 [00:01<00:01, 224.44it/s]replace nan value:  50%|█████     | 259/515 [00:01<00:01, 227.35it/s]replace nan value:  55%|█████▍    | 283/515 [00:01<00:01, 229.16it/s]replace nan value:  60%|█████▉    | 307/515 [00:01<00:00, 229.63it/s]replace nan value:  64%|██████▍   | 331/515 [00:01<00:00, 229.38it/s]replace nan value:  69%|██████▊   | 354/515 [00:01<00:00, 226.72it/s]replace nan value:  73%|███████▎  | 378/515 [00:01<00:00, 228.02it/s]replace nan value:  78%|███████▊  | 401/515 [00:01<00:00, 228.01it/s]replace nan value:  82%|████████▏ | 424/515 [00:01<00:00, 226.42it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 222.92it/s]replace nan value:  91%|█████████▏| 470/515 [00:02<00:00, 223.71it/s]replace nan value:  96%|█████████▌| 494/515 [00:02<00:00, 225.55it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 224.62it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.57it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 54.83it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.23it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 70.62it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 70.14it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 52.93it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.20it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.29it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 53.99it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 52.84it/s]generate index:  17%|█▋        | 88/515 [00:01<00:07, 60.29it/s]generate index:  18%|█▊        | 95/515 [00:01<00:07, 59.74it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 57.54it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 62.84it/s]generate index:  23%|██▎       | 118/515 [00:02<00:06, 61.27it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 68.19it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 68.52it/s]generate index:  28%|██▊       | 142/515 [00:02<00:05, 68.84it/s]generate index:  29%|██▉       | 149/515 [00:02<00:05, 68.30it/s]generate index:  30%|███       | 156/515 [00:02<00:05, 67.31it/s]generate index:  32%|███▏      | 165/515 [00:02<00:05, 64.58it/s]generate index:  33%|███▎      | 172/515 [00:02<00:06, 57.00it/s]generate index:  35%|███▍      | 179/515 [00:02<00:05, 59.16it/s]generate index:  37%|███▋      | 188/515 [00:03<00:05, 63.71it/s]generate index:  38%|███▊      | 195/515 [00:03<00:04, 64.15it/s]generate index:  39%|███▉      | 202/515 [00:03<00:05, 58.81it/s]generate index:  42%|████▏     | 215/515 [00:03<00:03, 76.64it/s]generate index:  43%|████▎     | 224/515 [00:03<00:04, 70.83it/s]generate index:  46%|████▌     | 236/515 [00:03<00:03, 82.77it/s]generate index:  48%|████▊     | 246/515 [00:03<00:03, 86.83it/s]generate index:  50%|████▉     | 256/515 [00:04<00:03, 68.71it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 74.79it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.99it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 65.42it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 67.84it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 63.10it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 64.01it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 62.01it/s]generate index:  63%|██████▎   | 323/515 [00:05<00:02, 64.97it/s]generate index:  64%|██████▍   | 331/515 [00:05<00:02, 64.65it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 52.45it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 47.55it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 42.72it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 58.47it/s]generate index:  72%|███████▏  | 369/515 [00:05<00:02, 58.29it/s]generate index:  73%|███████▎  | 377/515 [00:06<00:02, 62.25it/s]generate index:  75%|███████▍  | 385/515 [00:06<00:01, 66.25it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 67.84it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 69.32it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 59.96it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 62.29it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 74.24it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 54.55it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.76it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.14it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.07it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.06it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.01it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.81it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 62.17it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 69.82it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.49it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 87.31it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 157.32it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 180.26it/s]remove invalid data : null / measurement error:  47%|████▋     | 73/154 [00:00<00:00, 192.94it/s]remove invalid data : null / measurement error:  62%|██████▏   | 95/154 [00:00<00:00, 201.29it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 210.38it/s]remove invalid data : null / measurement error:  91%|█████████ | 140/154 [00:00<00:00, 206.08it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 194.09it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 242.99it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 248.15it/s]replace nan value:  58%|█████▊    | 76/131 [00:00<00:00, 245.92it/s]replace nan value:  77%|███████▋  | 101/131 [00:00<00:00, 244.61it/s]replace nan value:  97%|█████████▋| 127/131 [00:00<00:00, 247.45it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 246.60it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.51it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.12it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.43it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.57it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.18it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.69it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.16it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.36it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.09it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.00it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.43it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.94it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.83it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.11it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.69it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.49it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 67.36it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.27it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 38.68it/s]remove invalid data : null / measurement error:  13%|█▎        | 25/193 [00:00<00:01, 134.63it/s]remove invalid data : null / measurement error:  24%|██▍       | 46/193 [00:00<00:00, 164.75it/s]remove invalid data : null / measurement error:  35%|███▍      | 67/193 [00:00<00:00, 180.90it/s]remove invalid data : null / measurement error:  46%|████▌     | 89/193 [00:00<00:00, 191.68it/s]remove invalid data : null / measurement error:  56%|█████▋    | 109/193 [00:00<00:00, 193.82it/s]remove invalid data : null / measurement error:  69%|██████▉   | 134/193 [00:00<00:00, 210.17it/s]remove invalid data : null / measurement error:  81%|████████  | 156/193 [00:00<00:00, 210.42it/s]remove invalid data : null / measurement error:  92%|█████████▏| 178/193 [00:00<00:00, 205.87it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 190.08it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 243.84it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 250.12it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 250.50it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 247.90it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 248.02it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 250.38it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.37it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 107.67it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.96it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.13it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.66it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.25it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.24it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.24it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.38it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.80it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.36it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.13it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 45.14it/s]generate index:  72%|███████▏  | 115/160 [00:01<00:00, 50.18it/s]generate index:  77%|███████▋  | 123/160 [00:01<00:00, 54.70it/s]generate index:  81%|████████  | 129/160 [00:02<00:00, 53.62it/s]generate index:  84%|████████▍ | 135/160 [00:02<00:00, 51.68it/s]generate index:  89%|████████▉ | 142/160 [00:02<00:00, 55.83it/s]generate index:  92%|█████████▎| 148/160 [00:02<00:00, 56.16it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 50.19it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 46.27it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 58.42it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:27<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 186, in train
    valid_loss, valid_acc, valid_f1 = valid_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 103, in valid_per_epoch
    for batch_idx, (data, target) in enumerate(valid_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1204, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 2.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-4:
Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self.run()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/threading.py", line 910, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/multiprocessing/reductions.py", line 295, in rebuild_storage_fd
    fd = df.detach()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 513, in Client
    answer_challenge(c, authkey)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 757, in answer_challenge
    message = connection.recv_bytes(256)         # reject large message
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 221, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 419, in _recv_bytes
    buf = self._recv(4)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/multiprocessing/connection.py", line 388, in _recv
    raise EOFError
EOFError
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_0_Focal_smoothing_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:03, 189.81it/s]remove invalid data : null / measurement error:   6%|▋         | 39/616 [00:00<00:03, 185.30it/s]remove invalid data : null / measurement error:   9%|▉         | 58/616 [00:00<00:03, 151.68it/s]remove invalid data : null / measurement error:  13%|█▎        | 78/616 [00:00<00:03, 166.55it/s]remove invalid data : null / measurement error:  16%|█▌        | 99/616 [00:00<00:02, 180.44it/s]remove invalid data : null / measurement error:  20%|█▉        | 121/616 [00:00<00:02, 190.68it/s]remove invalid data : null / measurement error:  23%|██▎       | 143/616 [00:00<00:02, 197.23it/s]remove invalid data : null / measurement error:  27%|██▋       | 165/616 [00:00<00:02, 202.72it/s]remove invalid data : null / measurement error:  30%|███       | 186/616 [00:00<00:02, 192.93it/s]remove invalid data : null / measurement error:  33%|███▎      | 206/616 [00:01<00:02, 193.67it/s]remove invalid data : null / measurement error:  37%|███▋      | 227/616 [00:01<00:01, 196.96it/s]remove invalid data : null / measurement error:  40%|████      | 248/616 [00:01<00:01, 197.96it/s]remove invalid data : null / measurement error:  44%|████▎     | 269/616 [00:01<00:01, 200.77it/s]remove invalid data : null / measurement error:  47%|████▋     | 290/616 [00:01<00:01, 200.69it/s]remove invalid data : null / measurement error:  50%|█████     | 311/616 [00:01<00:01, 200.43it/s]remove invalid data : null / measurement error:  54%|█████▍    | 332/616 [00:01<00:01, 201.33it/s]remove invalid data : null / measurement error:  57%|█████▋    | 353/616 [00:01<00:01, 202.13it/s]remove invalid data : null / measurement error:  61%|██████    | 377/616 [00:01<00:01, 212.94it/s]remove invalid data : null / measurement error:  65%|██████▌   | 403/616 [00:02<00:00, 226.63it/s]remove invalid data : null / measurement error:  69%|██████▉   | 428/616 [00:02<00:00, 231.58it/s]remove invalid data : null / measurement error:  73%|███████▎  | 452/616 [00:02<00:00, 231.83it/s]remove invalid data : null / measurement error:  77%|███████▋  | 476/616 [00:02<00:00, 225.39it/s]remove invalid data : null / measurement error:  81%|████████  | 499/616 [00:02<00:00, 218.02it/s]remove invalid data : null / measurement error:  85%|████████▍ | 521/616 [00:02<00:00, 213.90it/s]remove invalid data : null / measurement error:  88%|████████▊ | 543/616 [00:02<00:00, 208.95it/s]remove invalid data : null / measurement error:  92%|█████████▏| 564/616 [00:02<00:00, 206.89it/s]remove invalid data : null / measurement error:  95%|█████████▍| 585/616 [00:02<00:00, 205.30it/s]remove invalid data : null / measurement error:  98%|█████████▊| 606/616 [00:02<00:00, 203.95it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 202.64it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 234.21it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 198.34it/s]replace nan value:  13%|█▎        | 69/515 [00:00<00:02, 188.35it/s]replace nan value:  18%|█▊        | 94/515 [00:00<00:02, 207.28it/s]replace nan value:  23%|██▎       | 119/515 [00:00<00:01, 219.02it/s]replace nan value:  28%|██▊       | 144/515 [00:00<00:01, 227.33it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 233.12it/s]replace nan value:  38%|███▊      | 194/515 [00:00<00:01, 236.94it/s]replace nan value:  42%|████▏     | 218/515 [00:01<00:01, 216.98it/s]replace nan value:  47%|████▋     | 241/515 [00:01<00:01, 205.69it/s]replace nan value:  51%|█████▏    | 264/515 [00:01<00:01, 212.00it/s]replace nan value:  56%|█████▌    | 286/515 [00:01<00:01, 214.10it/s]replace nan value:  60%|██████    | 309/515 [00:01<00:00, 217.61it/s]replace nan value:  64%|██████▍   | 332/515 [00:01<00:00, 220.42it/s]replace nan value:  69%|██████▉   | 355/515 [00:01<00:00, 220.39it/s]replace nan value:  74%|███████▎  | 379/515 [00:01<00:00, 224.66it/s]replace nan value:  78%|███████▊  | 403/515 [00:01<00:00, 227.06it/s]replace nan value:  83%|████████▎ | 427/515 [00:01<00:00, 228.81it/s]replace nan value:  87%|████████▋ | 450/515 [00:02<00:00, 228.27it/s]replace nan value:  92%|█████████▏| 474/515 [00:02<00:00, 229.67it/s]replace nan value:  97%|█████████▋| 498/515 [00:02<00:00, 230.98it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 221.72it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.45it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.23it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.13it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 70.12it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 69.57it/s]generate index:   9%|▉         | 48/515 [00:00<00:08, 53.08it/s]generate index:  10%|█         | 54/515 [00:00<00:09, 46.98it/s]generate index:  12%|█▏        | 60/515 [00:01<00:11, 39.80it/s]generate index:  13%|█▎        | 68/515 [00:01<00:09, 47.42it/s]generate index:  14%|█▍        | 74/515 [00:01<00:09, 46.03it/s]generate index:  15%|█▌        | 79/515 [00:01<00:09, 44.46it/s]generate index:  17%|█▋        | 88/515 [00:01<00:08, 52.17it/s]generate index:  18%|█▊        | 95/515 [00:01<00:07, 53.93it/s]generate index:  20%|█▉        | 101/515 [00:01<00:07, 53.31it/s]generate index:  21%|██▏       | 110/515 [00:02<00:06, 60.49it/s]generate index:  23%|██▎       | 118/515 [00:02<00:06, 59.68it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 67.88it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 69.05it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 70.14it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 69.72it/s]generate index:  31%|███       | 160/515 [00:02<00:05, 70.37it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 69.49it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 66.73it/s]generate index:  36%|███▌      | 184/515 [00:03<00:04, 69.06it/s]generate index:  37%|███▋      | 191/515 [00:03<00:04, 68.03it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 66.88it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 65.46it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 86.24it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 82.78it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 79.36it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 81.29it/s]generate index:  50%|████▉     | 256/515 [00:04<00:03, 64.84it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 71.95it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 75.75it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.63it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.99it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 63.36it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.75it/s]generate index:  61%|██████    | 314/515 [00:05<00:03, 54.58it/s]generate index:  62%|██████▏   | 320/515 [00:05<00:03, 55.23it/s]generate index:  64%|██████▎   | 328/515 [00:05<00:03, 59.60it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 53.62it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 44.13it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 44.68it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.10it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 57.73it/s]generate index:  72%|███████▏  | 373/515 [00:06<00:02, 70.62it/s]generate index:  74%|███████▍  | 381/515 [00:06<00:01, 72.00it/s]generate index:  76%|███████▌  | 389/515 [00:06<00:01, 63.75it/s]generate index:  77%|███████▋  | 398/515 [00:06<00:01, 69.88it/s]generate index:  79%|███████▉  | 406/515 [00:06<00:01, 60.73it/s]generate index:  80%|████████  | 413/515 [00:06<00:01, 61.27it/s]generate index:  82%|████████▏ | 424/515 [00:06<00:01, 72.96it/s]generate index:  84%|████████▍ | 432/515 [00:06<00:01, 66.80it/s]generate index:  85%|████████▌ | 440/515 [00:07<00:01, 43.52it/s]generate index:  87%|████████▋ | 446/515 [00:07<00:01, 44.22it/s]generate index:  89%|████████▊ | 456/515 [00:07<00:01, 54.47it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 59.84it/s]generate index:  91%|█████████▏| 471/515 [00:07<00:00, 50.37it/s]generate index:  93%|█████████▎| 480/515 [00:07<00:00, 58.30it/s]generate index:  95%|█████████▍| 488/515 [00:08<00:00, 62.18it/s]generate index:  96%|█████████▌| 495/515 [00:08<00:00, 61.70it/s]generate index:  97%|█████████▋| 502/515 [00:08<00:00, 63.20it/s]generate index:  99%|█████████▉| 509/515 [00:08<00:00, 62.57it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 60.26it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 58.74it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 138.36it/s]remove invalid data : null / measurement error:  30%|██▉       | 46/154 [00:00<00:00, 164.26it/s]remove invalid data : null / measurement error:  43%|████▎     | 66/154 [00:00<00:00, 175.77it/s]remove invalid data : null / measurement error:  56%|█████▌    | 86/154 [00:00<00:00, 184.24it/s]remove invalid data : null / measurement error:  71%|███████   | 109/154 [00:00<00:00, 196.29it/s]remove invalid data : null / measurement error:  84%|████████▍ | 130/154 [00:00<00:00, 198.40it/s]remove invalid data : null / measurement error:  97%|█████████▋| 150/154 [00:00<00:00, 196.56it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 182.23it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 23/131 [00:00<00:00, 223.48it/s]replace nan value:  36%|███▌      | 47/131 [00:00<00:00, 230.73it/s]replace nan value:  54%|█████▍    | 71/131 [00:00<00:00, 232.48it/s]replace nan value:  73%|███████▎  | 95/131 [00:00<00:00, 231.02it/s]replace nan value:  91%|█████████ | 119/131 [00:00<00:00, 231.94it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 231.82it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   3%|▎         | 4/131 [00:00<00:03, 36.42it/s]generate index:   7%|▋         | 9/131 [00:00<00:02, 41.43it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 40.14it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 49.54it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 57.58it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 61.14it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.38it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.72it/s]generate index:  44%|████▍     | 58/131 [00:01<00:01, 62.79it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.70it/s]generate index:  56%|█████▌    | 73/131 [00:01<00:00, 62.82it/s]generate index:  61%|██████    | 80/131 [00:01<00:00, 56.97it/s]generate index:  66%|██████▌   | 86/131 [00:01<00:00, 53.93it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 43.67it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 46.37it/s]generate index:  79%|███████▊  | 103/131 [00:01<00:00, 46.16it/s]generate index:  83%|████████▎ | 109/131 [00:02<00:00, 48.92it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 59.01it/s]generate index:  98%|█████████▊| 129/131 [00:02<00:00, 72.49it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 56.33it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▎         | 7/193 [00:00<00:02, 68.97it/s]remove invalid data : null / measurement error:  15%|█▍        | 28/193 [00:00<00:01, 151.26it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 177.48it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 191.78it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 199.52it/s]remove invalid data : null / measurement error:  59%|█████▉    | 114/193 [00:00<00:00, 201.15it/s]remove invalid data : null / measurement error:  72%|███████▏  | 139/193 [00:00<00:00, 214.86it/s]remove invalid data : null / measurement error:  83%|████████▎ | 161/193 [00:00<00:00, 205.40it/s]remove invalid data : null / measurement error:  94%|█████████▍| 182/193 [00:00<00:00, 194.42it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 191.65it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 254.14it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 256.24it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 255.14it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 248.84it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 231.15it/s]replace nan value:  96%|█████████▌| 153/160 [00:00<00:00, 232.06it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 238.89it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 98.19it/s]generate index:  13%|█▎        | 21/160 [00:00<00:02, 61.07it/s]generate index:  18%|█▊        | 28/160 [00:00<00:02, 57.88it/s]generate index:  24%|██▍       | 38/160 [00:00<00:01, 69.44it/s]generate index:  29%|██▉       | 47/160 [00:00<00:01, 74.88it/s]generate index:  36%|███▌      | 57/160 [00:00<00:01, 81.72it/s]generate index:  41%|████▏     | 66/160 [00:00<00:01, 81.87it/s]generate index:  47%|████▋     | 75/160 [00:01<00:01, 74.11it/s]generate index:  52%|█████▏    | 83/160 [00:01<00:01, 62.12it/s]generate index:  56%|█████▋    | 90/160 [00:01<00:01, 56.23it/s]generate index:  60%|██████    | 96/160 [00:01<00:01, 55.99it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 50.17it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 46.62it/s]generate index:  73%|███████▎  | 117/160 [00:01<00:00, 56.54it/s]generate index:  78%|███████▊  | 124/160 [00:01<00:00, 59.41it/s]generate index:  82%|████████▏ | 131/160 [00:02<00:00, 51.31it/s]generate index:  86%|████████▌ | 137/160 [00:02<00:00, 45.17it/s]generate index:  91%|█████████ | 145/160 [00:02<00:00, 52.07it/s]generate index:  95%|█████████▌| 152/160 [00:02<00:00, 55.75it/s]generate index:  99%|█████████▉| 158/160 [00:02<00:00, 54.93it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 58.95it/s]
================= Dataset information =================
train data : 54007, disrupt : 478, non-disrupt : 53529
valid data : 14998, disrupt : 124, non-disrupt : 14874
test data : 17316, disrupt : 152, non-disrupt : 17164

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]training process:   0%|          | 0/128 [01:08<?, ?it/s]
Traceback (most recent call last):
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/train_transformer.py", line 266, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 176, in train
    train_loss, train_acc, train_f1 = train_per_epoch(
  File "/home/zinzinbin/codes_for_study/Bayesian-disruption-prediction/src/train.py", line 38, in train_per_epoch
    for batch_idx, (data, target) in enumerate(train_loader):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1250, in _process_data
    data.reraise()
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/_utils.py", line 457, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    return self.collate_fn(data)
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in default_collate
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 172, in <listcomp>
    return [default_collate(samples) for samples in transposed]  # Backwards compatibility.
  File "/home/zinzinbin/anaconda3/envs/research-env/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 137, in default_collate
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
RuntimeError: Trying to resize storage that is not resizable

Exception in thread Thread-3:
Traceback (most recent call last):
================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 19/616 [00:00<00:03, 189.76it/s]remove invalid data : null / measurement error:   6%|▌         | 38/616 [00:00<00:03, 187.04it/s]remove invalid data : null / measurement error:   9%|▉         | 57/616 [00:00<00:03, 186.01it/s]remove invalid data : null / measurement error:  12%|█▏        | 76/616 [00:00<00:02, 186.57it/s]remove invalid data : null / measurement error:  16%|█▌        | 96/616 [00:00<00:02, 189.55it/s]remove invalid data : null / measurement error:  19%|█▉        | 116/616 [00:00<00:02, 192.74it/s]remove invalid data : null / measurement error:  22%|██▏       | 136/616 [00:00<00:02, 193.47it/s]remove invalid data : null / measurement error:  25%|██▌       | 156/616 [00:00<00:02, 193.60it/s]remove invalid data : null / measurement error:  29%|██▊       | 176/616 [00:00<00:02, 191.73it/s]remove invalid data : null / measurement error:  32%|███▏      | 196/616 [00:01<00:02, 190.53it/s]remove invalid data : null / measurement error:  35%|███▌      | 216/616 [00:01<00:02, 190.96it/s]remove invalid data : null / measurement error:  38%|███▊      | 236/616 [00:01<00:01, 191.78it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 192.32it/s]remove invalid data : null / measurement error:  45%|████▍     | 276/616 [00:01<00:01, 193.60it/s]remove invalid data : null / measurement error:  48%|████▊     | 296/616 [00:01<00:01, 192.83it/s]remove invalid data : null / measurement error:  51%|█████▏    | 316/616 [00:01<00:01, 191.57it/s]remove invalid data : null / measurement error:  55%|█████▍    | 336/616 [00:01<00:01, 191.17it/s]remove invalid data : null / measurement error:  58%|█████▊    | 356/616 [00:01<00:01, 190.57it/s]remove invalid data : null / measurement error:  62%|██████▏   | 380/616 [00:01<00:01, 202.85it/s]remove invalid data : null / measurement error:  66%|██████▌   | 405/616 [00:02<00:00, 214.45it/s]remove invalid data : null / measurement error:  69%|██████▉   | 428/616 [00:02<00:00, 218.68it/s]remove invalid data : null / measurement error:  73%|███████▎  | 450/616 [00:02<00:00, 218.57it/s]remove invalid data : null / measurement error:  77%|███████▋  | 472/616 [00:02<00:00, 213.17it/s]remove invalid data : null / measurement error:  80%|████████  | 494/616 [00:02<00:00, 206.98it/s]remove invalid data : null / measurement error:  84%|████████▎ | 515/616 [00:02<00:00, 202.46it/s]remove invalid data : null / measurement error:  87%|████████▋ | 536/616 [00:02<00:00, 198.22it/s]remove invalid data : null / measurement error:  90%|█████████ | 556/616 [00:02<00:00, 195.31it/s]remove invalid data : null / measurement error:  94%|█████████▎| 576/616 [00:02<00:00, 194.46it/s]remove invalid data : null / measurement error:  97%|█████████▋| 596/616 [00:03<00:00, 194.37it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 193.89it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 196.71it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/515 [00:00<00:02, 223.80it/s]replace nan value:   9%|▉         | 46/515 [00:00<00:02, 223.29it/s]replace nan value:  13%|█▎        | 69/515 [00:00<00:02, 222.76it/s]replace nan value:  18%|█▊        | 92/515 [00:00<00:01, 225.07it/s]replace nan value:  22%|██▏       | 115/515 [00:00<00:01, 226.20it/s]replace nan value:  27%|██▋       | 138/515 [00:00<00:01, 227.06it/s]replace nan value:  31%|███▏      | 161/515 [00:00<00:01, 227.00it/s]replace nan value:  36%|███▌      | 184/515 [00:00<00:01, 226.89it/s]replace nan value:  40%|████      | 207/515 [00:00<00:01, 226.96it/s]replace nan value:  45%|████▍     | 231/515 [00:01<00:01, 227.92it/s]replace nan value:  49%|████▉     | 254/515 [00:01<00:01, 227.92it/s]replace nan value:  54%|█████▍    | 278/515 [00:01<00:01, 228.63it/s]replace nan value:  58%|█████▊    | 301/515 [00:01<00:00, 228.38it/s]replace nan value:  63%|██████▎   | 324/515 [00:01<00:00, 220.74it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 221.93it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 227.87it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 232.33it/s]replace nan value:  82%|████████▏ | 421/515 [00:01<00:00, 234.37it/s]replace nan value:  86%|████████▋ | 445/515 [00:01<00:00, 234.32it/s]replace nan value:  91%|█████████▏| 470/515 [00:02<00:00, 236.36it/s]replace nan value:  96%|█████████▌| 495/515 [00:02<00:00, 238.41it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 229.92it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.63it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 54.83it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.40it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 70.69it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 70.82it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 53.50it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.33it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 46.68it/s]generate index:  14%|█▎        | 70/515 [00:01<00:08, 51.65it/s]generate index:  15%|█▍        | 76/515 [00:01<00:08, 52.11it/s]generate index:  17%|█▋        | 85/515 [00:01<00:07, 61.38it/s]generate index:  18%|█▊        | 92/515 [00:01<00:07, 58.43it/s]generate index:  19%|█▉        | 99/515 [00:01<00:07, 55.24it/s]generate index:  21%|██        | 106/515 [00:01<00:06, 58.80it/s]generate index:  23%|██▎       | 116/515 [00:01<00:06, 66.32it/s]generate index:  24%|██▍       | 123/515 [00:02<00:06, 64.14it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 68.12it/s]generate index:  27%|██▋       | 139/515 [00:02<00:05, 68.25it/s]generate index:  28%|██▊       | 146/515 [00:02<00:05, 67.14it/s]generate index:  30%|██▉       | 154/515 [00:02<00:05, 68.46it/s]generate index:  32%|███▏      | 163/515 [00:02<00:04, 73.64it/s]generate index:  33%|███▎      | 171/515 [00:02<00:05, 66.48it/s]generate index:  35%|███▍      | 178/515 [00:02<00:05, 64.67it/s]generate index:  37%|███▋      | 188/515 [00:03<00:04, 68.94it/s]generate index:  38%|███▊      | 195/515 [00:03<00:04, 67.42it/s]generate index:  39%|███▉      | 202/515 [00:03<00:05, 60.39it/s]generate index:  42%|████▏     | 215/515 [00:03<00:03, 77.45it/s]generate index:  43%|████▎     | 224/515 [00:03<00:04, 70.80it/s]generate index:  46%|████▌     | 236/515 [00:03<00:03, 82.13it/s]generate index:  48%|████▊     | 246/515 [00:03<00:03, 85.75it/s]generate index:  50%|████▉     | 255/515 [00:03<00:03, 66.27it/s]generate index:  51%|█████▏    | 265/515 [00:04<00:03, 73.85it/s]generate index:  53%|█████▎    | 275/515 [00:04<00:03, 77.09it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 60.70it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 63.44it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 60.66it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 60.61it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 59.05it/s]generate index:  62%|██████▏   | 321/515 [00:05<00:03, 60.67it/s]generate index:  64%|██████▍   | 329/515 [00:05<00:02, 64.42it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 53.73it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 44.02it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 43.10it/s]generate index:  69%|██████▊   | 353/515 [00:05<00:03, 46.75it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 56.74it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 71.28it/s]generate index:  75%|███████▍  | 384/515 [00:06<00:01, 74.60it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 71.11it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 72.63it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 61.40it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 62.97it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 74.92it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.06it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.53it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.43it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 62.98it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 55.78it/s]generate index:  94%|█████████▎| 482/515 [00:07<00:00, 65.22it/s]generate index:  95%|█████████▌| 490/515 [00:07<00:00, 64.86it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 59.72it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 66.99it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.25it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 67.80it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 148.00it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 174.32it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 188.96it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 195.40it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 210.40it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 207.89it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 192.59it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 247.95it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 249.81it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 250.21it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 247.45it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 249.43it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 248.89it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.90it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.85it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 53.90it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 59.66it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 61.63it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 59.80it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 59.96it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 61.92it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 65.82it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 67.69it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 62.06it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 46.78it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 46.70it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 45.43it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 46.88it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 54.51it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 63.01it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.18it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 97.84it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:01, 159.59it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 183.63it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 194.80it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 199.67it/s]remove invalid data : null / measurement error:  61%|██████    | 117/193 [00:00<00:00, 202.88it/s]remove invalid data : null / measurement error:  74%|███████▎  | 142/193 [00:00<00:00, 215.66it/s]remove invalid data : null / measurement error:  85%|████████▍ | 164/193 [00:00<00:00, 211.96it/s]remove invalid data : null / measurement error:  96%|█████████▋| 186/193 [00:00<00:00, 209.84it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 199.43it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 249.59it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 251.76it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 251.16it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 248.03it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 247.48it/s]replace nan value:  96%|█████████▌| 153/160 [00:00<00:00, 247.76it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 248.25it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 103.71it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.49it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 60.12it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 72.54it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 79.07it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 81.40it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 81.52it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 66.64it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 57.26it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 58.06it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 51.88it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 48.17it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 57.75it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 58.84it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 54.37it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 53.28it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 57.38it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 61.47it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 60.93it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.225, valid loss : 0.085, train acc : 0.960, valid acc : 0.983, train f1 : 0.504, valid f1 : 0.496

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 353.82it/s][A
 37%|███▋      | 73/195 [00:00<00:00, 358.08it/s][A
 56%|█████▋    | 110/195 [00:00<00:00, 359.54it/s][A
 75%|███████▌  | 147/195 [00:00<00:00, 359.92it/s][A
 94%|█████████▍| 184/195 [00:00<00:00, 360.47it/s][A100%|██████████| 195/195 [00:00<00:00, 359.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.496
training process:   1%|          | 1/128 [01:58<4:11:38, 118.88s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:28<3:33:55, 101.87s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:57<3:19:22, 95.70s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:26<3:12:55, 93.35s/it]epoch : 5, train loss : 0.079, valid loss : 0.074, train acc : 0.982, valid acc : 0.983, train f1 : 0.495, valid f1 : 0.496

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 260.63it/s][A
 28%|██▊       | 54/195 [00:00<00:00, 247.27it/s][A
 41%|████      | 79/195 [00:00<00:00, 229.94it/s][A
 56%|█████▌    | 109/195 [00:00<00:00, 253.91it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 279.48it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 295.87it/s][A100%|██████████| 195/195 [00:00<00:00, 279.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:21<3:27:22, 101.16s/it]Best score increase :0.496 -> 0.500
training process:   5%|▍         | 6/128 [09:47<3:15:11, 96.00s/it] EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:13<3:06:53, 92.67s/it]Best score increase :0.500 -> 0.511
training process:   6%|▋         | 8/128 [12:44<3:04:01, 92.02s/it]epoch : 9, train loss : 0.067, valid loss : 0.064, train acc : 0.983, valid acc : 0.983, train f1 : 0.547, valid f1 : 0.590

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.14it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.73it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 345.90it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 346.46it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 345.30it/s][A100%|██████████| 195/195 [00:00<00:00, 345.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.511 -> 0.590
training process:   7%|▋         | 9/128 [14:35<3:14:36, 98.12s/it]Best score increase :0.590 -> 0.604
training process:   8%|▊         | 10/128 [16:03<3:06:28, 94.81s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [17:32<3:01:17, 92.97s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▉         | 12/128 [18:59<2:56:10, 91.13s/it]epoch : 13, train loss : 0.061, valid loss : 0.067, train acc : 0.983, valid acc : 0.984, train f1 : 0.611, valid f1 : 0.618

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 342.32it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 347.94it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 349.83it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 350.78it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 351.59it/s][A100%|██████████| 195/195 [00:00<00:00, 350.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.604 -> 0.618
training process:  10%|█         | 13/128 [20:50<3:06:20, 97.22s/it]Best score increase :0.618 -> 0.619
training process:  11%|█         | 14/128 [22:19<3:00:01, 94.75s/it]EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [23:47<2:54:34, 92.69s/it]Best score increase :0.619 -> 0.634
training process:  12%|█▎        | 16/128 [25:15<2:50:30, 91.34s/it]epoch : 17, train loss : 0.054, valid loss : 0.061, train acc : 0.985, valid acc : 0.984, train f1 : 0.680, valid f1 : 0.631

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 310.39it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 300.20it/s][A
 49%|████▊     | 95/195 [00:00<00:00, 297.67it/s][A
 64%|██████▍   | 125/195 [00:00<00:00, 296.42it/s][A
 80%|████████  | 156/195 [00:00<00:00, 299.19it/s][A
 96%|█████████▌| 187/195 [00:00<00:00, 301.26it/s][A100%|██████████| 195/195 [00:00<00:00, 300.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [27:09<3:01:44, 98.24s/it]Best score increase :0.634 -> 0.646
training process:  14%|█▍        | 18/128 [28:37<2:54:09, 95.00s/it]Best score increase :0.646 -> 0.672
training process:  15%|█▍        | 19/128 [30:05<2:49:01, 93.04s/it]Best score increase :0.672 -> 0.680
training process:  16%|█▌        | 20/128 [31:33<2:44:33, 91.42s/it]epoch : 21, train loss : 0.049, valid loss : 0.055, train acc : 0.986, valid acc : 0.986, train f1 : 0.708, valid f1 : 0.679

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▍        | 29/195 [00:00<00:00, 286.93it/s][A
 30%|███       | 59/195 [00:00<00:00, 290.01it/s][A
 46%|████▌     | 89/195 [00:00<00:00, 291.02it/s][A
 61%|██████    | 119/195 [00:00<00:00, 290.20it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 290.94it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 291.48it/s][A100%|██████████| 195/195 [00:00<00:00, 290.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [33:25<2:54:03, 97.60s/it]EarlyStopping counter : 2 out of 40
training process:  17%|█▋        | 22/128 [34:52<2:46:48, 94.42s/it]EarlyStopping counter : 3 out of 40
training process:  18%|█▊        | 23/128 [36:20<2:42:04, 92.61s/it]Best score increase :0.680 -> 0.702
training process:  19%|█▉        | 24/128 [37:49<2:38:17, 91.32s/it]epoch : 25, train loss : 0.044, valid loss : 0.055, train acc : 0.987, valid acc : 0.986, train f1 : 0.748, valid f1 : 0.704

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 348.65it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 353.80it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 355.73it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 355.96it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 356.87it/s][A100%|██████████| 195/195 [00:00<00:00, 355.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.702 -> 0.704
training process:  20%|█▉        | 25/128 [39:43<2:48:41, 98.27s/it]EarlyStopping counter : 1 out of 40
training process:  20%|██        | 26/128 [41:12<2:42:13, 95.43s/it]EarlyStopping counter : 2 out of 40
training process:  21%|██        | 27/128 [42:42<2:37:47, 93.74s/it]EarlyStopping counter : 3 out of 40
training process:  22%|██▏       | 28/128 [44:10<2:33:24, 92.04s/it]epoch : 29, train loss : 0.041, valid loss : 0.055, train acc : 0.987, valid acc : 0.986, train f1 : 0.769, valid f1 : 0.718

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.08it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.61it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.49it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.94it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 341.47it/s][A100%|██████████| 195/195 [00:00<00:00, 338.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.704 -> 0.718
training process:  23%|██▎       | 29/128 [46:06<2:43:40, 99.20s/it]Best score increase :0.718 -> 0.722
training process:  23%|██▎       | 30/128 [47:33<2:36:21, 95.73s/it]EarlyStopping counter : 1 out of 40
training process:  24%|██▍       | 31/128 [49:00<2:30:39, 93.20s/it]EarlyStopping counter : 2 out of 40
training process:  25%|██▌       | 32/128 [50:30<2:27:18, 92.07s/it]epoch : 33, train loss : 0.037, valid loss : 0.061, train acc : 0.989, valid acc : 0.987, train f1 : 0.795, valid f1 : 0.735

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 274.36it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 279.46it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 281.15it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 279.08it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 280.45it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 281.53it/s][A100%|██████████| 195/195 [00:00<00:00, 281.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.722 -> 0.735
training process:  26%|██▌       | 33/128 [52:22<2:35:11, 98.01s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [53:50<2:28:45, 94.95s/it]Best score increase :0.735 -> 0.745
training process:  27%|██▋       | 35/128 [55:17<2:23:51, 92.81s/it]EarlyStopping counter : 1 out of 40
training process:  28%|██▊       | 36/128 [56:46<2:20:25, 91.58s/it]epoch : 37, train loss : 0.035, valid loss : 0.060, train acc : 0.989, valid acc : 0.986, train f1 : 0.809, valid f1 : 0.743

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.53it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 346.87it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 348.66it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 349.67it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 348.23it/s][A100%|██████████| 195/195 [00:00<00:00, 347.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  29%|██▉       | 37/128 [58:39<2:28:31, 97.93s/it]EarlyStopping counter : 3 out of 40
training process:  30%|██▉       | 38/128 [1:00:04<2:20:56, 93.96s/it]EarlyStopping counter : 4 out of 40
training process:  30%|███       | 39/128 [1:01:33<2:17:17, 92.56s/it]Best score increase :0.745 -> 0.760
training process:  31%|███▏      | 40/128 [1:03:03<2:14:30, 91.71s/it]epoch : 41, train loss : 0.031, valid loss : 0.064, train acc : 0.990, valid acc : 0.988, train f1 : 0.832, valid f1 : 0.772

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.57it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 336.95it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 338.95it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 339.83it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.38it/s][A100%|██████████| 195/195 [00:00<00:00, 339.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.760 -> 0.772
training process:  32%|███▏      | 41/128 [1:04:57<2:22:56, 98.58s/it]EarlyStopping counter : 1 out of 40
training process:  33%|███▎      | 42/128 [1:06:23<2:15:40, 94.66s/it]EarlyStopping counter : 2 out of 40
training process:  34%|███▎      | 43/128 [1:07:51<2:11:14, 92.64s/it]EarlyStopping counter : 3 out of 40
training process:  34%|███▍      | 44/128 [1:09:18<2:07:31, 91.09s/it]epoch : 45, train loss : 0.029, valid loss : 0.064, train acc : 0.991, valid acc : 0.986, train f1 : 0.840, valid f1 : 0.756

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 261.88it/s][A
 29%|██▊       | 56/195 [00:00<00:00, 273.98it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 241.21it/s][A
 57%|█████▋    | 111/195 [00:00<00:00, 251.27it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 275.98it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 294.32it/s][A100%|██████████| 195/195 [00:00<00:00, 280.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  35%|███▌      | 45/128 [1:11:15<2:16:40, 98.81s/it]EarlyStopping counter : 5 out of 40
training process:  36%|███▌      | 46/128 [1:12:44<2:11:03, 95.90s/it]EarlyStopping counter : 6 out of 40
training process:  37%|███▋      | 47/128 [1:14:11<2:05:53, 93.25s/it]EarlyStopping counter : 7 out of 40
training process:  38%|███▊      | 48/128 [1:15:38<2:01:50, 91.38s/it]epoch : 49, train loss : 0.027, valid loss : 0.070, train acc : 0.991, valid acc : 0.987, train f1 : 0.858, valid f1 : 0.753

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 345.08it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 348.33it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 349.49it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 349.69it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 349.12it/s][A100%|██████████| 195/195 [00:00<00:00, 348.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  38%|███▊      | 49/128 [1:17:34<2:09:51, 98.63s/it]EarlyStopping counter : 9 out of 40
training process:  39%|███▉      | 50/128 [1:19:03<2:04:36, 95.85s/it]EarlyStopping counter : 10 out of 40
training process:  40%|███▉      | 51/128 [1:20:31<2:00:06, 93.60s/it]EarlyStopping counter : 11 out of 40
training process:  41%|████      | 52/128 [1:22:03<1:57:47, 92.99s/it]epoch : 53, train loss : 0.027, valid loss : 0.069, train acc : 0.992, valid acc : 0.984, train f1 : 0.862, valid f1 : 0.744

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 345.57it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 347.03it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 349.61it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 350.82it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 351.29it/s][A100%|██████████| 195/195 [00:00<00:00, 350.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  41%|████▏     | 53/128 [1:23:54<2:03:06, 98.48s/it]EarlyStopping counter : 13 out of 40
training process:  42%|████▏     | 54/128 [1:25:24<1:58:15, 95.88s/it]EarlyStopping counter : 14 out of 40
training process:  43%|████▎     | 55/128 [1:26:52<1:53:34, 93.35s/it]EarlyStopping counter : 15 out of 40
training process:  44%|████▍     | 56/128 [1:28:19<1:49:53, 91.58s/it]epoch : 57, train loss : 0.024, valid loss : 0.067, train acc : 0.992, valid acc : 0.986, train f1 : 0.874, valid f1 : 0.757

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.71it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.16it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.03it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.37it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.99it/s][A100%|██████████| 195/195 [00:00<00:00, 338.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  45%|████▍     | 57/128 [1:30:11<1:55:43, 97.79s/it]EarlyStopping counter : 17 out of 40
training process:  45%|████▌     | 58/128 [1:31:41<1:51:10, 95.29s/it]EarlyStopping counter : 18 out of 40
training process:  46%|████▌     | 59/128 [1:33:11<1:47:44, 93.68s/it]EarlyStopping counter : 19 out of 40
training process:  47%|████▋     | 60/128 [1:34:38<1:44:09, 91.91s/it]epoch : 61, train loss : 0.022, valid loss : 0.100, train acc : 0.993, valid acc : 0.971, train f1 : 0.883, valid f1 : 0.682

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.17it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 339.01it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 342.88it/s][A
 71%|███████   | 138/195 [00:00<00:00, 344.90it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 346.52it/s][A100%|██████████| 195/195 [00:00<00:00, 344.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  48%|████▊     | 61/128 [1:36:29<1:48:53, 97.51s/it]EarlyStopping counter : 21 out of 40
training process:  48%|████▊     | 62/128 [1:37:58<1:44:24, 94.91s/it]EarlyStopping counter : 22 out of 40
training process:  49%|████▉     | 63/128 [1:39:28<1:41:19, 93.54s/it]EarlyStopping counter : 23 out of 40
training process:  50%|█████     | 64/128 [1:40:54<1:37:23, 91.30s/it]epoch : 65, train loss : 0.022, valid loss : 0.084, train acc : 0.993, valid acc : 0.977, train f1 : 0.890, valid f1 : 0.680

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 279.65it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 285.04it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 287.11it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 285.87it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 286.85it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 287.60it/s][A100%|██████████| 195/195 [00:00<00:00, 286.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  51%|█████     | 65/128 [1:42:47<1:42:29, 97.61s/it]EarlyStopping counter : 25 out of 40
training process:  52%|█████▏    | 66/128 [1:44:15<1:37:57, 94.79s/it]EarlyStopping counter : 26 out of 40
training process:  52%|█████▏    | 67/128 [1:45:42<1:34:04, 92.54s/it]EarlyStopping counter : 27 out of 40
training process:  53%|█████▎    | 68/128 [1:47:11<1:31:29, 91.49s/it]epoch : 69, train loss : 0.020, valid loss : 0.072, train acc : 0.993, valid acc : 0.986, train f1 : 0.896, valid f1 : 0.753

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.15it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 345.01it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 347.10it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.67it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 283.76it/s][A100%|██████████| 195/195 [00:00<00:00, 296.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  54%|█████▍    | 69/128 [1:49:08<1:37:29, 99.14s/it]EarlyStopping counter : 29 out of 40
training process:  55%|█████▍    | 70/128 [1:50:38<1:33:09, 96.37s/it]Best score increase :0.772 -> 0.780
training process:  55%|█████▌    | 71/128 [1:52:04<1:28:43, 93.40s/it]EarlyStopping counter : 1 out of 40
training process:  56%|█████▋    | 72/128 [1:53:34<1:26:02, 92.19s/it]epoch : 73, train loss : 0.019, valid loss : 0.100, train acc : 0.994, valid acc : 0.969, train f1 : 0.901, valid f1 : 0.676

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.76it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.77it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 346.15it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 347.44it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 347.95it/s][A100%|██████████| 195/195 [00:00<00:00, 346.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  57%|█████▋    | 73/128 [1:55:25<1:29:48, 97.98s/it]EarlyStopping counter : 3 out of 40
training process:  58%|█████▊    | 74/128 [1:56:53<1:25:30, 95.00s/it]EarlyStopping counter : 4 out of 40
training process:  59%|█████▊    | 75/128 [1:58:22<1:22:09, 93.01s/it]EarlyStopping counter : 5 out of 40
training process:  59%|█████▉    | 76/128 [1:59:48<1:18:50, 90.97s/it]epoch : 77, train loss : 0.018, valid loss : 0.120, train acc : 0.994, valid acc : 0.971, train f1 : 0.904, valid f1 : 0.673

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 343.25it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 349.92it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 351.93it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 353.03it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 353.73it/s][A100%|██████████| 195/195 [00:00<00:00, 352.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  60%|██████    | 77/128 [2:01:41<1:22:52, 97.51s/it]EarlyStopping counter : 7 out of 40
training process:  61%|██████    | 78/128 [2:03:10<1:19:04, 94.90s/it]EarlyStopping counter : 8 out of 40
training process:  62%|██████▏   | 79/128 [2:04:41<1:16:34, 93.77s/it]EarlyStopping counter : 9 out of 40
training process:  62%|██████▎   | 80/128 [2:06:10<1:13:56, 92.42s/it]epoch : 81, train loss : 0.017, valid loss : 0.129, train acc : 0.995, valid acc : 0.970, train f1 : 0.916, valid f1 : 0.672

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 342.44it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 346.80it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 348.42it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 349.10it/s][A
 91%|█████████ | 177/195 [00:00<00:00, 348.93it/s][A100%|██████████| 195/195 [00:00<00:00, 348.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  63%|██████▎   | 81/128 [2:08:02<1:17:06, 98.44s/it]EarlyStopping counter : 11 out of 40
training process:  64%|██████▍   | 82/128 [2:09:31<1:13:10, 95.45s/it]EarlyStopping counter : 12 out of 40
training process:  65%|██████▍   | 83/128 [2:11:00<1:10:13, 93.63s/it]EarlyStopping counter : 13 out of 40
training process:  66%|██████▌   | 84/128 [2:12:29<1:07:33, 92.13s/it]epoch : 85, train loss : 0.016, valid loss : 0.138, train acc : 0.994, valid acc : 0.970, train f1 : 0.915, valid f1 : 0.670

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.81it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.93it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.54it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 345.92it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.14it/s][A100%|██████████| 195/195 [00:00<00:00, 343.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  66%|██████▋   | 85/128 [2:14:25<1:11:09, 99.28s/it]EarlyStopping counter : 15 out of 40
training process:  67%|██████▋   | 86/128 [2:15:52<1:06:58, 95.67s/it]EarlyStopping counter : 16 out of 40
training process:  68%|██████▊   | 87/128 [2:17:20<1:03:51, 93.45s/it]EarlyStopping counter : 17 out of 40
training process:  69%|██████▉   | 88/128 [2:18:50<1:01:36, 92.42s/it]epoch : 89, train loss : 0.016, valid loss : 0.153, train acc : 0.994, valid acc : 0.968, train f1 : 0.916, valid f1 : 0.665

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 354.38it/s][A
 37%|███▋      | 73/195 [00:00<00:00, 358.90it/s][A
 56%|█████▌    | 109/195 [00:00<00:00, 357.60it/s][A
 74%|███████▍  | 145/195 [00:00<00:00, 356.07it/s][A
 93%|█████████▎| 181/195 [00:00<00:00, 355.68it/s][A100%|██████████| 195/195 [00:00<00:00, 356.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  70%|██████▉   | 89/128 [2:20:44<1:04:10, 98.74s/it]EarlyStopping counter : 19 out of 40
training process:  70%|███████   | 90/128 [2:22:10<1:00:08, 94.95s/it]EarlyStopping counter : 20 out of 40
training process:  71%|███████   | 91/128 [2:23:38<57:13, 92.79s/it]  EarlyStopping counter : 21 out of 40
training process:  72%|███████▏  | 92/128 [2:25:06<54:52, 91.45s/it]epoch : 93, train loss : 0.016, valid loss : 0.092, train acc : 0.995, valid acc : 0.978, train f1 : 0.927, valid f1 : 0.717

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.13it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 346.03it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.94it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.15it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 347.56it/s][A100%|██████████| 195/195 [00:00<00:00, 346.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  73%|███████▎  | 93/128 [2:27:00<57:17, 98.20s/it]EarlyStopping counter : 23 out of 40
training process:  73%|███████▎  | 94/128 [2:28:27<53:47, 94.93s/it]EarlyStopping counter : 24 out of 40
training process:  74%|███████▍  | 95/128 [2:29:56<51:11, 93.08s/it]EarlyStopping counter : 25 out of 40
training process:  75%|███████▌  | 96/128 [2:31:25<48:58, 91.82s/it]epoch : 97, train loss : 0.015, valid loss : 0.172, train acc : 0.995, valid acc : 0.966, train f1 : 0.929, valid f1 : 0.671

  0%|          | 0/195 [00:00<?, ?it/s][A
 13%|█▎        | 25/195 [00:00<00:00, 246.89it/s][A
 30%|███       | 59/195 [00:00<00:00, 296.61it/s][A
 48%|████▊     | 93/195 [00:00<00:00, 315.25it/s][A
 65%|██████▌   | 127/195 [00:00<00:00, 324.28it/s][A
 83%|████████▎ | 161/195 [00:00<00:00, 329.23it/s][A
100%|██████████| 195/195 [00:00<00:00, 332.25it/s][A100%|██████████| 195/195 [00:00<00:00, 321.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  76%|███████▌  | 97/128 [2:33:18<50:45, 98.24s/it]EarlyStopping counter : 27 out of 40
training process:  77%|███████▋  | 98/128 [2:34:49<47:57, 95.92s/it]EarlyStopping counter : 28 out of 40
training process:  77%|███████▋  | 99/128 [2:36:16<45:02, 93.19s/it]EarlyStopping counter : 29 out of 40
training process:  78%|███████▊  | 100/128 [2:37:45<42:59, 92.13s/it]epoch : 101, train loss : 0.014, valid loss : 0.108, train acc : 0.995, valid acc : 0.977, train f1 : 0.930, valid f1 : 0.705

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.83it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.90it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.53it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.24it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 347.75it/s][A100%|██████████| 195/195 [00:00<00:00, 346.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  79%|███████▉  | 101/128 [2:39:39<44:21, 98.56s/it]EarlyStopping counter : 31 out of 40
training process:  80%|███████▉  | 102/128 [2:41:08<41:28, 95.71s/it]EarlyStopping counter : 32 out of 40
training process:  80%|████████  | 103/128 [2:42:37<39:03, 93.74s/it]EarlyStopping counter : 33 out of 40
training process:  81%|████████▏ | 104/128 [2:44:07<37:04, 92.70s/it]epoch : 105, train loss : 0.014, valid loss : 0.148, train acc : 0.995, valid acc : 0.969, train f1 : 0.929, valid f1 : 0.678

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█▏        | 22/195 [00:00<00:00, 216.97it/s][A
 25%|██▌       | 49/195 [00:00<00:00, 247.69it/s][A
 39%|███▉      | 77/195 [00:00<00:00, 258.49it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 264.80it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 268.87it/s][A
 83%|████████▎ | 161/195 [00:00<00:00, 271.46it/s][A
 97%|█████████▋| 189/195 [00:00<00:00, 229.79it/s][A100%|██████████| 195/195 [00:00<00:00, 244.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 34 out of 40
training process:  82%|████████▏ | 105/128 [2:46:01<37:56, 98.98s/it]EarlyStopping counter : 35 out of 40
training process:  83%|████████▎ | 106/128 [2:47:29<35:04, 95.66s/it]EarlyStopping counter : 36 out of 40
training process:  84%|████████▎ | 107/128 [2:48:58<32:49, 93.78s/it]EarlyStopping counter : 37 out of 40
training process:  84%|████████▍ | 108/128 [2:50:26<30:40, 92.01s/it]epoch : 109, train loss : 0.013, valid loss : 0.174, train acc : 0.996, valid acc : 0.969, train f1 : 0.935, valid f1 : 0.666

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.97it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.58it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.55it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.59it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.20it/s][A100%|██████████| 195/195 [00:00<00:00, 342.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 38 out of 40
training process:  85%|████████▌ | 109/128 [2:52:19<31:06, 98.21s/it]EarlyStopping counter : 39 out of 40
training process:  86%|████████▌ | 110/128 [2:53:48<28:37, 95.42s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 110, best f1 score : 0.780
training process:  86%|████████▌ | 110/128 [2:55:16<28:40, 95.61s/it]
training process finished, best loss : 0.068 and best acc : 0.987, best f1 : 0.780, best epoch : 70

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.63      0.43      0.51       303
           1       0.99      1.00      0.99     16947

    accuracy                           0.99     17250
   macro avg       0.81      0.71      0.75     17250
weighted avg       0.98      0.99      0.98     17250


# test acc : 0.99, test f1 : 0.75, test AUC : 0.71, test loss : 21.413

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:03, 11.49s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:56, 11.77s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:42, 11.59s/it]processing for feature importance:  24%|██▎       | 4/17 [00:45<02:27, 11.37s/it]processing for feature importance:  29%|██▉       | 5/17 [00:56<02:13, 11.10s/it]processing for feature importance:  35%|███▌      | 6/17 [01:08<02:06, 11.48s/it]processing for feature importance:  41%|████      | 7/17 [01:20<01:55, 11.56s/it]processing for feature importance:  47%|████▋     | 8/17 [01:32<01:45, 11.76s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:44<01:35, 11.93s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:57<01:24, 12.01s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:08<01:10, 11.83s/it]processing for feature importance:  71%|███████   | 12/17 [02:19<00:58, 11.63s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:31<00:46, 11.68s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:42<00:34, 11.51s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:54<00:23, 11.53s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:06<00:11, 11.62s/it]processing for feature importance: 100%|██████████| 17/17 [03:16<00:00, 11.26s/it]processing for feature importance: 100%|██████████| 17/17 [03:16<00:00, 11.55s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:03<13:15,  3.79s/it]visualize 2D latent space:   1%|          | 2/211 [00:03<05:48,  1.67s/it]visualize 2D latent space:   1%|          | 2/211 [00:05<09:38,  2.77s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.94s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:15,  1.15s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:46,  1.61s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<12:23,  3.54s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<09:17,  2.67s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:06,  1.89s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:30,  1.37s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▋        | 32/195 [00:00<00:00, 317.39it/s] 34%|███▍      | 67/195 [00:00<00:00, 333.03it/s] 52%|█████▏    | 102/195 [00:00<00:00, 340.27it/s] 70%|███████   | 137/195 [00:00<00:00, 339.35it/s] 88%|████████▊ | 172/195 [00:00<00:00, 341.35it/s]100%|██████████| 195/195 [00:00<00:00, 338.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 205.91it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 203.07it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 200.84it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 203.03it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.33it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 204.15it/s]remove invalid data : null / measurement error:  24%|██▍       | 147/616 [00:00<00:02, 204.70it/s]remove invalid data : null / measurement error:  27%|██▋       | 168/616 [00:00<00:02, 205.07it/s]remove invalid data : null / measurement error:  31%|███       | 189/616 [00:00<00:02, 202.95it/s]remove invalid data : null / measurement error:  34%|███▍      | 210/616 [00:01<00:02, 201.97it/s]remove invalid data : null / measurement error:  38%|███▊      | 231/616 [00:01<00:01, 202.43it/s]remove invalid data : null / measurement error:  41%|████      | 252/616 [00:01<00:01, 201.99it/s]remove invalid data : null / measurement error:  44%|████▍     | 273/616 [00:01<00:01, 203.46it/s]remove invalid data : null / measurement error:  48%|████▊     | 294/616 [00:01<00:01, 202.72it/s]remove invalid data : null / measurement error:  51%|█████     | 315/616 [00:01<00:01, 201.77it/s]remove invalid data : null / measurement error:  55%|█████▍    | 336/616 [00:01<00:01, 201.40it/s]remove invalid data : null / measurement error:  58%|█████▊    | 357/616 [00:01<00:01, 200.92it/s]remove invalid data : null / measurement error:  62%|██████▏   | 382/616 [00:01<00:01, 214.51it/s]remove invalid data : null / measurement error:  66%|██████▌   | 408/616 [00:01<00:00, 226.57it/s]remove invalid data : null / measurement error:  70%|███████   | 432/616 [00:02<00:00, 227.58it/s]remove invalid data : null / measurement error:  74%|███████▍  | 456/616 [00:02<00:00, 230.19it/s]remove invalid data : null / measurement error:  78%|███████▊  | 480/616 [00:02<00:00, 222.60it/s]remove invalid data : null / measurement error:  82%|████████▏ | 503/616 [00:02<00:00, 215.56it/s]remove invalid data : null / measurement error:  85%|████████▌ | 525/616 [00:02<00:00, 212.03it/s]remove invalid data : null / measurement error:  89%|████████▉ | 547/616 [00:02<00:00, 207.49it/s]remove invalid data : null / measurement error:  92%|█████████▏| 568/616 [00:02<00:00, 205.59it/s]remove invalid data : null / measurement error:  96%|█████████▌| 589/616 [00:02<00:00, 204.27it/s]remove invalid data : null / measurement error:  99%|█████████▉| 610/616 [00:02<00:00, 204.11it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.85it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 240.42it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 240.26it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 241.14it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 243.11it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 244.30it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 245.68it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 246.35it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 246.40it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 244.38it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 244.23it/s]replace nan value:  53%|█████▎    | 275/515 [00:01<00:00, 244.61it/s]replace nan value:  58%|█████▊    | 300/515 [00:01<00:00, 243.70it/s]replace nan value:  63%|██████▎   | 325/515 [00:01<00:00, 244.80it/s]replace nan value:  68%|██████▊   | 350/515 [00:01<00:00, 242.32it/s]replace nan value:  73%|███████▎  | 375/515 [00:01<00:00, 243.23it/s]replace nan value:  78%|███████▊  | 400/515 [00:01<00:00, 243.33it/s]replace nan value:  83%|████████▎ | 425/515 [00:01<00:00, 242.64it/s]replace nan value:  87%|████████▋ | 450/515 [00:01<00:00, 240.55it/s]replace nan value:  92%|█████████▏| 475/515 [00:01<00:00, 240.81it/s]replace nan value:  97%|█████████▋| 500/515 [00:02<00:00, 241.30it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 243.00it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.44it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.21it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.32it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.58it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.23it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.25it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.48it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.31it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.25it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.42it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.61it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.25it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 60.13it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 66.04it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.91it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 70.65it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 71.16it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 72.65it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 71.98it/s]generate index:  31%|███       | 159/515 [00:02<00:04, 71.93it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 73.07it/s]generate index:  34%|███▍      | 175/515 [00:02<00:04, 68.78it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.69it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.28it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.74it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.34it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.17it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 87.25it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 87.99it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 73.07it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.87it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.46it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.41it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.60it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 66.32it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 63.80it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 64.04it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 62.53it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 64.22it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 67.96it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 56.64it/s]generate index:  67%|██████▋   | 343/515 [00:05<00:03, 47.08it/s]generate index:  68%|██████▊   | 349/515 [00:05<00:03, 43.26it/s]generate index:  70%|██████▉   | 359/515 [00:05<00:02, 54.72it/s]generate index:  72%|███████▏  | 371/515 [00:05<00:02, 69.38it/s]generate index:  74%|███████▍  | 381/515 [00:05<00:01, 73.27it/s]generate index:  76%|███████▌  | 389/515 [00:05<00:01, 70.52it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 76.19it/s]generate index:  79%|███████▉  | 408/515 [00:06<00:01, 62.82it/s]generate index:  81%|████████  | 416/515 [00:06<00:01, 66.52it/s]generate index:  83%|████████▎ | 427/515 [00:06<00:01, 76.47it/s]generate index:  85%|████████▍ | 436/515 [00:06<00:01, 57.85it/s]generate index:  86%|████████▌ | 443/515 [00:06<00:01, 47.72it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.57it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.21it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.28it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.24it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.48it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.61it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.69it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.84it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 68.28it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 149.69it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 176.65it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 191.73it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 198.15it/s]remove invalid data : null / measurement error:  75%|███████▌  | 116/154 [00:00<00:00, 209.04it/s]remove invalid data : null / measurement error:  89%|████████▉ | 137/154 [00:00<00:00, 173.11it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 178.30it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 24/131 [00:00<00:00, 238.82it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 245.79it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 205.41it/s]replace nan value:  74%|███████▍  | 97/131 [00:00<00:00, 209.71it/s]replace nan value:  91%|█████████ | 119/131 [00:00<00:00, 196.18it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 203.67it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 72.76it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 49.64it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 55.75it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 57.77it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 63.59it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 64.19it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 60.65it/s]generate index:  47%|████▋     | 62/131 [00:00<00:01, 68.33it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 64.41it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 66.54it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 64.88it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 46.81it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 48.54it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 46.89it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 50.93it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 59.59it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 68.63it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.69it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|          | 1/193 [00:00<00:19, 10.00it/s]remove invalid data : null / measurement error:  12%|█▏        | 23/193 [00:00<00:01, 130.17it/s]remove invalid data : null / measurement error:  22%|██▏       | 43/193 [00:00<00:00, 160.96it/s]remove invalid data : null / measurement error:  34%|███▎      | 65/193 [00:00<00:00, 180.60it/s]remove invalid data : null / measurement error:  45%|████▌     | 87/193 [00:00<00:00, 193.48it/s]remove invalid data : null / measurement error:  55%|█████▌    | 107/193 [00:00<00:00, 195.17it/s]remove invalid data : null / measurement error:  68%|██████▊   | 132/193 [00:00<00:00, 210.84it/s]remove invalid data : null / measurement error:  80%|███████▉  | 154/193 [00:00<00:00, 210.58it/s]remove invalid data : null / measurement error:  91%|█████████ | 176/193 [00:00<00:00, 207.52it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 189.79it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 245.44it/s]replace nan value:  31%|███▏      | 50/160 [00:00<00:00, 247.66it/s]replace nan value:  47%|████▋     | 75/160 [00:00<00:00, 246.86it/s]replace nan value:  62%|██████▎   | 100/160 [00:00<00:00, 239.81it/s]replace nan value:  78%|███████▊  | 125/160 [00:00<00:00, 238.72it/s]replace nan value:  93%|█████████▎| 149/160 [00:00<00:00, 239.05it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 240.98it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.76it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.30it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.24it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.02it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.50it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.77it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.97it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.15it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.67it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.20it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.83it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.07it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.83it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.99it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.51it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 51.03it/s]generate index:  91%|█████████ | 145/160 [00:02<00:00, 55.19it/s]generate index:  95%|█████████▌| 152/160 [00:02<00:00, 57.28it/s]generate index:  99%|█████████▉| 158/160 [00:02<00:00, 55.57it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.16it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.515, valid loss : 0.433, train acc : 0.737, valid acc : 0.773, train f1 : 0.736, valid f1 : 0.485

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.53it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.02it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 347.58it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 350.07it/s][A
 91%|█████████ | 177/195 [00:00<00:00, 350.96it/s][A100%|██████████| 195/195 [00:00<00:00, 349.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.485
training process:   1%|          | 1/128 [01:57<4:09:21, 117.81s/it]Best score increase :0.485 -> 0.516
training process:   2%|▏         | 2/128 [03:30<3:36:55, 103.30s/it]Best score increase :0.516 -> 0.547
training process:   2%|▏         | 3/128 [05:03<3:24:50, 98.32s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:35<3:18:18, 95.95s/it]epoch : 5, train loss : 0.195, valid loss : 0.235, train acc : 0.925, valid acc : 0.901, train f1 : 0.925, valid f1 : 0.569

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.67it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.45it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 349.40it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 352.30it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 353.60it/s][A100%|██████████| 195/195 [00:00<00:00, 351.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.547 -> 0.569
training process:   4%|▍         | 5/128 [08:31<3:31:37, 103.23s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [10:02<3:21:07, 98.91s/it] EarlyStopping counter : 2 out of 40
training process:   5%|▌         | 7/128 [11:32<3:13:59, 96.19s/it]EarlyStopping counter : 3 out of 40
training process:   6%|▋         | 8/128 [13:03<3:08:42, 94.36s/it]epoch : 9, train loss : 0.125, valid loss : 0.251, train acc : 0.956, valid acc : 0.909, train f1 : 0.956, valid f1 : 0.580

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.27it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.52it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.66it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.38it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.33it/s][A100%|██████████| 195/195 [00:00<00:00, 340.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.569 -> 0.580
training process:   7%|▋         | 9/128 [15:00<3:21:14, 101.46s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:30<3:12:45, 98.02s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [18:01<3:06:42, 95.75s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▉         | 12/128 [19:33<3:03:15, 94.79s/it]epoch : 13, train loss : 0.092, valid loss : 0.315, train acc : 0.969, valid acc : 0.900, train f1 : 0.969, valid f1 : 0.567

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.54it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.53it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.18it/s][A
 70%|███████   | 137/195 [00:00<00:00, 337.19it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.26it/s][A100%|██████████| 195/195 [00:00<00:00, 337.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  10%|█         | 13/128 [21:32<3:15:37, 102.07s/it]Best score increase :0.580 -> 0.587
training process:  11%|█         | 14/128 [23:06<3:09:21, 99.66s/it] EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [24:38<3:03:07, 97.24s/it]EarlyStopping counter : 2 out of 40
training process:  12%|█▎        | 16/128 [26:11<2:59:07, 95.96s/it]epoch : 17, train loss : 0.071, valid loss : 0.222, train acc : 0.977, valid acc : 0.931, train f1 : 0.977, valid f1 : 0.596

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.19it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.11it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.59it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.55it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.06it/s][A100%|██████████| 195/195 [00:00<00:00, 336.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.587 -> 0.596
training process:  13%|█▎        | 17/128 [28:11<3:10:49, 103.15s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [29:41<3:01:56, 99.24s/it] EarlyStopping counter : 2 out of 40
training process:  15%|█▍        | 19/128 [31:15<2:57:39, 97.79s/it]EarlyStopping counter : 3 out of 40
training process:  16%|█▌        | 20/128 [32:49<2:53:36, 96.45s/it]epoch : 21, train loss : 0.059, valid loss : 0.252, train acc : 0.980, valid acc : 0.918, train f1 : 0.980, valid f1 : 0.581

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.82it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.28it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.66it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.09it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.29it/s][A100%|██████████| 195/195 [00:00<00:00, 331.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  16%|█▋        | 21/128 [34:49<3:04:38, 103.54s/it]Best score increase :0.596 -> 0.617
training process:  17%|█▋        | 22/128 [36:21<2:56:49, 100.09s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [37:54<2:51:36, 98.07s/it] EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [39:27<2:47:26, 96.60s/it]epoch : 25, train loss : 0.050, valid loss : 0.194, train acc : 0.984, valid acc : 0.946, train f1 : 0.984, valid f1 : 0.617

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.49it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.66it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.40it/s][A
 70%|███████   | 137/195 [00:00<00:00, 339.56it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 339.48it/s][A100%|██████████| 195/195 [00:00<00:00, 337.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [41:26<2:57:04, 103.15s/it]Best score increase :0.617 -> 0.623
training process:  20%|██        | 26/128 [42:59<2:50:20, 100.20s/it]EarlyStopping counter : 1 out of 40
training process:  21%|██        | 27/128 [44:32<2:45:08, 98.11s/it] EarlyStopping counter : 2 out of 40
training process:  22%|██▏       | 28/128 [46:06<2:41:14, 96.74s/it]epoch : 29, train loss : 0.043, valid loss : 0.223, train acc : 0.987, valid acc : 0.939, train f1 : 0.987, valid f1 : 0.603

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.86it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 338.31it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.57it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.36it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 344.85it/s][A100%|██████████| 195/195 [00:00<00:00, 343.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 29/128 [48:05<2:50:37, 103.41s/it]Best score increase :0.623 -> 0.649
training process:  23%|██▎       | 30/128 [49:37<2:43:22, 100.03s/it]EarlyStopping counter : 1 out of 40
training process:  24%|██▍       | 31/128 [51:09<2:38:04, 97.77s/it] EarlyStopping counter : 2 out of 40
training process:  25%|██▌       | 32/128 [52:44<2:35:02, 96.90s/it]epoch : 33, train loss : 0.039, valid loss : 0.202, train acc : 0.988, valid acc : 0.946, train f1 : 0.988, valid f1 : 0.620

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.18it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.28it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.12it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.82it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.63it/s][A100%|██████████| 195/195 [00:00<00:00, 343.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  26%|██▌       | 33/128 [54:44<2:44:26, 103.86s/it]EarlyStopping counter : 4 out of 40
training process:  27%|██▋       | 34/128 [56:16<2:36:46, 100.07s/it]EarlyStopping counter : 5 out of 40
training process:  27%|██▋       | 35/128 [57:48<2:31:19, 97.63s/it] Best score increase :0.649 -> 0.658
training process:  28%|██▊       | 36/128 [59:20<2:27:22, 96.12s/it]epoch : 37, train loss : 0.033, valid loss : 0.195, train acc : 0.989, valid acc : 0.943, train f1 : 0.989, valid f1 : 0.622

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.64it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 332.60it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.71it/s][A
 70%|███████   | 137/195 [00:00<00:00, 336.34it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.54it/s][A100%|██████████| 195/195 [00:00<00:00, 336.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  29%|██▉       | 37/128 [1:01:19<2:36:04, 102.90s/it]EarlyStopping counter : 2 out of 40
training process:  30%|██▉       | 38/128 [1:02:51<2:29:35, 99.73s/it] EarlyStopping counter : 3 out of 40
training process:  30%|███       | 39/128 [1:04:26<2:25:36, 98.16s/it]EarlyStopping counter : 4 out of 40
training process:  31%|███▏      | 40/128 [1:06:01<2:22:35, 97.22s/it]epoch : 41, train loss : 0.029, valid loss : 0.207, train acc : 0.991, valid acc : 0.953, train f1 : 0.991, valid f1 : 0.633

  0%|          | 0/195 [00:00<?, ?it/s][A
 12%|█▏        | 24/195 [00:00<00:00, 233.33it/s][A
 26%|██▌       | 51/195 [00:00<00:00, 254.15it/s][A
 41%|████      | 79/195 [00:00<00:00, 263.70it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 268.36it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 265.37it/s][A
 83%|████████▎ | 161/195 [00:00<00:00, 259.49it/s][A
 96%|█████████▋| 188/195 [00:00<00:00, 261.01it/s][A100%|██████████| 195/195 [00:00<00:00, 261.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  32%|███▏      | 41/128 [1:08:02<2:31:32, 104.51s/it]EarlyStopping counter : 6 out of 40
training process:  33%|███▎      | 42/128 [1:09:35<2:24:40, 100.94s/it]Best score increase :0.658 -> 0.663
training process:  34%|███▎      | 43/128 [1:11:08<2:19:27, 98.44s/it] EarlyStopping counter : 1 out of 40
training process:  34%|███▍      | 44/128 [1:12:42<2:16:05, 97.21s/it]epoch : 45, train loss : 0.028, valid loss : 0.202, train acc : 0.992, valid acc : 0.957, train f1 : 0.992, valid f1 : 0.642

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.01it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.96it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.78it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.91it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.58it/s][A100%|██████████| 195/195 [00:00<00:00, 329.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  35%|███▌      | 45/128 [1:14:43<2:24:16, 104.29s/it]EarlyStopping counter : 3 out of 40
training process:  36%|███▌      | 46/128 [1:16:17<2:18:29, 101.34s/it]EarlyStopping counter : 4 out of 40
training process:  37%|███▋      | 47/128 [1:17:51<2:13:35, 98.96s/it] EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 48/128 [1:19:25<2:10:01, 97.52s/it]epoch : 49, train loss : 0.024, valid loss : 0.198, train acc : 0.993, valid acc : 0.958, train f1 : 0.993, valid f1 : 0.654

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 266.70it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 274.35it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 277.33it/s][A
 58%|█████▊    | 113/195 [00:00<00:00, 278.99it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 280.11it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 280.38it/s][A100%|██████████| 195/195 [00:00<00:00, 279.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 49/128 [1:21:23<2:16:46, 103.88s/it]Best score increase :0.663 -> 0.672
training process:  39%|███▉      | 50/128 [1:22:54<2:09:59, 99.99s/it] EarlyStopping counter : 1 out of 40
training process:  40%|███▉      | 51/128 [1:24:27<2:05:35, 97.86s/it]EarlyStopping counter : 2 out of 40
training process:  41%|████      | 52/128 [1:25:59<2:01:34, 95.98s/it]epoch : 53, train loss : 0.020, valid loss : 0.205, train acc : 0.994, valid acc : 0.956, train f1 : 0.994, valid f1 : 0.646

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.96it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.94it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.24it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.25it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.00it/s][A100%|██████████| 195/195 [00:00<00:00, 339.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  41%|████▏     | 53/128 [1:27:58<2:08:37, 102.89s/it]EarlyStopping counter : 4 out of 40
training process:  42%|████▏     | 54/128 [1:29:30<2:02:56, 99.68s/it] EarlyStopping counter : 5 out of 40
training process:  43%|████▎     | 55/128 [1:31:05<1:59:27, 98.19s/it]EarlyStopping counter : 6 out of 40
training process:  44%|████▍     | 56/128 [1:32:37<1:55:46, 96.48s/it]epoch : 57, train loss : 0.022, valid loss : 0.268, train acc : 0.994, valid acc : 0.938, train f1 : 0.994, valid f1 : 0.608

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.65it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.75it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.24it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.81it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 346.91it/s][A100%|██████████| 195/195 [00:00<00:00, 344.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  45%|████▍     | 57/128 [1:34:38<2:02:40, 103.67s/it]Best score increase :0.672 -> 0.680
training process:  45%|████▌     | 58/128 [1:36:12<1:57:37, 100.83s/it]EarlyStopping counter : 1 out of 40
training process:  46%|████▌     | 59/128 [1:37:45<1:53:15, 98.48s/it] EarlyStopping counter : 2 out of 40
training process:  47%|████▋     | 60/128 [1:39:17<1:49:33, 96.66s/it]epoch : 61, train loss : 0.021, valid loss : 0.194, train acc : 0.994, valid acc : 0.965, train f1 : 0.994, valid f1 : 0.673

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.41it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.11it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.02it/s][A
 70%|███████   | 137/195 [00:00<00:00, 341.11it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 322.10it/s][A100%|██████████| 195/195 [00:00<00:00, 304.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  48%|████▊     | 61/128 [1:41:17<1:55:47, 103.70s/it]EarlyStopping counter : 4 out of 40
training process:  48%|████▊     | 62/128 [1:42:48<1:49:49, 99.85s/it] EarlyStopping counter : 5 out of 40
training process:  49%|████▉     | 63/128 [1:44:21<1:45:43, 97.59s/it]Best score increase :0.680 -> 0.692
training process:  50%|█████     | 64/128 [1:45:54<1:42:52, 96.45s/it]epoch : 65, train loss : 0.019, valid loss : 0.244, train acc : 0.995, valid acc : 0.954, train f1 : 0.995, valid f1 : 0.640

  0%|          | 0/195 [00:00<?, ?it/s][A
 13%|█▎        | 26/195 [00:00<00:00, 257.39it/s][A
 28%|██▊       | 54/195 [00:00<00:00, 268.80it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 274.00it/s][A
 57%|█████▋    | 112/195 [00:00<00:00, 276.52it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 278.22it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 279.42it/s][A100%|██████████| 195/195 [00:00<00:00, 276.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  51%|█████     | 65/128 [1:47:53<1:48:15, 103.11s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 66/128 [1:49:22<1:42:15, 98.96s/it] EarlyStopping counter : 3 out of 40
training process:  52%|█████▏    | 67/128 [1:50:56<1:38:53, 97.26s/it]EarlyStopping counter : 4 out of 40
training process:  53%|█████▎    | 68/128 [1:52:27<1:35:28, 95.48s/it]epoch : 69, train loss : 0.018, valid loss : 0.229, train acc : 0.995, valid acc : 0.960, train f1 : 0.995, valid f1 : 0.659

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.35it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 338.10it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.06it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.05it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 344.18it/s][A100%|██████████| 195/195 [00:00<00:00, 342.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  54%|█████▍    | 69/128 [1:54:26<1:40:58, 102.69s/it]EarlyStopping counter : 6 out of 40
training process:  55%|█████▍    | 70/128 [1:55:58<1:36:09, 99.47s/it] EarlyStopping counter : 7 out of 40
training process:  55%|█████▌    | 71/128 [1:57:31<1:32:33, 97.44s/it]EarlyStopping counter : 8 out of 40
training process:  56%|█████▋    | 72/128 [1:59:03<1:29:20, 95.72s/it]epoch : 73, train loss : 0.015, valid loss : 0.217, train acc : 0.996, valid acc : 0.967, train f1 : 0.996, valid f1 : 0.675

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 342.64it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.34it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 345.16it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 345.84it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 346.20it/s][A100%|██████████| 195/195 [00:00<00:00, 345.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  57%|█████▋    | 73/128 [2:01:01<1:33:58, 102.53s/it]EarlyStopping counter : 10 out of 40
training process:  58%|█████▊    | 74/128 [2:02:37<1:30:22, 100.42s/it]EarlyStopping counter : 11 out of 40
training process:  59%|█████▊    | 75/128 [2:04:10<1:26:45, 98.21s/it] EarlyStopping counter : 12 out of 40
training process:  59%|█████▉    | 76/128 [2:05:44<1:23:57, 96.87s/it]epoch : 77, train loss : 0.015, valid loss : 0.235, train acc : 0.996, valid acc : 0.969, train f1 : 0.996, valid f1 : 0.680

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.99it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.82it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.63it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.57it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.16it/s][A100%|██████████| 195/195 [00:00<00:00, 339.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  60%|██████    | 77/128 [2:07:44<1:28:23, 103.99s/it]EarlyStopping counter : 14 out of 40
training process:  61%|██████    | 78/128 [2:09:18<1:24:08, 100.98s/it]EarlyStopping counter : 15 out of 40
training process:  62%|██████▏   | 79/128 [2:10:54<1:21:19, 99.58s/it] EarlyStopping counter : 16 out of 40
training process:  62%|██████▎   | 80/128 [2:12:25<1:17:30, 96.89s/it]epoch : 81, train loss : 0.013, valid loss : 0.195, train acc : 0.997, valid acc : 0.971, train f1 : 0.997, valid f1 : 0.698

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.52it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.23it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.72it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.65it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 338.45it/s][A100%|██████████| 195/195 [00:00<00:00, 337.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.692 -> 0.698
training process:  63%|██████▎   | 81/128 [2:14:23<1:20:56, 103.33s/it]EarlyStopping counter : 1 out of 40
training process:  64%|██████▍   | 82/128 [2:15:55<1:16:29, 99.77s/it] Best score increase :0.698 -> 0.699
training process:  65%|██████▍   | 83/128 [2:17:26<1:12:52, 97.16s/it]EarlyStopping counter : 1 out of 40
training process:  66%|██████▌   | 84/128 [2:18:59<1:10:17, 95.86s/it]epoch : 85, train loss : 0.016, valid loss : 0.237, train acc : 0.996, valid acc : 0.967, train f1 : 0.996, valid f1 : 0.684

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.81it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 339.39it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 344.01it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.48it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 345.03it/s][A100%|██████████| 195/195 [00:00<00:00, 343.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  66%|██████▋   | 85/128 [2:20:57<1:13:33, 102.63s/it]EarlyStopping counter : 3 out of 40
training process:  67%|██████▋   | 86/128 [2:22:30<1:09:50, 99.78s/it] EarlyStopping counter : 4 out of 40
training process:  68%|██████▊   | 87/128 [2:24:02<1:06:36, 97.48s/it]EarlyStopping counter : 5 out of 40
training process:  69%|██████▉   | 88/128 [2:25:33<1:03:36, 95.40s/it]epoch : 89, train loss : 0.014, valid loss : 0.261, train acc : 0.996, valid acc : 0.963, train f1 : 0.996, valid f1 : 0.662

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.19it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.85it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.85it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.74it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 347.37it/s][A100%|██████████| 195/195 [00:00<00:00, 346.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  70%|██████▉   | 89/128 [2:27:33<1:06:52, 102.88s/it]EarlyStopping counter : 7 out of 40
training process:  70%|███████   | 90/128 [2:29:06<1:03:16, 99.90s/it] EarlyStopping counter : 8 out of 40
training process:  71%|███████   | 91/128 [2:30:38<1:00:04, 97.41s/it]EarlyStopping counter : 9 out of 40
training process:  72%|███████▏  | 92/128 [2:32:10<57:27, 95.77s/it]  epoch : 93, train loss : 0.012, valid loss : 0.242, train acc : 0.997, valid acc : 0.966, train f1 : 0.997, valid f1 : 0.682

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.90it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.79it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 340.88it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.79it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 344.50it/s][A100%|██████████| 195/195 [00:00<00:00, 342.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  73%|███████▎  | 93/128 [2:34:08<59:50, 102.59s/it]EarlyStopping counter : 11 out of 40
training process:  73%|███████▎  | 94/128 [2:35:40<56:19, 99.40s/it] EarlyStopping counter : 12 out of 40
training process:  74%|███████▍  | 95/128 [2:37:14<53:45, 97.75s/it]EarlyStopping counter : 13 out of 40
training process:  75%|███████▌  | 96/128 [2:38:47<51:20, 96.26s/it]epoch : 97, train loss : 0.012, valid loss : 0.270, train acc : 0.997, valid acc : 0.965, train f1 : 0.997, valid f1 : 0.664

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.10it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.80it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.82it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.09it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.56it/s][A100%|██████████| 195/195 [00:00<00:00, 341.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  76%|███████▌  | 97/128 [2:40:46<53:19, 103.22s/it]EarlyStopping counter : 15 out of 40
training process:  77%|███████▋  | 98/128 [2:42:19<49:59, 99.97s/it] Best score increase :0.699 -> 0.704
training process:  77%|███████▋  | 99/128 [2:43:51<47:13, 97.71s/it]EarlyStopping counter : 1 out of 40
training process:  78%|███████▊  | 100/128 [2:45:23<44:50, 96.09s/it]epoch : 101, train loss : 0.013, valid loss : 0.295, train acc : 0.997, valid acc : 0.963, train f1 : 0.997, valid f1 : 0.665

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.43it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.92it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.82it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.23it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.06it/s][A100%|██████████| 195/195 [00:00<00:00, 340.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  79%|███████▉  | 101/128 [2:47:22<46:14, 102.75s/it]EarlyStopping counter : 3 out of 40
training process:  80%|███████▉  | 102/128 [2:48:54<43:10, 99.63s/it] EarlyStopping counter : 4 out of 40
training process:  80%|████████  | 103/128 [2:50:25<40:28, 97.12s/it]EarlyStopping counter : 5 out of 40
training process:  81%|████████▏ | 104/128 [2:51:59<38:22, 95.95s/it]epoch : 105, train loss : 0.013, valid loss : 0.246, train acc : 0.997, valid acc : 0.973, train f1 : 0.997, valid f1 : 0.705

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.66it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.80it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.45it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.69it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.75it/s][A100%|██████████| 195/195 [00:00<00:00, 340.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.704 -> 0.705
training process:  82%|████████▏ | 105/128 [2:53:59<39:36, 103.31s/it]Best score increase :0.705 -> 0.717
training process:  83%|████████▎ | 106/128 [2:55:30<36:29, 99.50s/it] EarlyStopping counter : 1 out of 40
training process:  84%|████████▎ | 107/128 [2:57:05<34:22, 98.24s/it]EarlyStopping counter : 2 out of 40
training process:  84%|████████▍ | 108/128 [2:58:37<32:04, 96.24s/it]epoch : 109, train loss : 0.012, valid loss : 0.281, train acc : 0.997, valid acc : 0.964, train f1 : 0.997, valid f1 : 0.669

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.19it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 334.23it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.45it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.19it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.59it/s][A100%|██████████| 195/195 [00:00<00:00, 337.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  85%|████████▌ | 109/128 [3:00:35<32:34, 102.86s/it]EarlyStopping counter : 4 out of 40
training process:  86%|████████▌ | 110/128 [3:02:10<30:07, 100.42s/it]EarlyStopping counter : 5 out of 40
training process:  87%|████████▋ | 111/128 [3:03:43<27:49, 98.21s/it] EarlyStopping counter : 6 out of 40
training process:  88%|████████▊ | 112/128 [3:05:15<25:42, 96.41s/it]epoch : 113, train loss : 0.012, valid loss : 0.275, train acc : 0.997, valid acc : 0.973, train f1 : 0.997, valid f1 : 0.698

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.04it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 340.08it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 344.11it/s][A
 71%|███████   | 138/195 [00:00<00:00, 342.81it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 344.30it/s][A100%|██████████| 195/195 [00:00<00:00, 343.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  88%|████████▊ | 113/128 [3:07:15<25:53, 103.57s/it]EarlyStopping counter : 8 out of 40
training process:  89%|████████▉ | 114/128 [3:08:49<23:28, 100.61s/it]EarlyStopping counter : 9 out of 40
training process:  90%|████████▉ | 115/128 [3:10:23<21:21, 98.56s/it] EarlyStopping counter : 10 out of 40
training process:  91%|█████████ | 116/128 [3:11:56<19:23, 96.95s/it]epoch : 117, train loss : 0.011, valid loss : 0.296, train acc : 0.998, valid acc : 0.971, train f1 : 0.998, valid f1 : 0.697

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 342.20it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 351.86it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 350.62it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 353.49it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 355.08it/s][A100%|██████████| 195/195 [00:00<00:00, 353.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  91%|█████████▏| 117/128 [3:13:55<19:00, 103.64s/it]EarlyStopping counter : 12 out of 40
training process:  92%|█████████▏| 118/128 [3:15:27<16:41, 100.13s/it]EarlyStopping counter : 13 out of 40
training process:  93%|█████████▎| 119/128 [3:16:59<14:40, 97.83s/it] EarlyStopping counter : 14 out of 40
training process:  94%|█████████▍| 120/128 [3:18:33<12:53, 96.64s/it]epoch : 121, train loss : 0.010, valid loss : 0.326, train acc : 0.998, valid acc : 0.965, train f1 : 0.998, valid f1 : 0.667

  0%|          | 0/195 [00:00<?, ?it/s][A
 13%|█▎        | 26/195 [00:00<00:00, 257.28it/s][A
 28%|██▊       | 54/195 [00:00<00:00, 265.71it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 268.54it/s][A
 56%|█████▌    | 109/195 [00:00<00:00, 268.83it/s][A
 70%|███████   | 137/195 [00:00<00:00, 269.32it/s][A
 85%|████████▍ | 165/195 [00:00<00:00, 269.59it/s][A
 98%|█████████▊| 192/195 [00:00<00:00, 269.63it/s][A100%|██████████| 195/195 [00:00<00:00, 268.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  95%|█████████▍| 121/128 [3:20:33<12:03, 103.39s/it]EarlyStopping counter : 16 out of 40
training process:  95%|█████████▌| 122/128 [3:22:08<10:06, 101.13s/it]EarlyStopping counter : 17 out of 40
training process:  96%|█████████▌| 123/128 [3:23:43<08:15, 99.18s/it] EarlyStopping counter : 18 out of 40
training process:  97%|█████████▋| 124/128 [3:25:16<06:28, 97.22s/it]epoch : 125, train loss : 0.011, valid loss : 0.300, train acc : 0.998, valid acc : 0.973, train f1 : 0.998, valid f1 : 0.708

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 263.33it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 270.02it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 268.80it/s][A
 57%|█████▋    | 111/195 [00:00<00:00, 271.39it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 273.30it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 274.35it/s][A
100%|██████████| 195/195 [00:00<00:00, 275.04it/s][A100%|██████████| 195/195 [00:00<00:00, 272.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  98%|█████████▊| 125/128 [3:27:14<05:10, 103.49s/it]EarlyStopping counter : 20 out of 40
training process:  98%|█████████▊| 126/128 [3:28:46<03:20, 100.06s/it]EarlyStopping counter : 21 out of 40
training process:  99%|█████████▉| 127/128 [3:30:20<01:38, 98.42s/it] EarlyStopping counter : 22 out of 40
training process: 100%|██████████| 128/128 [3:31:52<00:00, 96.32s/it]training process: 100%|██████████| 128/128 [3:31:52<00:00, 99.32s/it]
training process finished, best loss : 0.239 and best acc : 0.975, best f1 : 0.717, best epoch : 105

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.45      0.42      0.43       303
           1       0.99      0.99      0.99     16947

    accuracy                           0.98     17250
   macro avg       0.72      0.70      0.71     17250
weighted avg       0.98      0.98      0.98     17250


# test acc : 0.98, test f1 : 0.71, test AUC : 0.70, test loss : 54.385

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:07, 11.73s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:58, 11.88s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:48, 12.00s/it]processing for feature importance:  24%|██▎       | 4/17 [00:47<02:35, 12.00s/it]processing for feature importance:  29%|██▉       | 5/17 [01:00<02:27, 12.33s/it]processing for feature importance:  35%|███▌      | 6/17 [01:17<02:30, 13.70s/it]processing for feature importance:  41%|████      | 7/17 [01:31<02:18, 13.81s/it]processing for feature importance:  47%|████▋     | 8/17 [01:43<02:00, 13.42s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:55<01:43, 12.91s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:08<01:29, 12.81s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:20<01:15, 12.57s/it]processing for feature importance:  71%|███████   | 12/17 [02:32<01:01, 12.38s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:44<00:49, 12.39s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:56<00:37, 12.38s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:09<00:24, 12.45s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:21<00:12, 12.28s/it]processing for feature importance: 100%|██████████| 17/17 [03:33<00:00, 12.18s/it]processing for feature importance: 100%|██████████| 17/17 [03:33<00:00, 12.55s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:03<12:07,  3.47s/it]visualize 2D latent space:   1%|          | 2/211 [00:05<08:45,  2.52s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:00,  1.80s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:01<00:54,  1.21it/s]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:48,  1.65s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:02<09:43,  2.78s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:03<05:32,  1.59s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<08:50,  2.54s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:07,  1.90s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:26,  1.32s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▋        | 32/195 [00:00<00:00, 312.85it/s] 34%|███▍      | 67/195 [00:00<00:00, 334.47it/s] 53%|█████▎    | 103/195 [00:00<00:00, 341.66it/s] 71%|███████   | 138/195 [00:00<00:00, 344.24it/s] 89%|████████▊ | 173/195 [00:00<00:00, 345.46it/s]100%|██████████| 195/195 [00:00<00:00, 342.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.03it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 200.70it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 198.95it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 201.12it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 202.88it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 205.84it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 208.22it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 207.84it/s]remove invalid data : null / measurement error:  31%|███       | 191/616 [00:00<00:02, 206.35it/s]remove invalid data : null / measurement error:  34%|███▍      | 212/616 [00:01<00:01, 206.19it/s]remove invalid data : null / measurement error:  38%|███▊      | 233/616 [00:01<00:01, 206.41it/s]remove invalid data : null / measurement error:  41%|████      | 254/616 [00:01<00:01, 206.32it/s]remove invalid data : null / measurement error:  45%|████▍     | 276/616 [00:01<00:01, 207.79it/s]remove invalid data : null / measurement error:  48%|████▊     | 297/616 [00:01<00:01, 207.44it/s]remove invalid data : null / measurement error:  52%|█████▏    | 318/616 [00:01<00:01, 206.33it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 205.50it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 204.19it/s]remove invalid data : null / measurement error:  63%|██████▎   | 386/616 [00:01<00:01, 219.44it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:01<00:00, 233.27it/s]remove invalid data : null / measurement error:  71%|███████   | 437/616 [00:02<00:00, 229.47it/s]remove invalid data : null / measurement error:  75%|███████▍  | 461/616 [00:02<00:00, 232.52it/s]remove invalid data : null / measurement error:  79%|███████▊  | 485/616 [00:02<00:00, 224.53it/s]remove invalid data : null / measurement error:  82%|████████▏ | 508/616 [00:02<00:00, 218.47it/s]remove invalid data : null / measurement error:  86%|████████▌ | 530/616 [00:02<00:00, 214.08it/s]remove invalid data : null / measurement error:  90%|████████▉ | 552/616 [00:02<00:00, 210.11it/s]remove invalid data : null / measurement error:  93%|█████████▎| 574/616 [00:02<00:00, 208.50it/s]remove invalid data : null / measurement error:  97%|█████████▋| 595/616 [00:02<00:00, 207.80it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 206.77it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 210.71it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.58it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 234.24it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 234.92it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 237.02it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 238.45it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 240.43it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 241.35it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 240.76it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 240.43it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 240.72it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:01, 241.45it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 241.39it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 242.33it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 240.65it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 241.60it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 242.25it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 241.04it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 239.16it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 239.73it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 240.71it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 240.18it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.54it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.21it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.47it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.49it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.33it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.01it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.96it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.07it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.71it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.56it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.37it/s]generate index:  18%|█▊        | 95/515 [00:01<00:08, 52.44it/s]generate index:  20%|█▉        | 101/515 [00:01<00:08, 51.25it/s]generate index:  21%|██▏       | 110/515 [00:01<00:06, 58.35it/s]generate index:  23%|██▎       | 118/515 [00:02<00:06, 57.85it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 66.45it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 67.77it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 69.23it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 69.71it/s]generate index:  31%|███       | 160/515 [00:02<00:05, 70.96it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.31it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.51it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.83it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 70.31it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.66it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.90it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.76it/s]generate index:  45%|████▍     | 231/515 [00:03<00:03, 74.89it/s]generate index:  46%|████▋     | 239/515 [00:03<00:03, 71.20it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 72.72it/s]generate index:  50%|████▉     | 255/515 [00:03<00:04, 61.35it/s]generate index:  51%|█████▏    | 265/515 [00:04<00:03, 69.93it/s]generate index:  53%|█████▎    | 275/515 [00:04<00:03, 74.83it/s]generate index:  55%|█████▍    | 283/515 [00:04<00:03, 59.28it/s]generate index:  56%|█████▋    | 290/515 [00:04<00:03, 61.57it/s]generate index:  58%|█████▊    | 297/515 [00:04<00:03, 62.22it/s]generate index:  59%|█████▉    | 304/515 [00:04<00:03, 62.12it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 63.86it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 60.41it/s]generate index:  63%|██████▎   | 327/515 [00:05<00:02, 64.59it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 58.91it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 47.49it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 45.68it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 52.00it/s]generate index:  71%|███████   | 364/515 [00:05<00:02, 60.40it/s]generate index:  73%|███████▎  | 376/515 [00:05<00:01, 73.76it/s]generate index:  75%|███████▍  | 385/515 [00:06<00:01, 77.53it/s]generate index:  77%|███████▋  | 394/515 [00:06<00:01, 77.98it/s]generate index:  78%|███████▊  | 403/515 [00:06<00:01, 72.18it/s]generate index:  80%|███████▉  | 411/515 [00:06<00:01, 63.85it/s]generate index:  82%|████████▏ | 422/515 [00:06<00:01, 73.77it/s]generate index:  83%|████████▎ | 430/515 [00:06<00:01, 73.40it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 51.95it/s]generate index:  86%|████████▋ | 445/515 [00:07<00:01, 48.41it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.10it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 62.78it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 55.99it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 65.75it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 63.68it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.14it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 68.06it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.88it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 4/154 [00:00<00:03, 39.35it/s]remove invalid data : null / measurement error:  16%|█▌        | 24/154 [00:00<00:00, 132.35it/s]remove invalid data : null / measurement error:  29%|██▉       | 45/154 [00:00<00:00, 163.97it/s]remove invalid data : null / measurement error:  42%|████▏     | 65/154 [00:00<00:00, 177.37it/s]remove invalid data : null / measurement error:  55%|█████▌    | 85/154 [00:00<00:00, 185.11it/s]remove invalid data : null / measurement error:  70%|███████   | 108/154 [00:00<00:00, 197.28it/s]remove invalid data : null / measurement error:  84%|████████▍ | 129/154 [00:00<00:00, 199.21it/s]remove invalid data : null / measurement error:  97%|█████████▋| 149/154 [00:00<00:00, 199.31it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 182.72it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 23/131 [00:00<00:00, 227.48it/s]replace nan value:  37%|███▋      | 48/131 [00:00<00:00, 235.78it/s]replace nan value:  56%|█████▌    | 73/131 [00:00<00:00, 241.79it/s]replace nan value:  75%|███████▍  | 98/131 [00:00<00:00, 243.76it/s]replace nan value:  95%|█████████▍| 124/131 [00:00<00:00, 248.14it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 244.78it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.58it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 50.36it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 56.21it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 62.58it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.90it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.89it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 62.02it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 64.03it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 68.01it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.90it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 63.84it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 48.79it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 47.56it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 47.58it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 48.33it/s]generate index:  89%|████████▊ | 116/131 [00:02<00:00, 57.84it/s]generate index:  96%|█████████▌| 126/131 [00:02<00:00, 68.54it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.78it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 6/193 [00:00<00:03, 59.06it/s]remove invalid data : null / measurement error:  15%|█▍        | 28/193 [00:00<00:01, 149.51it/s]remove invalid data : null / measurement error:  26%|██▌       | 50/193 [00:00<00:00, 177.46it/s]remove invalid data : null / measurement error:  37%|███▋      | 72/193 [00:00<00:00, 193.44it/s]remove invalid data : null / measurement error:  49%|████▊     | 94/193 [00:00<00:00, 199.75it/s]remove invalid data : null / measurement error:  60%|█████▉    | 115/193 [00:00<00:00, 201.90it/s]remove invalid data : null / measurement error:  73%|███████▎  | 140/193 [00:00<00:00, 216.48it/s]remove invalid data : null / measurement error:  84%|████████▍ | 162/193 [00:00<00:00, 212.54it/s]remove invalid data : null / measurement error:  95%|█████████▌| 184/193 [00:00<00:00, 209.99it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 197.35it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 249.92it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 253.13it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 254.41it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 252.07it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 251.26it/s]replace nan value:  97%|█████████▋| 155/160 [00:00<00:00, 250.59it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 251.25it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 103.43it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.77it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.14it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.92it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.57it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.59it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.80it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.72it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.28it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.65it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.38it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.05it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.28it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.31it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.50it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.13it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.24it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.40it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.93it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.023, valid loss : 0.023, train acc : 0.589, valid acc : 0.467, train f1 : 0.396, valid f1 : 0.338

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.10it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.91it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.73it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 337.04it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.88it/s][A100%|██████████| 195/195 [00:00<00:00, 335.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.338
training process:   1%|          | 1/128 [02:00<4:16:03, 120.97s/it]Best score increase :0.338 -> 0.504
training process:   2%|▏         | 2/128 [03:26<3:30:31, 100.25s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [04:56<3:18:29, 95.27s/it] EarlyStopping counter : 2 out of 40
training process:   3%|▎         | 4/128 [06:23<3:10:40, 92.26s/it]epoch : 5, train loss : 0.016, valid loss : 0.016, train acc : 0.797, valid acc : 0.820, train f1 : 0.502, valid f1 : 0.511

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.53it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.80it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.82it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.11it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.30it/s][A100%|██████████| 195/195 [00:00<00:00, 342.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.504 -> 0.511
training process:   4%|▍         | 5/128 [08:19<3:26:46, 100.87s/it]Best score increase :0.511 -> 0.534
training process:   5%|▍         | 6/128 [09:52<3:19:32, 98.14s/it] Best score increase :0.534 -> 0.561
training process:   5%|▌         | 7/128 [11:25<3:14:40, 96.54s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:58<3:10:40, 95.34s/it]epoch : 9, train loss : 0.013, valid loss : 0.016, train acc : 0.854, valid acc : 0.881, train f1 : 0.542, valid f1 : 0.554

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.85it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 344.25it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.41it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 345.90it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.20it/s][A100%|██████████| 195/195 [00:00<00:00, 343.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:56<3:22:57, 102.33s/it]Best score increase :0.561 -> 0.579
training process:   8%|▊         | 10/128 [16:28<3:14:52, 99.09s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [18:00<3:09:01, 96.94s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▉         | 12/128 [19:32<3:04:52, 95.62s/it]epoch : 13, train loss : 0.012, valid loss : 0.016, train acc : 0.892, valid acc : 0.922, train f1 : 0.574, valid f1 : 0.597

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 262.87it/s][A
 29%|██▊       | 56/195 [00:00<00:00, 273.72it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 277.59it/s][A
 58%|█████▊    | 114/195 [00:00<00:00, 279.53it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 280.86it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 281.73it/s][A100%|██████████| 195/195 [00:00<00:00, 279.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.579 -> 0.597
training process:  10%|█         | 13/128 [21:30<3:16:05, 102.31s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [23:00<3:07:19, 98.59s/it] EarlyStopping counter : 2 out of 40
training process:  12%|█▏        | 15/128 [24:30<3:00:37, 95.91s/it]EarlyStopping counter : 3 out of 40
training process:  12%|█▎        | 16/128 [26:00<2:55:45, 94.16s/it]epoch : 17, train loss : 0.011, valid loss : 0.014, train acc : 0.918, valid acc : 0.836, train f1 : 0.607, valid f1 : 0.527

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.28it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.92it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 340.71it/s][A
 71%|███████   | 138/195 [00:00<00:00, 342.60it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.07it/s][A100%|██████████| 195/195 [00:00<00:00, 340.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  13%|█▎        | 17/128 [27:51<3:03:44, 99.32s/it]EarlyStopping counter : 5 out of 40
training process:  14%|█▍        | 18/128 [29:18<2:55:18, 95.62s/it]EarlyStopping counter : 6 out of 40
training process:  15%|█▍        | 19/128 [30:46<2:49:28, 93.29s/it]EarlyStopping counter : 7 out of 40
training process:  16%|█▌        | 20/128 [32:15<2:45:18, 91.84s/it]epoch : 21, train loss : 0.009, valid loss : 0.017, train acc : 0.927, valid acc : 0.906, train f1 : 0.628, valid f1 : 0.578

  0%|          | 0/195 [00:00<?, ?it/s][A
 13%|█▎        | 26/195 [00:00<00:00, 258.54it/s][A
 27%|██▋       | 53/195 [00:00<00:00, 262.54it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 271.22it/s][A
 57%|█████▋    | 111/195 [00:00<00:00, 277.39it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 280.89it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 281.75it/s][A100%|██████████| 195/195 [00:00<00:00, 276.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  16%|█▋        | 21/128 [34:09<2:55:49, 98.60s/it]EarlyStopping counter : 9 out of 40
training process:  17%|█▋        | 22/128 [35:38<2:49:17, 95.83s/it]Best score increase :0.597 -> 0.604
training process:  18%|█▊        | 23/128 [37:08<2:44:25, 93.96s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [38:37<2:40:20, 92.51s/it]epoch : 25, train loss : 0.009, valid loss : 0.016, train acc : 0.943, valid acc : 0.915, train f1 : 0.660, valid f1 : 0.591

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.12it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.82it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.59it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.85it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.29it/s][A100%|██████████| 195/195 [00:00<00:00, 343.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  20%|█▉        | 25/128 [40:30<2:49:11, 98.56s/it]EarlyStopping counter : 3 out of 40
training process:  20%|██        | 26/128 [42:00<2:43:12, 96.01s/it]EarlyStopping counter : 4 out of 40
training process:  21%|██        | 27/128 [43:29<2:38:13, 94.00s/it]Best score increase :0.604 -> 0.610
training process:  22%|██▏       | 28/128 [44:59<2:34:32, 92.73s/it]epoch : 29, train loss : 0.008, valid loss : 0.021, train acc : 0.950, valid acc : 0.937, train f1 : 0.677, valid f1 : 0.623

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.57it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 344.41it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 346.12it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 347.08it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 348.15it/s][A100%|██████████| 195/195 [00:00<00:00, 347.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.610 -> 0.623
training process:  23%|██▎       | 29/128 [46:53<2:43:35, 99.14s/it]EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 30/128 [48:23<2:37:34, 96.47s/it]EarlyStopping counter : 2 out of 40
training process:  24%|██▍       | 31/128 [49:53<2:32:31, 94.35s/it]EarlyStopping counter : 3 out of 40
training process:  25%|██▌       | 32/128 [51:20<2:27:53, 92.43s/it]epoch : 33, train loss : 0.008, valid loss : 0.020, train acc : 0.960, valid acc : 0.947, train f1 : 0.707, valid f1 : 0.643

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.16it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 341.32it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 269.17it/s][A
 71%|███████   | 138/195 [00:00<00:00, 287.07it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 301.59it/s][A100%|██████████| 195/195 [00:00<00:00, 303.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.623 -> 0.643
training process:  26%|██▌       | 33/128 [53:19<2:38:30, 100.11s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [54:52<2:33:49, 98.18s/it] EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [56:22<2:28:22, 95.73s/it]EarlyStopping counter : 3 out of 40
training process:  28%|██▊       | 36/128 [57:52<2:24:16, 94.10s/it]epoch : 37, train loss : 0.006, valid loss : 0.025, train acc : 0.967, valid acc : 0.945, train f1 : 0.737, valid f1 : 0.635

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 271.48it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 277.39it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 280.36it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 281.34it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 281.00it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 281.15it/s][A100%|██████████| 195/195 [00:00<00:00, 280.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  29%|██▉       | 37/128 [59:45<2:30:55, 99.51s/it]Best score increase :0.643 -> 0.665
training process:  30%|██▉       | 38/128 [1:01:12<2:23:46, 95.85s/it]Best score increase :0.665 -> 0.674
training process:  30%|███       | 39/128 [1:02:41<2:19:18, 93.92s/it]EarlyStopping counter : 1 out of 40
training process:  31%|███▏      | 40/128 [1:04:10<2:15:16, 92.24s/it]epoch : 41, train loss : 0.006, valid loss : 0.033, train acc : 0.971, valid acc : 0.963, train f1 : 0.755, valid f1 : 0.674

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.28it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.95it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.16it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.73it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.74it/s][A100%|██████████| 195/195 [00:00<00:00, 342.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  32%|███▏      | 41/128 [1:06:04<2:23:28, 98.95s/it]EarlyStopping counter : 3 out of 40
training process:  33%|███▎      | 42/128 [1:07:35<2:18:05, 96.34s/it]EarlyStopping counter : 4 out of 40
training process:  34%|███▎      | 43/128 [1:09:03<2:13:19, 94.11s/it]Best score increase :0.674 -> 0.680
training process:  34%|███▍      | 44/128 [1:10:31<2:08:56, 92.10s/it]epoch : 45, train loss : 0.006, valid loss : 0.031, train acc : 0.975, valid acc : 0.963, train f1 : 0.777, valid f1 : 0.679

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 191.35it/s][A
 23%|██▎       | 44/195 [00:00<00:00, 216.88it/s][A
 39%|███▉      | 77/195 [00:00<00:00, 264.28it/s][A
 57%|█████▋    | 111/195 [00:00<00:00, 291.27it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 301.80it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 311.76it/s][A100%|██████████| 195/195 [00:00<00:00, 291.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  35%|███▌      | 45/128 [1:12:26<2:17:05, 99.10s/it]EarlyStopping counter : 2 out of 40
training process:  36%|███▌      | 46/128 [1:13:56<2:11:26, 96.18s/it]EarlyStopping counter : 3 out of 40
training process:  37%|███▋      | 47/128 [1:15:26<2:07:23, 94.36s/it]EarlyStopping counter : 4 out of 40
training process:  38%|███▊      | 48/128 [1:16:54<2:03:30, 92.63s/it]epoch : 49, train loss : 0.006, valid loss : 0.031, train acc : 0.977, valid acc : 0.963, train f1 : 0.786, valid f1 : 0.680

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 260.58it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 268.36it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 271.56it/s][A
 57%|█████▋    | 111/195 [00:00<00:00, 272.73it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 273.73it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 274.33it/s][A
100%|██████████| 195/195 [00:00<00:00, 272.50it/s][A100%|██████████| 195/195 [00:00<00:00, 271.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 49/128 [1:18:49<2:10:50, 99.38s/it]EarlyStopping counter : 6 out of 40
training process:  39%|███▉      | 50/128 [1:20:19<2:05:28, 96.52s/it]EarlyStopping counter : 7 out of 40
training process:  40%|███▉      | 51/128 [1:21:50<2:01:33, 94.72s/it]Best score increase :0.680 -> 0.683
training process:  41%|████      | 52/128 [1:23:17<1:57:09, 92.50s/it]epoch : 53, train loss : 0.006, valid loss : 0.029, train acc : 0.981, valid acc : 0.944, train f1 : 0.811, valid f1 : 0.635

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.18it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 344.31it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 346.21it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 347.09it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.86it/s][A100%|██████████| 195/195 [00:00<00:00, 345.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  41%|████▏     | 53/128 [1:25:10<2:03:11, 98.56s/it]Best score increase :0.683 -> 0.686
training process:  42%|████▏     | 54/128 [1:26:39<1:58:14, 95.88s/it]EarlyStopping counter : 1 out of 40
training process:  43%|████▎     | 55/128 [1:28:09<1:54:21, 93.99s/it]EarlyStopping counter : 2 out of 40
training process:  44%|████▍     | 56/128 [1:29:35<1:50:03, 91.71s/it]epoch : 57, train loss : 0.005, valid loss : 0.034, train acc : 0.981, valid acc : 0.953, train f1 : 0.814, valid f1 : 0.655

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.53it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.89it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.61it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.84it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.03it/s][A100%|██████████| 195/195 [00:00<00:00, 340.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  45%|████▍     | 57/128 [1:31:28<1:55:57, 97.99s/it]EarlyStopping counter : 4 out of 40
training process:  45%|████▌     | 58/128 [1:32:58<1:51:29, 95.57s/it]EarlyStopping counter : 5 out of 40
training process:  46%|████▌     | 59/128 [1:34:26<1:47:09, 93.18s/it]EarlyStopping counter : 6 out of 40
training process:  47%|████▋     | 60/128 [1:35:54<1:43:57, 91.73s/it]epoch : 61, train loss : 0.005, valid loss : 0.037, train acc : 0.986, valid acc : 0.977, train f1 : 0.844, valid f1 : 0.740

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 266.67it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 270.87it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 275.57it/s][A
 58%|█████▊    | 113/195 [00:00<00:00, 278.03it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 246.79it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 249.14it/s][A
 99%|█████████▉| 194/195 [00:00<00:00, 253.00it/s][A100%|██████████| 195/195 [00:00<00:00, 258.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.686 -> 0.740
training process:  48%|████▊     | 61/128 [1:37:49<1:50:15, 98.73s/it]EarlyStopping counter : 1 out of 40
training process:  48%|████▊     | 62/128 [1:39:16<1:44:35, 95.08s/it]EarlyStopping counter : 2 out of 40
training process:  49%|████▉     | 63/128 [1:40:42<1:40:01, 92.33s/it]EarlyStopping counter : 3 out of 40
training process:  50%|█████     | 64/128 [1:42:11<1:37:38, 91.53s/it]epoch : 65, train loss : 0.005, valid loss : 0.040, train acc : 0.988, valid acc : 0.973, train f1 : 0.862, valid f1 : 0.722

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 265.94it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 275.01it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 277.99it/s][A
 58%|█████▊    | 114/195 [00:00<00:00, 275.61it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 271.78it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 273.88it/s][A100%|██████████| 195/195 [00:00<00:00, 274.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  51%|█████     | 65/128 [1:44:09<1:44:31, 99.55s/it]EarlyStopping counter : 5 out of 40
training process:  52%|█████▏    | 66/128 [1:45:41<1:40:17, 97.06s/it]EarlyStopping counter : 6 out of 40
training process:  52%|█████▏    | 67/128 [1:47:10<1:36:12, 94.63s/it]EarlyStopping counter : 7 out of 40
training process:  53%|█████▎    | 68/128 [1:48:39<1:33:05, 93.09s/it]epoch : 69, train loss : 0.004, valid loss : 0.047, train acc : 0.988, valid acc : 0.977, train f1 : 0.866, valid f1 : 0.734

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.92it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.00it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.53it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.34it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.96it/s][A100%|██████████| 195/195 [00:00<00:00, 340.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  54%|█████▍    | 69/128 [1:50:33<1:37:35, 99.24s/it]EarlyStopping counter : 9 out of 40
training process:  55%|█████▍    | 70/128 [1:52:03<1:33:11, 96.40s/it]Best score increase :0.740 -> 0.759
training process:  55%|█████▌    | 71/128 [1:53:31<1:29:27, 94.17s/it]EarlyStopping counter : 1 out of 40
training process:  56%|█████▋    | 72/128 [1:55:01<1:26:31, 92.71s/it]epoch : 73, train loss : 0.004, valid loss : 0.043, train acc : 0.990, valid acc : 0.961, train f1 : 0.881, valid f1 : 0.673

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 269.25it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 275.18it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 280.57it/s][A
 58%|█████▊    | 113/195 [00:00<00:00, 283.15it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 284.63it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 285.69it/s][A100%|██████████| 195/195 [00:00<00:00, 282.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  57%|█████▋    | 73/128 [1:56:57<1:31:23, 99.71s/it]EarlyStopping counter : 3 out of 40
training process:  58%|█████▊    | 74/128 [1:58:27<1:27:11, 96.88s/it]EarlyStopping counter : 4 out of 40
training process:  59%|█████▊    | 75/128 [1:59:57<1:23:47, 94.85s/it]EarlyStopping counter : 5 out of 40
training process:  59%|█████▉    | 76/128 [2:01:26<1:20:31, 92.92s/it]epoch : 77, train loss : 0.005, valid loss : 0.053, train acc : 0.991, valid acc : 0.964, train f1 : 0.888, valid f1 : 0.676

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 332.83it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 340.49it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 342.82it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 343.87it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 344.40it/s][A100%|██████████| 195/195 [00:00<00:00, 343.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  60%|██████    | 77/128 [2:03:21<1:24:41, 99.63s/it]EarlyStopping counter : 7 out of 40
training process:  61%|██████    | 78/128 [2:04:50<1:20:21, 96.43s/it]EarlyStopping counter : 8 out of 40
training process:  62%|██████▏   | 79/128 [2:06:17<1:16:27, 93.62s/it]EarlyStopping counter : 9 out of 40
training process:  62%|██████▎   | 80/128 [2:07:48<1:14:12, 92.76s/it]epoch : 81, train loss : 0.004, valid loss : 0.056, train acc : 0.991, valid acc : 0.986, train f1 : 0.890, valid f1 : 0.791

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.89it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 340.34it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 344.68it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.84it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 348.22it/s][A100%|██████████| 195/195 [00:00<00:00, 346.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.759 -> 0.791
training process:  63%|██████▎   | 81/128 [2:09:45<1:18:20, 100.00s/it]EarlyStopping counter : 1 out of 40
training process:  64%|██████▍   | 82/128 [2:11:12<1:13:46, 96.24s/it] EarlyStopping counter : 2 out of 40
training process:  65%|██████▍   | 83/128 [2:12:40<1:10:18, 93.74s/it]EarlyStopping counter : 3 out of 40
training process:  66%|██████▌   | 84/128 [2:14:08<1:07:29, 92.04s/it]epoch : 85, train loss : 0.003, valid loss : 0.053, train acc : 0.992, valid acc : 0.985, train f1 : 0.904, valid f1 : 0.790

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.91it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 321.61it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 327.36it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 328.15it/s][A
 85%|████████▌ | 166/195 [00:00<00:00, 288.68it/s][A100%|██████████| 195/195 [00:00<00:00, 301.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  66%|██████▋   | 85/128 [2:16:04<1:11:00, 99.09s/it]EarlyStopping counter : 5 out of 40
training process:  67%|██████▋   | 86/128 [2:17:32<1:07:11, 95.98s/it]Best score increase :0.791 -> 0.796
training process:  68%|██████▊   | 87/128 [2:19:04<1:04:40, 94.63s/it]EarlyStopping counter : 1 out of 40
training process:  69%|██████▉   | 88/128 [2:20:34<1:02:15, 93.39s/it]epoch : 89, train loss : 0.004, valid loss : 0.050, train acc : 0.993, valid acc : 0.964, train f1 : 0.915, valid f1 : 0.682

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.70it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.55it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.76it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.29it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.06it/s][A100%|██████████| 195/195 [00:00<00:00, 332.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  70%|██████▉   | 89/128 [2:22:33<1:05:36, 100.93s/it]EarlyStopping counter : 3 out of 40
training process:  70%|███████   | 90/128 [2:24:03<1:01:48, 97.58s/it] EarlyStopping counter : 4 out of 40
training process:  71%|███████   | 91/128 [2:25:30<58:22, 94.66s/it]  EarlyStopping counter : 5 out of 40
training process:  72%|███████▏  | 92/128 [2:26:59<55:44, 92.90s/it]epoch : 93, train loss : 0.003, valid loss : 0.052, train acc : 0.994, valid acc : 0.985, train f1 : 0.923, valid f1 : 0.795

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 260.82it/s][A
 28%|██▊       | 54/195 [00:00<00:00, 221.50it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 251.69it/s][A
 60%|██████    | 117/195 [00:00<00:00, 280.22it/s][A
 77%|███████▋  | 150/195 [00:00<00:00, 294.46it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 304.20it/s][A100%|██████████| 195/195 [00:00<00:00, 286.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  73%|███████▎  | 93/128 [2:28:57<58:35, 100.45s/it]EarlyStopping counter : 7 out of 40
training process:  73%|███████▎  | 94/128 [2:30:27<55:05, 97.23s/it] EarlyStopping counter : 8 out of 40
training process:  74%|███████▍  | 95/128 [2:31:56<52:04, 94.69s/it]EarlyStopping counter : 9 out of 40
training process:  75%|███████▌  | 96/128 [2:33:24<49:31, 92.85s/it]epoch : 97, train loss : 0.004, valid loss : 0.051, train acc : 0.995, valid acc : 0.973, train f1 : 0.929, valid f1 : 0.726

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 345.16it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 349.39it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 351.10it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 351.98it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 351.89it/s][A100%|██████████| 195/195 [00:00<00:00, 350.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  76%|███████▌  | 97/128 [2:35:16<50:53, 98.50s/it]EarlyStopping counter : 11 out of 40
training process:  77%|███████▋  | 98/128 [2:36:45<47:49, 95.66s/it]Best score increase :0.796 -> 0.805
training process:  77%|███████▋  | 99/128 [2:38:15<45:28, 94.09s/it]EarlyStopping counter : 1 out of 40
training process:  78%|███████▊  | 100/128 [2:39:44<43:07, 92.41s/it]epoch : 101, train loss : 0.003, valid loss : 0.066, train acc : 0.995, valid acc : 0.981, train f1 : 0.934, valid f1 : 0.759

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.75it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 344.04it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 346.19it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.87it/s][A
 90%|█████████ | 176/195 [00:00<00:00, 349.13it/s][A100%|██████████| 195/195 [00:00<00:00, 347.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  79%|███████▉  | 101/128 [2:41:39<44:39, 99.25s/it]Best score increase :0.805 -> 0.812
training process:  80%|███████▉  | 102/128 [2:43:12<42:11, 97.35s/it]EarlyStopping counter : 1 out of 40
training process:  80%|████████  | 103/128 [2:44:43<39:47, 95.51s/it]EarlyStopping counter : 2 out of 40
training process:  81%|████████▏ | 104/128 [2:46:11<37:15, 93.16s/it]epoch : 105, train loss : 0.003, valid loss : 0.060, train acc : 0.995, valid acc : 0.982, train f1 : 0.937, valid f1 : 0.771

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 207.24it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 264.63it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 292.64it/s][A
 61%|██████    | 119/195 [00:00<00:00, 309.16it/s][A
 78%|███████▊  | 153/195 [00:00<00:00, 318.30it/s][A
 96%|█████████▌| 187/195 [00:00<00:00, 323.87it/s][A100%|██████████| 195/195 [00:00<00:00, 307.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  82%|████████▏ | 105/128 [2:48:06<38:13, 99.70s/it]EarlyStopping counter : 4 out of 40
training process:  83%|████████▎ | 106/128 [2:49:37<35:33, 96.99s/it]EarlyStopping counter : 5 out of 40
training process:  84%|████████▎ | 107/128 [2:51:07<33:16, 95.07s/it]EarlyStopping counter : 6 out of 40
training process:  84%|████████▍ | 108/128 [2:52:38<31:14, 93.74s/it]epoch : 109, train loss : 0.003, valid loss : 0.062, train acc : 0.996, valid acc : 0.980, train f1 : 0.942, valid f1 : 0.755

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 342.02it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 347.74it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 348.74it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 349.79it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 350.66it/s][A100%|██████████| 195/195 [00:00<00:00, 349.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  85%|████████▌ | 109/128 [2:54:33<31:43, 100.20s/it]EarlyStopping counter : 8 out of 40
training process:  86%|████████▌ | 110/128 [2:56:01<28:59, 96.64s/it] EarlyStopping counter : 9 out of 40
training process:  87%|████████▋ | 111/128 [2:57:33<26:56, 95.09s/it]EarlyStopping counter : 10 out of 40
training process:  88%|████████▊ | 112/128 [2:59:00<24:43, 92.73s/it]epoch : 113, train loss : 0.003, valid loss : 0.070, train acc : 0.995, valid acc : 0.985, train f1 : 0.940, valid f1 : 0.788

  0%|          | 0/195 [00:00<?, ?it/s][A
 13%|█▎        | 25/195 [00:00<00:00, 244.95it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 259.24it/s][A
 41%|████      | 80/195 [00:00<00:00, 266.26it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 266.94it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 269.65it/s][A
 84%|████████▎ | 163/195 [00:00<00:00, 271.36it/s][A
 98%|█████████▊| 191/195 [00:00<00:00, 272.73it/s][A100%|██████████| 195/195 [00:00<00:00, 268.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  88%|████████▊ | 113/128 [3:00:52<24:38, 98.54s/it]EarlyStopping counter : 12 out of 40
training process:  89%|████████▉ | 114/128 [3:02:19<22:11, 95.13s/it]EarlyStopping counter : 13 out of 40
training process:  90%|████████▉ | 115/128 [3:03:47<20:05, 92.73s/it]EarlyStopping counter : 14 out of 40
training process:  91%|█████████ | 116/128 [3:05:15<18:18, 91.53s/it]epoch : 117, train loss : 0.003, valid loss : 0.068, train acc : 0.996, valid acc : 0.985, train f1 : 0.946, valid f1 : 0.782

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 276.05it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 279.99it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 281.24it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 281.77it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 281.84it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 280.95it/s][A100%|██████████| 195/195 [00:00<00:00, 280.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  91%|█████████▏| 117/128 [3:07:10<18:03, 98.50s/it]EarlyStopping counter : 16 out of 40
training process:  92%|█████████▏| 118/128 [3:08:40<15:59, 95.90s/it]EarlyStopping counter : 17 out of 40
training process:  93%|█████████▎| 119/128 [3:10:05<13:53, 92.65s/it]EarlyStopping counter : 18 out of 40
training process:  94%|█████████▍| 120/128 [3:11:35<12:14, 91.77s/it]epoch : 121, train loss : 0.003, valid loss : 0.070, train acc : 0.996, valid acc : 0.973, train f1 : 0.952, valid f1 : 0.709

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.06it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 329.92it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 325.50it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 318.85it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 320.58it/s][A100%|██████████| 195/195 [00:00<00:00, 323.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  95%|█████████▍| 121/128 [3:13:28<11:28, 98.39s/it]EarlyStopping counter : 20 out of 40
training process:  95%|█████████▌| 122/128 [3:14:56<09:30, 95.04s/it]EarlyStopping counter : 21 out of 40
training process:  96%|█████████▌| 123/128 [3:16:26<07:48, 93.75s/it]EarlyStopping counter : 22 out of 40
training process:  97%|█████████▋| 124/128 [3:17:56<06:10, 92.54s/it]epoch : 125, train loss : 0.003, valid loss : 0.074, train acc : 0.997, valid acc : 0.986, train f1 : 0.953, valid f1 : 0.795

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 314.04it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.96it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.04it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.85it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 336.86it/s][A100%|██████████| 195/195 [00:00<00:00, 335.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  98%|█████████▊| 125/128 [3:19:52<04:58, 99.61s/it]EarlyStopping counter : 24 out of 40
training process:  98%|█████████▊| 126/128 [3:21:22<03:13, 96.73s/it]EarlyStopping counter : 25 out of 40
training process:  99%|█████████▉| 127/128 [3:22:53<01:34, 94.98s/it]EarlyStopping counter : 26 out of 40
training process: 100%|██████████| 128/128 [3:24:24<00:00, 93.60s/it]training process: 100%|██████████| 128/128 [3:24:24<00:00, 95.81s/it]
training process finished, best loss : 0.066 and best acc : 0.988, best f1 : 0.812, best epoch : 101

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.48      0.53       303
           1       0.99      0.99      0.99     16947

    accuracy                           0.99     17250
   macro avg       0.79      0.74      0.76     17250
weighted avg       0.98      0.99      0.98     17250


# test acc : 0.99, test f1 : 0.76, test AUC : 0.74, test loss : 19.427

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:09, 11.85s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:03, 12.26s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:44, 11.74s/it]processing for feature importance:  24%|██▎       | 4/17 [00:47<02:34, 11.86s/it]processing for feature importance:  29%|██▉       | 5/17 [01:00<02:24, 12.08s/it]processing for feature importance:  35%|███▌      | 6/17 [01:12<02:13, 12.17s/it]processing for feature importance:  41%|████      | 7/17 [01:24<02:01, 12.14s/it]processing for feature importance:  47%|████▋     | 8/17 [01:36<01:48, 12.03s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:49<01:38, 12.35s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:02<01:28, 12.71s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:14<01:13, 12.33s/it]processing for feature importance:  71%|███████   | 12/17 [02:27<01:02, 12.46s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:39<00:49, 12.32s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:51<00:37, 12.36s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:03<00:24, 12.21s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:14<00:12, 12.04s/it]processing for feature importance: 100%|██████████| 17/17 [03:26<00:00, 11.92s/it]processing for feature importance: 100%|██████████| 17/17 [03:26<00:00, 12.16s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:02<09:22,  2.68s/it]visualize 2D latent space:   1%|          | 2/211 [00:03<04:44,  1.36s/it]visualize 2D latent space:   1%|          | 2/211 [00:04<07:30,  2.16s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:13,  2.00s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:31,  1.39s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<12:56,  3.70s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<09:09,  2.63s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:27,  2.20s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:38,  1.50s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s]  4%|▍         | 8/195 [00:00<00:04, 37.74it/s] 18%|█▊        | 36/195 [00:00<00:01, 134.80it/s] 33%|███▎      | 65/195 [00:00<00:00, 189.37it/s] 48%|████▊     | 94/195 [00:00<00:00, 221.51it/s] 63%|██████▎   | 123/195 [00:00<00:00, 241.50it/s] 78%|███████▊  | 152/195 [00:00<00:00, 254.33it/s] 92%|█████████▏| 180/195 [00:00<00:00, 261.59it/s]100%|██████████| 195/195 [00:00<00:00, 221.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_smoothing_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 19/616 [00:00<00:03, 189.79it/s]remove invalid data : null / measurement error:   6%|▋         | 39/616 [00:00<00:03, 192.30it/s]remove invalid data : null / measurement error:  10%|▉         | 59/616 [00:00<00:02, 191.63it/s]remove invalid data : null / measurement error:  13%|█▎        | 79/616 [00:00<00:03, 174.49it/s]remove invalid data : null / measurement error:  16%|█▌        | 97/616 [00:00<00:03, 172.00it/s]remove invalid data : null / measurement error:  19%|█▉        | 118/616 [00:00<00:02, 182.87it/s]remove invalid data : null / measurement error:  23%|██▎       | 139/616 [00:00<00:02, 189.72it/s]remove invalid data : null / measurement error:  26%|██▌       | 161/616 [00:00<00:02, 196.82it/s]remove invalid data : null / measurement error:  29%|██▉       | 181/616 [00:00<00:02, 197.02it/s]remove invalid data : null / measurement error:  33%|███▎      | 201/616 [00:01<00:02, 175.26it/s]remove invalid data : null / measurement error:  36%|███▌      | 219/616 [00:01<00:02, 167.10it/s]remove invalid data : null / measurement error:  39%|███▉      | 240/616 [00:01<00:02, 177.03it/s]remove invalid data : null / measurement error:  42%|████▏     | 261/616 [00:01<00:01, 183.79it/s]remove invalid data : null / measurement error:  46%|████▌     | 282/616 [00:01<00:01, 189.76it/s]remove invalid data : null / measurement error:  49%|████▉     | 303/616 [00:01<00:01, 193.90it/s]remove invalid data : null / measurement error:  53%|█████▎    | 324/616 [00:01<00:01, 196.50it/s]remove invalid data : null / measurement error:  56%|█████▌    | 345/616 [00:01<00:01, 198.02it/s]remove invalid data : null / measurement error:  59%|█████▉    | 366/616 [00:01<00:01, 200.41it/s]remove invalid data : null / measurement error:  63%|██████▎   | 391/616 [00:02<00:01, 214.18it/s]remove invalid data : null / measurement error:  67%|██████▋   | 415/616 [00:02<00:00, 220.55it/s]remove invalid data : null / measurement error:  71%|███████   | 438/616 [00:02<00:00, 190.15it/s]remove invalid data : null / measurement error:  75%|███████▌  | 462/616 [00:02<00:00, 201.03it/s]remove invalid data : null / measurement error:  78%|███████▊  | 483/616 [00:02<00:00, 199.00it/s]remove invalid data : null / measurement error:  82%|████████▏ | 504/616 [00:02<00:00, 199.94it/s]remove invalid data : null / measurement error:  85%|████████▌ | 525/616 [00:02<00:00, 201.87it/s]remove invalid data : null / measurement error:  89%|████████▊ | 546/616 [00:02<00:00, 200.78it/s]remove invalid data : null / measurement error:  92%|█████████▏| 567/616 [00:02<00:00, 200.57it/s]remove invalid data : null / measurement error:  95%|█████████▌| 588/616 [00:03<00:00, 198.45it/s]remove invalid data : null / measurement error:  99%|█████████▊| 608/616 [00:03<00:00, 197.69it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 193.38it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   4%|▎         | 19/515 [00:00<00:02, 186.60it/s]replace nan value:   7%|▋         | 38/515 [00:00<00:02, 167.58it/s]replace nan value:  12%|█▏        | 60/515 [00:00<00:02, 187.68it/s]replace nan value:  16%|█▋        | 84/515 [00:00<00:02, 205.58it/s]replace nan value:  21%|██        | 106/515 [00:00<00:01, 209.59it/s]replace nan value:  25%|██▌       | 130/515 [00:00<00:01, 217.63it/s]replace nan value:  30%|██▉       | 154/515 [00:00<00:01, 224.30it/s]replace nan value:  35%|███▍      | 179/515 [00:00<00:01, 229.63it/s]replace nan value:  39%|███▉      | 203/515 [00:00<00:01, 201.22it/s]replace nan value:  43%|████▎     | 224/515 [00:01<00:01, 202.10it/s]replace nan value:  48%|████▊     | 248/515 [00:01<00:01, 212.45it/s]replace nan value:  53%|█████▎    | 273/515 [00:01<00:01, 220.57it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 224.19it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 229.03it/s]replace nan value:  67%|██████▋   | 346/515 [00:01<00:00, 230.90it/s]replace nan value:  72%|███████▏  | 371/515 [00:01<00:00, 234.30it/s]replace nan value:  77%|███████▋  | 396/515 [00:01<00:00, 236.10it/s]replace nan value:  82%|████████▏ | 420/515 [00:01<00:00, 232.64it/s]replace nan value:  86%|████████▌ | 444/515 [00:02<00:00, 231.25it/s]replace nan value:  91%|█████████ | 468/515 [00:02<00:00, 232.87it/s]replace nan value:  96%|█████████▌| 492/515 [00:02<00:00, 234.46it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 221.62it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.09it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.79it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.69it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.21it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.68it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.70it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.39it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.21it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.67it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 52.99it/s]generate index:  17%|█▋        | 87/515 [00:01<00:07, 58.67it/s]generate index:  18%|█▊        | 94/515 [00:01<00:07, 54.09it/s]generate index:  19%|█▉        | 100/515 [00:01<00:07, 52.69it/s]generate index:  21%|██        | 107/515 [00:01<00:07, 56.35it/s]generate index:  23%|██▎       | 117/515 [00:01<00:06, 65.32it/s]generate index:  24%|██▍       | 124/515 [00:02<00:05, 65.88it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 69.09it/s]generate index:  27%|██▋       | 140/515 [00:02<00:05, 65.19it/s]generate index:  29%|██▊       | 147/515 [00:02<00:05, 62.67it/s]generate index:  30%|███       | 155/515 [00:02<00:05, 66.93it/s]generate index:  32%|███▏      | 164/515 [00:02<00:04, 70.45it/s]generate index:  33%|███▎      | 172/515 [00:02<00:05, 66.77it/s]generate index:  35%|███▍      | 179/515 [00:02<00:05, 66.75it/s]generate index:  37%|███▋      | 188/515 [00:03<00:04, 71.07it/s]generate index:  38%|███▊      | 196/515 [00:03<00:04, 69.99it/s]generate index:  40%|███▉      | 204/515 [00:03<00:04, 66.56it/s]generate index:  42%|████▏     | 217/515 [00:03<00:03, 82.48it/s]generate index:  44%|████▍     | 226/515 [00:03<00:03, 75.09it/s]generate index:  46%|████▌     | 237/515 [00:03<00:03, 83.61it/s]generate index:  48%|████▊     | 246/515 [00:03<00:03, 85.12it/s]generate index:  50%|████▉     | 255/515 [00:03<00:03, 66.21it/s]generate index:  52%|█████▏    | 266/515 [00:04<00:03, 74.75it/s]generate index:  53%|█████▎    | 275/515 [00:04<00:03, 77.75it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.42it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.40it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:04, 53.70it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 54.22it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 55.24it/s]generate index:  62%|██████▏   | 321/515 [00:05<00:03, 58.60it/s]generate index:  64%|██████▍   | 329/515 [00:05<00:02, 63.55it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 51.57it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:04, 38.81it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:04, 39.31it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 46.31it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 53.76it/s]generate index:  73%|███████▎  | 375/515 [00:06<00:02, 69.63it/s]generate index:  75%|███████▍  | 384/515 [00:06<00:01, 73.80it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 72.90it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 72.67it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.05it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 63.75it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.66it/s]generate index:  85%|████████▍ | 437/515 [00:07<00:01, 55.10it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.92it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.12it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.94it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 49.13it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 59.58it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 59.92it/s]generate index:  97%|█████████▋| 498/515 [00:08<00:00, 59.18it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 67.70it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 61.36it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   1%|          | 1/154 [00:00<00:15,  9.87it/s]remove invalid data : null / measurement error:  14%|█▎        | 21/154 [00:00<00:01, 120.58it/s]remove invalid data : null / measurement error:  27%|██▋       | 42/154 [00:00<00:00, 158.25it/s]remove invalid data : null / measurement error:  40%|████      | 62/154 [00:00<00:00, 174.44it/s]remove invalid data : null / measurement error:  54%|█████▍    | 83/154 [00:00<00:00, 186.55it/s]remove invalid data : null / measurement error:  69%|██████▉   | 107/154 [00:00<00:00, 201.46it/s]remove invalid data : null / measurement error:  84%|████████▍ | 129/154 [00:00<00:00, 205.28it/s]remove invalid data : null / measurement error:  97%|█████████▋| 150/154 [00:00<00:00, 202.74it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 182.99it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 243.72it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 245.98it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 246.56it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 243.62it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 245.45it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 245.28it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 67.82it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.03it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.38it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.46it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.60it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 49.83it/s]generate index:  38%|███▊      | 50/131 [00:00<00:01, 51.97it/s]generate index:  44%|████▍     | 58/131 [00:01<00:01, 57.03it/s]generate index:  50%|█████     | 66/131 [00:01<00:01, 62.90it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 65.68it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 61.12it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 44.58it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 44.71it/s]generate index:  76%|███████▌  | 99/131 [00:01<00:00, 43.46it/s]generate index:  80%|████████  | 105/131 [00:02<00:00, 45.69it/s]generate index:  85%|████████▌ | 112/131 [00:02<00:00, 49.57it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 62.90it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 56.05it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/193 [00:00<00:03, 49.82it/s]remove invalid data : null / measurement error:  13%|█▎        | 26/193 [00:00<00:01, 142.74it/s]remove invalid data : null / measurement error:  24%|██▍       | 47/193 [00:00<00:00, 170.95it/s]remove invalid data : null / measurement error:  35%|███▌      | 68/193 [00:00<00:00, 185.94it/s]remove invalid data : null / measurement error:  47%|████▋     | 90/193 [00:00<00:00, 195.32it/s]remove invalid data : null / measurement error:  58%|█████▊    | 111/193 [00:00<00:00, 194.85it/s]remove invalid data : null / measurement error:  70%|██████▉   | 135/193 [00:00<00:00, 208.73it/s]remove invalid data : null / measurement error:  81%|████████  | 156/193 [00:00<00:00, 208.29it/s]remove invalid data : null / measurement error:  92%|█████████▏| 177/193 [00:00<00:00, 205.42it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 192.07it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 246.37it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 248.72it/s]replace nan value:  48%|████▊     | 76/160 [00:00<00:00, 201.96it/s]replace nan value:  62%|██████▏   | 99/160 [00:00<00:00, 209.14it/s]replace nan value:  78%|███████▊  | 124/160 [00:00<00:00, 221.52it/s]replace nan value:  93%|█████████▎| 149/160 [00:00<00:00, 229.84it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 226.14it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 109.62it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 66.07it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.71it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.92it/s]generate index:  31%|███▏      | 50/160 [00:00<00:01, 68.12it/s]generate index:  36%|███▋      | 58/160 [00:00<00:01, 67.00it/s]generate index:  42%|████▎     | 68/160 [00:00<00:01, 75.52it/s]generate index:  48%|████▊     | 76/160 [00:01<00:01, 69.14it/s]generate index:  52%|█████▎    | 84/160 [00:01<00:01, 62.86it/s]generate index:  57%|█████▋    | 91/160 [00:01<00:01, 55.74it/s]generate index:  61%|██████▏   | 98/160 [00:01<00:01, 58.25it/s]generate index:  66%|██████▌   | 105/160 [00:01<00:01, 48.27it/s]generate index:  70%|███████   | 112/160 [00:01<00:00, 52.35it/s]generate index:  76%|███████▌  | 121/160 [00:01<00:00, 60.10it/s]generate index:  80%|████████  | 128/160 [00:02<00:00, 55.27it/s]generate index:  84%|████████▍ | 135/160 [00:02<00:00, 54.60it/s]generate index:  89%|████████▉ | 142/160 [00:02<00:00, 58.13it/s]generate index:  93%|█████████▎| 149/160 [00:02<00:00, 60.21it/s]generate index:  98%|█████████▊| 156/160 [00:02<00:00, 59.95it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 59.75it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.160, valid loss : 0.028, train acc : 0.960, valid acc : 0.983, train f1 : 0.505, valid f1 : 0.496

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.81it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.80it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 345.09it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 347.18it/s][A
 91%|█████████ | 177/195 [00:00<00:00, 348.25it/s][A100%|██████████| 195/195 [00:00<00:00, 346.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.496
training process:   1%|          | 1/128 [01:57<4:09:43, 117.98s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:26<3:31:24, 100.67s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:58<3:21:34, 96.76s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:28<3:14:07, 93.93s/it]epoch : 5, train loss : -0.025, valid loss : -0.049, train acc : 0.982, valid acc : 0.983, train f1 : 0.500, valid f1 : 0.499

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.24it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.32it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.42it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.55it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.17it/s][A100%|██████████| 195/195 [00:00<00:00, 341.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.496 -> 0.499
training process:   4%|▍         | 5/128 [08:21<3:27:12, 101.07s/it]Best score increase :0.499 -> 0.517
training process:   5%|▍         | 6/128 [09:51<3:17:16, 97.02s/it] Best score increase :0.517 -> 0.533
training process:   5%|▌         | 7/128 [11:22<3:12:01, 95.22s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:54<3:08:25, 94.21s/it]epoch : 9, train loss : -0.146, valid loss : -0.176, train acc : 0.981, valid acc : 0.982, train f1 : 0.541, valid f1 : 0.540

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.35it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.77it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.60it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 347.03it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 347.64it/s][A100%|██████████| 195/195 [00:00<00:00, 345.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.533 -> 0.540
training process:   7%|▋         | 9/128 [14:50<3:20:01, 100.85s/it]Best score increase :0.540 -> 0.569
training process:   8%|▊         | 10/128 [16:18<3:10:52, 97.05s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [17:48<3:04:49, 94.78s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▉         | 12/128 [19:16<2:59:37, 92.91s/it]epoch : 13, train loss : -0.316, valid loss : -0.391, train acc : 0.980, valid acc : 0.983, train f1 : 0.558, valid f1 : 0.550

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|▉         | 19/195 [00:00<00:00, 188.63it/s][A
 23%|██▎       | 45/195 [00:00<00:00, 228.04it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 213.19it/s][A
 48%|████▊     | 94/195 [00:00<00:00, 228.17it/s][A
 65%|██████▍   | 126/195 [00:00<00:00, 258.25it/s][A
 82%|████████▏ | 159/195 [00:00<00:00, 278.10it/s][A
 98%|█████████▊| 192/195 [00:00<00:00, 293.42it/s][A100%|██████████| 195/195 [00:00<00:00, 263.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  10%|█         | 13/128 [21:16<3:13:48, 101.12s/it]EarlyStopping counter : 4 out of 40
training process:  11%|█         | 14/128 [22:43<3:03:36, 96.64s/it] EarlyStopping counter : 5 out of 40
training process:  12%|█▏        | 15/128 [24:11<2:57:24, 94.20s/it]EarlyStopping counter : 6 out of 40
training process:  12%|█▎        | 16/128 [25:38<2:51:22, 91.81s/it]epoch : 17, train loss : -0.515, valid loss : -0.667, train acc : 0.978, valid acc : 0.984, train f1 : 0.593, valid f1 : 0.538

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.26it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.70it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.07it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.27it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.86it/s][A100%|██████████| 195/195 [00:00<00:00, 335.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  13%|█▎        | 17/128 [27:32<3:02:15, 98.52s/it]Best score increase :0.569 -> 0.610
training process:  14%|█▍        | 18/128 [28:57<2:53:05, 94.41s/it]EarlyStopping counter : 1 out of 40
training process:  15%|█▍        | 19/128 [30:22<2:46:22, 91.58s/it]EarlyStopping counter : 2 out of 40
training process:  16%|█▌        | 20/128 [31:49<2:42:52, 90.49s/it]epoch : 21, train loss : -0.775, valid loss : -0.865, train acc : 0.977, valid acc : 0.983, train f1 : 0.601, valid f1 : 0.522

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.61it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 328.99it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 332.85it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.83it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 336.26it/s][A100%|██████████| 195/195 [00:00<00:00, 335.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  16%|█▋        | 21/128 [33:43<2:53:50, 97.48s/it]EarlyStopping counter : 4 out of 40
training process:  17%|█▋        | 22/128 [35:13<2:47:57, 95.07s/it]EarlyStopping counter : 5 out of 40
training process:  18%|█▊        | 23/128 [36:41<2:43:03, 93.18s/it]EarlyStopping counter : 6 out of 40
training process:  19%|█▉        | 24/128 [38:10<2:38:56, 91.70s/it]epoch : 25, train loss : -1.046, valid loss : -1.256, train acc : 0.977, valid acc : 0.982, train f1 : 0.618, valid f1 : 0.610

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.48it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.81it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 340.33it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.59it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.23it/s][A100%|██████████| 195/195 [00:00<00:00, 340.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  20%|█▉        | 25/128 [40:01<2:47:35, 97.63s/it]EarlyStopping counter : 8 out of 40
training process:  20%|██        | 26/128 [41:28<2:40:29, 94.41s/it]EarlyStopping counter : 9 out of 40
training process:  21%|██        | 27/128 [42:57<2:36:14, 92.82s/it]Best score increase :0.610 -> 0.621
training process:  22%|██▏       | 28/128 [44:27<2:32:59, 91.80s/it]epoch : 29, train loss : -1.317, valid loss : -1.525, train acc : 0.974, valid acc : 0.984, train f1 : 0.614, valid f1 : 0.547

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 206.10it/s][A
 26%|██▌       | 51/195 [00:00<00:00, 260.88it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 291.58it/s][A
 60%|██████    | 117/195 [00:00<00:00, 306.17it/s][A
 77%|███████▋  | 150/195 [00:00<00:00, 312.93it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 318.35it/s][A100%|██████████| 195/195 [00:00<00:00, 303.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 29/128 [46:22<2:43:23, 99.02s/it]EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 30/128 [47:55<2:38:47, 97.22s/it]EarlyStopping counter : 3 out of 40
training process:  24%|██▍       | 31/128 [49:28<2:35:01, 95.89s/it]EarlyStopping counter : 4 out of 40
training process:  25%|██▌       | 32/128 [51:00<2:31:23, 94.62s/it]epoch : 33, train loss : -1.670, valid loss : -1.674, train acc : 0.975, valid acc : 0.984, train f1 : 0.617, valid f1 : 0.554

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.76it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.90it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.84it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.53it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.39it/s][A100%|██████████| 195/195 [00:00<00:00, 337.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  26%|██▌       | 33/128 [53:01<2:42:15, 102.48s/it]Best score increase :0.621 -> 0.638
training process:  27%|██▋       | 34/128 [54:30<2:34:24, 98.56s/it] EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 35/128 [55:59<2:28:01, 95.50s/it]EarlyStopping counter : 2 out of 40
training process:  28%|██▊       | 36/128 [57:28<2:23:35, 93.65s/it]epoch : 37, train loss : -1.964, valid loss : -1.830, train acc : 0.972, valid acc : 0.983, train f1 : 0.603, valid f1 : 0.646

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.31it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.25it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 329.26it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 331.88it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 333.20it/s][A100%|██████████| 195/195 [00:00<00:00, 332.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.638 -> 0.646
training process:  29%|██▉       | 37/128 [59:23<2:31:36, 99.96s/it]EarlyStopping counter : 1 out of 40
training process:  30%|██▉       | 38/128 [1:00:54<2:26:15, 97.51s/it]EarlyStopping counter : 2 out of 40
training process:  30%|███       | 39/128 [1:02:24<2:20:57, 95.03s/it]EarlyStopping counter : 3 out of 40
training process:  31%|███▏      | 40/128 [1:03:53<2:16:59, 93.40s/it]epoch : 41, train loss : -2.268, valid loss : -2.144, train acc : 0.964, valid acc : 0.984, train f1 : 0.594, valid f1 : 0.586

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.92it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.32it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.95it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 333.86it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.49it/s][A100%|██████████| 195/195 [00:00<00:00, 333.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  32%|███▏      | 41/128 [1:05:47<2:24:27, 99.63s/it]EarlyStopping counter : 5 out of 40
training process:  33%|███▎      | 42/128 [1:07:18<2:18:51, 96.88s/it]Best score increase :0.646 -> 0.659
training process:  34%|███▎      | 43/128 [1:08:49<2:14:39, 95.06s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▍      | 44/128 [1:10:19<2:11:02, 93.60s/it]epoch : 45, train loss : -2.601, valid loss : -2.492, train acc : 0.962, valid acc : 0.983, train f1 : 0.598, valid f1 : 0.654

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.02it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.25it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.95it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.15it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.89it/s][A100%|██████████| 195/195 [00:00<00:00, 336.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  35%|███▌      | 45/128 [1:12:11<2:17:10, 99.16s/it]EarlyStopping counter : 3 out of 40
training process:  36%|███▌      | 46/128 [1:13:44<2:13:10, 97.44s/it]EarlyStopping counter : 4 out of 40
training process:  37%|███▋      | 47/128 [1:15:19<2:10:19, 96.54s/it]EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 48/128 [1:16:55<2:08:23, 96.29s/it]epoch : 49, train loss : -3.030, valid loss : -2.805, train acc : 0.970, valid acc : 0.985, train f1 : 0.611, valid f1 : 0.621

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.73it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.57it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.62it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.49it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.57it/s][A100%|██████████| 195/195 [00:00<00:00, 336.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 49/128 [1:18:55<2:16:23, 103.59s/it]EarlyStopping counter : 7 out of 40
training process:  39%|███▉      | 50/128 [1:20:22<2:08:06, 98.55s/it] EarlyStopping counter : 8 out of 40
training process:  40%|███▉      | 51/128 [1:21:52<2:03:08, 95.95s/it]EarlyStopping counter : 9 out of 40
training process:  41%|████      | 52/128 [1:23:22<1:59:20, 94.21s/it]epoch : 53, train loss : -3.444, valid loss : -3.309, train acc : 0.975, valid acc : 0.980, train f1 : 0.625, valid f1 : 0.615

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.24it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.56it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.54it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.04it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.90it/s][A100%|██████████| 195/195 [00:00<00:00, 334.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  41%|████▏     | 53/128 [1:25:18<2:06:01, 100.81s/it]EarlyStopping counter : 11 out of 40
training process:  42%|████▏     | 54/128 [1:26:48<2:00:24, 97.62s/it] EarlyStopping counter : 12 out of 40
training process:  43%|████▎     | 55/128 [1:28:21<1:56:57, 96.13s/it]EarlyStopping counter : 13 out of 40
training process:  44%|████▍     | 56/128 [1:29:52<1:53:28, 94.56s/it]epoch : 57, train loss : -3.709, valid loss : -3.646, train acc : 0.973, valid acc : 0.980, train f1 : 0.634, valid f1 : 0.659

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.80it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 334.50it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 331.10it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 333.53it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.22it/s][A100%|██████████| 195/195 [00:00<00:00, 334.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  45%|████▍     | 57/128 [1:31:46<1:58:42, 100.31s/it]EarlyStopping counter : 15 out of 40
training process:  45%|████▌     | 58/128 [1:33:14<1:52:43, 96.62s/it] EarlyStopping counter : 16 out of 40
training process:  46%|████▌     | 59/128 [1:34:42<1:48:21, 94.23s/it]EarlyStopping counter : 17 out of 40
training process:  47%|████▋     | 60/128 [1:36:11<1:44:54, 92.57s/it]epoch : 61, train loss : -4.024, valid loss : -3.627, train acc : 0.972, valid acc : 0.980, train f1 : 0.623, valid f1 : 0.684

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.28it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.48it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.14it/s][A
 70%|███████   | 137/195 [00:00<00:00, 337.97it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.82it/s][A100%|██████████| 195/195 [00:00<00:00, 336.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.659 -> 0.684
training process:  48%|████▊     | 61/128 [1:38:06<1:50:50, 99.27s/it]EarlyStopping counter : 1 out of 40
training process:  48%|████▊     | 62/128 [1:39:35<1:45:57, 96.33s/it]EarlyStopping counter : 2 out of 40
training process:  49%|████▉     | 63/128 [1:41:07<1:42:46, 94.87s/it]EarlyStopping counter : 3 out of 40
training process:  50%|█████     | 64/128 [1:42:37<1:39:45, 93.52s/it]epoch : 65, train loss : -4.526, valid loss : -3.811, train acc : 0.975, valid acc : 0.985, train f1 : 0.625, valid f1 : 0.600

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.25it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.23it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.69it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.63it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 336.04it/s][A100%|██████████| 195/195 [00:00<00:00, 335.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  51%|█████     | 65/128 [1:44:32<1:45:02, 100.04s/it]EarlyStopping counter : 5 out of 40
training process:  52%|█████▏    | 66/128 [1:46:02<1:40:02, 96.82s/it] EarlyStopping counter : 6 out of 40
training process:  52%|█████▏    | 67/128 [1:47:32<1:36:20, 94.77s/it]EarlyStopping counter : 7 out of 40
training process:  53%|█████▎    | 68/128 [1:48:59<1:32:36, 92.60s/it]epoch : 69, train loss : -4.918, valid loss : -4.495, train acc : 0.965, valid acc : 0.985, train f1 : 0.623, valid f1 : 0.616

  0%|          | 0/195 [00:00<?, ?it/s][A
 12%|█▏        | 23/195 [00:00<00:00, 225.56it/s][A
 24%|██▍       | 47/195 [00:00<00:00, 230.07it/s][A
 41%|████      | 80/195 [00:00<00:00, 273.40it/s][A
 58%|█████▊    | 114/195 [00:00<00:00, 298.86it/s][A
 75%|███████▌  | 147/195 [00:00<00:00, 309.32it/s][A
 93%|█████████▎| 181/195 [00:00<00:00, 319.10it/s][A100%|██████████| 195/195 [00:00<00:00, 300.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  54%|█████▍    | 69/128 [1:50:53<1:37:10, 98.82s/it]EarlyStopping counter : 9 out of 40
training process:  55%|█████▍    | 70/128 [1:52:21<1:32:26, 95.62s/it]EarlyStopping counter : 10 out of 40
training process:  55%|█████▌    | 71/128 [1:53:50<1:28:53, 93.57s/it]EarlyStopping counter : 11 out of 40
training process:  56%|█████▋    | 72/128 [1:55:17<1:25:35, 91.71s/it]epoch : 73, train loss : -5.244, valid loss : -4.378, train acc : 0.974, valid acc : 0.983, train f1 : 0.649, valid f1 : 0.608

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.10it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 329.71it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 330.95it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 324.53it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 322.21it/s][A100%|██████████| 195/195 [00:00<00:00, 323.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  57%|█████▋    | 73/128 [1:57:13<1:30:41, 98.94s/it]Best score increase :0.684 -> 0.688
training process:  58%|█████▊    | 74/128 [1:58:44<1:26:55, 96.59s/it]EarlyStopping counter : 1 out of 40
training process:  59%|█████▊    | 75/128 [2:00:15<1:23:49, 94.89s/it]EarlyStopping counter : 2 out of 40
training process:  59%|█████▉    | 76/128 [2:01:42<1:20:08, 92.48s/it]epoch : 77, train loss : -5.202, valid loss : -4.505, train acc : 0.975, valid acc : 0.984, train f1 : 0.646, valid f1 : 0.555

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.41it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.95it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.82it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.02it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.26it/s][A100%|██████████| 195/195 [00:00<00:00, 336.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  60%|██████    | 77/128 [2:03:38<1:24:44, 99.70s/it]EarlyStopping counter : 4 out of 40
training process:  61%|██████    | 78/128 [2:05:09<1:20:51, 97.03s/it]EarlyStopping counter : 5 out of 40
training process:  62%|██████▏   | 79/128 [2:06:41<1:17:57, 95.45s/it]EarlyStopping counter : 6 out of 40
training process:  62%|██████▎   | 80/128 [2:08:13<1:15:29, 94.37s/it]epoch : 81, train loss : -5.823, valid loss : -5.107, train acc : 0.973, valid acc : 0.985, train f1 : 0.650, valid f1 : 0.624

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 195.91it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 254.13it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 286.58it/s][A
 59%|█████▉    | 116/195 [00:00<00:00, 302.03it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 310.81it/s][A
 93%|█████████▎| 182/195 [00:00<00:00, 315.38it/s][A100%|██████████| 195/195 [00:00<00:00, 300.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  63%|██████▎   | 81/128 [2:10:09<1:19:06, 101.00s/it]EarlyStopping counter : 8 out of 40
training process:  64%|██████▍   | 82/128 [2:11:39<1:14:57, 97.77s/it] EarlyStopping counter : 9 out of 40
training process:  65%|██████▍   | 83/128 [2:13:09<1:11:33, 95.41s/it]EarlyStopping counter : 10 out of 40
training process:  66%|██████▌   | 84/128 [2:14:40<1:09:01, 94.13s/it]epoch : 85, train loss : -6.162, valid loss : -5.012, train acc : 0.978, valid acc : 0.984, train f1 : 0.659, valid f1 : 0.662

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.45it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 336.49it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 338.16it/s][A
 71%|███████   | 138/195 [00:00<00:00, 334.90it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 337.18it/s][A100%|██████████| 195/195 [00:00<00:00, 336.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  66%|██████▋   | 85/128 [2:16:36<1:12:08, 100.65s/it]EarlyStopping counter : 12 out of 40
training process:  67%|██████▋   | 86/128 [2:18:05<1:07:52, 96.97s/it] EarlyStopping counter : 13 out of 40
training process:  68%|██████▊   | 87/128 [2:19:34<1:04:38, 94.59s/it]EarlyStopping counter : 14 out of 40
training process:  69%|██████▉   | 88/128 [2:21:05<1:02:27, 93.69s/it]epoch : 89, train loss : -6.703, valid loss : -5.622, train acc : 0.977, valid acc : 0.984, train f1 : 0.677, valid f1 : 0.676

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.78it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.65it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.87it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.52it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.80it/s][A100%|██████████| 195/195 [00:00<00:00, 340.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  70%|██████▉   | 89/128 [2:23:03<1:05:36, 100.93s/it]EarlyStopping counter : 16 out of 40
training process:  70%|███████   | 90/128 [2:24:32<1:01:43, 97.46s/it] EarlyStopping counter : 17 out of 40
training process:  71%|███████   | 91/128 [2:26:04<59:00, 95.69s/it]  EarlyStopping counter : 18 out of 40
training process:  72%|███████▏  | 92/128 [2:27:34<56:24, 94.02s/it]epoch : 93, train loss : -6.943, valid loss : -5.506, train acc : 0.979, valid acc : 0.985, train f1 : 0.676, valid f1 : 0.595

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 329.69it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.50it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 334.60it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.11it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 335.44it/s][A100%|██████████| 195/195 [00:00<00:00, 334.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  73%|███████▎  | 93/128 [2:29:31<58:51, 100.91s/it]EarlyStopping counter : 20 out of 40
training process:  73%|███████▎  | 94/128 [2:31:01<55:17, 97.59s/it] EarlyStopping counter : 21 out of 40
training process:  74%|███████▍  | 95/128 [2:32:33<52:48, 96.01s/it]EarlyStopping counter : 22 out of 40
training process:  75%|███████▌  | 96/128 [2:34:04<50:22, 94.44s/it]epoch : 97, train loss : -7.380, valid loss : -6.085, train acc : 0.977, valid acc : 0.971, train f1 : 0.669, valid f1 : 0.620

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.64it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.94it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.45it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 338.43it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 313.91it/s][A100%|██████████| 195/195 [00:00<00:00, 307.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  76%|███████▌  | 97/128 [2:36:00<52:12, 101.04s/it]EarlyStopping counter : 24 out of 40
training process:  77%|███████▋  | 98/128 [2:37:27<48:24, 96.81s/it] EarlyStopping counter : 25 out of 40
training process:  77%|███████▋  | 99/128 [2:38:57<45:48, 94.79s/it]EarlyStopping counter : 26 out of 40
training process:  78%|███████▊  | 100/128 [2:40:26<43:21, 92.89s/it]epoch : 101, train loss : -7.757, valid loss : -6.394, train acc : 0.976, valid acc : 0.985, train f1 : 0.683, valid f1 : 0.670

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.51it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.31it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.95it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 332.77it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.95it/s][A100%|██████████| 195/195 [00:00<00:00, 332.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  79%|███████▉  | 101/128 [2:42:19<44:35, 99.09s/it]Best score increase :0.688 -> 0.689
training process:  80%|███████▉  | 102/128 [2:43:50<41:50, 96.56s/it]EarlyStopping counter : 1 out of 40
training process:  80%|████████  | 103/128 [2:45:19<39:19, 94.37s/it]EarlyStopping counter : 2 out of 40
training process:  81%|████████▏ | 104/128 [2:46:47<36:59, 92.48s/it]epoch : 105, train loss : -7.850, valid loss : -6.592, train acc : 0.975, valid acc : 0.983, train f1 : 0.678, valid f1 : 0.668

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.22it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 328.07it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 329.77it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 330.82it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 326.58it/s][A100%|██████████| 195/195 [00:00<00:00, 327.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  82%|████████▏ | 105/128 [2:48:42<37:58, 99.08s/it]EarlyStopping counter : 4 out of 40
training process:  83%|████████▎ | 106/128 [2:50:08<34:54, 95.22s/it]EarlyStopping counter : 5 out of 40
training process:  84%|████████▎ | 107/128 [2:51:38<32:45, 93.59s/it]EarlyStopping counter : 6 out of 40
training process:  84%|████████▍ | 108/128 [2:53:07<30:46, 92.34s/it]epoch : 109, train loss : -7.967, valid loss : -6.544, train acc : 0.980, valid acc : 0.983, train f1 : 0.706, valid f1 : 0.627

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.60it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.73it/s][A
 51%|█████     | 99/195 [00:00<00:00, 263.59it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 280.20it/s][A
 84%|████████▎ | 163/195 [00:00<00:00, 293.01it/s][A100%|██████████| 195/195 [00:00<00:00, 297.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  85%|████████▌ | 109/128 [2:55:04<31:34, 99.72s/it]EarlyStopping counter : 8 out of 40
training process:  86%|████████▌ | 110/128 [2:56:32<28:49, 96.09s/it]EarlyStopping counter : 9 out of 40
training process:  87%|████████▋ | 111/128 [2:58:02<26:42, 94.26s/it]EarlyStopping counter : 10 out of 40
training process:  88%|████████▊ | 112/128 [2:59:32<24:49, 93.07s/it]epoch : 113, train loss : -8.415, valid loss : -6.976, train acc : 0.983, valid acc : 0.983, train f1 : 0.720, valid f1 : 0.681

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.64it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 332.53it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.61it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.13it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.01it/s][A100%|██████████| 195/195 [00:00<00:00, 337.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  88%|████████▊ | 113/128 [3:01:29<25:04, 100.30s/it]EarlyStopping counter : 12 out of 40
training process:  89%|████████▉ | 114/128 [3:03:00<22:42, 97.34s/it] EarlyStopping counter : 13 out of 40
training process:  90%|████████▉ | 115/128 [3:04:30<20:38, 95.27s/it]EarlyStopping counter : 14 out of 40
training process:  91%|█████████ | 116/128 [3:06:01<18:46, 93.86s/it]epoch : 117, train loss : -8.692, valid loss : -7.219, train acc : 0.982, valid acc : 0.983, train f1 : 0.716, valid f1 : 0.674

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.26it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.71it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.80it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.34it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.84it/s][A100%|██████████| 195/195 [00:00<00:00, 338.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  91%|█████████▏| 117/128 [3:07:58<18:30, 100.97s/it]EarlyStopping counter : 16 out of 40
training process:  92%|█████████▏| 118/128 [3:09:27<16:13, 97.35s/it] EarlyStopping counter : 17 out of 40
training process:  93%|█████████▎| 119/128 [3:10:56<14:13, 94.83s/it]EarlyStopping counter : 18 out of 40
training process:  94%|█████████▍| 120/128 [3:12:26<12:27, 93.45s/it]epoch : 121, train loss : -9.012, valid loss : -7.720, train acc : 0.978, valid acc : 0.972, train f1 : 0.703, valid f1 : 0.674

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.17it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.56it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.96it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 337.04it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.97it/s][A100%|██████████| 195/195 [00:00<00:00, 336.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  95%|█████████▍| 121/128 [3:14:23<11:43, 100.50s/it]EarlyStopping counter : 20 out of 40
training process:  95%|█████████▌| 122/128 [3:15:54<09:44, 97.44s/it] EarlyStopping counter : 21 out of 40
training process:  96%|█████████▌| 123/128 [3:17:24<07:56, 95.26s/it]EarlyStopping counter : 22 out of 40
training process:  97%|█████████▋| 124/128 [3:18:50<06:10, 92.54s/it]epoch : 125, train loss : -9.273, valid loss : -7.556, train acc : 0.981, valid acc : 0.983, train f1 : 0.717, valid f1 : 0.710

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.96it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.59it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.63it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.80it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 341.13it/s][A100%|██████████| 195/195 [00:00<00:00, 341.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.689 -> 0.710
training process:  98%|█████████▊| 125/128 [3:20:46<04:58, 99.52s/it]EarlyStopping counter : 1 out of 40
training process:  98%|█████████▊| 126/128 [3:22:15<03:12, 96.41s/it]EarlyStopping counter : 2 out of 40
training process:  99%|█████████▉| 127/128 [3:23:43<01:33, 93.89s/it]EarlyStopping counter : 3 out of 40
training process: 100%|██████████| 128/128 [3:25:14<00:00, 92.96s/it]training process: 100%|██████████| 128/128 [3:25:14<00:00, 96.21s/it]
training process finished, best loss : -7.556 and best acc : 0.983, best f1 : 0.710, best epoch : 124

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.49      0.28      0.36       303
           1       0.99      0.99      0.99     16947

    accuracy                           0.98     17250
   macro avg       0.74      0.64      0.68     17250
weighted avg       0.98      0.98      0.98     17250


# test acc : 0.98, test f1 : 0.68, test AUC : 0.64, test loss : -1394.032

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<02:56, 11.01s/it]processing for feature importance:  12%|█▏        | 2/17 [00:21<02:43, 10.92s/it]processing for feature importance:  18%|█▊        | 3/17 [00:32<02:30, 10.78s/it]processing for feature importance:  24%|██▎       | 4/17 [00:42<02:17, 10.61s/it]processing for feature importance:  29%|██▉       | 5/17 [00:54<02:10, 10.88s/it]processing for feature importance:  35%|███▌      | 6/17 [01:05<02:00, 10.95s/it]processing for feature importance:  41%|████      | 7/17 [01:17<01:53, 11.38s/it]processing for feature importance:  47%|████▋     | 8/17 [01:29<01:44, 11.59s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:41<01:33, 11.66s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:52<01:19, 11.38s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:04<01:09, 11.65s/it]processing for feature importance:  71%|███████   | 12/17 [02:16<00:58, 11.72s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:27<00:46, 11.65s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:39<00:34, 11.52s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:50<00:22, 11.43s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:01<00:11, 11.49s/it]processing for feature importance: 100%|██████████| 17/17 [03:14<00:00, 11.92s/it]processing for feature importance: 100%|██████████| 17/17 [03:14<00:00, 11.46s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:03<13:41,  3.91s/it]visualize 2D latent space:   1%|          | 2/211 [00:05<09:45,  2.80s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:27,  1.32s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<12:31,  3.58s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:04<06:58,  2.00s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:15,  2.02s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:14,  1.12s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<01:48,  1.65s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 13%|█▎        | 26/195 [00:00<00:00, 253.35it/s] 30%|███       | 59/195 [00:00<00:00, 293.51it/s] 46%|████▌     | 89/195 [00:00<00:00, 248.08it/s] 59%|█████▉    | 116/195 [00:00<00:00, 255.70it/s] 76%|███████▌  | 148/195 [00:00<00:00, 276.40it/s] 92%|█████████▏| 180/195 [00:00<00:00, 289.96it/s]100%|██████████| 195/195 [00:00<00:00, 279.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_smoothing_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 14/616 [00:00<00:04, 135.30it/s]remove invalid data : null / measurement error:   5%|▌         | 33/616 [00:00<00:03, 164.80it/s]remove invalid data : null / measurement error:   9%|▊         | 53/616 [00:00<00:03, 178.91it/s]remove invalid data : null / measurement error:  12%|█▏        | 73/616 [00:00<00:02, 186.79it/s]remove invalid data : null / measurement error:  15%|█▌        | 94/616 [00:00<00:02, 193.92it/s]remove invalid data : null / measurement error:  19%|█▊        | 115/616 [00:00<00:02, 199.05it/s]remove invalid data : null / measurement error:  22%|██▏       | 137/616 [00:00<00:02, 203.11it/s]remove invalid data : null / measurement error:  26%|██▌       | 159/616 [00:00<00:02, 207.23it/s]remove invalid data : null / measurement error:  29%|██▉       | 180/616 [00:00<00:02, 205.54it/s]remove invalid data : null / measurement error:  33%|███▎      | 201/616 [00:01<00:02, 204.00it/s]remove invalid data : null / measurement error:  36%|███▌      | 222/616 [00:01<00:01, 204.33it/s]remove invalid data : null / measurement error:  39%|███▉      | 243/616 [00:01<00:01, 205.58it/s]remove invalid data : null / measurement error:  43%|████▎     | 264/616 [00:01<00:01, 205.91it/s]remove invalid data : null / measurement error:  46%|████▋     | 285/616 [00:01<00:01, 205.80it/s]remove invalid data : null / measurement error:  50%|████▉     | 306/616 [00:01<00:01, 204.61it/s]remove invalid data : null / measurement error:  53%|█████▎    | 327/616 [00:01<00:01, 203.63it/s]remove invalid data : null / measurement error:  56%|█████▋    | 348/616 [00:01<00:01, 203.23it/s]remove invalid data : null / measurement error:  60%|██████    | 371/616 [00:01<00:01, 208.47it/s]remove invalid data : null / measurement error:  64%|██████▍   | 397/616 [00:01<00:00, 223.28it/s]remove invalid data : null / measurement error:  69%|██████▉   | 424/616 [00:02<00:00, 234.49it/s]remove invalid data : null / measurement error:  73%|███████▎  | 448/616 [00:02<00:00, 231.64it/s]remove invalid data : null / measurement error:  77%|███████▋  | 472/616 [00:02<00:00, 226.33it/s]remove invalid data : null / measurement error:  80%|████████  | 495/616 [00:02<00:00, 220.08it/s]remove invalid data : null / measurement error:  84%|████████▍ | 518/616 [00:02<00:00, 215.13it/s]remove invalid data : null / measurement error:  88%|████████▊ | 540/616 [00:02<00:00, 211.64it/s]remove invalid data : null / measurement error:  91%|█████████ | 562/616 [00:02<00:00, 209.92it/s]remove invalid data : null / measurement error:  95%|█████████▍| 584/616 [00:02<00:00, 208.83it/s]remove invalid data : null / measurement error:  98%|█████████▊| 605/616 [00:02<00:00, 207.94it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.17it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 236.83it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 236.55it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 237.10it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 239.30it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 240.66it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 242.18it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 243.02it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 243.19it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 240.53it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 241.61it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 243.16it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 242.74it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 243.02it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 240.17it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 241.13it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 242.26it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 242.09it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 240.59it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 241.23it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 242.19it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 241.42it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.07it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.71it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.96it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.01it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.84it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.19it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.12it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.20it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.79it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.61it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.47it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.01it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.76it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.35it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.85it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.69it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.72it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.29it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.80it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.41it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.53it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.59it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.82it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.30it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.41it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.69it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.55it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.27it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 89.38it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.49it/s]generate index:  51%|█████     | 261/515 [00:03<00:03, 74.32it/s]generate index:  52%|█████▏    | 270/515 [00:03<00:03, 77.56it/s]generate index:  54%|█████▍    | 279/515 [00:04<00:03, 67.54it/s]generate index:  56%|█████▌    | 287/515 [00:04<00:03, 65.36it/s]generate index:  57%|█████▋    | 295/515 [00:04<00:03, 65.02it/s]generate index:  59%|█████▊    | 302/515 [00:04<00:03, 61.50it/s]generate index:  60%|██████    | 310/515 [00:04<00:03, 65.65it/s]generate index:  62%|██████▏   | 317/515 [00:04<00:03, 60.00it/s]generate index:  63%|██████▎   | 325/515 [00:04<00:03, 62.81it/s]generate index:  64%|██████▍   | 332/515 [00:04<00:02, 64.25it/s]generate index:  66%|██████▌   | 339/515 [00:05<00:03, 49.28it/s]generate index:  67%|██████▋   | 345/515 [00:05<00:03, 48.10it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.78it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 56.96it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 70.69it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 74.56it/s]generate index:  76%|███████▋  | 393/515 [00:05<00:01, 73.46it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 73.37it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.64it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.26it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.50it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 54.73it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 50.56it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.98it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.83it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.46it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.41it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.10it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 63.71it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.53it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.40it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 86.54it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 156.69it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 179.66it/s]remove invalid data : null / measurement error:  47%|████▋     | 73/154 [00:00<00:00, 192.68it/s]remove invalid data : null / measurement error:  62%|██████▏   | 95/154 [00:00<00:00, 201.31it/s]remove invalid data : null / measurement error:  77%|███████▋  | 119/154 [00:00<00:00, 211.96it/s]remove invalid data : null / measurement error:  92%|█████████▏| 141/154 [00:00<00:00, 209.47it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 196.00it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 249.44it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 251.78it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 252.17it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 249.06it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 251.16it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 250.65it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.91it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 50.15it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 55.85it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.74it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.68it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.69it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.87it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.89it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.87it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.76it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.26it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.18it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.05it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.10it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 48.73it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.31it/s]generate index:  96%|█████████▌| 126/131 [00:02<00:00, 69.99it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.02it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 76.93it/s]remove invalid data : null / measurement error:  16%|█▌        | 30/193 [00:00<00:01, 155.90it/s]remove invalid data : null / measurement error:  26%|██▋       | 51/193 [00:00<00:00, 177.52it/s]remove invalid data : null / measurement error:  38%|███▊      | 73/193 [00:00<00:00, 192.33it/s]remove invalid data : null / measurement error:  49%|████▉     | 95/193 [00:00<00:00, 198.88it/s]remove invalid data : null / measurement error:  60%|██████    | 116/193 [00:00<00:00, 201.98it/s]remove invalid data : null / measurement error:  73%|███████▎  | 141/193 [00:00<00:00, 216.25it/s]remove invalid data : null / measurement error:  84%|████████▍ | 163/193 [00:00<00:00, 213.30it/s]remove invalid data : null / measurement error:  96%|█████████▌| 185/193 [00:00<00:00, 211.25it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 198.50it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 257.82it/s]replace nan value:  33%|███▎      | 53/160 [00:00<00:00, 259.99it/s]replace nan value:  49%|████▉     | 79/160 [00:00<00:00, 257.27it/s]replace nan value:  66%|██████▌   | 105/160 [00:00<00:00, 252.96it/s]replace nan value:  82%|████████▏ | 131/160 [00:00<00:00, 251.81it/s]replace nan value:  98%|█████████▊| 157/160 [00:00<00:00, 251.34it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 253.13it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 102.76it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.43it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.88it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.61it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.25it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.26it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.54it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.72it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.03it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.83it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.46it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.63it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.46it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.62it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.02it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.76it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.98it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.62it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.78it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.403, valid loss : 0.326, train acc : 0.736, valid acc : 0.771, train f1 : 0.736, valid f1 : 0.484

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.25it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.07it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.61it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.09it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.43it/s][A100%|██████████| 195/195 [00:00<00:00, 342.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.484
training process:   1%|          | 1/128 [01:59<4:13:57, 119.98s/it]Best score increase :0.484 -> 0.516
training process:   2%|▏         | 2/128 [03:32<3:37:32, 103.59s/it]Best score increase :0.516 -> 0.552
training process:   2%|▏         | 3/128 [05:07<3:28:14, 99.96s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:41<3:21:47, 97.64s/it]epoch : 5, train loss : 0.113, valid loss : 0.105, train acc : 0.922, valid acc : 0.909, train f1 : 0.922, valid f1 : 0.576

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.16it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.77it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 336.54it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.66it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 339.79it/s][A100%|██████████| 195/195 [00:00<00:00, 338.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.552 -> 0.576
training process:   4%|▍         | 5/128 [08:41<3:36:06, 105.42s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [10:13<3:25:42, 101.17s/it]EarlyStopping counter : 2 out of 40
training process:   5%|▌         | 7/128 [11:48<3:19:27, 98.90s/it] EarlyStopping counter : 3 out of 40
training process:   6%|▋         | 8/128 [13:21<3:14:10, 97.09s/it]epoch : 9, train loss : 0.014, valid loss : 0.104, train acc : 0.951, valid acc : 0.884, train f1 : 0.951, valid f1 : 0.558

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 308.06it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 324.09it/s][A
 51%|█████     | 99/195 [00:00<00:00, 330.23it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 332.72it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 333.85it/s][A100%|██████████| 195/195 [00:00<00:00, 331.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   7%|▋         | 9/128 [15:21<3:26:37, 104.18s/it]EarlyStopping counter : 5 out of 40
training process:   8%|▊         | 10/128 [16:53<3:17:26, 100.39s/it]EarlyStopping counter : 6 out of 40
training process:   9%|▊         | 11/128 [18:25<3:10:48, 97.85s/it] EarlyStopping counter : 7 out of 40
training process:   9%|▉         | 12/128 [19:56<3:05:25, 95.91s/it]epoch : 13, train loss : -0.111, valid loss : -0.056, train acc : 0.965, valid acc : 0.911, train f1 : 0.965, valid f1 : 0.573

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 279.34it/s][A
 32%|███▏      | 62/195 [00:00<00:00, 311.53it/s][A
 49%|████▉     | 96/195 [00:00<00:00, 323.96it/s][A
 67%|██████▋   | 130/195 [00:00<00:00, 330.06it/s][A
 84%|████████▍ | 164/195 [00:00<00:00, 333.58it/s][A100%|██████████| 195/195 [00:00<00:00, 326.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  10%|█         | 13/128 [21:57<3:18:23, 103.51s/it]EarlyStopping counter : 9 out of 40
training process:  11%|█         | 14/128 [23:34<3:12:34, 101.35s/it]EarlyStopping counter : 10 out of 40
training process:  12%|█▏        | 15/128 [25:04<3:04:54, 98.18s/it] Best score increase :0.576 -> 0.582
training process:  12%|█▎        | 16/128 [26:38<3:00:41, 96.80s/it]epoch : 17, train loss : -0.288, valid loss : -0.340, train acc : 0.971, valid acc : 0.927, train f1 : 0.971, valid f1 : 0.589

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▌        | 30/195 [00:00<00:00, 297.34it/s][A
 32%|███▏      | 63/195 [00:00<00:00, 316.10it/s][A
 50%|████▉     | 97/195 [00:00<00:00, 324.25it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 329.27it/s][A
 85%|████████▍ | 165/195 [00:00<00:00, 332.03it/s][A100%|██████████| 195/195 [00:00<00:00, 328.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.582 -> 0.589
training process:  13%|█▎        | 17/128 [28:39<3:12:36, 104.11s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [30:12<3:04:52, 100.84s/it]EarlyStopping counter : 2 out of 40
training process:  15%|█▍        | 19/128 [31:48<3:00:12, 99.19s/it] Best score increase :0.589 -> 0.600
training process:  16%|█▌        | 20/128 [33:21<2:55:17, 97.38s/it]epoch : 21, train loss : -0.504, valid loss : -0.383, train acc : 0.973, valid acc : 0.916, train f1 : 0.973, valid f1 : 0.580

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▌        | 30/195 [00:00<00:00, 290.99it/s][A
 32%|███▏      | 63/195 [00:00<00:00, 313.57it/s][A
 49%|████▉     | 96/195 [00:00<00:00, 318.69it/s][A
 67%|██████▋   | 130/195 [00:00<00:00, 325.03it/s][A
 84%|████████▍ | 164/195 [00:00<00:00, 329.21it/s][A100%|██████████| 195/195 [00:00<00:00, 325.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [35:20<3:05:28, 104.00s/it]Best score increase :0.600 -> 0.636
training process:  17%|█▋        | 22/128 [36:53<2:58:00, 100.76s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [38:27<2:52:32, 98.59s/it] EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [40:02<2:48:55, 97.46s/it]epoch : 25, train loss : -0.756, valid loss : -0.814, train acc : 0.975, valid acc : 0.941, train f1 : 0.975, valid f1 : 0.613

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▍        | 29/195 [00:00<00:00, 282.15it/s][A
 32%|███▏      | 62/195 [00:00<00:00, 304.89it/s][A
 49%|████▊     | 95/195 [00:00<00:00, 314.01it/s][A
 66%|██████▌   | 128/195 [00:00<00:00, 318.71it/s][A
 83%|████████▎ | 161/195 [00:00<00:00, 321.36it/s][A
 99%|█████████▉| 194/195 [00:00<00:00, 316.46it/s][A100%|██████████| 195/195 [00:00<00:00, 314.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [42:03<2:59:39, 104.65s/it]EarlyStopping counter : 4 out of 40
training process:  20%|██        | 26/128 [43:35<2:51:29, 100.88s/it]EarlyStopping counter : 5 out of 40
training process:  21%|██        | 27/128 [45:06<2:44:36, 97.79s/it] EarlyStopping counter : 6 out of 40
training process:  22%|██▏       | 28/128 [46:42<2:42:21, 97.42s/it]epoch : 29, train loss : -1.034, valid loss : -0.733, train acc : 0.978, valid acc : 0.940, train f1 : 0.978, valid f1 : 0.606

  0%|          | 0/195 [00:00<?, ?it/s][A
 12%|█▏        | 24/195 [00:00<00:00, 234.66it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 249.39it/s][A
 39%|███▉      | 77/195 [00:00<00:00, 254.63it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 259.70it/s][A
 67%|██████▋   | 130/195 [00:00<00:00, 259.65it/s][A
 81%|████████  | 157/195 [00:00<00:00, 262.91it/s][A
 94%|█████████▍| 184/195 [00:00<00:00, 264.96it/s][A100%|██████████| 195/195 [00:00<00:00, 260.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 29/128 [48:45<2:53:13, 104.99s/it]EarlyStopping counter : 8 out of 40
training process:  23%|██▎       | 30/128 [50:19<2:46:09, 101.73s/it]EarlyStopping counter : 9 out of 40
training process:  24%|██▍       | 31/128 [51:50<2:39:10, 98.46s/it] EarlyStopping counter : 10 out of 40
training process:  25%|██▌       | 32/128 [53:24<2:35:27, 97.16s/it]epoch : 33, train loss : -1.314, valid loss : -0.926, train acc : 0.980, valid acc : 0.944, train f1 : 0.980, valid f1 : 0.624

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▌        | 30/195 [00:00<00:00, 293.71it/s][A
 32%|███▏      | 62/195 [00:00<00:00, 308.14it/s][A
 49%|████▉     | 96/195 [00:00<00:00, 318.70it/s][A
 67%|██████▋   | 130/195 [00:00<00:00, 324.27it/s][A
 84%|████████▎ | 163/195 [00:00<00:00, 322.23it/s][A100%|██████████| 195/195 [00:00<00:00, 320.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  26%|██▌       | 33/128 [55:22<2:43:46, 103.44s/it]EarlyStopping counter : 12 out of 40
training process:  27%|██▋       | 34/128 [56:53<2:35:56, 99.54s/it] EarlyStopping counter : 13 out of 40
training process:  27%|██▋       | 35/128 [58:25<2:30:59, 97.42s/it]EarlyStopping counter : 14 out of 40
training process:  28%|██▊       | 36/128 [59:59<2:27:53, 96.45s/it]epoch : 37, train loss : -1.587, valid loss : -0.987, train acc : 0.981, valid acc : 0.943, train f1 : 0.981, valid f1 : 0.626

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.77it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.15it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.11it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.22it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.32it/s][A100%|██████████| 195/195 [00:00<00:00, 333.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  29%|██▉       | 37/128 [1:01:57<2:36:05, 102.91s/it]EarlyStopping counter : 16 out of 40
training process:  30%|██▉       | 38/128 [1:03:28<2:29:02, 99.36s/it] EarlyStopping counter : 17 out of 40
training process:  30%|███       | 39/128 [1:05:01<2:24:24, 97.36s/it]EarlyStopping counter : 18 out of 40
training process:  31%|███▏      | 40/128 [1:06:34<2:20:40, 95.91s/it]epoch : 41, train loss : -1.864, valid loss : 0.067, train acc : 0.984, valid acc : 0.927, train f1 : 0.984, valid f1 : 0.595

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 314.65it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.61it/s][A
 51%|█████     | 99/195 [00:00<00:00, 326.31it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 329.41it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 332.66it/s][A100%|██████████| 195/195 [00:00<00:00, 330.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  32%|███▏      | 41/128 [1:08:35<2:30:01, 103.46s/it]EarlyStopping counter : 20 out of 40
training process:  33%|███▎      | 42/128 [1:10:09<2:24:21, 100.72s/it]EarlyStopping counter : 21 out of 40
training process:  34%|███▎      | 43/128 [1:11:43<2:19:45, 98.65s/it] Best score increase :0.636 -> 0.637
training process:  34%|███▍      | 44/128 [1:13:14<2:15:06, 96.51s/it]epoch : 45, train loss : -2.134, valid loss : -1.372, train acc : 0.985, valid acc : 0.956, train f1 : 0.985, valid f1 : 0.650

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 311.43it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.54it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.76it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.95it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 341.51it/s][A100%|██████████| 195/195 [00:00<00:00, 337.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.637 -> 0.650
training process:  35%|███▌      | 45/128 [1:15:14<2:23:10, 103.50s/it]EarlyStopping counter : 1 out of 40
training process:  36%|███▌      | 46/128 [1:16:49<2:17:48, 100.83s/it]EarlyStopping counter : 2 out of 40
training process:  37%|███▋      | 47/128 [1:18:22<2:13:06, 98.60s/it] EarlyStopping counter : 3 out of 40
training process:  38%|███▊      | 48/128 [1:19:54<2:08:37, 96.47s/it]epoch : 49, train loss : -2.415, valid loss : -0.168, train acc : 0.986, valid acc : 0.936, train f1 : 0.986, valid f1 : 0.615

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 314.69it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.54it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.73it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.33it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.16it/s][A100%|██████████| 195/195 [00:00<00:00, 335.60it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  38%|███▊      | 49/128 [1:21:52<2:15:44, 103.09s/it]EarlyStopping counter : 5 out of 40
training process:  39%|███▉      | 50/128 [1:23:24<2:09:38, 99.73s/it] EarlyStopping counter : 6 out of 40
training process:  40%|███▉      | 51/128 [1:24:57<2:05:25, 97.73s/it]EarlyStopping counter : 7 out of 40
training process:  41%|████      | 52/128 [1:26:31<2:02:16, 96.54s/it]epoch : 53, train loss : -2.673, valid loss : -0.202, train acc : 0.987, valid acc : 0.950, train f1 : 0.987, valid f1 : 0.633

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.00it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 330.76it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.50it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.79it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 339.17it/s][A100%|██████████| 195/195 [00:00<00:00, 336.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  41%|████▏     | 53/128 [1:28:28<2:08:31, 102.82s/it]Best score increase :0.650 -> 0.660
training process:  42%|████▏     | 54/128 [1:30:04<2:04:15, 100.75s/it]EarlyStopping counter : 1 out of 40
training process:  43%|████▎     | 55/128 [1:31:35<1:58:52, 97.71s/it] EarlyStopping counter : 2 out of 40
training process:  44%|████▍     | 56/128 [1:33:06<1:54:46, 95.65s/it]epoch : 57, train loss : -2.868, valid loss : -0.603, train acc : 0.987, valid acc : 0.945, train f1 : 0.987, valid f1 : 0.631

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.95it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.41it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.30it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.69it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.70it/s][A100%|██████████| 195/195 [00:00<00:00, 329.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  45%|████▍     | 57/128 [1:35:05<2:01:24, 102.60s/it]EarlyStopping counter : 4 out of 40
training process:  45%|████▌     | 58/128 [1:36:39<1:56:59, 100.28s/it]EarlyStopping counter : 5 out of 40
training process:  46%|████▌     | 59/128 [1:38:11<1:52:28, 97.81s/it] EarlyStopping counter : 6 out of 40
training process:  47%|████▋     | 60/128 [1:39:47<1:49:58, 97.04s/it]epoch : 61, train loss : -3.162, valid loss : -1.156, train acc : 0.989, valid acc : 0.953, train f1 : 0.989, valid f1 : 0.643

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 308.24it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 325.93it/s][A
 51%|█████     | 99/195 [00:00<00:00, 329.57it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.81it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.65it/s][A100%|██████████| 195/195 [00:00<00:00, 333.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  48%|████▊     | 61/128 [1:41:45<1:55:27, 103.40s/it]EarlyStopping counter : 8 out of 40
training process:  48%|████▊     | 62/128 [1:43:18<1:50:10, 100.16s/it]EarlyStopping counter : 9 out of 40
training process:  49%|████▉     | 63/128 [1:44:50<1:45:56, 97.79s/it] Best score increase :0.660 -> 0.699
training process:  50%|█████     | 64/128 [1:46:24<1:43:00, 96.56s/it]epoch : 65, train loss : -3.358, valid loss : -1.151, train acc : 0.990, valid acc : 0.963, train f1 : 0.990, valid f1 : 0.666

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.19it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.60it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.93it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.34it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.72it/s][A100%|██████████| 195/195 [00:00<00:00, 333.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  51%|█████     | 65/128 [1:48:22<1:48:14, 103.08s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 66/128 [1:49:55<1:43:35, 100.24s/it]EarlyStopping counter : 3 out of 40
training process:  52%|█████▏    | 67/128 [1:51:27<1:39:08, 97.51s/it] EarlyStopping counter : 4 out of 40
training process:  53%|█████▎    | 68/128 [1:53:01<1:36:36, 96.60s/it]epoch : 69, train loss : -3.598, valid loss : 0.483, train acc : 0.990, valid acc : 0.958, train f1 : 0.990, valid f1 : 0.659

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.49it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.49it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.78it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 297.63it/s][A
 85%|████████▌ | 166/195 [00:00<00:00, 276.39it/s][A
100%|██████████| 195/195 [00:00<00:00, 265.63it/s][A100%|██████████| 195/195 [00:00<00:00, 284.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  54%|█████▍    | 69/128 [1:55:02<1:42:15, 103.99s/it]EarlyStopping counter : 6 out of 40
training process:  55%|█████▍    | 70/128 [1:56:34<1:37:05, 100.43s/it]EarlyStopping counter : 7 out of 40
training process:  55%|█████▌    | 71/128 [1:58:04<1:32:25, 97.28s/it] EarlyStopping counter : 8 out of 40
training process:  56%|█████▋    | 72/128 [1:59:39<1:29:56, 96.36s/it]epoch : 73, train loss : -3.763, valid loss : 1.195, train acc : 0.991, valid acc : 0.939, train f1 : 0.991, valid f1 : 0.620

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.81it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.49it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 327.78it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 331.95it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.59it/s][A100%|██████████| 195/195 [00:00<00:00, 333.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  57%|█████▋    | 73/128 [2:01:41<1:35:33, 104.24s/it]EarlyStopping counter : 10 out of 40
training process:  58%|█████▊    | 74/128 [2:03:13<1:30:22, 100.42s/it]EarlyStopping counter : 11 out of 40
training process:  59%|█████▊    | 75/128 [2:04:45<1:26:37, 98.07s/it] EarlyStopping counter : 12 out of 40
training process:  59%|█████▉    | 76/128 [2:06:18<1:23:30, 96.35s/it]epoch : 77, train loss : -4.098, valid loss : -0.686, train acc : 0.992, valid acc : 0.964, train f1 : 0.992, valid f1 : 0.667

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.62it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 327.62it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 330.15it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 331.49it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.38it/s][A100%|██████████| 195/195 [00:00<00:00, 331.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  60%|██████    | 77/128 [2:08:22<1:28:57, 104.67s/it]Best score increase :0.699 -> 0.702
training process:  61%|██████    | 78/128 [2:09:57<1:24:45, 101.72s/it]EarlyStopping counter : 1 out of 40
training process:  62%|██████▏   | 79/128 [2:11:31<1:21:17, 99.55s/it] EarlyStopping counter : 2 out of 40
training process:  62%|██████▎   | 80/128 [2:13:02<1:17:41, 97.11s/it]epoch : 81, train loss : -4.314, valid loss : -0.575, train acc : 0.994, valid acc : 0.970, train f1 : 0.994, valid f1 : 0.697

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.89it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.19it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.55it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.03it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.02it/s][A100%|██████████| 195/195 [00:00<00:00, 339.63it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  63%|██████▎   | 81/128 [2:15:02<1:21:25, 103.95s/it]EarlyStopping counter : 4 out of 40
training process:  64%|██████▍   | 82/128 [2:16:35<1:17:01, 100.46s/it]Best score increase :0.702 -> 0.713
training process:  65%|██████▍   | 83/128 [2:18:07<1:13:25, 97.90s/it] EarlyStopping counter : 1 out of 40
training process:  66%|██████▌   | 84/128 [2:19:38<1:10:25, 96.03s/it]epoch : 85, train loss : -4.533, valid loss : 1.050, train acc : 0.994, valid acc : 0.969, train f1 : 0.994, valid f1 : 0.691

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.07it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.73it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.54it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.26it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 338.85it/s][A100%|██████████| 195/195 [00:00<00:00, 338.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  66%|██████▋   | 85/128 [2:21:35<1:13:13, 102.18s/it]EarlyStopping counter : 3 out of 40
training process:  67%|██████▋   | 86/128 [2:23:07<1:09:29, 99.28s/it] EarlyStopping counter : 4 out of 40
training process:  68%|██████▊   | 87/128 [2:24:43<1:07:09, 98.28s/it]EarlyStopping counter : 5 out of 40
training process:  69%|██████▉   | 88/128 [2:26:15<1:04:16, 96.40s/it]epoch : 89, train loss : -4.792, valid loss : -0.510, train acc : 0.994, valid acc : 0.975, train f1 : 0.994, valid f1 : 0.714

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.98it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.10it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.04it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.24it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 336.78it/s][A100%|██████████| 195/195 [00:00<00:00, 336.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.713 -> 0.714
training process:  70%|██████▉   | 89/128 [2:28:14<1:07:06, 103.25s/it]EarlyStopping counter : 1 out of 40
training process:  70%|███████   | 90/128 [2:29:48<1:03:33, 100.37s/it]EarlyStopping counter : 2 out of 40
training process:  71%|███████   | 91/128 [2:31:22<1:00:42, 98.46s/it] EarlyStopping counter : 3 out of 40
training process:  72%|███████▏  | 92/128 [2:32:53<57:46, 96.30s/it]  epoch : 93, train loss : -5.001, valid loss : 0.910, train acc : 0.995, valid acc : 0.972, train f1 : 0.995, valid f1 : 0.704

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.44it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.81it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.55it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 328.22it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.05it/s][A100%|██████████| 195/195 [00:00<00:00, 330.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  73%|███████▎  | 93/128 [2:34:50<59:43, 102.39s/it]EarlyStopping counter : 5 out of 40
training process:  73%|███████▎  | 94/128 [2:36:24<56:34, 99.85s/it] EarlyStopping counter : 6 out of 40
training process:  74%|███████▍  | 95/128 [2:37:55<53:24, 97.09s/it]EarlyStopping counter : 7 out of 40
training process:  75%|███████▌  | 96/128 [2:39:29<51:24, 96.40s/it]epoch : 97, train loss : -5.070, valid loss : 1.148, train acc : 0.995, valid acc : 0.972, train f1 : 0.995, valid f1 : 0.694

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.27it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.81it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.78it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.36it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.36it/s][A100%|██████████| 195/195 [00:00<00:00, 337.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  76%|███████▌  | 97/128 [2:41:32<53:51, 104.23s/it]EarlyStopping counter : 9 out of 40
training process:  77%|███████▋  | 98/128 [2:43:05<50:29, 100.99s/it]Best score increase :0.714 -> 0.722
training process:  77%|███████▋  | 99/128 [2:44:37<47:28, 98.24s/it] EarlyStopping counter : 1 out of 40
training process:  78%|███████▊  | 100/128 [2:46:10<45:05, 96.62s/it]epoch : 101, train loss : -5.300, valid loss : 2.987, train acc : 0.996, valid acc : 0.970, train f1 : 0.996, valid f1 : 0.687

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.56it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.26it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.29it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.94it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.82it/s][A100%|██████████| 195/195 [00:00<00:00, 343.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  79%|███████▉  | 101/128 [2:48:08<46:22, 103.07s/it]EarlyStopping counter : 3 out of 40
training process:  80%|███████▉  | 102/128 [2:49:40<43:13, 99.75s/it] EarlyStopping counter : 4 out of 40
training process:  80%|████████  | 103/128 [2:51:12<40:36, 97.44s/it]EarlyStopping counter : 5 out of 40
training process:  81%|████████▏ | 104/128 [2:52:46<38:32, 96.35s/it]epoch : 105, train loss : -5.399, valid loss : 1.376, train acc : 0.995, valid acc : 0.973, train f1 : 0.995, valid f1 : 0.708

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.30it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.34it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 330.16it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.44it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.10it/s][A100%|██████████| 195/195 [00:00<00:00, 335.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  82%|████████▏ | 105/128 [2:54:46<39:39, 103.44s/it]EarlyStopping counter : 7 out of 40
training process:  83%|████████▎ | 106/128 [2:56:19<36:47, 100.36s/it]EarlyStopping counter : 8 out of 40
training process:  84%|████████▎ | 107/128 [2:57:53<34:29, 98.53s/it] EarlyStopping counter : 9 out of 40
training process:  84%|████████▍ | 108/128 [2:59:26<32:16, 96.83s/it]epoch : 109, train loss : -5.603, valid loss : 2.315, train acc : 0.996, valid acc : 0.971, train f1 : 0.996, valid f1 : 0.702

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.55it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.48it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.07it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.48it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.48it/s][A100%|██████████| 195/195 [00:00<00:00, 341.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  85%|████████▌ | 109/128 [3:01:25<32:45, 103.45s/it]EarlyStopping counter : 11 out of 40
training process:  86%|████████▌ | 110/128 [3:02:58<30:02, 100.16s/it]EarlyStopping counter : 12 out of 40
training process:  87%|████████▋ | 111/128 [3:04:29<27:37, 97.53s/it] EarlyStopping counter : 13 out of 40
training process:  88%|████████▊ | 112/128 [3:06:02<25:40, 96.29s/it]epoch : 113, train loss : -5.781, valid loss : 1.447, train acc : 0.997, valid acc : 0.975, train f1 : 0.997, valid f1 : 0.712

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.60it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.83it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.10it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.38it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.17it/s][A100%|██████████| 195/195 [00:00<00:00, 340.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  88%|████████▊ | 113/128 [3:08:02<25:50, 103.37s/it]EarlyStopping counter : 15 out of 40
training process:  89%|████████▉ | 114/128 [3:09:34<23:19, 99.94s/it] EarlyStopping counter : 16 out of 40
training process:  90%|████████▉ | 115/128 [3:11:08<21:13, 97.99s/it]EarlyStopping counter : 17 out of 40
training process:  91%|█████████ | 116/128 [3:12:40<19:14, 96.18s/it]epoch : 117, train loss : -6.000, valid loss : 1.735, train acc : 0.997, valid acc : 0.976, train f1 : 0.997, valid f1 : 0.723

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.71it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.26it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.25it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.93it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.94it/s][A100%|██████████| 195/195 [00:00<00:00, 335.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  91%|█████████▏| 117/128 [3:14:38<18:50, 102.79s/it]EarlyStopping counter : 19 out of 40
training process:  92%|█████████▏| 118/128 [3:16:11<16:38, 99.84s/it] EarlyStopping counter : 20 out of 40
training process:  93%|█████████▎| 119/128 [3:17:44<14:39, 97.75s/it]EarlyStopping counter : 21 out of 40
training process:  94%|█████████▍| 120/128 [3:19:15<12:47, 95.93s/it]epoch : 121, train loss : -6.181, valid loss : 1.513, train acc : 0.997, valid acc : 0.977, train f1 : 0.997, valid f1 : 0.722

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.46it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 321.75it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 327.79it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 331.04it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.38it/s][A100%|██████████| 195/195 [00:00<00:00, 322.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  95%|█████████▍| 121/128 [3:21:15<12:02, 103.15s/it]EarlyStopping counter : 23 out of 40
training process:  95%|█████████▌| 122/128 [3:22:48<10:00, 100.09s/it]EarlyStopping counter : 24 out of 40
training process:  96%|█████████▌| 123/128 [3:24:21<08:09, 97.99s/it] EarlyStopping counter : 25 out of 40
training process:  97%|█████████▋| 124/128 [3:25:56<06:27, 96.85s/it]epoch : 125, train loss : -6.379, valid loss : 2.399, train acc : 0.997, valid acc : 0.975, train f1 : 0.997, valid f1 : 0.712

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.75it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.47it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.07it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.01it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.12it/s][A100%|██████████| 195/195 [00:00<00:00, 340.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  98%|█████████▊| 125/128 [3:27:55<05:10, 103.63s/it]Best score increase :0.722 -> 0.724
training process:  98%|█████████▊| 126/128 [3:29:28<03:21, 100.57s/it]EarlyStopping counter : 1 out of 40
training process:  99%|█████████▉| 127/128 [3:31:02<01:38, 98.51s/it] EarlyStopping counter : 2 out of 40
training process: 100%|██████████| 128/128 [3:32:37<00:00, 97.50s/it]training process: 100%|██████████| 128/128 [3:32:37<00:00, 99.67s/it]
training process finished, best loss : 1.631 and best acc : 0.977, best f1 : 0.724, best epoch : 125

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.46      0.42      0.44       303
           1       0.99      0.99      0.99     16947

    accuracy                           0.98     17250
   macro avg       0.72      0.71      0.72     17250
weighted avg       0.98      0.98      0.98     17250


# test acc : 0.98, test f1 : 0.72, test AUC : 0.71, test loss : 253.374

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:13<03:38, 13.65s/it]processing for feature importance:  12%|█▏        | 2/17 [00:28<03:32, 14.18s/it]processing for feature importance:  18%|█▊        | 3/17 [00:40<03:07, 13.42s/it]processing for feature importance:  24%|██▎       | 4/17 [00:53<02:50, 13.09s/it]processing for feature importance:  29%|██▉       | 5/17 [01:07<02:42, 13.51s/it]processing for feature importance:  35%|███▌      | 6/17 [01:19<02:23, 13.07s/it]processing for feature importance:  41%|████      | 7/17 [01:32<02:09, 12.95s/it]processing for feature importance:  47%|████▋     | 8/17 [01:44<01:54, 12.77s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:57<01:41, 12.66s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:09<01:27, 12.52s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:21<01:14, 12.45s/it]processing for feature importance:  71%|███████   | 12/17 [02:34<01:03, 12.61s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:46<00:49, 12.46s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:59<00:37, 12.36s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:13<00:26, 13.03s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:26<00:13, 13.01s/it]processing for feature importance: 100%|██████████| 17/17 [03:38<00:00, 12.76s/it]processing for feature importance: 100%|██████████| 17/17 [03:38<00:00, 12.87s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:03<12:09,  3.47s/it]visualize 2D latent space:   1%|          | 2/211 [00:05<08:57,  2.57s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:30,  1.37s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<12:06,  3.46s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<08:54,  2.56s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:02,  1.83s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:26,  1.31s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 305.37it/s] 33%|███▎      | 65/195 [00:00<00:00, 325.30it/s] 51%|█████▏    | 100/195 [00:00<00:00, 332.13it/s] 69%|██████▉   | 135/195 [00:00<00:00, 335.34it/s] 87%|████████▋ | 169/195 [00:00<00:00, 335.77it/s]100%|██████████| 195/195 [00:00<00:00, 333.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_smoothing_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 204.96it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 201.21it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 194.52it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 197.23it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 199.06it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 202.02it/s]remove invalid data : null / measurement error:  24%|██▍       | 147/616 [00:00<00:02, 203.89it/s]remove invalid data : null / measurement error:  27%|██▋       | 169/616 [00:00<00:02, 206.23it/s]remove invalid data : null / measurement error:  31%|███       | 190/616 [00:00<00:02, 204.07it/s]remove invalid data : null / measurement error:  34%|███▍      | 211/616 [00:01<00:01, 202.86it/s]remove invalid data : null / measurement error:  38%|███▊      | 232/616 [00:01<00:01, 202.54it/s]remove invalid data : null / measurement error:  41%|████      | 253/616 [00:01<00:01, 202.67it/s]remove invalid data : null / measurement error:  44%|████▍     | 274/616 [00:01<00:01, 204.45it/s]remove invalid data : null / measurement error:  48%|████▊     | 295/616 [00:01<00:01, 204.48it/s]remove invalid data : null / measurement error:  51%|█████▏    | 316/616 [00:01<00:01, 203.70it/s]remove invalid data : null / measurement error:  55%|█████▍    | 337/616 [00:01<00:01, 203.09it/s]remove invalid data : null / measurement error:  58%|█████▊    | 358/616 [00:01<00:01, 202.12it/s]remove invalid data : null / measurement error:  62%|██████▏   | 384/616 [00:01<00:01, 217.05it/s]remove invalid data : null / measurement error:  67%|██████▋   | 410/616 [00:01<00:00, 228.30it/s]remove invalid data : null / measurement error:  70%|███████   | 433/616 [00:02<00:00, 227.13it/s]remove invalid data : null / measurement error:  74%|███████▍  | 457/616 [00:02<00:00, 230.52it/s]remove invalid data : null / measurement error:  78%|███████▊  | 481/616 [00:02<00:00, 221.64it/s]remove invalid data : null / measurement error:  82%|████████▏ | 504/616 [00:02<00:00, 214.57it/s]remove invalid data : null / measurement error:  85%|████████▌ | 526/616 [00:02<00:00, 210.91it/s]remove invalid data : null / measurement error:  89%|████████▉ | 548/616 [00:02<00:00, 206.52it/s]remove invalid data : null / measurement error:  92%|█████████▏| 569/616 [00:02<00:00, 204.90it/s]remove invalid data : null / measurement error:  96%|█████████▌| 590/616 [00:02<00:00, 204.65it/s]remove invalid data : null / measurement error:  99%|█████████▉| 611/616 [00:02<00:00, 203.69it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.54it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 234.72it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 233.99it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 234.49it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 236.59it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 237.69it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 239.32it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 240.12it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 240.22it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 240.41it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 241.00it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:01, 241.50it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 240.76it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 242.24it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 240.80it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 241.42it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 241.94it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 240.96it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 239.05it/s]replace nan value:  91%|█████████▏| 471/515 [00:01<00:00, 239.26it/s]replace nan value:  96%|█████████▋| 496/515 [00:02<00:00, 240.22it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 239.91it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 42.23it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 58.31it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.37it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.71it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.80it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.73it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.13it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.72it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 55.65it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.48it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.11it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.38it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.90it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.37it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.72it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.77it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 70.17it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.65it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.46it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 70.09it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 71.16it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.83it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.99it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.29it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.36it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.42it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.05it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.37it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.41it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.63it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 72.20it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 75.37it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 78.57it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 64.01it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 66.28it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 61.28it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 62.02it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 60.04it/s]generate index:  63%|██████▎   | 323/515 [00:04<00:03, 63.23it/s]generate index:  64%|██████▍   | 331/515 [00:04<00:02, 63.38it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 51.80it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 47.42it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 42.95it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 58.88it/s]generate index:  73%|███████▎  | 374/515 [00:05<00:01, 71.23it/s]generate index:  74%|███████▍  | 382/515 [00:05<00:01, 73.04it/s]generate index:  76%|███████▌  | 390/515 [00:05<00:01, 67.81it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 75.00it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.84it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.00it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.16it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 54.19it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 50.54it/s]generate index:  89%|████████▊ | 456/515 [00:07<00:00, 61.33it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.68it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.26it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.13it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.48it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.75it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.27it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 64.29it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▋         | 10/154 [00:00<00:01, 96.72it/s]remove invalid data : null / measurement error:  20%|██        | 31/154 [00:00<00:00, 159.60it/s]remove invalid data : null / measurement error:  34%|███▍      | 52/154 [00:00<00:00, 180.87it/s]remove invalid data : null / measurement error:  48%|████▊     | 74/154 [00:00<00:00, 193.52it/s]remove invalid data : null / measurement error:  62%|██████▏   | 96/154 [00:00<00:00, 202.75it/s]remove invalid data : null / measurement error:  77%|███████▋  | 119/154 [00:00<00:00, 211.79it/s]remove invalid data : null / measurement error:  92%|█████████▏| 141/154 [00:00<00:00, 208.73it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 196.37it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 245.97it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 248.40it/s]replace nan value:  58%|█████▊    | 76/131 [00:00<00:00, 248.89it/s]replace nan value:  77%|███████▋  | 101/131 [00:00<00:00, 246.28it/s]replace nan value:  97%|█████████▋| 127/131 [00:00<00:00, 247.87it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 247.61it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 67.61it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.90it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.27it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.74it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.39it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.86it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.89it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.75it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.59it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.37it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.55it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.90it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.77it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.35it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.84it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.71it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 67.58it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.50it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 76.71it/s]remove invalid data : null / measurement error:  15%|█▌        | 29/193 [00:00<00:01, 152.87it/s]remove invalid data : null / measurement error:  26%|██▌       | 50/193 [00:00<00:00, 177.38it/s]remove invalid data : null / measurement error:  37%|███▋      | 72/193 [00:00<00:00, 192.42it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 198.09it/s]remove invalid data : null / measurement error:  59%|█████▊    | 113/193 [00:00<00:00, 198.69it/s]remove invalid data : null / measurement error:  72%|███████▏  | 138/193 [00:00<00:00, 213.32it/s]remove invalid data : null / measurement error:  83%|████████▎ | 160/193 [00:00<00:00, 211.75it/s]remove invalid data : null / measurement error:  94%|█████████▍| 182/193 [00:00<00:00, 208.32it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 196.46it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 249.07it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 251.82it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 251.67it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 248.15it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 247.27it/s]replace nan value:  96%|█████████▌| 153/160 [00:00<00:00, 247.42it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 248.06it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.48it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.74it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.96it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.61it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.18it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.13it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.35it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.43it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.13it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.25it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.71it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.71it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.52it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.56it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.90it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.41it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.57it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 62.80it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.58it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.551, valid loss : -0.908, train acc : 0.542, valid acc : 0.604, train f1 : 0.364, valid f1 : 0.388

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▍        | 29/195 [00:00<00:00, 286.84it/s][A
 30%|███       | 59/195 [00:00<00:00, 291.04it/s][A
 46%|████▌     | 89/195 [00:00<00:00, 283.36it/s][A
 61%|██████    | 118/195 [00:00<00:00, 262.96it/s][A
 74%|███████▍  | 145/195 [00:00<00:00, 251.28it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 273.58it/s][A100%|██████████| 195/195 [00:00<00:00, 275.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.388
training process:   1%|          | 1/128 [02:01<4:16:53, 121.37s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:35<3:41:06, 105.29s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [05:07<3:27:01, 99.37s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:38<3:18:44, 96.17s/it]epoch : 5, train loss : -3.294, valid loss : -3.627, train acc : 0.329, valid acc : 0.349, train f1 : 0.263, valid f1 : 0.275

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.01it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.15it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.03it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.97it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.00it/s][A100%|██████████| 195/195 [00:00<00:00, 338.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:34<3:31:21, 103.10s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [10:02<3:19:23, 98.06s/it] EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:34<3:13:27, 95.93s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [13:03<3:07:32, 93.77s/it]epoch : 9, train loss : -6.894, valid loss : -7.752, train acc : 0.233, valid acc : 0.240, train f1 : 0.201, valid f1 : 0.205

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.49it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.86it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.05it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 345.56it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.85it/s][A100%|██████████| 195/195 [00:00<00:00, 345.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:57<3:18:47, 100.23s/it]EarlyStopping counter : 9 out of 40
training process:   8%|▊         | 10/128 [16:27<3:11:02, 97.14s/it]EarlyStopping counter : 10 out of 40
training process:   9%|▊         | 11/128 [17:57<3:04:35, 94.66s/it]EarlyStopping counter : 11 out of 40
training process:   9%|▉         | 12/128 [19:25<2:59:12, 92.70s/it]epoch : 13, train loss : -11.282, valid loss : -12.152, train acc : 0.192, valid acc : 0.257, train f1 : 0.171, valid f1 : 0.215

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.64it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.85it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.86it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.19it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.97it/s][A100%|██████████| 195/195 [00:00<00:00, 339.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  10%|█         | 13/128 [21:19<3:10:14, 99.26s/it]EarlyStopping counter : 13 out of 40
training process:  11%|█         | 14/128 [22:48<3:02:21, 95.98s/it]EarlyStopping counter : 14 out of 40
training process:  12%|█▏        | 15/128 [24:17<2:57:21, 94.17s/it]EarlyStopping counter : 15 out of 40
training process:  12%|█▎        | 16/128 [25:48<2:53:41, 93.05s/it]epoch : 17, train loss : -16.578, valid loss : -18.302, train acc : 0.196, valid acc : 0.248, train f1 : 0.174, valid f1 : 0.211

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.64it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.57it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 343.65it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 345.77it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 346.85it/s][A100%|██████████| 195/195 [00:00<00:00, 346.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  13%|█▎        | 17/128 [27:45<3:05:26, 100.24s/it]EarlyStopping counter : 17 out of 40
training process:  14%|█▍        | 18/128 [29:18<2:59:40, 98.00s/it] EarlyStopping counter : 18 out of 40
training process:  15%|█▍        | 19/128 [30:50<2:54:44, 96.19s/it]EarlyStopping counter : 19 out of 40
training process:  16%|█▌        | 20/128 [32:21<2:50:32, 94.74s/it]epoch : 21, train loss : -22.284, valid loss : -22.769, train acc : 0.182, valid acc : 0.200, train f1 : 0.164, valid f1 : 0.176

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 343.86it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 346.91it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 348.10it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 348.48it/s][A
 90%|█████████ | 176/195 [00:00<00:00, 349.07it/s][A100%|██████████| 195/195 [00:00<00:00, 348.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  16%|█▋        | 21/128 [34:17<3:00:31, 101.23s/it]EarlyStopping counter : 21 out of 40
training process:  17%|█▋        | 22/128 [35:50<2:54:26, 98.74s/it] EarlyStopping counter : 22 out of 40
training process:  18%|█▊        | 23/128 [37:21<2:48:24, 96.24s/it]EarlyStopping counter : 23 out of 40
training process:  19%|█▉        | 24/128 [38:49<2:42:50, 93.94s/it]epoch : 25, train loss : -28.491, valid loss : -31.451, train acc : 0.194, valid acc : 0.219, train f1 : 0.173, valid f1 : 0.191

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.13it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.66it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.46it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.49it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 339.17it/s][A100%|██████████| 195/195 [00:00<00:00, 339.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  20%|█▉        | 25/128 [40:49<2:54:41, 101.76s/it]EarlyStopping counter : 25 out of 40
training process:  20%|██        | 26/128 [42:22<2:48:14, 98.97s/it] EarlyStopping counter : 26 out of 40
training process:  21%|██        | 27/128 [43:56<2:44:08, 97.51s/it]EarlyStopping counter : 27 out of 40
training process:  22%|██▏       | 28/128 [45:27<2:39:22, 95.62s/it]epoch : 29, train loss : -35.096, valid loss : -37.113, train acc : 0.196, valid acc : 0.278, train f1 : 0.175, valid f1 : 0.231

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.64it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.60it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.90it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.01it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.63it/s][A100%|██████████| 195/195 [00:00<00:00, 339.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  23%|██▎       | 29/128 [47:23<2:47:47, 101.69s/it]EarlyStopping counter : 29 out of 40
training process:  23%|██▎       | 30/128 [48:56<2:41:50, 99.09s/it] EarlyStopping counter : 30 out of 40
training process:  24%|██▍       | 31/128 [50:28<2:36:53, 97.04s/it]EarlyStopping counter : 31 out of 40
training process:  25%|██▌       | 32/128 [51:59<2:32:03, 95.04s/it]epoch : 33, train loss : -42.208, valid loss : -42.726, train acc : 0.224, valid acc : 0.275, train f1 : 0.195, valid f1 : 0.229

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.50it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 332.17it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.54it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.58it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.87it/s][A100%|██████████| 195/195 [00:00<00:00, 338.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  26%|██▌       | 33/128 [53:58<2:41:53, 102.24s/it]EarlyStopping counter : 33 out of 40
training process:  27%|██▋       | 34/128 [55:27<2:34:17, 98.49s/it] EarlyStopping counter : 34 out of 40
training process:  27%|██▋       | 35/128 [56:57<2:28:42, 95.95s/it]EarlyStopping counter : 35 out of 40
training process:  28%|██▊       | 36/128 [58:27<2:24:07, 93.99s/it]epoch : 37, train loss : -49.132, valid loss : -52.050, train acc : 0.237, valid acc : 0.269, train f1 : 0.204, valid f1 : 0.225

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.79it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.77it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.80it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.36it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.84it/s][A100%|██████████| 195/195 [00:00<00:00, 341.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  29%|██▉       | 37/128 [1:00:21<2:31:39, 100.00s/it]EarlyStopping counter : 37 out of 40
training process:  30%|██▉       | 38/128 [1:01:51<2:25:32, 97.02s/it] EarlyStopping counter : 38 out of 40
training process:  30%|███       | 39/128 [1:03:21<2:20:48, 94.93s/it]EarlyStopping counter : 39 out of 40
training process:  31%|███▏      | 40/128 [1:04:52<2:17:35, 93.81s/it]epoch : 41, train loss : -56.425, valid loss : -64.129, train acc : 0.237, valid acc : 0.197, train f1 : 0.205, valid f1 : 0.175

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.72it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.58it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.69it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.50it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.62it/s][A100%|██████████| 195/195 [00:00<00:00, 343.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 40, best f1 score : 0.388
training process:  31%|███▏      | 40/128 [1:06:47<2:26:55, 100.18s/it]
training process finished, best loss : -1.383 and best acc : 0.603, best f1 : 0.388, best epoch : 1

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.01      0.34      0.03       303
           1       0.98      0.57      0.72     16947

    accuracy                           0.56     17250
   macro avg       0.50      0.45      0.37     17250
weighted avg       0.96      0.56      0.71     17250


# test acc : 0.56, test f1 : 0.37, test AUC : 0.45, test loss : -252.989

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:10, 11.91s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:53, 11.57s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:43, 11.68s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:31, 11.68s/it]processing for feature importance:  29%|██▉       | 5/17 [00:58<02:20, 11.68s/it]processing for feature importance:  35%|███▌      | 6/17 [01:10<02:09, 11.77s/it]processing for feature importance:  41%|████      | 7/17 [01:22<02:00, 12.00s/it]processing for feature importance:  47%|████▋     | 8/17 [01:35<01:49, 12.17s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:46<01:35, 12.00s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:59<01:24, 12.02s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:11<01:12, 12.07s/it]processing for feature importance:  71%|███████   | 12/17 [02:24<01:01, 12.39s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:36<00:48, 12.19s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:49<00:37, 12.48s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:01<00:24, 12.48s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:13<00:12, 12.30s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 12.23s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 12.10s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:02<10:13,  2.92s/it]visualize 2D latent space:   1%|          | 2/211 [00:03<06:45,  1.94s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:21,  2.11s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:36,  1.46s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<12:22,  3.54s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<08:58,  2.58s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
Transformer_clip_10_dist_1_CE_smoothing_RW_Robust_TQ_seed_42 : visualize 2D latent space doesn't work due to stability error

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 302.75it/s] 33%|███▎      | 65/195 [00:00<00:00, 323.52it/s] 51%|█████     | 99/195 [00:00<00:00, 330.34it/s] 68%|██████▊   | 133/195 [00:00<00:00, 333.72it/s] 86%|████████▌ | 167/195 [00:00<00:00, 335.56it/s]100%|██████████| 195/195 [00:00<00:00, 332.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.72it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 202.13it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 197.18it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 200.82it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 201.15it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 204.48it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 207.52it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 209.42it/s]remove invalid data : null / measurement error:  31%|███       | 192/616 [00:00<00:02, 204.99it/s]remove invalid data : null / measurement error:  35%|███▍      | 213/616 [00:01<00:01, 205.46it/s]remove invalid data : null / measurement error:  38%|███▊      | 234/616 [00:01<00:01, 206.18it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 205.06it/s]remove invalid data : null / measurement error:  45%|████▍     | 277/616 [00:01<00:01, 206.57it/s]remove invalid data : null / measurement error:  48%|████▊     | 298/616 [00:01<00:01, 206.34it/s]remove invalid data : null / measurement error:  52%|█████▏    | 319/616 [00:01<00:01, 205.28it/s]remove invalid data : null / measurement error:  55%|█████▌    | 340/616 [00:01<00:01, 203.30it/s]remove invalid data : null / measurement error:  59%|█████▊    | 361/616 [00:01<00:01, 204.07it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:01<00:01, 218.40it/s]remove invalid data : null / measurement error:  67%|██████▋   | 414/616 [00:01<00:00, 233.53it/s]remove invalid data : null / measurement error:  71%|███████   | 438/616 [00:02<00:00, 228.92it/s]remove invalid data : null / measurement error:  75%|███████▌  | 462/616 [00:02<00:00, 231.58it/s]remove invalid data : null / measurement error:  79%|███████▉  | 486/616 [00:02<00:00, 224.36it/s]remove invalid data : null / measurement error:  83%|████████▎ | 509/616 [00:02<00:00, 219.48it/s]remove invalid data : null / measurement error:  86%|████████▋ | 532/616 [00:02<00:00, 213.32it/s]remove invalid data : null / measurement error:  90%|████████▉ | 554/616 [00:02<00:00, 209.98it/s]remove invalid data : null / measurement error:  94%|█████████▎| 576/616 [00:02<00:00, 208.08it/s]remove invalid data : null / measurement error:  97%|█████████▋| 597/616 [00:02<00:00, 207.03it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 210.09it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 226.71it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 229.88it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 231.23it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 233.04it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 234.69it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 236.79it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 235.69it/s]replace nan value:  37%|███▋      | 193/515 [00:00<00:01, 236.92it/s]replace nan value:  42%|████▏     | 218/515 [00:00<00:01, 238.38it/s]replace nan value:  47%|████▋     | 243/515 [00:01<00:01, 239.43it/s]replace nan value:  52%|█████▏    | 268/515 [00:01<00:01, 240.48it/s]replace nan value:  57%|█████▋    | 293/515 [00:01<00:00, 240.36it/s]replace nan value:  62%|██████▏   | 318/515 [00:01<00:00, 240.32it/s]replace nan value:  67%|██████▋   | 343/515 [00:01<00:00, 238.45it/s]replace nan value:  71%|███████▏  | 367/515 [00:01<00:00, 236.55it/s]replace nan value:  76%|███████▌  | 392/515 [00:01<00:00, 238.78it/s]replace nan value:  81%|████████  | 417/515 [00:01<00:00, 239.47it/s]replace nan value:  86%|████████▌ | 441/515 [00:01<00:00, 238.82it/s]replace nan value:  90%|█████████ | 466/515 [00:01<00:00, 240.05it/s]replace nan value:  95%|█████████▌| 491/515 [00:02<00:00, 240.48it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 237.88it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.80it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.20it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.71it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.31it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.06it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.47it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.82it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.18it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.17it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.14it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.97it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.35it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.01it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.67it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.07it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.69it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.75it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.46it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 71.30it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.39it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.77it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.14it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.48it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.75it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.54it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.16it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.75it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 88.57it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 88.67it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 76.04it/s]generate index:  50%|█████     | 260/515 [00:03<00:03, 74.44it/s]generate index:  52%|█████▏    | 269/515 [00:03<00:03, 77.97it/s]generate index:  54%|█████▍    | 278/515 [00:04<00:03, 71.39it/s]generate index:  56%|█████▌    | 286/515 [00:04<00:03, 66.03it/s]generate index:  57%|█████▋    | 294/515 [00:04<00:03, 68.91it/s]generate index:  59%|█████▊    | 302/515 [00:04<00:03, 63.01it/s]generate index:  60%|██████    | 310/515 [00:04<00:03, 66.84it/s]generate index:  62%|██████▏   | 317/515 [00:04<00:03, 60.35it/s]generate index:  63%|██████▎   | 324/515 [00:04<00:03, 62.66it/s]generate index:  64%|██████▍   | 331/515 [00:04<00:02, 62.46it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 50.81it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 46.34it/s]generate index:  68%|██████▊   | 349/515 [00:05<00:03, 41.86it/s]generate index:  70%|██████▉   | 359/515 [00:05<00:02, 54.07it/s]generate index:  72%|███████▏  | 371/515 [00:05<00:02, 69.38it/s]generate index:  74%|███████▍  | 381/515 [00:05<00:01, 73.05it/s]generate index:  76%|███████▌  | 389/515 [00:05<00:01, 69.78it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 74.58it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 61.95it/s]generate index:  81%|████████  | 415/515 [00:06<00:01, 65.66it/s]generate index:  83%|████████▎ | 426/515 [00:06<00:01, 74.01it/s]generate index:  84%|████████▍ | 434/515 [00:06<00:01, 61.21it/s]generate index:  86%|████████▌ | 441/515 [00:06<00:01, 47.12it/s]generate index:  87%|████████▋ | 450/515 [00:06<00:01, 55.36it/s]generate index:  89%|████████▉ | 458/515 [00:07<00:00, 58.76it/s]generate index:  90%|█████████ | 466/515 [00:07<00:00, 61.82it/s]generate index:  92%|█████████▏| 473/515 [00:07<00:00, 57.07it/s]generate index:  94%|█████████▍| 485/515 [00:07<00:00, 70.53it/s]generate index:  96%|█████████▌| 493/515 [00:07<00:00, 65.99it/s]generate index:  97%|█████████▋| 501/515 [00:07<00:00, 67.06it/s]generate index:  99%|█████████▉| 509/515 [00:07<00:00, 67.42it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.45it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 68.12it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 148.31it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 175.00it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 189.94it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 196.67it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 211.62it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 209.04it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 193.62it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 245.17it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 247.27it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 247.75it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 244.45it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 246.15it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 246.19it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.94it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.05it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.34it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.48it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.69it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.99it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.32it/s]generate index:  45%|████▌     | 59/131 [00:00<00:01, 66.44it/s]generate index:  51%|█████     | 67/131 [00:01<00:00, 65.72it/s]generate index:  57%|█████▋    | 75/131 [00:01<00:00, 67.99it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 65.20it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.27it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 47.95it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 47.90it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 48.55it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.15it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 67.26it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.69it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 77.35it/s]remove invalid data : null / measurement error:  16%|█▌        | 30/193 [00:00<00:01, 156.32it/s]remove invalid data : null / measurement error:  27%|██▋       | 52/193 [00:00<00:00, 182.67it/s]remove invalid data : null / measurement error:  38%|███▊      | 74/193 [00:00<00:00, 195.44it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 201.72it/s]remove invalid data : null / measurement error:  61%|██████    | 118/193 [00:00<00:00, 206.58it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 218.45it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 213.83it/s]remove invalid data : null / measurement error:  97%|█████████▋| 187/193 [00:00<00:00, 211.13it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 199.99it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 246.46it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 248.92it/s]replace nan value:  48%|████▊     | 76/160 [00:00<00:00, 248.22it/s]replace nan value:  63%|██████▎   | 101/160 [00:00<00:00, 245.61it/s]replace nan value:  79%|███████▉  | 126/160 [00:00<00:00, 244.77it/s]replace nan value:  94%|█████████▍| 151/160 [00:00<00:00, 244.93it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 245.52it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 102.79it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.04it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.96it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 76.25it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 83.31it/s]generate index:  38%|███▊      | 61/160 [00:00<00:01, 83.08it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 85.40it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.98it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.17it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.95it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.54it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.67it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.62it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.13it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.96it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.87it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 60.32it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 64.84it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.45it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.043, valid loss : 0.025, train acc : 0.960, valid acc : 0.983, train f1 : 0.503, valid f1 : 0.496

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 346.58it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 352.31it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 353.75it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 354.88it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 355.39it/s][A100%|██████████| 195/195 [00:00<00:00, 354.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.496
training process:   1%|          | 1/128 [02:00<4:14:17, 120.14s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:27<3:31:31, 100.73s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:56<3:18:32, 95.30s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:26<3:12:59, 93.38s/it]epoch : 5, train loss : 0.021, valid loss : 0.020, train acc : 0.983, valid acc : 0.982, train f1 : 0.534, valid f1 : 0.542

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.78it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.33it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.82it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.35it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.83it/s][A100%|██████████| 195/195 [00:00<00:00, 340.06it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.496 -> 0.542
training process:   4%|▍         | 5/128 [08:18<3:25:05, 100.04s/it]Best score increase :0.542 -> 0.546
training process:   5%|▍         | 6/128 [09:46<3:15:17, 96.04s/it] EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:13<3:07:39, 93.06s/it]EarlyStopping counter : 2 out of 40
training process:   6%|▋         | 8/128 [12:43<3:04:10, 92.09s/it]epoch : 9, train loss : 0.018, valid loss : 0.019, train acc : 0.982, valid acc : 0.983, train f1 : 0.568, valid f1 : 0.564

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.44it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.30it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.19it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.14it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 346.63it/s][A100%|██████████| 195/195 [00:00<00:00, 345.63it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.546 -> 0.564
training process:   7%|▋         | 9/128 [14:36<3:15:25, 98.53s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:07<3:09:32, 96.38s/it]Best score increase :0.564 -> 0.632
training process:   9%|▊         | 11/128 [17:40<3:05:40, 95.22s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [19:12<3:02:08, 94.21s/it]epoch : 13, train loss : 0.016, valid loss : 0.017, train acc : 0.983, valid acc : 0.984, train f1 : 0.631, valid f1 : 0.629

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.24it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.21it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.69it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 348.35it/s][A
 91%|█████████ | 177/195 [00:00<00:00, 349.12it/s][A100%|██████████| 195/195 [00:00<00:00, 347.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  10%|█         | 13/128 [21:08<3:13:15, 100.83s/it]EarlyStopping counter : 3 out of 40
training process:  11%|█         | 14/128 [22:38<3:05:22, 97.56s/it] EarlyStopping counter : 4 out of 40
training process:  12%|█▏        | 15/128 [24:11<3:00:57, 96.09s/it]Best score increase :0.632 -> 0.636
training process:  12%|█▎        | 16/128 [25:42<2:56:41, 94.65s/it]epoch : 17, train loss : 0.015, valid loss : 0.017, train acc : 0.985, valid acc : 0.984, train f1 : 0.687, valid f1 : 0.666

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.51it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.95it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.28it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.74it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 341.31it/s][A100%|██████████| 195/195 [00:00<00:00, 340.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.636 -> 0.666
training process:  13%|█▎        | 17/128 [27:36<3:06:04, 100.58s/it]Best score increase :0.666 -> 0.696
training process:  14%|█▍        | 18/128 [29:05<2:58:05, 97.14s/it] EarlyStopping counter : 1 out of 40
training process:  15%|█▍        | 19/128 [30:32<2:50:51, 94.05s/it]EarlyStopping counter : 2 out of 40
training process:  16%|█▌        | 20/128 [32:03<2:47:44, 93.19s/it]epoch : 21, train loss : 0.013, valid loss : 0.016, train acc : 0.985, valid acc : 0.986, train f1 : 0.712, valid f1 : 0.692

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.13it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.44it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.44it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.38it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 346.99it/s][A100%|██████████| 195/195 [00:00<00:00, 345.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  16%|█▋        | 21/128 [33:59<2:57:55, 99.77s/it]EarlyStopping counter : 4 out of 40
training process:  17%|█▋        | 22/128 [35:27<2:50:24, 96.45s/it]EarlyStopping counter : 5 out of 40
training process:  18%|█▊        | 23/128 [36:59<2:46:18, 95.03s/it]EarlyStopping counter : 6 out of 40
training process:  19%|█▉        | 24/128 [38:29<2:42:07, 93.53s/it]epoch : 25, train loss : 0.011, valid loss : 0.016, train acc : 0.987, valid acc : 0.985, train f1 : 0.758, valid f1 : 0.696

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.71it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.92it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.76it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.23it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.05it/s][A100%|██████████| 195/195 [00:00<00:00, 344.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  20%|█▉        | 25/128 [40:22<2:50:27, 99.29s/it]EarlyStopping counter : 8 out of 40
training process:  20%|██        | 26/128 [41:50<2:43:11, 96.00s/it]Best score increase :0.696 -> 0.738
training process:  21%|██        | 27/128 [43:20<2:38:34, 94.20s/it]EarlyStopping counter : 1 out of 40
training process:  22%|██▏       | 28/128 [44:52<2:35:41, 93.41s/it]epoch : 29, train loss : 0.010, valid loss : 0.018, train acc : 0.988, valid acc : 0.979, train f1 : 0.789, valid f1 : 0.704

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.08it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.41it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.20it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.01it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.50it/s][A100%|██████████| 195/195 [00:00<00:00, 341.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 29/128 [46:46<2:44:39, 99.79s/it]Best score increase :0.738 -> 0.743
training process:  23%|██▎       | 30/128 [48:16<2:38:10, 96.85s/it]Best score increase :0.743 -> 0.773
training process:  24%|██▍       | 31/128 [49:44<2:32:12, 94.15s/it]EarlyStopping counter : 1 out of 40
training process:  25%|██▌       | 32/128 [51:14<2:28:28, 92.79s/it]epoch : 33, train loss : 0.009, valid loss : 0.019, train acc : 0.989, valid acc : 0.977, train f1 : 0.805, valid f1 : 0.684

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.77it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.60it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.86it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.18it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.95it/s][A100%|██████████| 195/195 [00:00<00:00, 336.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  26%|██▌       | 33/128 [53:08<2:36:58, 99.14s/it]EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 34/128 [54:38<2:31:17, 96.57s/it]EarlyStopping counter : 4 out of 40
training process:  27%|██▋       | 35/128 [56:05<2:25:09, 93.65s/it]Best score increase :0.773 -> 0.783
training process:  28%|██▊       | 36/128 [57:33<2:20:53, 91.88s/it]epoch : 37, train loss : 0.008, valid loss : 0.019, train acc : 0.990, valid acc : 0.980, train f1 : 0.830, valid f1 : 0.729

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.44it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.23it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.17it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.22it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.57it/s][A100%|██████████| 195/195 [00:00<00:00, 342.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  29%|██▉       | 37/128 [59:25<2:28:24, 97.85s/it]EarlyStopping counter : 2 out of 40
training process:  30%|██▉       | 38/128 [1:00:55<2:23:18, 95.54s/it]Best score increase :0.783 -> 0.795
training process:  30%|███       | 39/128 [1:02:23<2:18:30, 93.38s/it]EarlyStopping counter : 1 out of 40
training process:  31%|███▏      | 40/128 [1:03:56<2:16:29, 93.07s/it]epoch : 41, train loss : 0.007, valid loss : 0.021, train acc : 0.991, valid acc : 0.979, train f1 : 0.853, valid f1 : 0.715

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.31it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.11it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.79it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.04it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.91it/s][A100%|██████████| 195/195 [00:00<00:00, 342.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  32%|███▏      | 41/128 [1:05:49<2:23:53, 99.23s/it]EarlyStopping counter : 3 out of 40
training process:  33%|███▎      | 42/128 [1:07:18<2:17:34, 95.99s/it]EarlyStopping counter : 4 out of 40
training process:  34%|███▎      | 43/128 [1:08:48<2:13:29, 94.23s/it]Best score increase :0.795 -> 0.799
training process:  34%|███▍      | 44/128 [1:10:18<2:10:09, 92.97s/it]epoch : 45, train loss : 0.006, valid loss : 0.029, train acc : 0.991, valid acc : 0.972, train f1 : 0.856, valid f1 : 0.698

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.56it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.64it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.01it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.94it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 339.19it/s][A100%|██████████| 195/195 [00:00<00:00, 339.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  35%|███▌      | 45/128 [1:12:14<2:18:21, 100.02s/it]Best score increase :0.799 -> 0.803
training process:  36%|███▌      | 46/128 [1:13:42<2:11:51, 96.48s/it] EarlyStopping counter : 1 out of 40
training process:  37%|███▋      | 47/128 [1:15:09<2:06:22, 93.61s/it]EarlyStopping counter : 2 out of 40
training process:  38%|███▊      | 48/128 [1:16:39<2:03:11, 92.39s/it]epoch : 49, train loss : 0.006, valid loss : 0.021, train acc : 0.992, valid acc : 0.987, train f1 : 0.881, valid f1 : 0.776

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.83it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.75it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.26it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.05it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.61it/s][A100%|██████████| 195/195 [00:00<00:00, 341.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  38%|███▊      | 49/128 [1:18:36<2:11:34, 99.93s/it]EarlyStopping counter : 4 out of 40
training process:  39%|███▉      | 50/128 [1:20:04<2:05:03, 96.19s/it]EarlyStopping counter : 5 out of 40
training process:  40%|███▉      | 51/128 [1:21:35<2:01:25, 94.62s/it]EarlyStopping counter : 6 out of 40
training process:  41%|████      | 52/128 [1:23:03<1:57:30, 92.76s/it]epoch : 53, train loss : 0.005, valid loss : 0.026, train acc : 0.993, valid acc : 0.977, train f1 : 0.891, valid f1 : 0.718

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 348.02it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 347.89it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 348.01it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 348.57it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 348.95it/s][A100%|██████████| 195/195 [00:00<00:00, 334.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  41%|████▏     | 53/128 [1:24:57<2:03:44, 98.99s/it]EarlyStopping counter : 8 out of 40
training process:  42%|████▏     | 54/128 [1:26:24<1:57:52, 95.57s/it]EarlyStopping counter : 9 out of 40
training process:  43%|████▎     | 55/128 [1:27:52<1:53:21, 93.18s/it]EarlyStopping counter : 10 out of 40
training process:  44%|████▍     | 56/128 [1:29:23<1:51:11, 92.66s/it]epoch : 57, train loss : 0.005, valid loss : 0.027, train acc : 0.994, valid acc : 0.975, train f1 : 0.903, valid f1 : 0.711

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.70it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.66it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 344.69it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 345.84it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 346.39it/s][A100%|██████████| 195/195 [00:00<00:00, 345.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  45%|████▍     | 57/128 [1:31:20<1:58:14, 99.92s/it]EarlyStopping counter : 12 out of 40
training process:  45%|████▌     | 58/128 [1:32:52<1:53:37, 97.39s/it]EarlyStopping counter : 13 out of 40
training process:  46%|████▌     | 59/128 [1:34:21<1:49:11, 94.95s/it]EarlyStopping counter : 14 out of 40
training process:  47%|████▋     | 60/128 [1:35:51<1:46:01, 93.55s/it]epoch : 61, train loss : 0.005, valid loss : 0.023, train acc : 0.994, valid acc : 0.982, train f1 : 0.909, valid f1 : 0.752

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.48it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.42it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.05it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.02it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 337.71it/s][A100%|██████████| 195/195 [00:00<00:00, 338.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  48%|████▊     | 61/128 [1:37:47<1:51:59, 100.29s/it]EarlyStopping counter : 16 out of 40
training process:  48%|████▊     | 62/128 [1:39:17<1:46:40, 96.98s/it] EarlyStopping counter : 17 out of 40
training process:  49%|████▉     | 63/128 [1:40:46<1:42:42, 94.81s/it]EarlyStopping counter : 18 out of 40
training process:  50%|█████     | 64/128 [1:42:18<1:40:17, 94.02s/it]epoch : 65, train loss : 0.004, valid loss : 0.026, train acc : 0.995, valid acc : 0.980, train f1 : 0.920, valid f1 : 0.741

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.57it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.81it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.82it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.16it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.62it/s][A100%|██████████| 195/195 [00:00<00:00, 340.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  51%|█████     | 65/128 [1:44:14<1:45:29, 100.47s/it]EarlyStopping counter : 20 out of 40
training process:  52%|█████▏    | 66/128 [1:45:44<1:40:38, 97.40s/it] EarlyStopping counter : 21 out of 40
training process:  52%|█████▏    | 67/128 [1:47:15<1:36:57, 95.37s/it]EarlyStopping counter : 22 out of 40
training process:  53%|█████▎    | 68/128 [1:48:45<1:33:54, 93.91s/it]epoch : 69, train loss : 0.004, valid loss : 0.028, train acc : 0.995, valid acc : 0.979, train f1 : 0.922, valid f1 : 0.726

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 344.33it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 347.96it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 349.15it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 349.69it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 349.89it/s][A100%|██████████| 195/195 [00:00<00:00, 349.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  54%|█████▍    | 69/128 [1:50:39<1:38:04, 99.74s/it]EarlyStopping counter : 24 out of 40
training process:  55%|█████▍    | 70/128 [1:52:05<1:32:33, 95.74s/it]EarlyStopping counter : 25 out of 40
training process:  55%|█████▌    | 71/128 [1:53:30<1:27:59, 92.62s/it]EarlyStopping counter : 26 out of 40
training process:  56%|█████▋    | 72/128 [1:54:59<1:25:18, 91.41s/it]epoch : 73, train loss : 0.004, valid loss : 0.026, train acc : 0.995, valid acc : 0.977, train f1 : 0.920, valid f1 : 0.722

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.07it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.90it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.23it/s][A
 71%|███████   | 138/195 [00:00<00:00, 337.26it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 338.78it/s][A100%|██████████| 195/195 [00:00<00:00, 338.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  57%|█████▋    | 73/128 [1:56:52<1:29:48, 97.97s/it]EarlyStopping counter : 28 out of 40
training process:  58%|█████▊    | 74/128 [1:58:19<1:25:15, 94.72s/it]EarlyStopping counter : 29 out of 40
training process:  59%|█████▊    | 75/128 [1:59:49<1:22:11, 93.05s/it]EarlyStopping counter : 30 out of 40
training process:  59%|█████▉    | 76/128 [2:01:18<1:19:45, 92.02s/it]epoch : 77, train loss : 0.004, valid loss : 0.050, train acc : 0.995, valid acc : 0.972, train f1 : 0.930, valid f1 : 0.696

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.54it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 266.51it/s][A
 49%|████▉     | 96/195 [00:00<00:00, 264.09it/s][A
 66%|██████▌   | 129/195 [00:00<00:00, 286.49it/s][A
 83%|████████▎ | 162/195 [00:00<00:00, 300.88it/s][A
100%|██████████| 195/195 [00:00<00:00, 309.97it/s][A100%|██████████| 195/195 [00:00<00:00, 296.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  60%|██████    | 77/128 [2:03:16<1:24:43, 99.68s/it]EarlyStopping counter : 32 out of 40
training process:  61%|██████    | 78/128 [2:04:43<1:19:57, 95.95s/it]EarlyStopping counter : 33 out of 40
training process:  62%|██████▏   | 79/128 [2:06:10<1:16:17, 93.41s/it]EarlyStopping counter : 34 out of 40
training process:  62%|██████▎   | 80/128 [2:07:41<1:13:59, 92.48s/it]epoch : 81, train loss : 0.004, valid loss : 0.030, train acc : 0.996, valid acc : 0.982, train f1 : 0.936, valid f1 : 0.748

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.17it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.65it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.91it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.63it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.88it/s][A100%|██████████| 195/195 [00:00<00:00, 339.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  63%|██████▎   | 81/128 [2:09:35<1:17:35, 99.06s/it]EarlyStopping counter : 36 out of 40
training process:  64%|██████▍   | 82/128 [2:11:07<1:14:09, 96.73s/it]EarlyStopping counter : 37 out of 40
training process:  65%|██████▍   | 83/128 [2:12:35<1:10:44, 94.31s/it]EarlyStopping counter : 38 out of 40
training process:  66%|██████▌   | 84/128 [2:14:09<1:08:58, 94.06s/it]epoch : 85, train loss : 0.004, valid loss : 0.036, train acc : 0.996, valid acc : 0.976, train f1 : 0.942, valid f1 : 0.722

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.02it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.44it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.48it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.56it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.05it/s][A100%|██████████| 195/195 [00:00<00:00, 342.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  66%|██████▋   | 85/128 [2:16:06<1:12:21, 100.96s/it]Best score increase :0.803 -> 0.806
training process:  67%|██████▋   | 86/128 [2:17:35<1:08:15, 97.50s/it] EarlyStopping counter : 1 out of 40
training process:  68%|██████▊   | 87/128 [2:19:02<1:04:27, 94.33s/it]EarlyStopping counter : 2 out of 40
training process:  69%|██████▉   | 88/128 [2:20:31<1:01:49, 92.73s/it]epoch : 89, train loss : 0.004, valid loss : 0.055, train acc : 0.996, valid acc : 0.970, train f1 : 0.936, valid f1 : 0.696

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 350.79it/s][A
 37%|███▋      | 72/195 [00:00<00:00, 349.15it/s][A
 55%|█████▌    | 108/195 [00:00<00:00, 353.22it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 328.75it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 328.70it/s][A100%|██████████| 195/195 [00:00<00:00, 334.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  70%|██████▉   | 89/128 [2:22:26<1:04:39, 99.49s/it]EarlyStopping counter : 4 out of 40
training process:  70%|███████   | 90/128 [2:23:57<1:01:24, 96.97s/it]EarlyStopping counter : 5 out of 40
training process:  71%|███████   | 91/128 [2:25:25<58:02, 94.13s/it]  EarlyStopping counter : 6 out of 40
training process:  72%|███████▏  | 92/128 [2:26:56<55:57, 93.26s/it]epoch : 93, train loss : 0.003, valid loss : 0.052, train acc : 0.996, valid acc : 0.976, train f1 : 0.947, valid f1 : 0.716

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.30it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 331.82it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.30it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.08it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.48it/s][A100%|██████████| 195/195 [00:00<00:00, 336.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  73%|███████▎  | 93/128 [2:28:53<58:34, 100.42s/it]EarlyStopping counter : 8 out of 40
training process:  73%|███████▎  | 94/128 [2:30:20<54:35, 96.35s/it] EarlyStopping counter : 9 out of 40
training process:  74%|███████▍  | 95/128 [2:31:47<51:22, 93.40s/it]EarlyStopping counter : 10 out of 40
training process:  75%|███████▌  | 96/128 [2:33:15<49:00, 91.89s/it]epoch : 97, train loss : 0.003, valid loss : 0.044, train acc : 0.996, valid acc : 0.975, train f1 : 0.947, valid f1 : 0.720

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.70it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.47it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.42it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.20it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.60it/s][A100%|██████████| 195/195 [00:00<00:00, 339.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  76%|███████▌  | 97/128 [2:35:05<50:16, 97.30s/it]EarlyStopping counter : 12 out of 40
training process:  77%|███████▋  | 98/128 [2:36:34<47:26, 94.90s/it]EarlyStopping counter : 13 out of 40
training process:  77%|███████▋  | 99/128 [2:38:06<45:21, 93.86s/it]EarlyStopping counter : 14 out of 40
training process:  78%|███████▊  | 100/128 [2:39:35<43:12, 92.58s/it]epoch : 101, train loss : 0.003, valid loss : 0.052, train acc : 0.996, valid acc : 0.976, train f1 : 0.947, valid f1 : 0.716

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.03it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.03it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.80it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.78it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.08it/s][A100%|██████████| 195/195 [00:00<00:00, 344.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  79%|███████▉  | 101/128 [2:41:29<44:28, 98.84s/it]EarlyStopping counter : 16 out of 40
training process:  80%|███████▉  | 102/128 [2:42:59<41:45, 96.36s/it]EarlyStopping counter : 17 out of 40
training process:  80%|████████  | 103/128 [2:44:29<39:18, 94.34s/it]EarlyStopping counter : 18 out of 40
training process:  81%|████████▏ | 104/128 [2:45:58<37:05, 92.72s/it]epoch : 105, train loss : 0.003, valid loss : 0.039, train acc : 0.997, valid acc : 0.979, train f1 : 0.955, valid f1 : 0.732

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.67it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.79it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.76it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.60it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.18it/s][A100%|██████████| 195/195 [00:00<00:00, 338.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  82%|████████▏ | 105/128 [2:47:55<38:20, 100.00s/it]EarlyStopping counter : 20 out of 40
training process:  83%|████████▎ | 106/128 [2:49:26<35:41, 97.33s/it] EarlyStopping counter : 21 out of 40
training process:  84%|████████▎ | 107/128 [2:50:58<33:27, 95.61s/it]EarlyStopping counter : 22 out of 40
training process:  84%|████████▍ | 108/128 [2:52:26<31:08, 93.40s/it]epoch : 109, train loss : 0.003, valid loss : 0.061, train acc : 0.997, valid acc : 0.975, train f1 : 0.955, valid f1 : 0.714

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 346.89it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 351.83it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 349.43it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 351.85it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 354.13it/s][A100%|██████████| 195/195 [00:00<00:00, 352.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  85%|████████▌ | 109/128 [2:54:22<31:46, 100.35s/it]EarlyStopping counter : 24 out of 40
training process:  86%|████████▌ | 110/128 [2:55:51<29:04, 96.89s/it] EarlyStopping counter : 25 out of 40
training process:  87%|████████▋ | 111/128 [2:57:20<26:44, 94.37s/it]EarlyStopping counter : 26 out of 40
training process:  88%|████████▊ | 112/128 [2:58:49<24:45, 92.86s/it]epoch : 113, train loss : 0.003, valid loss : 0.072, train acc : 0.997, valid acc : 0.974, train f1 : 0.958, valid f1 : 0.704

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█▏        | 22/195 [00:00<00:00, 212.18it/s][A
 27%|██▋       | 53/195 [00:00<00:00, 267.52it/s][A
 45%|████▍     | 87/195 [00:00<00:00, 297.21it/s][A
 62%|██████▏   | 120/195 [00:00<00:00, 306.68it/s][A
 79%|███████▉  | 154/195 [00:00<00:00, 318.01it/s][A
 96%|█████████▋| 188/195 [00:00<00:00, 324.90it/s][A100%|██████████| 195/195 [00:00<00:00, 308.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  88%|████████▊ | 113/128 [3:00:42<24:44, 98.95s/it]EarlyStopping counter : 28 out of 40
training process:  89%|████████▉ | 114/128 [3:02:14<22:34, 96.72s/it]EarlyStopping counter : 29 out of 40
training process:  90%|████████▉ | 115/128 [3:03:42<20:25, 94.29s/it]EarlyStopping counter : 30 out of 40
training process:  91%|█████████ | 116/128 [3:05:11<18:30, 92.56s/it]epoch : 117, train loss : 0.003, valid loss : 0.054, train acc : 0.997, valid acc : 0.980, train f1 : 0.961, valid f1 : 0.742

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.68it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.38it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.91it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.18it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.60it/s][A100%|██████████| 195/195 [00:00<00:00, 343.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  91%|█████████▏| 117/128 [3:07:08<18:20, 100.01s/it]EarlyStopping counter : 32 out of 40
training process:  92%|█████████▏| 118/128 [3:08:37<16:06, 96.65s/it] EarlyStopping counter : 33 out of 40
training process:  93%|█████████▎| 119/128 [3:10:08<14:13, 94.85s/it]EarlyStopping counter : 34 out of 40
training process:  94%|█████████▍| 120/128 [3:11:37<12:26, 93.30s/it]epoch : 121, train loss : 0.002, valid loss : 0.088, train acc : 0.998, valid acc : 0.974, train f1 : 0.964, valid f1 : 0.713

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.94it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.09it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.20it/s][A
 70%|███████   | 137/195 [00:00<00:00, 334.52it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 337.26it/s][A100%|██████████| 195/195 [00:00<00:00, 336.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  95%|█████████▍| 121/128 [3:13:30<11:33, 99.14s/it]EarlyStopping counter : 36 out of 40
training process:  95%|█████████▌| 122/128 [3:14:57<09:32, 95.42s/it]EarlyStopping counter : 37 out of 40
training process:  96%|█████████▌| 123/128 [3:16:26<07:47, 93.42s/it]EarlyStopping counter : 38 out of 40
training process:  97%|█████████▋| 124/128 [3:17:55<06:08, 92.17s/it]epoch : 125, train loss : 0.003, valid loss : 0.074, train acc : 0.997, valid acc : 0.975, train f1 : 0.963, valid f1 : 0.716

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.44it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.92it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.54it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.57it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.82it/s][A100%|██████████| 195/195 [00:00<00:00, 338.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  98%|█████████▊| 125/128 [3:19:48<04:55, 98.53s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 125, best f1 score : 0.806
training process:  98%|█████████▊| 125/128 [3:21:16<04:49, 96.61s/it]
training process finished, best loss : 0.030 and best acc : 0.988, best f1 : 0.806, best epoch : 85

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.45      0.51       303
           1       0.99      0.99      0.99     16947

    accuracy                           0.98     17250
   macro avg       0.79      0.72      0.75     17250
weighted avg       0.98      0.98      0.98     17250


# test acc : 0.98, test f1 : 0.75, test AUC : 0.72, test loss : 9.431

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:06, 11.69s/it]processing for feature importance:  12%|█▏        | 2/17 [00:22<02:50, 11.34s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:41, 11.55s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:32, 11.72s/it]processing for feature importance:  29%|██▉       | 5/17 [01:00<02:30, 12.51s/it]processing for feature importance:  35%|███▌      | 6/17 [01:12<02:17, 12.46s/it]processing for feature importance:  41%|████      | 7/17 [01:25<02:06, 12.65s/it]processing for feature importance:  47%|████▋     | 8/17 [01:37<01:51, 12.35s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:49<01:38, 12.27s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:01<01:25, 12.27s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:14<01:13, 12.21s/it]processing for feature importance:  71%|███████   | 12/17 [02:26<01:00, 12.16s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:37<00:48, 12.00s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:50<00:36, 12.16s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:01<00:23, 11.96s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:13<00:11, 11.98s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 11.81s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 12.07s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:03<12:52,  3.68s/it]visualize 2D latent space:   1%|          | 2/211 [00:05<09:36,  2.76s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:23,  2.14s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:34,  1.43s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<11:47,  3.37s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:03<05:19,  1.53s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:04<07:00,  2.01s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:19,  2.08s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:23,  1.26s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:04<02:20,  2.13s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 10%|█         | 20/195 [00:00<00:00, 193.00it/s] 26%|██▌       | 51/195 [00:00<00:00, 256.91it/s] 44%|████▎     | 85/195 [00:00<00:00, 290.67it/s] 61%|██████    | 119/195 [00:00<00:00, 306.47it/s] 78%|███████▊  | 153/195 [00:00<00:00, 315.34it/s] 96%|█████████▌| 187/195 [00:00<00:00, 321.48it/s]100%|██████████| 195/195 [00:00<00:00, 302.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.55it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 201.44it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 199.40it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 201.71it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.49it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 177.12it/s]remove invalid data : null / measurement error:  24%|██▎       | 145/616 [00:00<00:02, 177.94it/s]remove invalid data : null / measurement error:  27%|██▋       | 164/616 [00:00<00:02, 160.60it/s]remove invalid data : null / measurement error:  30%|██▉       | 183/616 [00:01<00:02, 168.16it/s]remove invalid data : null / measurement error:  33%|███▎      | 204/616 [00:01<00:02, 177.88it/s]remove invalid data : null / measurement error:  37%|███▋      | 225/616 [00:01<00:02, 185.63it/s]remove invalid data : null / measurement error:  40%|███▉      | 246/616 [00:01<00:01, 191.59it/s]remove invalid data : null / measurement error:  44%|████▎     | 268/616 [00:01<00:01, 197.03it/s]remove invalid data : null / measurement error:  47%|████▋     | 289/616 [00:01<00:01, 198.98it/s]remove invalid data : null / measurement error:  50%|█████     | 310/616 [00:01<00:01, 200.06it/s]remove invalid data : null / measurement error:  54%|█████▎    | 331/616 [00:01<00:01, 200.87it/s]remove invalid data : null / measurement error:  57%|█████▋    | 352/616 [00:01<00:01, 201.80it/s]remove invalid data : null / measurement error:  61%|██████    | 376/616 [00:01<00:01, 211.87it/s]remove invalid data : null / measurement error:  65%|██████▌   | 403/616 [00:02<00:00, 226.75it/s]remove invalid data : null / measurement error:  69%|██████▉   | 426/616 [00:02<00:00, 203.25it/s]remove invalid data : null / measurement error:  73%|███████▎  | 447/616 [00:02<00:00, 185.17it/s]remove invalid data : null / measurement error:  76%|███████▌  | 467/616 [00:02<00:00, 179.37it/s]remove invalid data : null / measurement error:  79%|███████▉  | 488/616 [00:02<00:00, 186.48it/s]remove invalid data : null / measurement error:  83%|████████▎ | 509/616 [00:02<00:00, 192.06it/s]remove invalid data : null / measurement error:  86%|████████▌ | 530/616 [00:02<00:00, 195.60it/s]remove invalid data : null / measurement error:  89%|████████▉ | 551/616 [00:02<00:00, 197.24it/s]remove invalid data : null / measurement error:  93%|█████████▎| 572/616 [00:02<00:00, 199.07it/s]remove invalid data : null / measurement error:  96%|█████████▋| 593/616 [00:03<00:00, 200.84it/s]remove invalid data : null / measurement error: 100%|█████████▉| 614/616 [00:03<00:00, 201.94it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 193.76it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 233.67it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 233.16it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 234.54it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 238.84it/s]replace nan value:  23%|██▎       | 121/515 [00:00<00:02, 196.81it/s]replace nan value:  28%|██▊       | 142/515 [00:00<00:02, 178.70it/s]replace nan value:  32%|███▏      | 164/515 [00:00<00:01, 188.68it/s]replace nan value:  37%|███▋      | 188/515 [00:00<00:01, 202.98it/s]replace nan value:  41%|████      | 212/515 [00:01<00:01, 213.07it/s]replace nan value:  46%|████▌     | 237/515 [00:01<00:01, 221.76it/s]replace nan value:  51%|█████     | 262/515 [00:01<00:01, 227.62it/s]replace nan value:  56%|█████▌    | 286/515 [00:01<00:00, 231.04it/s]replace nan value:  60%|██████    | 310/515 [00:01<00:00, 233.66it/s]replace nan value:  65%|██████▍   | 334/515 [00:01<00:00, 234.80it/s]replace nan value:  70%|██████▉   | 358/515 [00:01<00:00, 233.31it/s]replace nan value:  74%|███████▍  | 383/515 [00:01<00:00, 236.55it/s]replace nan value:  79%|███████▉  | 408/515 [00:01<00:00, 237.65it/s]replace nan value:  84%|████████▍ | 433/515 [00:01<00:00, 235.37it/s]replace nan value:  89%|████████▊ | 457/515 [00:02<00:00, 203.59it/s]replace nan value:  93%|█████████▎| 479/515 [00:02<00:00, 185.60it/s]replace nan value:  97%|█████████▋| 501/515 [00:02<00:00, 193.34it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 214.17it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.70it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.39it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.65it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.08it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.87it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.22it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.42it/s]generate index:  12%|█▏        | 63/515 [00:01<00:12, 37.52it/s]generate index:  13%|█▎        | 69/515 [00:01<00:10, 40.70it/s]generate index:  15%|█▍        | 76/515 [00:01<00:09, 44.71it/s]generate index:  17%|█▋        | 86/515 [00:01<00:07, 56.55it/s]generate index:  18%|█▊        | 93/515 [00:01<00:07, 55.51it/s]generate index:  19%|█▉        | 100/515 [00:01<00:07, 54.27it/s]generate index:  21%|██        | 107/515 [00:01<00:07, 57.07it/s]generate index:  23%|██▎       | 116/515 [00:02<00:06, 64.95it/s]generate index:  24%|██▍       | 123/515 [00:02<00:06, 63.69it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 68.27it/s]generate index:  27%|██▋       | 140/515 [00:02<00:05, 68.35it/s]generate index:  29%|██▊       | 147/515 [00:02<00:06, 60.34it/s]generate index:  30%|██▉       | 154/515 [00:02<00:06, 54.67it/s]generate index:  31%|███       | 160/515 [00:02<00:06, 54.29it/s]generate index:  32%|███▏      | 167/515 [00:02<00:06, 57.14it/s]generate index:  34%|███▎      | 173/515 [00:03<00:06, 55.07it/s]generate index:  35%|███▌      | 182/515 [00:03<00:05, 63.58it/s]generate index:  37%|███▋      | 189/515 [00:03<00:05, 62.59it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 65.48it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 64.72it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 85.22it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 82.23it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 79.25it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 82.04it/s]generate index:  50%|████▉     | 256/515 [00:04<00:04, 56.44it/s]generate index:  51%|█████▏    | 264/515 [00:04<00:04, 59.95it/s]generate index:  53%|█████▎    | 274/515 [00:04<00:03, 67.57it/s]generate index:  55%|█████▍    | 282/515 [00:04<00:04, 54.77it/s]generate index:  56%|█████▋    | 290/515 [00:04<00:03, 57.78it/s]generate index:  58%|█████▊    | 297/515 [00:04<00:03, 59.22it/s]generate index:  59%|█████▉    | 304/515 [00:05<00:03, 59.77it/s]generate index:  61%|██████    | 312/515 [00:05<00:03, 61.38it/s]generate index:  62%|██████▏   | 319/515 [00:05<00:03, 58.53it/s]generate index:  63%|██████▎   | 327/515 [00:05<00:03, 62.61it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 57.33it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:04, 38.59it/s]generate index:  67%|██████▋   | 345/515 [00:06<00:04, 37.57it/s]generate index:  68%|██████▊   | 350/515 [00:06<00:04, 34.61it/s]generate index:  70%|███████   | 362/515 [00:06<00:02, 51.12it/s]generate index:  73%|███████▎  | 374/515 [00:06<00:02, 64.75it/s]generate index:  74%|███████▍  | 382/515 [00:06<00:01, 68.05it/s]generate index:  76%|███████▌  | 390/515 [00:06<00:01, 64.57it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 72.61it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.49it/s]generate index:  81%|████████  | 417/515 [00:07<00:01, 64.27it/s]generate index:  83%|████████▎ | 428/515 [00:07<00:01, 73.81it/s]generate index:  85%|████████▍ | 436/515 [00:07<00:01, 46.65it/s]generate index:  86%|████████▌ | 443/515 [00:07<00:01, 41.26it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 53.37it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 58.98it/s]generate index:  92%|█████████▏| 472/515 [00:08<00:00, 53.99it/s]generate index:  94%|█████████▍| 483/515 [00:08<00:00, 64.02it/s]generate index:  95%|█████████▌| 491/515 [00:08<00:00, 62.68it/s]generate index:  97%|█████████▋| 498/515 [00:08<00:00, 60.65it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 68.63it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 57.68it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:03, 47.71it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 140.38it/s]remove invalid data : null / measurement error:  31%|███       | 47/154 [00:00<00:00, 171.56it/s]remove invalid data : null / measurement error:  45%|████▍     | 69/154 [00:00<00:00, 188.69it/s]remove invalid data : null / measurement error:  58%|█████▊    | 90/154 [00:00<00:00, 195.94it/s]remove invalid data : null / measurement error:  75%|███████▍  | 115/154 [00:00<00:00, 213.19it/s]remove invalid data : null / measurement error:  89%|████████▉ | 137/154 [00:00<00:00, 210.94it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 192.94it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.23it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.22it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 250.78it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 250.14it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 207.35it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 223.90it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   3%|▎         | 4/131 [00:00<00:03, 35.85it/s]generate index:   7%|▋         | 9/131 [00:00<00:02, 42.54it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 40.56it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 49.34it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 57.04it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 60.26it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 59.41it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.19it/s]generate index:  44%|████▍     | 58/131 [00:01<00:01, 62.16it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.39it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.84it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 55.21it/s]generate index:  66%|██████▋   | 87/131 [00:01<00:01, 39.37it/s]generate index:  70%|███████   | 92/131 [00:01<00:01, 37.65it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 41.48it/s]generate index:  79%|███████▊  | 103/131 [00:02<00:00, 42.49it/s]generate index:  83%|████████▎ | 109/131 [00:02<00:00, 46.11it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 56.71it/s]generate index:  98%|█████████▊| 129/131 [00:02<00:00, 70.62it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 53.66it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 77.69it/s]remove invalid data : null / measurement error:  16%|█▌        | 30/193 [00:00<00:01, 157.57it/s]remove invalid data : null / measurement error:  27%|██▋       | 52/193 [00:00<00:00, 184.14it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 184.23it/s]remove invalid data : null / measurement error:  47%|████▋     | 90/193 [00:00<00:00, 166.29it/s]remove invalid data : null / measurement error:  55%|█████▌    | 107/193 [00:00<00:00, 148.76it/s]remove invalid data : null / measurement error:  67%|██████▋   | 130/193 [00:00<00:00, 170.53it/s]remove invalid data : null / measurement error:  79%|███████▉  | 152/193 [00:00<00:00, 184.70it/s]remove invalid data : null / measurement error:  90%|████████▉ | 173/193 [00:00<00:00, 190.83it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 177.64it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 248.35it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 251.37it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 250.42it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 247.51it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 246.82it/s]replace nan value:  96%|█████████▌| 153/160 [00:00<00:00, 247.39it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 247.76it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 106.55it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 65.11it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.57it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 76.69it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 83.50it/s]generate index:  38%|███▊      | 61/160 [00:00<00:01, 83.48it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 86.57it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 70.83it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.65it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 61.56it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 55.01it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 51.06it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 61.29it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 62.49it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 57.78it/s]generate index:  87%|████████▋ | 139/160 [00:02<00:00, 55.92it/s]generate index:  92%|█████████▏| 147/160 [00:02<00:00, 61.57it/s]generate index:  97%|█████████▋| 155/160 [00:02<00:00, 61.45it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 64.48it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.132, valid loss : 0.098, train acc : 0.735, valid acc : 0.799, train f1 : 0.735, valid f1 : 0.495

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.64it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.42it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.85it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.20it/s][A
 90%|█████████ | 176/195 [00:00<00:00, 348.42it/s][A100%|██████████| 195/195 [00:00<00:00, 346.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.495
training process:   1%|          | 1/128 [02:00<4:15:35, 120.76s/it]Best score increase :0.495 -> 0.526
training process:   2%|▏         | 2/128 [03:32<3:38:02, 103.83s/it]Best score increase :0.526 -> 0.548
training process:   2%|▏         | 3/128 [05:05<3:26:11, 98.97s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:38<3:19:14, 96.41s/it]epoch : 5, train loss : 0.048, valid loss : 0.058, train acc : 0.932, valid acc : 0.906, train f1 : 0.932, valid f1 : 0.573

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|▉         | 19/195 [00:00<00:00, 182.51it/s][A
 25%|██▌       | 49/195 [00:00<00:00, 247.79it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 283.05it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 300.89it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 312.06it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 318.38it/s][A100%|██████████| 195/195 [00:00<00:00, 300.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.548 -> 0.573
training process:   4%|▍         | 5/128 [08:38<3:34:58, 104.87s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [10:12<3:25:52, 101.25s/it]EarlyStopping counter : 2 out of 40
training process:   5%|▌         | 7/128 [11:48<3:20:50, 99.59s/it] EarlyStopping counter : 3 out of 40
training process:   6%|▋         | 8/128 [13:21<3:14:54, 97.45s/it]epoch : 9, train loss : 0.031, valid loss : 0.094, train acc : 0.960, valid acc : 0.879, train f1 : 0.960, valid f1 : 0.554

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.99it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.01it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.70it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 345.43it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.64it/s][A100%|██████████| 195/195 [00:00<00:00, 343.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   7%|▋         | 9/128 [15:20<3:26:45, 104.24s/it]EarlyStopping counter : 5 out of 40
training process:   8%|▊         | 10/128 [16:53<3:18:16, 100.82s/it]EarlyStopping counter : 6 out of 40
training process:   9%|▊         | 11/128 [18:27<3:12:02, 98.48s/it] EarlyStopping counter : 7 out of 40
training process:   9%|▉         | 12/128 [20:00<3:07:27, 96.96s/it]epoch : 13, train loss : 0.023, valid loss : 0.091, train acc : 0.971, valid acc : 0.909, train f1 : 0.971, valid f1 : 0.571

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 311.72it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 323.88it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 328.52it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 327.47it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 330.57it/s][A100%|██████████| 195/195 [00:00<00:00, 329.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  10%|█         | 13/128 [21:58<3:17:56, 103.27s/it]Best score increase :0.573 -> 0.582
training process:  11%|█         | 14/128 [23:31<3:10:13, 100.12s/it]Best score increase :0.582 -> 0.584
training process:  12%|█▏        | 15/128 [25:05<3:05:20, 98.41s/it] EarlyStopping counter : 1 out of 40
training process:  12%|█▎        | 16/128 [26:38<3:00:26, 96.67s/it]epoch : 17, train loss : 0.018, valid loss : 0.065, train acc : 0.978, valid acc : 0.931, train f1 : 0.978, valid f1 : 0.599

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 313.69it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.94it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.83it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 332.71it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.76it/s][A100%|██████████| 195/195 [00:00<00:00, 332.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.584 -> 0.599
training process:  13%|█▎        | 17/128 [28:35<3:10:15, 102.84s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [30:09<3:03:33, 100.12s/it]EarlyStopping counter : 2 out of 40
training process:  15%|█▍        | 19/128 [31:41<2:57:42, 97.82s/it] EarlyStopping counter : 3 out of 40
training process:  16%|█▌        | 20/128 [33:12<2:52:24, 95.79s/it]epoch : 21, train loss : 0.016, valid loss : 0.088, train acc : 0.981, valid acc : 0.919, train f1 : 0.981, valid f1 : 0.584

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 313.61it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.88it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.60it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.34it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 334.52it/s][A100%|██████████| 195/195 [00:00<00:00, 332.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  16%|█▋        | 21/128 [35:09<3:01:50, 101.96s/it]Best score increase :0.599 -> 0.606
training process:  17%|█▋        | 22/128 [36:43<2:55:52, 99.55s/it] EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [38:14<2:49:55, 97.10s/it]EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [39:48<2:46:31, 96.07s/it]epoch : 25, train loss : 0.014, valid loss : 0.057, train acc : 0.984, valid acc : 0.944, train f1 : 0.984, valid f1 : 0.615

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 314.36it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.44it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.19it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.35it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 332.85it/s][A100%|██████████| 195/195 [00:00<00:00, 330.60it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.606 -> 0.615
training process:  20%|█▉        | 25/128 [41:46<2:56:39, 102.91s/it]Best score increase :0.615 -> 0.629
training process:  20%|██        | 26/128 [43:22<2:50:58, 100.57s/it]EarlyStopping counter : 1 out of 40
training process:  21%|██        | 27/128 [44:55<2:45:44, 98.46s/it] EarlyStopping counter : 2 out of 40
training process:  22%|██▏       | 28/128 [46:26<2:40:15, 96.16s/it]epoch : 29, train loss : 0.012, valid loss : 0.064, train acc : 0.986, valid acc : 0.944, train f1 : 0.986, valid f1 : 0.611

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 304.58it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 324.65it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.45it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.41it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.67it/s][A100%|██████████| 195/195 [00:00<00:00, 334.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 29/128 [48:25<2:49:51, 102.94s/it]EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 30/128 [49:57<2:42:55, 99.75s/it] EarlyStopping counter : 5 out of 40
training process:  24%|██▍       | 31/128 [51:31<2:38:19, 97.93s/it]EarlyStopping counter : 6 out of 40
training process:  25%|██▌       | 32/128 [53:04<2:34:43, 96.70s/it]epoch : 33, train loss : 0.010, valid loss : 0.052, train acc : 0.988, valid acc : 0.958, train f1 : 0.988, valid f1 : 0.641

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▌        | 30/195 [00:00<00:00, 295.88it/s][A
 32%|███▏      | 63/195 [00:00<00:00, 313.00it/s][A
 49%|████▉     | 96/195 [00:00<00:00, 319.66it/s][A
 66%|██████▌   | 129/195 [00:00<00:00, 323.22it/s][A
 83%|████████▎ | 162/195 [00:00<00:00, 320.57it/s][A
100%|██████████| 195/195 [00:00<00:00, 323.10it/s][A100%|██████████| 195/195 [00:00<00:00, 320.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.629 -> 0.641
training process:  26%|██▌       | 33/128 [55:04<2:43:58, 103.57s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [56:38<2:37:41, 100.65s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [58:10<2:32:10, 98.18s/it] Best score increase :0.641 -> 0.651
training process:  28%|██▊       | 36/128 [59:44<2:28:17, 96.71s/it]epoch : 37, train loss : 0.009, valid loss : 0.049, train acc : 0.989, valid acc : 0.958, train f1 : 0.989, valid f1 : 0.651

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 314.10it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.77it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.86it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 332.02it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 330.54it/s][A100%|██████████| 195/195 [00:00<00:00, 329.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  29%|██▉       | 37/128 [1:01:44<2:37:37, 103.93s/it]EarlyStopping counter : 2 out of 40
training process:  30%|██▉       | 38/128 [1:03:17<2:30:44, 100.50s/it]EarlyStopping counter : 3 out of 40
training process:  30%|███       | 39/128 [1:04:53<2:26:56, 99.06s/it] EarlyStopping counter : 4 out of 40
training process:  31%|███▏      | 40/128 [1:06:24<2:21:58, 96.80s/it]epoch : 41, train loss : 0.008, valid loss : 0.056, train acc : 0.991, valid acc : 0.959, train f1 : 0.991, valid f1 : 0.641

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 302.63it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 314.73it/s][A
 50%|█████     | 98/195 [00:00<00:00, 322.85it/s][A
 68%|██████▊   | 132/195 [00:00<00:00, 327.27it/s][A
 85%|████████▌ | 166/195 [00:00<00:00, 329.62it/s][A100%|██████████| 195/195 [00:00<00:00, 326.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  32%|███▏      | 41/128 [1:08:26<2:31:20, 104.38s/it]EarlyStopping counter : 6 out of 40
training process:  33%|███▎      | 42/128 [1:10:00<2:25:09, 101.28s/it]EarlyStopping counter : 7 out of 40
training process:  34%|███▎      | 43/128 [1:11:35<2:20:32, 99.21s/it] EarlyStopping counter : 8 out of 40
training process:  34%|███▍      | 44/128 [1:13:09<2:16:44, 97.67s/it]epoch : 45, train loss : 0.008, valid loss : 0.074, train acc : 0.992, valid acc : 0.946, train f1 : 0.992, valid f1 : 0.617

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 307.78it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 321.46it/s][A
 51%|█████     | 99/195 [00:00<00:00, 326.90it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 329.77it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 331.35it/s][A100%|██████████| 195/195 [00:00<00:00, 328.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  35%|███▌      | 45/128 [1:15:08<2:23:55, 104.04s/it]EarlyStopping counter : 10 out of 40
training process:  36%|███▌      | 46/128 [1:16:40<2:17:35, 100.68s/it]EarlyStopping counter : 11 out of 40
training process:  37%|███▋      | 47/128 [1:18:13<2:12:32, 98.18s/it] EarlyStopping counter : 12 out of 40
training process:  38%|███▊      | 48/128 [1:19:44<2:08:17, 96.22s/it]epoch : 49, train loss : 0.007, valid loss : 0.063, train acc : 0.993, valid acc : 0.959, train f1 : 0.993, valid f1 : 0.650

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▌        | 30/195 [00:00<00:00, 297.77it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 317.85it/s][A
 50%|████▉     | 97/195 [00:00<00:00, 319.68it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 326.31it/s][A
 85%|████████▍ | 165/195 [00:00<00:00, 330.96it/s][A100%|██████████| 195/195 [00:00<00:00, 327.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  38%|███▊      | 49/128 [1:21:43<2:15:38, 103.02s/it]EarlyStopping counter : 14 out of 40
training process:  39%|███▉      | 50/128 [1:23:15<2:09:21, 99.51s/it] Best score increase :0.651 -> 0.667
training process:  40%|███▉      | 51/128 [1:24:50<2:06:02, 98.21s/it]EarlyStopping counter : 1 out of 40
training process:  41%|████      | 52/128 [1:26:25<2:03:15, 97.31s/it]epoch : 53, train loss : 0.006, valid loss : 0.057, train acc : 0.993, valid acc : 0.960, train f1 : 0.993, valid f1 : 0.646

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 313.53it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 324.82it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.36it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 331.93it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 329.38it/s][A100%|██████████| 195/195 [00:00<00:00, 329.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  41%|████▏     | 53/128 [1:28:23<2:09:25, 103.54s/it]EarlyStopping counter : 3 out of 40
training process:  42%|████▏     | 54/128 [1:29:56<2:03:47, 100.37s/it]EarlyStopping counter : 4 out of 40
training process:  43%|████▎     | 55/128 [1:31:29<1:59:30, 98.23s/it] EarlyStopping counter : 5 out of 40
training process:  44%|████▍     | 56/128 [1:33:01<1:55:33, 96.30s/it]epoch : 57, train loss : 0.007, valid loss : 0.074, train acc : 0.993, valid acc : 0.953, train f1 : 0.993, valid f1 : 0.630

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 301.76it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 318.02it/s][A
 50%|████▉     | 97/195 [00:00<00:00, 322.64it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 326.27it/s][A
 85%|████████▍ | 165/195 [00:00<00:00, 328.35it/s][A100%|██████████| 195/195 [00:00<00:00, 325.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  45%|████▍     | 57/128 [1:35:03<2:03:12, 104.13s/it]EarlyStopping counter : 7 out of 40
training process:  45%|████▌     | 58/128 [1:36:39<1:58:33, 101.62s/it]Best score increase :0.667 -> 0.672
training process:  46%|████▌     | 59/128 [1:38:14<1:54:30, 99.58s/it] EarlyStopping counter : 1 out of 40
training process:  47%|████▋     | 60/128 [1:39:47<1:50:43, 97.69s/it]epoch : 61, train loss : 0.006, valid loss : 0.056, train acc : 0.994, valid acc : 0.971, train f1 : 0.994, valid f1 : 0.672

  0%|          | 0/195 [00:00<?, ?it/s][A
 13%|█▎        | 26/195 [00:00<00:00, 259.66it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 256.24it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 274.59it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 293.31it/s][A
 76%|███████▌  | 148/195 [00:00<00:00, 303.81it/s][A
 93%|█████████▎| 181/195 [00:00<00:00, 310.16it/s][A100%|██████████| 195/195 [00:00<00:00, 297.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  48%|████▊     | 61/128 [1:41:48<1:56:56, 104.73s/it]EarlyStopping counter : 3 out of 40
training process:  48%|████▊     | 62/128 [1:43:22<1:51:21, 101.23s/it]EarlyStopping counter : 4 out of 40
training process:  49%|████▉     | 63/128 [1:44:52<1:46:06, 97.94s/it] EarlyStopping counter : 5 out of 40
training process:  50%|█████     | 64/128 [1:46:24<1:42:32, 96.13s/it]epoch : 65, train loss : 0.005, valid loss : 0.071, train acc : 0.995, valid acc : 0.961, train f1 : 0.995, valid f1 : 0.642

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 305.14it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.52it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.43it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.31it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 332.86it/s][A100%|██████████| 195/195 [00:00<00:00, 330.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  51%|█████     | 65/128 [1:48:21<1:47:37, 102.50s/it]EarlyStopping counter : 7 out of 40
training process:  52%|█████▏    | 66/128 [1:49:55<1:43:06, 99.79s/it] EarlyStopping counter : 8 out of 40
training process:  52%|█████▏    | 67/128 [1:51:27<1:39:15, 97.63s/it]EarlyStopping counter : 9 out of 40
training process:  53%|█████▎    | 68/128 [1:53:00<1:36:15, 96.25s/it]epoch : 69, train loss : 0.005, valid loss : 0.069, train acc : 0.995, valid acc : 0.968, train f1 : 0.995, valid f1 : 0.668

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.55it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.68it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.87it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.59it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.11it/s][A100%|██████████| 195/195 [00:00<00:00, 335.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  54%|█████▍    | 69/128 [1:55:00<1:41:40, 103.39s/it]EarlyStopping counter : 11 out of 40
training process:  55%|█████▍    | 70/128 [1:56:33<1:36:52, 100.22s/it]EarlyStopping counter : 12 out of 40
training process:  55%|█████▌    | 71/128 [1:58:08<1:33:45, 98.70s/it] EarlyStopping counter : 13 out of 40
training process:  56%|█████▋    | 72/128 [1:59:42<1:30:39, 97.14s/it]epoch : 73, train loss : 0.004, valid loss : 0.066, train acc : 0.995, valid acc : 0.968, train f1 : 0.995, valid f1 : 0.667

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.32it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.54it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 340.35it/s][A
 71%|███████   | 138/195 [00:00<00:00, 342.57it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 343.87it/s][A100%|██████████| 195/195 [00:00<00:00, 342.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  57%|█████▋    | 73/128 [2:01:41<1:35:04, 103.71s/it]EarlyStopping counter : 15 out of 40
training process:  58%|█████▊    | 74/128 [2:03:14<1:30:28, 100.52s/it]EarlyStopping counter : 16 out of 40
training process:  59%|█████▊    | 75/128 [2:04:48<1:27:11, 98.70s/it] EarlyStopping counter : 17 out of 40
training process:  59%|█████▉    | 76/128 [2:06:21<1:24:01, 96.95s/it]epoch : 77, train loss : 0.004, valid loss : 0.067, train acc : 0.996, valid acc : 0.972, train f1 : 0.996, valid f1 : 0.677

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 308.86it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 323.33it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.67it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.50it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 331.41it/s][A100%|██████████| 195/195 [00:00<00:00, 329.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.672 -> 0.677
training process:  60%|██████    | 77/128 [2:08:23<1:28:38, 104.29s/it]EarlyStopping counter : 1 out of 40
training process:  61%|██████    | 78/128 [2:09:55<1:23:58, 100.77s/it]EarlyStopping counter : 2 out of 40
training process:  62%|██████▏   | 79/128 [2:11:29<1:20:29, 98.56s/it] EarlyStopping counter : 3 out of 40
training process:  62%|██████▎   | 80/128 [2:13:00<1:17:09, 96.45s/it]epoch : 81, train loss : 0.004, valid loss : 0.064, train acc : 0.996, valid acc : 0.970, train f1 : 0.996, valid f1 : 0.677

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.53it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.64it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.43it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.78it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.63it/s][A100%|██████████| 195/195 [00:00<00:00, 336.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  63%|██████▎   | 81/128 [2:15:00<1:21:03, 103.49s/it]EarlyStopping counter : 5 out of 40
training process:  64%|██████▍   | 82/128 [2:16:33<1:16:55, 100.35s/it]Best score increase :0.677 -> 0.681
training process:  65%|██████▍   | 83/128 [2:18:06<1:13:40, 98.24s/it] EarlyStopping counter : 1 out of 40
training process:  66%|██████▌   | 84/128 [2:19:41<1:11:10, 97.06s/it]epoch : 85, train loss : 0.004, valid loss : 0.073, train acc : 0.996, valid acc : 0.967, train f1 : 0.996, valid f1 : 0.671

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█▏        | 22/195 [00:00<00:00, 213.05it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 261.25it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 292.04it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 249.43it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 245.95it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 269.48it/s][A100%|██████████| 195/195 [00:00<00:00, 268.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  66%|██████▋   | 85/128 [2:21:41<1:14:38, 104.15s/it]EarlyStopping counter : 3 out of 40
training process:  67%|██████▋   | 86/128 [2:23:16<1:10:54, 101.29s/it]EarlyStopping counter : 4 out of 40
training process:  68%|██████▊   | 87/128 [2:24:48<1:07:24, 98.65s/it] EarlyStopping counter : 5 out of 40
training process:  69%|██████▉   | 88/128 [2:26:21<1:04:37, 96.94s/it]epoch : 89, train loss : 0.004, valid loss : 0.064, train acc : 0.997, valid acc : 0.972, train f1 : 0.997, valid f1 : 0.689

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.70it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.09it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.98it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.55it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 339.11it/s][A100%|██████████| 195/195 [00:00<00:00, 336.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.681 -> 0.689
training process:  70%|██████▉   | 89/128 [2:28:24<1:07:58, 104.58s/it]EarlyStopping counter : 1 out of 40
training process:  70%|███████   | 90/128 [2:29:59<1:04:25, 101.71s/it]EarlyStopping counter : 2 out of 40
training process:  71%|███████   | 91/128 [2:31:32<1:01:12, 99.24s/it] EarlyStopping counter : 3 out of 40
training process:  72%|███████▏  | 92/128 [2:33:05<58:17, 97.14s/it]  epoch : 93, train loss : 0.003, valid loss : 0.088, train acc : 0.997, valid acc : 0.968, train f1 : 0.997, valid f1 : 0.667

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 301.42it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.44it/s][A
 51%|█████     | 99/195 [00:00<00:00, 329.97it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 333.71it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 336.87it/s][A100%|██████████| 195/195 [00:00<00:00, 333.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  73%|███████▎  | 93/128 [2:35:05<1:00:47, 104.21s/it]EarlyStopping counter : 5 out of 40
training process:  73%|███████▎  | 94/128 [2:36:38<57:09, 100.86s/it]  EarlyStopping counter : 6 out of 40
training process:  74%|███████▍  | 95/128 [2:38:09<53:49, 97.87s/it] EarlyStopping counter : 7 out of 40
training process:  75%|███████▌  | 96/128 [2:39:40<51:04, 95.77s/it]epoch : 97, train loss : 0.003, valid loss : 0.085, train acc : 0.997, valid acc : 0.973, train f1 : 0.997, valid f1 : 0.685

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.09it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.96it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.46it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.37it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.58it/s][A100%|██████████| 195/195 [00:00<00:00, 335.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  76%|███████▌  | 97/128 [2:41:39<53:06, 102.78s/it]EarlyStopping counter : 9 out of 40
training process:  77%|███████▋  | 98/128 [2:43:10<49:38, 99.30s/it] EarlyStopping counter : 10 out of 40
training process:  77%|███████▋  | 99/128 [2:44:43<47:00, 97.24s/it]EarlyStopping counter : 11 out of 40
training process:  78%|███████▊  | 100/128 [2:46:17<44:56, 96.30s/it]epoch : 101, train loss : 0.004, valid loss : 0.089, train acc : 0.997, valid acc : 0.970, train f1 : 0.997, valid f1 : 0.672

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.89it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.59it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.00it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.11it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 338.38it/s][A100%|██████████| 195/195 [00:00<00:00, 339.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  79%|███████▉  | 101/128 [2:48:16<46:28, 103.29s/it]EarlyStopping counter : 13 out of 40
training process:  80%|███████▉  | 102/128 [2:49:47<43:07, 99.52s/it] EarlyStopping counter : 14 out of 40
training process:  80%|████████  | 103/128 [2:51:19<40:29, 97.20s/it]EarlyStopping counter : 15 out of 40
training process:  81%|████████▏ | 104/128 [2:52:51<38:13, 95.56s/it]epoch : 105, train loss : 0.003, valid loss : 0.084, train acc : 0.997, valid acc : 0.968, train f1 : 0.997, valid f1 : 0.667

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.31it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.65it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.38it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.79it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.53it/s][A100%|██████████| 195/195 [00:00<00:00, 339.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  82%|████████▏ | 105/128 [2:54:52<39:32, 103.13s/it]EarlyStopping counter : 17 out of 40
training process:  83%|████████▎ | 106/128 [2:56:22<36:23, 99.26s/it] EarlyStopping counter : 18 out of 40
training process:  84%|████████▎ | 107/128 [2:57:51<33:39, 96.15s/it]EarlyStopping counter : 19 out of 40
training process:  84%|████████▍ | 108/128 [2:59:24<31:48, 95.43s/it]epoch : 109, train loss : 0.003, valid loss : 0.100, train acc : 0.998, valid acc : 0.966, train f1 : 0.998, valid f1 : 0.655

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.34it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.10it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.98it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.72it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.71it/s][A100%|██████████| 195/195 [00:00<00:00, 337.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  85%|████████▌ | 109/128 [3:01:23<32:23, 102.30s/it]EarlyStopping counter : 21 out of 40
training process:  86%|████████▌ | 110/128 [3:02:57<29:56, 99.81s/it] EarlyStopping counter : 22 out of 40
training process:  87%|████████▋ | 111/128 [3:04:29<27:39, 97.61s/it]EarlyStopping counter : 23 out of 40
training process:  88%|████████▊ | 112/128 [3:06:03<25:41, 96.34s/it]epoch : 113, train loss : 0.003, valid loss : 0.098, train acc : 0.997, valid acc : 0.970, train f1 : 0.997, valid f1 : 0.674

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.90it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.15it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.15it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.41it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.51it/s][A100%|██████████| 195/195 [00:00<00:00, 334.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  88%|████████▊ | 113/128 [3:08:02<25:47, 103.18s/it]EarlyStopping counter : 25 out of 40
training process:  89%|████████▉ | 114/128 [3:09:35<23:21, 100.09s/it]EarlyStopping counter : 26 out of 40
training process:  90%|████████▉ | 115/128 [3:11:08<21:16, 98.23s/it] EarlyStopping counter : 27 out of 40
training process:  91%|█████████ | 116/128 [3:12:41<19:18, 96.51s/it]epoch : 117, train loss : 0.003, valid loss : 0.103, train acc : 0.998, valid acc : 0.971, train f1 : 0.998, valid f1 : 0.677

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.16it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.94it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.20it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.54it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.31it/s][A100%|██████████| 195/195 [00:00<00:00, 343.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  91%|█████████▏| 117/128 [3:14:41<18:57, 103.43s/it]EarlyStopping counter : 29 out of 40
training process:  92%|█████████▏| 118/128 [3:16:14<16:44, 100.50s/it]Best score increase :0.689 -> 0.690
training process:  93%|█████████▎| 119/128 [3:17:49<14:48, 98.74s/it] EarlyStopping counter : 1 out of 40
training process:  94%|█████████▍| 120/128 [3:19:20<12:51, 96.40s/it]epoch : 121, train loss : 0.003, valid loss : 0.099, train acc : 0.998, valid acc : 0.974, train f1 : 0.998, valid f1 : 0.689

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.53it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.50it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.86it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.04it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.26it/s][A100%|██████████| 195/195 [00:00<00:00, 336.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  95%|█████████▍| 121/128 [3:21:17<11:58, 102.69s/it]EarlyStopping counter : 3 out of 40
training process:  95%|█████████▌| 122/128 [3:22:49<09:56, 99.41s/it] EarlyStopping counter : 4 out of 40
training process:  96%|█████████▌| 123/128 [3:24:24<08:10, 98.13s/it]EarlyStopping counter : 5 out of 40
training process:  97%|█████████▋| 124/128 [3:25:57<06:26, 96.54s/it]epoch : 125, train loss : 0.003, valid loss : 0.106, train acc : 0.998, valid acc : 0.972, train f1 : 0.998, valid f1 : 0.686

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 209.54it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 265.43it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 295.77it/s][A
 62%|██████▏   | 120/195 [00:00<00:00, 309.97it/s][A
 79%|███████▉  | 154/195 [00:00<00:00, 318.03it/s][A
 96%|█████████▋| 188/195 [00:00<00:00, 323.07it/s][A100%|██████████| 195/195 [00:00<00:00, 308.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  98%|█████████▊| 125/128 [3:27:56<05:09, 103.31s/it]EarlyStopping counter : 7 out of 40
training process:  98%|█████████▊| 126/128 [3:29:30<03:21, 100.54s/it]EarlyStopping counter : 8 out of 40
training process:  99%|█████████▉| 127/128 [3:31:03<01:38, 98.40s/it] EarlyStopping counter : 9 out of 40
training process: 100%|██████████| 128/128 [3:32:35<00:00, 96.43s/it]training process: 100%|██████████| 128/128 [3:32:35<00:00, 99.65s/it]
training process finished, best loss : 0.101 and best acc : 0.974, best f1 : 0.691, best epoch : 127

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.43      0.38      0.40       303
           1       0.99      0.99      0.99     16947

    accuracy                           0.98     17250
   macro avg       0.71      0.68      0.69     17250
weighted avg       0.98      0.98      0.98     17250


# test acc : 0.98, test f1 : 0.69, test AUC : 0.68, test loss : 23.749

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:13<03:40, 13.75s/it]processing for feature importance:  12%|█▏        | 2/17 [00:26<03:15, 13.04s/it]processing for feature importance:  18%|█▊        | 3/17 [00:42<03:20, 14.35s/it]processing for feature importance:  24%|██▎       | 4/17 [00:54<02:58, 13.73s/it]processing for feature importance:  29%|██▉       | 5/17 [01:08<02:43, 13.63s/it]processing for feature importance:  35%|███▌      | 6/17 [01:21<02:26, 13.35s/it]processing for feature importance:  41%|████      | 7/17 [01:33<02:10, 13.09s/it]processing for feature importance:  47%|████▋     | 8/17 [01:47<01:58, 13.14s/it]processing for feature importance:  53%|█████▎    | 9/17 [02:01<01:48, 13.52s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:14<01:33, 13.38s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:27<01:20, 13.34s/it]processing for feature importance:  71%|███████   | 12/17 [02:40<01:05, 13.16s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:53<00:52, 13.04s/it]processing for feature importance:  82%|████████▏ | 14/17 [03:06<00:39, 13.07s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:19<00:26, 13.17s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:32<00:13, 13.16s/it]processing for feature importance: 100%|██████████| 17/17 [03:45<00:00, 13.07s/it]processing for feature importance: 100%|██████████| 17/17 [03:45<00:00, 13.28s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:02<10:19,  2.95s/it]visualize 2D latent space:   1%|          | 2/211 [00:03<06:44,  1.94s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<01:56,  1.74s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:01<00:54,  1.22it/s]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:50,  1.67s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<12:59,  3.71s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<09:20,  2.68s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:10,  1.95s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:30,  1.37s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 17%|█▋        | 33/195 [00:00<00:00, 323.29it/s] 35%|███▌      | 69/195 [00:00<00:00, 339.37it/s] 54%|█████▍    | 105/195 [00:00<00:00, 344.40it/s] 72%|███████▏  | 141/195 [00:00<00:00, 346.66it/s] 90%|█████████ | 176/195 [00:00<00:00, 347.82it/s]100%|██████████| 195/195 [00:00<00:00, 345.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 199.93it/s]remove invalid data : null / measurement error:   7%|▋         | 41/616 [00:00<00:02, 198.00it/s]remove invalid data : null / measurement error:  10%|▉         | 61/616 [00:00<00:02, 195.98it/s]remove invalid data : null / measurement error:  13%|█▎        | 82/616 [00:00<00:02, 198.48it/s]remove invalid data : null / measurement error:  17%|█▋        | 103/616 [00:00<00:02, 200.63it/s]remove invalid data : null / measurement error:  20%|██        | 124/616 [00:00<00:02, 203.48it/s]remove invalid data : null / measurement error:  24%|██▎       | 145/616 [00:00<00:02, 205.19it/s]remove invalid data : null / measurement error:  27%|██▋       | 167/616 [00:00<00:02, 207.81it/s]remove invalid data : null / measurement error:  31%|███       | 188/616 [00:00<00:02, 205.56it/s]remove invalid data : null / measurement error:  34%|███▍      | 209/616 [00:01<00:01, 204.86it/s]remove invalid data : null / measurement error:  37%|███▋      | 230/616 [00:01<00:01, 205.45it/s]remove invalid data : null / measurement error:  41%|████      | 251/616 [00:01<00:01, 204.32it/s]remove invalid data : null / measurement error:  44%|████▍     | 272/616 [00:01<00:01, 205.24it/s]remove invalid data : null / measurement error:  48%|████▊     | 293/616 [00:01<00:01, 203.94it/s]remove invalid data : null / measurement error:  51%|█████     | 314/616 [00:01<00:01, 202.58it/s]remove invalid data : null / measurement error:  54%|█████▍    | 335/616 [00:01<00:01, 202.23it/s]remove invalid data : null / measurement error:  58%|█████▊    | 356/616 [00:01<00:01, 201.46it/s]remove invalid data : null / measurement error:  62%|██████▏   | 381/616 [00:01<00:01, 214.46it/s]remove invalid data : null / measurement error:  66%|██████▌   | 407/616 [00:01<00:00, 226.81it/s]remove invalid data : null / measurement error:  70%|██████▉   | 431/616 [00:02<00:00, 228.77it/s]remove invalid data : null / measurement error:  74%|███████▍  | 455/616 [00:02<00:00, 230.70it/s]remove invalid data : null / measurement error:  78%|███████▊  | 479/616 [00:02<00:00, 223.28it/s]remove invalid data : null / measurement error:  81%|████████▏ | 502/616 [00:02<00:00, 216.47it/s]remove invalid data : null / measurement error:  85%|████████▌ | 524/616 [00:02<00:00, 213.91it/s]remove invalid data : null / measurement error:  89%|████████▊ | 546/616 [00:02<00:00, 209.61it/s]remove invalid data : null / measurement error:  92%|█████████▏| 568/616 [00:02<00:00, 207.20it/s]remove invalid data : null / measurement error:  96%|█████████▌| 589/616 [00:02<00:00, 205.65it/s]remove invalid data : null / measurement error:  99%|█████████▉| 610/616 [00:02<00:00, 204.14it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 208.33it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 233.70it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 233.36it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 233.98it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 236.37it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 237.61it/s]replace nan value:  28%|██▊       | 146/515 [00:00<00:01, 236.63it/s]replace nan value:  33%|███▎      | 171/515 [00:00<00:01, 238.05it/s]replace nan value:  38%|███▊      | 196/515 [00:00<00:01, 238.83it/s]replace nan value:  43%|████▎     | 221/515 [00:00<00:01, 239.54it/s]replace nan value:  48%|████▊     | 246/515 [00:01<00:01, 241.74it/s]replace nan value:  53%|█████▎    | 271/515 [00:01<00:01, 242.60it/s]replace nan value:  57%|█████▋    | 296/515 [00:01<00:00, 241.28it/s]replace nan value:  62%|██████▏   | 321/515 [00:01<00:00, 241.04it/s]replace nan value:  67%|██████▋   | 346/515 [00:01<00:00, 238.66it/s]replace nan value:  72%|███████▏  | 371/515 [00:01<00:00, 239.17it/s]replace nan value:  77%|███████▋  | 396/515 [00:01<00:00, 239.95it/s]replace nan value:  82%|████████▏ | 420/515 [00:01<00:00, 239.30it/s]replace nan value:  86%|████████▌ | 444/515 [00:01<00:00, 237.53it/s]replace nan value:  91%|█████████ | 469/515 [00:01<00:00, 238.49it/s]replace nan value:  96%|█████████▌| 494/515 [00:02<00:00, 239.49it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 238.89it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.09it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.69it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.42it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.62it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.96it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.01it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.99it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.36it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 53.89it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 52.46it/s]generate index:  17%|█▋        | 88/515 [00:01<00:07, 60.25it/s]generate index:  18%|█▊        | 95/515 [00:01<00:07, 59.84it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 57.76it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 63.80it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.30it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.30it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 69.59it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 70.55it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 69.48it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.18it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 70.31it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.08it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.25it/s]generate index:  37%|███▋      | 191/515 [00:03<00:04, 68.17it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 67.02it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 65.57it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 86.80it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 83.88it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 80.21it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 82.05it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 67.02it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 72.99it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 75.88it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.70it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.74it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.28it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 61.19it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 60.98it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 60.45it/s]generate index:  64%|██████▎   | 328/515 [00:05<00:02, 64.57it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.96it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.86it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 43.93it/s]generate index:  69%|██████▊   | 354/515 [00:05<00:03, 49.55it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 56.85it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 71.48it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 75.06it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 71.78it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 72.64it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 61.82it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 63.91it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.47it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 54.93it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.75it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.84it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.61it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.52it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.28it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.06it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.39it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.09it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.38it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 66.80it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 147.35it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 174.07it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 189.08it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 195.68it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 210.72it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 208.18it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 192.53it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 246.86it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 249.27it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 249.91it/s]replace nan value:  78%|███████▊  | 102/131 [00:00<00:00, 247.34it/s]replace nan value:  98%|█████████▊| 128/131 [00:00<00:00, 249.80it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 249.10it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.16it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.11it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.30it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.28it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.39it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.61it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.87it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 62.94it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.92it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.85it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.17it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.61it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.54it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.15it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.65it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 55.41it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 64.09it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.10it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/193 [00:00<00:03, 49.66it/s]remove invalid data : null / measurement error:  13%|█▎        | 26/193 [00:00<00:01, 143.55it/s]remove invalid data : null / measurement error:  24%|██▍       | 47/193 [00:00<00:00, 172.62it/s]remove invalid data : null / measurement error:  36%|███▌      | 69/193 [00:00<00:00, 188.24it/s]remove invalid data : null / measurement error:  47%|████▋     | 91/193 [00:00<00:00, 198.14it/s]remove invalid data : null / measurement error:  58%|█████▊    | 112/193 [00:00<00:00, 199.41it/s]remove invalid data : null / measurement error:  71%|███████   | 137/193 [00:00<00:00, 214.31it/s]remove invalid data : null / measurement error:  82%|████████▏ | 159/193 [00:00<00:00, 213.85it/s]remove invalid data : null / measurement error:  94%|█████████▍| 181/193 [00:00<00:00, 210.89it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 196.06it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 249.48it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 251.92it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 251.08it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 247.68it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 247.12it/s]replace nan value:  96%|█████████▌| 153/160 [00:00<00:00, 247.52it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 248.04it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 100.90it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.44it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.00it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.64it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.74it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.32it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.27it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.10it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.45it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.22it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.84it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.07it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.83it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.96it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.42it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.24it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.16it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 62.30it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.95it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.006, valid loss : 0.005, train acc : 0.632, valid acc : 0.667, train f1 : 0.412, valid f1 : 0.430

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 193.19it/s][A
 23%|██▎       | 45/195 [00:00<00:00, 225.16it/s][A
 38%|███▊      | 74/195 [00:00<00:00, 254.25it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 259.89it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 286.06it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 302.63it/s][A100%|██████████| 195/195 [00:00<00:00, 283.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.430
training process:   1%|          | 1/128 [02:00<4:14:35, 120.28s/it]Best score increase :0.430 -> 0.504
training process:   2%|▏         | 2/128 [03:29<3:34:29, 102.14s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [04:58<3:19:38, 95.83s/it] Best score increase :0.504 -> 0.518
training process:   3%|▎         | 4/128 [06:24<3:10:38, 92.24s/it]epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.786, valid acc : 0.724, train f1 : 0.496, valid f1 : 0.463

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.59it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 339.49it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.80it/s][A
 71%|███████   | 138/195 [00:00<00:00, 342.95it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 343.62it/s][A100%|██████████| 195/195 [00:00<00:00, 342.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   4%|▍         | 5/128 [08:19<3:25:31, 100.25s/it]Best score increase :0.518 -> 0.535
training process:   5%|▍         | 6/128 [09:46<3:14:31, 95.67s/it] Best score increase :0.535 -> 0.561
training process:   5%|▌         | 7/128 [11:12<3:06:35, 92.52s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:39<3:01:59, 90.99s/it]epoch : 9, train loss : 0.004, valid loss : 0.004, train acc : 0.851, valid acc : 0.857, train f1 : 0.538, valid f1 : 0.534

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.06it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.77it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.41it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.24it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 347.70it/s][A100%|██████████| 195/195 [00:00<00:00, 346.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:36<3:16:37, 99.14s/it]Best score increase :0.561 -> 0.587
training process:   8%|▊         | 10/128 [16:09<3:10:56, 97.09s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [17:42<3:07:08, 95.97s/it]Best score increase :0.587 -> 0.589
training process:   9%|▉         | 12/128 [19:16<3:04:13, 95.29s/it]epoch : 13, train loss : 0.003, valid loss : 0.004, train acc : 0.890, valid acc : 0.909, train f1 : 0.573, valid f1 : 0.583

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.39it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 343.38it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 344.06it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 344.57it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 345.02it/s][A100%|██████████| 195/195 [00:00<00:00, 344.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  10%|█         | 13/128 [21:15<3:16:11, 102.36s/it]EarlyStopping counter : 2 out of 40
training process:  11%|█         | 14/128 [22:43<3:06:40, 98.25s/it] EarlyStopping counter : 3 out of 40
training process:  12%|█▏        | 15/128 [24:11<2:59:02, 95.07s/it]EarlyStopping counter : 4 out of 40
training process:  12%|█▎        | 16/128 [25:40<2:54:15, 93.35s/it]epoch : 17, train loss : 0.003, valid loss : 0.004, train acc : 0.906, valid acc : 0.870, train f1 : 0.594, valid f1 : 0.551

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.79it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.42it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 334.26it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.72it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 336.57it/s][A100%|██████████| 195/195 [00:00<00:00, 336.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  13%|█▎        | 17/128 [27:35<3:04:32, 99.75s/it]EarlyStopping counter : 6 out of 40
training process:  14%|█▍        | 18/128 [29:03<2:56:34, 96.31s/it]EarlyStopping counter : 7 out of 40
training process:  15%|█▍        | 19/128 [30:31<2:50:04, 93.62s/it]EarlyStopping counter : 8 out of 40
training process:  16%|█▌        | 20/128 [32:01<2:46:46, 92.65s/it]epoch : 21, train loss : 0.003, valid loss : 0.005, train acc : 0.919, valid acc : 0.929, train f1 : 0.616, valid f1 : 0.610

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.84it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.47it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.70it/s][A
 70%|███████   | 137/195 [00:00<00:00, 340.39it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 341.90it/s][A100%|██████████| 195/195 [00:00<00:00, 339.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.589 -> 0.610
training process:  16%|█▋        | 21/128 [33:54<2:56:01, 98.71s/it]EarlyStopping counter : 1 out of 40
training process:  17%|█▋        | 22/128 [35:22<2:48:30, 95.38s/it]EarlyStopping counter : 2 out of 40
training process:  18%|█▊        | 23/128 [36:47<2:41:36, 92.34s/it]EarlyStopping counter : 3 out of 40
training process:  19%|█▉        | 24/128 [38:15<2:38:06, 91.21s/it]epoch : 25, train loss : 0.003, valid loss : 0.005, train acc : 0.937, valid acc : 0.881, train f1 : 0.645, valid f1 : 0.558

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 344.10it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 347.29it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 348.35it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 348.88it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 348.74it/s][A100%|██████████| 195/195 [00:00<00:00, 348.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  20%|█▉        | 25/128 [40:10<2:48:50, 98.35s/it]EarlyStopping counter : 5 out of 40
training process:  20%|██        | 26/128 [41:41<2:43:11, 96.00s/it]EarlyStopping counter : 6 out of 40
training process:  21%|██        | 27/128 [43:13<2:39:28, 94.74s/it]Best score increase :0.610 -> 0.619
training process:  22%|██▏       | 28/128 [44:43<2:35:30, 93.30s/it]epoch : 29, train loss : 0.002, valid loss : 0.006, train acc : 0.942, valid acc : 0.933, train f1 : 0.663, valid f1 : 0.614

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.41it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.64it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.68it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.68it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.27it/s][A100%|██████████| 195/195 [00:00<00:00, 343.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 29/128 [46:36<2:43:47, 99.27s/it]EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 30/128 [48:08<2:38:51, 97.26s/it]EarlyStopping counter : 3 out of 40
training process:  24%|██▍       | 31/128 [49:41<2:35:04, 95.92s/it]EarlyStopping counter : 4 out of 40
training process:  25%|██▌       | 32/128 [51:15<2:32:14, 95.15s/it]epoch : 33, train loss : 0.002, valid loss : 0.006, train acc : 0.953, valid acc : 0.935, train f1 : 0.687, valid f1 : 0.620

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.76it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 331.25it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.73it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.53it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.07it/s][A100%|██████████| 195/195 [00:00<00:00, 339.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.619 -> 0.620
training process:  26%|██▌       | 33/128 [53:14<2:42:05, 102.38s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [54:36<2:31:07, 96.46s/it] EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [56:01<2:23:48, 92.78s/it]Best score increase :0.620 -> 0.628
training process:  28%|██▊       | 36/128 [57:25<2:18:18, 90.20s/it]epoch : 37, train loss : 0.002, valid loss : 0.009, train acc : 0.960, valid acc : 0.943, train f1 : 0.712, valid f1 : 0.625

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.31it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.61it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.35it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.73it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.62it/s][A100%|██████████| 195/195 [00:00<00:00, 343.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  29%|██▉       | 37/128 [59:12<2:24:22, 95.20s/it]Best score increase :0.628 -> 0.671
training process:  30%|██▉       | 38/128 [1:00:43<2:21:02, 94.03s/it]EarlyStopping counter : 1 out of 40
training process:  30%|███       | 39/128 [1:02:16<2:18:55, 93.66s/it]EarlyStopping counter : 2 out of 40
training process:  31%|███▏      | 40/128 [1:03:44<2:14:55, 92.00s/it]epoch : 41, train loss : 0.002, valid loss : 0.011, train acc : 0.963, valid acc : 0.954, train f1 : 0.724, valid f1 : 0.639

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 275.29it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 280.06it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 281.74it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 282.38it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 282.97it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 281.57it/s][A100%|██████████| 195/195 [00:00<00:00, 281.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  32%|███▏      | 41/128 [1:05:40<2:23:50, 99.21s/it]EarlyStopping counter : 4 out of 40
training process:  33%|███▎      | 42/128 [1:07:10<2:18:09, 96.39s/it]EarlyStopping counter : 5 out of 40
training process:  34%|███▎      | 43/128 [1:08:38<2:13:08, 93.99s/it]EarlyStopping counter : 6 out of 40
training process:  34%|███▍      | 44/128 [1:10:07<2:09:26, 92.45s/it]epoch : 45, train loss : 0.002, valid loss : 0.009, train acc : 0.969, valid acc : 0.937, train f1 : 0.747, valid f1 : 0.618

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.38it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.85it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.35it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.75it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.70it/s][A100%|██████████| 195/195 [00:00<00:00, 340.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  35%|███▌      | 45/128 [1:12:00<2:16:28, 98.65s/it]EarlyStopping counter : 8 out of 40
training process:  36%|███▌      | 46/128 [1:13:29<2:10:39, 95.61s/it]EarlyStopping counter : 9 out of 40
training process:  37%|███▋      | 47/128 [1:14:58<2:06:36, 93.78s/it]EarlyStopping counter : 10 out of 40
training process:  38%|███▊      | 48/128 [1:16:29<2:03:39, 92.75s/it]epoch : 49, train loss : 0.002, valid loss : 0.012, train acc : 0.972, valid acc : 0.965, train f1 : 0.762, valid f1 : 0.672

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.58it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 338.65it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 342.94it/s][A
 71%|███████   | 138/195 [00:00<00:00, 345.25it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 346.60it/s][A100%|██████████| 195/195 [00:00<00:00, 344.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  38%|███▊      | 49/128 [1:18:24<2:11:04, 99.55s/it]EarlyStopping counter : 12 out of 40
training process:  39%|███▉      | 50/128 [1:19:54<2:05:36, 96.62s/it]Best score increase :0.671 -> 0.675
training process:  40%|███▉      | 51/128 [1:21:23<2:01:01, 94.31s/it]EarlyStopping counter : 1 out of 40
training process:  41%|████      | 52/128 [1:22:52<1:57:45, 92.96s/it]epoch : 53, train loss : 0.002, valid loss : 0.012, train acc : 0.975, valid acc : 0.953, train f1 : 0.779, valid f1 : 0.645

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.64it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.91it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.02it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.33it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 336.60it/s][A100%|██████████| 195/195 [00:00<00:00, 336.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  41%|████▏     | 53/128 [1:24:47<2:04:22, 99.51s/it]EarlyStopping counter : 3 out of 40
training process:  42%|████▏     | 54/128 [1:26:17<1:59:17, 96.72s/it]EarlyStopping counter : 4 out of 40
training process:  43%|████▎     | 55/128 [1:27:46<1:54:47, 94.35s/it]EarlyStopping counter : 5 out of 40
training process:  44%|████▍     | 56/128 [1:29:17<1:51:57, 93.30s/it]epoch : 57, train loss : 0.002, valid loss : 0.015, train acc : 0.979, valid acc : 0.957, train f1 : 0.796, valid f1 : 0.649

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.66it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.76it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 334.75it/s][A
 71%|███████   | 138/195 [00:00<00:00, 337.68it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.60it/s][A100%|██████████| 195/195 [00:00<00:00, 338.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  45%|████▍     | 57/128 [1:31:12<1:57:57, 99.68s/it]EarlyStopping counter : 7 out of 40
training process:  45%|████▌     | 58/128 [1:32:42<1:53:03, 96.90s/it]EarlyStopping counter : 8 out of 40
training process:  46%|████▌     | 59/128 [1:34:11<1:48:47, 94.60s/it]EarlyStopping counter : 9 out of 40
training process:  47%|████▋     | 60/128 [1:35:42<1:45:54, 93.44s/it]epoch : 61, train loss : 0.001, valid loss : 0.013, train acc : 0.981, valid acc : 0.944, train f1 : 0.810, valid f1 : 0.627

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.02it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.29it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.70it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.03it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.98it/s][A100%|██████████| 195/195 [00:00<00:00, 343.73it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  48%|████▊     | 61/128 [1:37:33<1:50:09, 98.65s/it]EarlyStopping counter : 11 out of 40
training process:  48%|████▊     | 62/128 [1:39:05<1:46:21, 96.68s/it]EarlyStopping counter : 12 out of 40
training process:  49%|████▉     | 63/128 [1:40:38<1:43:35, 95.63s/it]EarlyStopping counter : 13 out of 40
training process:  50%|█████     | 64/128 [1:42:12<1:41:24, 95.07s/it]epoch : 65, train loss : 0.001, valid loss : 0.015, train acc : 0.983, valid acc : 0.957, train f1 : 0.823, valid f1 : 0.652

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.04it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.44it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.04it/s][A
 70%|███████   | 137/195 [00:00<00:00, 337.71it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.10it/s][A100%|██████████| 195/195 [00:00<00:00, 338.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  51%|█████     | 65/128 [1:44:10<1:47:09, 102.05s/it]EarlyStopping counter : 15 out of 40
training process:  52%|█████▏    | 66/128 [1:45:43<1:42:26, 99.13s/it] EarlyStopping counter : 16 out of 40
training process:  52%|█████▏    | 67/128 [1:47:14<1:38:33, 96.95s/it]EarlyStopping counter : 17 out of 40
training process:  53%|█████▎    | 68/128 [1:48:47<1:35:36, 95.62s/it]epoch : 69, train loss : 0.001, valid loss : 0.018, train acc : 0.984, valid acc : 0.957, train f1 : 0.831, valid f1 : 0.652

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.01it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.68it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.84it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.98it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 345.12it/s][A100%|██████████| 195/195 [00:00<00:00, 343.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  54%|█████▍    | 69/128 [1:50:45<1:40:47, 102.49s/it]EarlyStopping counter : 19 out of 40
training process:  55%|█████▍    | 70/128 [1:52:13<1:34:44, 98.01s/it] EarlyStopping counter : 20 out of 40
training process:  55%|█████▌    | 71/128 [1:53:42<1:30:34, 95.35s/it]EarlyStopping counter : 21 out of 40
training process:  56%|█████▋    | 72/128 [1:55:12<1:27:28, 93.72s/it]epoch : 73, train loss : 0.001, valid loss : 0.016, train acc : 0.987, valid acc : 0.945, train f1 : 0.852, valid f1 : 0.622

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.52it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.84it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 338.19it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.68it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 261.99it/s][A100%|██████████| 195/195 [00:00<00:00, 285.73it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  57%|█████▋    | 73/128 [1:57:06<1:31:24, 99.72s/it]EarlyStopping counter : 23 out of 40
training process:  58%|█████▊    | 74/128 [1:58:34<1:26:45, 96.41s/it]EarlyStopping counter : 24 out of 40
training process:  59%|█████▊    | 75/128 [2:00:04<1:23:22, 94.39s/it]EarlyStopping counter : 25 out of 40
training process:  59%|█████▉    | 76/128 [2:01:32<1:20:08, 92.47s/it]epoch : 77, train loss : 0.001, valid loss : 0.022, train acc : 0.987, valid acc : 0.959, train f1 : 0.858, valid f1 : 0.641

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.56it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.43it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.39it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 346.93it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 347.36it/s][A100%|██████████| 195/195 [00:00<00:00, 346.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  60%|██████    | 77/128 [2:03:25<1:23:41, 98.45s/it]EarlyStopping counter : 27 out of 40
training process:  61%|██████    | 78/128 [2:04:53<1:19:38, 95.58s/it]EarlyStopping counter : 28 out of 40
training process:  62%|██████▏   | 79/128 [2:06:24<1:16:44, 93.97s/it]EarlyStopping counter : 29 out of 40
training process:  62%|██████▎   | 80/128 [2:07:53<1:14:00, 92.51s/it]epoch : 81, train loss : 0.001, valid loss : 0.023, train acc : 0.987, valid acc : 0.963, train f1 : 0.859, valid f1 : 0.660

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.66it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.18it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.54it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.89it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.63it/s][A100%|██████████| 195/195 [00:00<00:00, 339.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  63%|██████▎   | 81/128 [2:09:48<1:17:50, 99.38s/it]EarlyStopping counter : 31 out of 40
training process:  64%|██████▍   | 82/128 [2:11:21<1:14:45, 97.51s/it]EarlyStopping counter : 32 out of 40
training process:  65%|██████▍   | 83/128 [2:12:54<1:12:08, 96.18s/it]EarlyStopping counter : 33 out of 40
training process:  66%|██████▌   | 84/128 [2:14:28<1:10:02, 95.51s/it]epoch : 85, train loss : 0.001, valid loss : 0.024, train acc : 0.990, valid acc : 0.963, train f1 : 0.880, valid f1 : 0.655

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.89it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.65it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 346.35it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 347.48it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 348.13it/s][A100%|██████████| 195/195 [00:00<00:00, 346.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 34 out of 40
training process:  66%|██████▋   | 85/128 [2:16:29<1:13:44, 102.90s/it]EarlyStopping counter : 35 out of 40
training process:  67%|██████▋   | 86/128 [2:18:00<1:09:37, 99.47s/it] EarlyStopping counter : 36 out of 40
training process:  68%|██████▊   | 87/128 [2:19:31<1:06:12, 96.90s/it]EarlyStopping counter : 37 out of 40
training process:  69%|██████▉   | 88/128 [2:21:03<1:03:34, 95.35s/it]epoch : 89, train loss : 0.001, valid loss : 0.022, train acc : 0.990, valid acc : 0.953, train f1 : 0.883, valid f1 : 0.636

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 347.01it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 352.61it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 352.38it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 354.09it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 354.93it/s][A100%|██████████| 195/195 [00:00<00:00, 353.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 38 out of 40
training process:  70%|██████▉   | 89/128 [2:23:00<1:06:18, 102.01s/it]EarlyStopping counter : 39 out of 40
training process:  70%|███████   | 90/128 [2:24:28<1:01:57, 97.84s/it] EarlyStopping counter : 40 out of 40
Early stopping | epoch : 90, best f1 score : 0.675
training process:  70%|███████   | 90/128 [2:26:01<1:01:39, 97.35s/it]
training process finished, best loss : 0.012 and best acc : 0.966, best f1 : 0.675, best epoch : 50

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.29      0.55      0.38       303
           1       0.99      0.98      0.98     16947

    accuracy                           0.97     17250
   macro avg       0.64      0.76      0.68     17250
weighted avg       0.98      0.97      0.97     17250


# test acc : 0.97, test f1 : 0.68, test AUC : 0.76, test loss : 3.780

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:10<02:54, 10.93s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:55, 11.73s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:45, 11.79s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:28, 11.46s/it]processing for feature importance:  29%|██▉       | 5/17 [00:57<02:15, 11.32s/it]processing for feature importance:  35%|███▌      | 6/17 [01:08<02:04, 11.29s/it]processing for feature importance:  41%|████      | 7/17 [01:19<01:51, 11.13s/it]processing for feature importance:  47%|████▋     | 8/17 [01:29<01:39, 11.03s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:41<01:30, 11.26s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:52<01:17, 11.05s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:04<01:07, 11.28s/it]processing for feature importance:  71%|███████   | 12/17 [02:15<00:56, 11.35s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:26<00:44, 11.11s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:37<00:33, 11.13s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:48<00:22, 11.05s/it]processing for feature importance:  94%|█████████▍| 16/17 [02:59<00:11, 11.01s/it]processing for feature importance: 100%|██████████| 17/17 [03:10<00:00, 11.11s/it]processing for feature importance: 100%|██████████| 17/17 [03:10<00:00, 11.20s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:02<10:01,  2.86s/it]visualize 2D latent space:   1%|          | 2/211 [00:03<05:53,  1.69s/it]visualize 2D latent space:   1%|          | 2/211 [00:04<07:23,  2.12s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:12,  1.10s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:42,  1.56s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:02<09:29,  2.71s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:04<06:46,  1.94s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<09:53,  2.84s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:13,  1.99s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:33,  1.42s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▋        | 32/195 [00:00<00:00, 311.37it/s] 34%|███▍      | 67/195 [00:00<00:00, 330.10it/s] 52%|█████▏    | 102/195 [00:00<00:00, 336.78it/s] 70%|███████   | 137/195 [00:00<00:00, 340.00it/s] 88%|████████▊ | 172/195 [00:00<00:00, 341.70it/s]100%|██████████| 195/195 [00:00<00:00, 338.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_smoothing_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.03it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 199.83it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 196.89it/s]remove invalid data : null / measurement error:  13%|█▎        | 83/616 [00:00<00:02, 198.11it/s]remove invalid data : null / measurement error:  17%|█▋        | 104/616 [00:00<00:02, 199.03it/s]remove invalid data : null / measurement error:  20%|██        | 125/616 [00:00<00:02, 201.27it/s]remove invalid data : null / measurement error:  24%|██▎       | 146/616 [00:00<00:02, 202.59it/s]remove invalid data : null / measurement error:  27%|██▋       | 167/616 [00:00<00:02, 204.73it/s]remove invalid data : null / measurement error:  31%|███       | 188/616 [00:00<00:02, 202.11it/s]remove invalid data : null / measurement error:  34%|███▍      | 209/616 [00:01<00:02, 200.53it/s]remove invalid data : null / measurement error:  37%|███▋      | 230/616 [00:01<00:01, 200.88it/s]remove invalid data : null / measurement error:  41%|████      | 251/616 [00:01<00:01, 200.02it/s]remove invalid data : null / measurement error:  44%|████▍     | 272/616 [00:01<00:01, 201.28it/s]remove invalid data : null / measurement error:  48%|████▊     | 293/616 [00:01<00:01, 200.12it/s]remove invalid data : null / measurement error:  51%|█████     | 314/616 [00:01<00:01, 199.01it/s]remove invalid data : null / measurement error:  54%|█████▍    | 335/616 [00:01<00:01, 199.39it/s]remove invalid data : null / measurement error:  58%|█████▊    | 356/616 [00:01<00:01, 199.84it/s]remove invalid data : null / measurement error:  62%|██████▏   | 381/616 [00:01<00:01, 213.49it/s]remove invalid data : null / measurement error:  66%|██████▌   | 407/616 [00:01<00:00, 225.95it/s]remove invalid data : null / measurement error:  70%|██████▉   | 431/616 [00:02<00:00, 228.02it/s]remove invalid data : null / measurement error:  74%|███████▍  | 455/616 [00:02<00:00, 229.77it/s]remove invalid data : null / measurement error:  78%|███████▊  | 478/616 [00:02<00:00, 222.11it/s]remove invalid data : null / measurement error:  81%|████████▏ | 501/616 [00:02<00:00, 214.38it/s]remove invalid data : null / measurement error:  85%|████████▍ | 523/616 [00:02<00:00, 210.32it/s]remove invalid data : null / measurement error:  88%|████████▊ | 545/616 [00:02<00:00, 205.50it/s]remove invalid data : null / measurement error:  92%|█████████▏| 566/616 [00:02<00:00, 203.31it/s]remove invalid data : null / measurement error:  95%|█████████▌| 587/616 [00:02<00:00, 201.63it/s]remove invalid data : null / measurement error:  99%|█████████▊| 608/616 [00:02<00:00, 201.07it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 205.77it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 236.51it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.68it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.35it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 238.27it/s]replace nan value:  23%|██▎       | 121/515 [00:00<00:01, 238.56it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 238.62it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 238.30it/s]replace nan value:  37%|███▋      | 193/515 [00:00<00:01, 237.84it/s]replace nan value:  42%|████▏     | 217/515 [00:00<00:01, 237.57it/s]replace nan value:  47%|████▋     | 241/515 [00:01<00:01, 237.72it/s]replace nan value:  51%|█████▏    | 265/515 [00:01<00:01, 237.76it/s]replace nan value:  56%|█████▌    | 289/515 [00:01<00:00, 237.24it/s]replace nan value:  61%|██████    | 313/515 [00:01<00:00, 236.99it/s]replace nan value:  65%|██████▌   | 337/515 [00:01<00:00, 236.02it/s]replace nan value:  70%|███████   | 361/515 [00:01<00:00, 234.45it/s]replace nan value:  75%|███████▍  | 386/515 [00:01<00:00, 236.20it/s]replace nan value:  80%|███████▉  | 410/515 [00:01<00:00, 235.91it/s]replace nan value:  84%|████████▍ | 434/515 [00:01<00:00, 236.00it/s]replace nan value:  89%|████████▉ | 458/515 [00:01<00:00, 236.81it/s]replace nan value:  94%|█████████▍| 483/515 [00:02<00:00, 238.60it/s]replace nan value:  99%|█████████▊| 508/515 [00:02<00:00, 239.84it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 237.50it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.04it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.98it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 76.00it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.34it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.42it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 53.51it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.43it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 46.90it/s]generate index:  14%|█▎        | 70/515 [00:01<00:08, 51.91it/s]generate index:  15%|█▍        | 76/515 [00:01<00:08, 52.51it/s]generate index:  17%|█▋        | 86/515 [00:01<00:06, 64.21it/s]generate index:  18%|█▊        | 93/515 [00:01<00:06, 60.29it/s]generate index:  19%|█▉        | 100/515 [00:01<00:07, 57.06it/s]generate index:  21%|██        | 107/515 [00:01<00:06, 58.91it/s]generate index:  23%|██▎       | 116/515 [00:01<00:06, 66.19it/s]generate index:  24%|██▍       | 123/515 [00:02<00:06, 64.14it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 68.24it/s]generate index:  27%|██▋       | 139/515 [00:02<00:05, 68.49it/s]generate index:  28%|██▊       | 146/515 [00:02<00:05, 67.43it/s]generate index:  30%|██▉       | 154/515 [00:02<00:05, 68.81it/s]generate index:  32%|███▏      | 163/515 [00:02<00:04, 73.99it/s]generate index:  33%|███▎      | 171/515 [00:02<00:05, 67.35it/s]generate index:  35%|███▍      | 178/515 [00:02<00:05, 65.52it/s]generate index:  37%|███▋      | 188/515 [00:02<00:04, 70.31it/s]generate index:  38%|███▊      | 196/515 [00:03<00:04, 69.03it/s]generate index:  39%|███▉      | 203/515 [00:03<00:04, 63.83it/s]generate index:  42%|████▏     | 215/515 [00:03<00:03, 78.17it/s]generate index:  43%|████▎     | 224/515 [00:03<00:04, 71.33it/s]generate index:  46%|████▌     | 236/515 [00:03<00:03, 82.85it/s]generate index:  48%|████▊     | 246/515 [00:03<00:03, 86.44it/s]generate index:  50%|████▉     | 255/515 [00:03<00:03, 66.36it/s]generate index:  51%|█████▏    | 265/515 [00:04<00:03, 73.99it/s]generate index:  53%|█████▎    | 275/515 [00:04<00:03, 77.30it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 60.96it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.09it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 61.47it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 61.33it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 59.60it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 61.12it/s]generate index:  64%|██████▎   | 328/515 [00:05<00:02, 63.14it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 55.80it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.06it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 45.19it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.21it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.38it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 71.74it/s]generate index:  75%|███████▍  | 384/515 [00:06<00:01, 75.65it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 72.69it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.57it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.52it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.05it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.14it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.03it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 47.70it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.64it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.28it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.15it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.12it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.05it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.27it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 68.49it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.98it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 89.58it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 155.84it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 176.74it/s]remove invalid data : null / measurement error:  47%|████▋     | 72/154 [00:00<00:00, 188.69it/s]remove invalid data : null / measurement error:  60%|██████    | 93/154 [00:00<00:00, 195.18it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 208.06it/s]remove invalid data : null / measurement error:  90%|████████▉ | 138/154 [00:00<00:00, 204.93it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 192.30it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 244.11it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 248.94it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 250.37it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 248.27it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 250.39it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 249.34it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.55it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.75it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 55.10it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.16it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.83it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.63it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.67it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 62.57it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.40it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.30it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 62.71it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.15it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.00it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 45.62it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.09it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 54.75it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 63.29it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.75it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 12/193 [00:00<00:01, 117.08it/s]remove invalid data : null / measurement error:  17%|█▋        | 32/193 [00:00<00:00, 164.97it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 185.04it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 195.42it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 200.01it/s]remove invalid data : null / measurement error:  61%|██████    | 117/193 [00:00<00:00, 202.70it/s]remove invalid data : null / measurement error:  73%|███████▎  | 141/193 [00:00<00:00, 214.62it/s]remove invalid data : null / measurement error:  84%|████████▍ | 163/193 [00:00<00:00, 210.84it/s]remove invalid data : null / measurement error:  96%|█████████▌| 185/193 [00:00<00:00, 207.25it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 199.26it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 245.47it/s]replace nan value:  31%|███▏      | 50/160 [00:00<00:00, 247.81it/s]replace nan value:  47%|████▋     | 75/160 [00:00<00:00, 247.66it/s]replace nan value:  62%|██████▎   | 100/160 [00:00<00:00, 245.63it/s]replace nan value:  78%|███████▊  | 125/160 [00:00<00:00, 244.55it/s]replace nan value:  94%|█████████▍| 150/160 [00:00<00:00, 243.97it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 244.83it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 101.41it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.12it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 60.65it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.10it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 79.63it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 81.57it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 81.60it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 67.01it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 57.64it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 58.43it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.30it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 48.63it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.67it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.12it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.88it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.73it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.07it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.42it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.86it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.034, valid loss : -0.041, train acc : 0.959, valid acc : 0.983, train f1 : 0.503, valid f1 : 0.496

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.15it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 324.52it/s][A
 51%|█████     | 99/195 [00:00<00:00, 327.13it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 328.91it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 330.04it/s][A100%|██████████| 195/195 [00:00<00:00, 328.63it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.496
training process:   1%|          | 1/128 [01:59<4:12:04, 119.09s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:28<3:33:49, 101.82s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:55<3:17:46, 94.93s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:23<3:10:36, 92.23s/it]epoch : 5, train loss : -0.042, valid loss : -0.042, train acc : 0.982, valid acc : 0.983, train f1 : 0.517, valid f1 : 0.518

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.61it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.76it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 334.94it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.41it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 335.68it/s][A100%|██████████| 195/195 [00:00<00:00, 334.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.496 -> 0.518
training process:   4%|▍         | 5/128 [08:18<3:25:46, 100.38s/it]Best score increase :0.518 -> 0.521
training process:   5%|▍         | 6/128 [09:47<3:16:29, 96.64s/it] EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:17<3:09:58, 94.20s/it]Best score increase :0.521 -> 0.560
training process:   6%|▋         | 8/128 [12:44<3:04:05, 92.05s/it]epoch : 9, train loss : -0.044, valid loss : -0.042, train acc : 0.983, valid acc : 0.982, train f1 : 0.591, valid f1 : 0.590

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.89it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.19it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.88it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.23it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.24it/s][A100%|██████████| 195/195 [00:00<00:00, 341.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.560 -> 0.590
training process:   7%|▋         | 9/128 [14:39<3:16:47, 99.22s/it]Best score increase :0.590 -> 0.603
training process:   8%|▊         | 10/128 [16:05<3:07:11, 95.18s/it]Best score increase :0.603 -> 0.622
training process:   9%|▊         | 11/128 [17:35<3:02:35, 93.64s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [19:06<2:59:37, 92.91s/it]epoch : 13, train loss : -0.044, valid loss : -0.044, train acc : 0.984, valid acc : 0.984, train f1 : 0.662, valid f1 : 0.657

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.81it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.60it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.36it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.08it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.79it/s][A100%|██████████| 195/195 [00:00<00:00, 339.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.622 -> 0.657
training process:  10%|█         | 13/128 [21:04<3:12:36, 100.49s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [22:34<3:04:29, 97.10s/it] EarlyStopping counter : 2 out of 40
training process:  12%|█▏        | 15/128 [24:05<2:59:26, 95.28s/it]Best score increase :0.657 -> 0.665
training process:  12%|█▎        | 16/128 [25:32<2:53:34, 92.99s/it]epoch : 17, train loss : -0.045, valid loss : -0.044, train acc : 0.986, valid acc : 0.985, train f1 : 0.719, valid f1 : 0.662

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.85it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.88it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.66it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.29it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.21it/s][A100%|██████████| 195/195 [00:00<00:00, 342.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [27:29<3:05:20, 100.18s/it]Best score increase :0.665 -> 0.705
training process:  14%|█▍        | 18/128 [28:59<2:58:05, 97.14s/it] Best score increase :0.705 -> 0.714
training process:  15%|█▍        | 19/128 [30:30<2:52:44, 95.09s/it]Best score increase :0.714 -> 0.739
training process:  16%|█▌        | 20/128 [31:59<2:47:48, 93.23s/it]epoch : 21, train loss : -0.046, valid loss : -0.045, train acc : 0.988, valid acc : 0.988, train f1 : 0.767, valid f1 : 0.744

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.06it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.53it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.03it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.29it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.06it/s][A100%|██████████| 195/195 [00:00<00:00, 342.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.739 -> 0.744
training process:  16%|█▋        | 21/128 [33:54<2:57:55, 99.77s/it]EarlyStopping counter : 1 out of 40
training process:  17%|█▋        | 22/128 [35:24<2:51:14, 96.93s/it]Best score increase :0.744 -> 0.753
training process:  18%|█▊        | 23/128 [36:50<2:44:05, 93.76s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [38:16<2:38:22, 91.37s/it]epoch : 25, train loss : -0.046, valid loss : -0.046, train acc : 0.989, valid acc : 0.988, train f1 : 0.796, valid f1 : 0.767

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.69it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.66it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 347.26it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.77it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 344.88it/s][A100%|██████████| 195/195 [00:00<00:00, 345.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.753 -> 0.767
training process:  20%|█▉        | 25/128 [40:12<2:49:39, 98.83s/it]EarlyStopping counter : 1 out of 40
training process:  20%|██        | 26/128 [41:46<2:45:29, 97.35s/it]Best score increase :0.767 -> 0.773
training process:  21%|██        | 27/128 [43:17<2:40:44, 95.49s/it]Best score increase :0.773 -> 0.785
training process:  22%|██▏       | 28/128 [44:47<2:36:27, 93.87s/it]epoch : 29, train loss : -0.047, valid loss : -0.046, train acc : 0.990, valid acc : 0.989, train f1 : 0.820, valid f1 : 0.773

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.19it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.32it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.22it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.61it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.28it/s][A100%|██████████| 195/195 [00:00<00:00, 342.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 29/128 [46:42<2:45:18, 100.19s/it]Best score increase :0.785 -> 0.788
training process:  23%|██▎       | 30/128 [48:11<2:37:59, 96.73s/it] Best score increase :0.788 -> 0.799
training process:  24%|██▍       | 31/128 [49:41<2:33:20, 94.85s/it]Best score increase :0.799 -> 0.807
training process:  25%|██▌       | 32/128 [51:08<2:27:40, 92.30s/it]epoch : 33, train loss : -0.047, valid loss : -0.045, train acc : 0.991, valid acc : 0.988, train f1 : 0.845, valid f1 : 0.793

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.36it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.56it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.27it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.43it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.62it/s][A100%|██████████| 195/195 [00:00<00:00, 342.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  26%|██▌       | 33/128 [53:04<2:37:17, 99.35s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 34/128 [54:32<2:30:20, 95.96s/it]EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 35/128 [56:02<2:26:01, 94.21s/it]Best score increase :0.807 -> 0.809
training process:  28%|██▊       | 36/128 [57:30<2:21:44, 92.44s/it]epoch : 37, train loss : -0.048, valid loss : -0.046, train acc : 0.992, valid acc : 0.990, train f1 : 0.859, valid f1 : 0.816

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.85it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.64it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.51it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.98it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 330.50it/s][A100%|██████████| 195/195 [00:00<00:00, 332.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.809 -> 0.816
training process:  29%|██▉       | 37/128 [59:25<2:30:19, 99.12s/it]Best score increase :0.816 -> 0.819
training process:  30%|██▉       | 38/128 [1:00:51<2:22:56, 95.30s/it]EarlyStopping counter : 1 out of 40
training process:  30%|███       | 39/128 [1:02:22<2:19:08, 93.80s/it]EarlyStopping counter : 2 out of 40
training process:  31%|███▏      | 40/128 [1:03:50<2:15:03, 92.09s/it]epoch : 41, train loss : -0.048, valid loss : -0.046, train acc : 0.992, valid acc : 0.991, train f1 : 0.872, valid f1 : 0.830

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 207.35it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 264.10it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 293.25it/s][A
 61%|██████    | 119/195 [00:00<00:00, 308.47it/s][A
 78%|███████▊  | 153/195 [00:00<00:00, 316.48it/s][A
 96%|█████████▌| 187/195 [00:00<00:00, 321.14it/s][A100%|██████████| 195/195 [00:00<00:00, 306.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.819 -> 0.830
training process:  32%|███▏      | 41/128 [1:05:45<2:23:52, 99.23s/it]EarlyStopping counter : 1 out of 40
training process:  33%|███▎      | 42/128 [1:07:13<2:17:14, 95.75s/it]EarlyStopping counter : 2 out of 40
training process:  34%|███▎      | 43/128 [1:08:44<2:13:35, 94.31s/it]Best score increase :0.830 -> 0.836
training process:  34%|███▍      | 44/128 [1:10:15<2:10:43, 93.37s/it]epoch : 45, train loss : -0.048, valid loss : -0.046, train acc : 0.993, valid acc : 0.988, train f1 : 0.887, valid f1 : 0.795

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.29it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.57it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.22it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.95it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.66it/s][A100%|██████████| 195/195 [00:00<00:00, 343.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  35%|███▌      | 45/128 [1:12:10<2:17:55, 99.71s/it]EarlyStopping counter : 2 out of 40
training process:  36%|███▌      | 46/128 [1:13:37<2:11:14, 96.04s/it]EarlyStopping counter : 3 out of 40
training process:  37%|███▋      | 47/128 [1:15:07<2:07:13, 94.24s/it]EarlyStopping counter : 4 out of 40
training process:  38%|███▊      | 48/128 [1:16:36<2:03:29, 92.62s/it]epoch : 49, train loss : -0.048, valid loss : -0.046, train acc : 0.994, valid acc : 0.990, train f1 : 0.899, valid f1 : 0.829

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.64it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 329.82it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.12it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.03it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.74it/s][A100%|██████████| 195/195 [00:00<00:00, 334.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 49/128 [1:18:37<2:13:08, 101.12s/it]EarlyStopping counter : 6 out of 40
training process:  39%|███▉      | 50/128 [1:20:04<2:06:01, 96.95s/it] EarlyStopping counter : 7 out of 40
training process:  40%|███▉      | 51/128 [1:21:31<2:00:36, 93.99s/it]EarlyStopping counter : 8 out of 40
training process:  41%|████      | 52/128 [1:23:02<1:57:38, 92.87s/it]epoch : 53, train loss : -0.048, valid loss : -0.046, train acc : 0.994, valid acc : 0.988, train f1 : 0.907, valid f1 : 0.794

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.88it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.69it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.54it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.27it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.88it/s][A100%|██████████| 195/195 [00:00<00:00, 339.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  41%|████▏     | 53/128 [1:24:55<2:03:55, 99.14s/it]EarlyStopping counter : 10 out of 40
training process:  42%|████▏     | 54/128 [1:26:23<1:57:52, 95.57s/it]EarlyStopping counter : 11 out of 40
training process:  43%|████▎     | 55/128 [1:27:52<1:53:56, 93.65s/it]EarlyStopping counter : 12 out of 40
training process:  44%|████▍     | 56/128 [1:29:22<1:51:01, 92.52s/it]epoch : 57, train loss : -0.049, valid loss : -0.046, train acc : 0.994, valid acc : 0.990, train f1 : 0.908, valid f1 : 0.825

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▍        | 29/195 [00:00<00:00, 287.30it/s][A
 30%|███       | 59/195 [00:00<00:00, 290.57it/s][A
 46%|████▌     | 89/195 [00:00<00:00, 287.00it/s][A
 61%|██████    | 119/195 [00:00<00:00, 289.43it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 290.63it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 291.23it/s][A100%|██████████| 195/195 [00:00<00:00, 289.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  45%|████▍     | 57/128 [1:31:18<1:57:48, 99.55s/it]EarlyStopping counter : 14 out of 40
training process:  45%|████▌     | 58/128 [1:32:46<1:52:16, 96.24s/it]EarlyStopping counter : 15 out of 40
training process:  46%|████▌     | 59/128 [1:34:15<1:48:06, 94.01s/it]Best score increase :0.836 -> 0.838
training process:  47%|████▋     | 60/128 [1:35:43<1:44:31, 92.23s/it]epoch : 61, train loss : -0.049, valid loss : -0.046, train acc : 0.995, valid acc : 0.989, train f1 : 0.922, valid f1 : 0.823

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.55it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.64it/s][A
 51%|█████     | 99/195 [00:00<00:00, 329.25it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.88it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 333.25it/s][A100%|██████████| 195/195 [00:00<00:00, 331.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  48%|████▊     | 61/128 [1:37:36<1:50:03, 98.57s/it]EarlyStopping counter : 2 out of 40
training process:  48%|████▊     | 62/128 [1:39:06<1:45:28, 95.89s/it]Best score increase :0.838 -> 0.840
training process:  49%|████▉     | 63/128 [1:40:39<1:42:46, 94.87s/it]EarlyStopping counter : 1 out of 40
training process:  50%|█████     | 64/128 [1:42:08<1:39:25, 93.21s/it]epoch : 65, train loss : -0.049, valid loss : -0.046, train acc : 0.995, valid acc : 0.988, train f1 : 0.919, valid f1 : 0.819

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.96it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.17it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 334.86it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.77it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.83it/s][A100%|██████████| 195/195 [00:00<00:00, 336.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  51%|█████     | 65/128 [1:44:04<1:45:14, 100.23s/it]EarlyStopping counter : 3 out of 40
training process:  52%|█████▏    | 66/128 [1:45:32<1:39:44, 96.53s/it] EarlyStopping counter : 4 out of 40
training process:  52%|█████▏    | 67/128 [1:47:02<1:36:04, 94.49s/it]EarlyStopping counter : 5 out of 40
training process:  53%|█████▎    | 68/128 [1:48:33<1:33:30, 93.51s/it]epoch : 69, train loss : -0.049, valid loss : -0.046, train acc : 0.995, valid acc : 0.990, train f1 : 0.926, valid f1 : 0.822

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 265.31it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 271.03it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 268.96it/s][A
 57%|█████▋    | 111/195 [00:00<00:00, 271.52it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 269.12it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 271.62it/s][A
100%|██████████| 195/195 [00:00<00:00, 267.51it/s][A100%|██████████| 195/195 [00:00<00:00, 268.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  54%|█████▍    | 69/128 [1:50:30<1:38:42, 100.39s/it]EarlyStopping counter : 7 out of 40
training process:  55%|█████▍    | 70/128 [1:52:00<1:34:00, 97.24s/it] EarlyStopping counter : 8 out of 40
training process:  55%|█████▌    | 71/128 [1:53:30<1:30:26, 95.21s/it]EarlyStopping counter : 9 out of 40
training process:  56%|█████▋    | 72/128 [1:55:01<1:27:33, 93.80s/it]epoch : 73, train loss : -0.049, valid loss : -0.046, train acc : 0.995, valid acc : 0.988, train f1 : 0.931, valid f1 : 0.822

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.77it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.74it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.73it/s][A
 70%|███████   | 137/195 [00:00<00:00, 339.91it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.98it/s][A100%|██████████| 195/195 [00:00<00:00, 338.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  57%|█████▋    | 73/128 [1:56:54<1:31:27, 99.77s/it]EarlyStopping counter : 11 out of 40
training process:  58%|█████▊    | 74/128 [1:58:23<1:26:44, 96.37s/it]EarlyStopping counter : 12 out of 40
training process:  59%|█████▊    | 75/128 [1:59:50<1:22:42, 93.64s/it]EarlyStopping counter : 13 out of 40
training process:  59%|█████▉    | 76/128 [2:01:20<1:20:06, 92.43s/it]epoch : 77, train loss : -0.049, valid loss : -0.045, train acc : 0.996, valid acc : 0.987, train f1 : 0.935, valid f1 : 0.804

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 343.79it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.13it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.95it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.97it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 348.58it/s][A100%|██████████| 195/195 [00:00<00:00, 347.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  60%|██████    | 77/128 [2:03:11<1:23:22, 98.09s/it]EarlyStopping counter : 15 out of 40
training process:  61%|██████    | 78/128 [2:04:40<1:19:30, 95.42s/it]EarlyStopping counter : 16 out of 40
training process:  62%|██████▏   | 79/128 [2:06:11<1:16:48, 94.05s/it]EarlyStopping counter : 17 out of 40
training process:  62%|██████▎   | 80/128 [2:07:40<1:13:59, 92.50s/it]epoch : 81, train loss : -0.049, valid loss : -0.045, train acc : 0.996, valid acc : 0.989, train f1 : 0.943, valid f1 : 0.821

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.93it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 346.06it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 347.48it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 348.16it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 348.38it/s][A100%|██████████| 195/195 [00:00<00:00, 346.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  63%|██████▎   | 81/128 [2:09:36<1:18:01, 99.60s/it]Best score increase :0.840 -> 0.843
training process:  64%|██████▍   | 82/128 [2:11:04<1:13:44, 96.19s/it]EarlyStopping counter : 1 out of 40
training process:  65%|██████▍   | 83/128 [2:12:34<1:10:38, 94.18s/it]EarlyStopping counter : 2 out of 40
training process:  66%|██████▌   | 84/128 [2:14:04<1:08:07, 92.89s/it]epoch : 85, train loss : -0.049, valid loss : -0.045, train acc : 0.996, valid acc : 0.989, train f1 : 0.945, valid f1 : 0.824

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 266.15it/s][A
 29%|██▊       | 56/195 [00:00<00:00, 274.90it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 277.68it/s][A
 58%|█████▊    | 114/195 [00:00<00:00, 279.08it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 270.13it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 273.24it/s][A100%|██████████| 195/195 [00:00<00:00, 274.62it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  66%|██████▋   | 85/128 [2:15:59<1:11:21, 99.56s/it]EarlyStopping counter : 4 out of 40
training process:  67%|██████▋   | 86/128 [2:17:29<1:07:42, 96.72s/it]EarlyStopping counter : 5 out of 40
training process:  68%|██████▊   | 87/128 [2:18:57<1:04:20, 94.17s/it]EarlyStopping counter : 6 out of 40
training process:  69%|██████▉   | 88/128 [2:20:27<1:01:53, 92.83s/it]epoch : 89, train loss : -0.049, valid loss : -0.045, train acc : 0.996, valid acc : 0.987, train f1 : 0.946, valid f1 : 0.809

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 271.19it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 279.97it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 283.12it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 284.55it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 285.35it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 284.34it/s][A100%|██████████| 195/195 [00:00<00:00, 283.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  70%|██████▉   | 89/128 [2:22:19<1:04:07, 98.65s/it]EarlyStopping counter : 8 out of 40
training process:  70%|███████   | 90/128 [2:23:48<1:00:43, 95.88s/it]EarlyStopping counter : 9 out of 40
training process:  71%|███████   | 91/128 [2:25:16<57:31, 93.29s/it]  EarlyStopping counter : 10 out of 40
training process:  72%|███████▏  | 92/128 [2:26:41<54:37, 91.03s/it]epoch : 93, train loss : -0.049, valid loss : -0.045, train acc : 0.997, valid acc : 0.988, train f1 : 0.953, valid f1 : 0.809

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 311.38it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 320.52it/s][A
 50%|█████     | 98/195 [00:00<00:00, 324.46it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 326.57it/s][A
 84%|████████▍ | 164/195 [00:00<00:00, 327.78it/s][A100%|██████████| 195/195 [00:00<00:00, 307.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  73%|███████▎  | 93/128 [2:28:37<57:20, 98.29s/it]EarlyStopping counter : 12 out of 40
training process:  73%|███████▎  | 94/128 [2:30:05<53:59, 95.27s/it]EarlyStopping counter : 13 out of 40
training process:  74%|███████▍  | 95/128 [2:31:33<51:17, 93.27s/it]EarlyStopping counter : 14 out of 40
training process:  75%|███████▌  | 96/128 [2:33:02<49:03, 91.99s/it]epoch : 97, train loss : -0.049, valid loss : -0.044, train acc : 0.997, valid acc : 0.986, train f1 : 0.957, valid f1 : 0.804

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.06it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.52it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.59it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.80it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 335.96it/s][A100%|██████████| 195/195 [00:00<00:00, 334.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  76%|███████▌  | 97/128 [2:34:59<51:22, 99.43s/it]EarlyStopping counter : 16 out of 40
training process:  77%|███████▋  | 98/128 [2:36:25<47:41, 95.38s/it]EarlyStopping counter : 17 out of 40
training process:  77%|███████▋  | 99/128 [2:37:52<44:50, 92.79s/it]EarlyStopping counter : 18 out of 40
training process:  78%|███████▊  | 100/128 [2:39:21<42:50, 91.80s/it]epoch : 101, train loss : -0.049, valid loss : -0.044, train acc : 0.997, valid acc : 0.988, train f1 : 0.953, valid f1 : 0.816

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.51it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.19it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 333.62it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.85it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 335.63it/s][A100%|██████████| 195/195 [00:00<00:00, 334.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  79%|███████▉  | 101/128 [2:41:15<44:18, 98.47s/it]EarlyStopping counter : 20 out of 40
training process:  80%|███████▉  | 102/128 [2:42:46<41:38, 96.10s/it]EarlyStopping counter : 21 out of 40
training process:  80%|████████  | 103/128 [2:44:16<39:18, 94.34s/it]EarlyStopping counter : 22 out of 40
training process:  81%|████████▏ | 104/128 [2:45:45<37:04, 92.69s/it]epoch : 105, train loss : -0.050, valid loss : -0.045, train acc : 0.997, valid acc : 0.987, train f1 : 0.955, valid f1 : 0.802

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.67it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.54it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.85it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.52it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.45it/s][A100%|██████████| 195/195 [00:00<00:00, 334.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  82%|████████▏ | 105/128 [2:47:42<38:19, 99.99s/it]EarlyStopping counter : 24 out of 40
training process:  83%|████████▎ | 106/128 [2:49:13<35:36, 97.13s/it]EarlyStopping counter : 25 out of 40
training process:  84%|████████▎ | 107/128 [2:50:43<33:15, 95.04s/it]EarlyStopping counter : 26 out of 40
training process:  84%|████████▍ | 108/128 [2:52:14<31:18, 93.92s/it]epoch : 109, train loss : -0.050, valid loss : -0.044, train acc : 0.997, valid acc : 0.988, train f1 : 0.962, valid f1 : 0.816

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.00it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.31it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.51it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.46it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.26it/s][A100%|██████████| 195/195 [00:00<00:00, 341.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  85%|████████▌ | 109/128 [2:54:08<31:41, 100.06s/it]EarlyStopping counter : 28 out of 40
training process:  86%|████████▌ | 110/128 [2:55:37<29:00, 96.68s/it] EarlyStopping counter : 29 out of 40
training process:  87%|████████▋ | 111/128 [2:57:09<26:58, 95.22s/it]EarlyStopping counter : 30 out of 40
training process:  88%|████████▊ | 112/128 [2:58:38<24:51, 93.20s/it]epoch : 113, train loss : -0.050, valid loss : -0.044, train acc : 0.997, valid acc : 0.985, train f1 : 0.959, valid f1 : 0.785

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.93it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.58it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.05it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.67it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.76it/s][A100%|██████████| 195/195 [00:00<00:00, 344.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  88%|████████▊ | 113/128 [3:00:33<24:59, 99.94s/it]EarlyStopping counter : 32 out of 40
training process:  89%|████████▉ | 114/128 [3:02:03<22:36, 96.91s/it]EarlyStopping counter : 33 out of 40
training process:  90%|████████▉ | 115/128 [3:03:33<20:32, 94.83s/it]EarlyStopping counter : 34 out of 40
training process:  91%|█████████ | 116/128 [3:05:03<18:40, 93.41s/it]epoch : 117, train loss : -0.050, valid loss : -0.045, train acc : 0.998, valid acc : 0.989, train f1 : 0.967, valid f1 : 0.819

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.89it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 344.17it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.69it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.09it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 346.88it/s][A100%|██████████| 195/195 [00:00<00:00, 346.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  91%|█████████▏| 117/128 [3:06:56<18:10, 99.15s/it]EarlyStopping counter : 36 out of 40
training process:  92%|█████████▏| 118/128 [3:08:25<16:03, 96.34s/it]EarlyStopping counter : 37 out of 40
training process:  93%|█████████▎| 119/128 [3:09:55<14:08, 94.31s/it]EarlyStopping counter : 38 out of 40
training process:  94%|█████████▍| 120/128 [3:11:25<12:24, 93.07s/it]epoch : 121, train loss : -0.050, valid loss : -0.044, train acc : 0.998, valid acc : 0.986, train f1 : 0.964, valid f1 : 0.808

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.74it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.51it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.30it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.25it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.28it/s][A100%|██████████| 195/195 [00:00<00:00, 337.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  95%|█████████▍| 121/128 [3:13:22<11:40, 100.09s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 121, best f1 score : 0.843
training process:  95%|█████████▍| 121/128 [3:14:52<11:16, 96.63s/it] 
training process finished, best loss : -0.046 and best acc : 0.991, best f1 : 0.843, best epoch : 81

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.71      0.54      0.62       303
           1       0.99      1.00      0.99     16947

    accuracy                           0.99     17250
   macro avg       0.85      0.77      0.80     17250
weighted avg       0.99      0.99      0.99     17250


# test acc : 0.99, test f1 : 0.80, test AUC : 0.77, test loss : -11.338

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:14, 12.13s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:57, 11.81s/it]processing for feature importance:  18%|█▊        | 3/17 [00:36<02:48, 12.03s/it]processing for feature importance:  24%|██▎       | 4/17 [00:49<02:43, 12.59s/it]processing for feature importance:  29%|██▉       | 5/17 [01:02<02:31, 12.64s/it]processing for feature importance:  35%|███▌      | 6/17 [01:14<02:18, 12.55s/it]processing for feature importance:  41%|████      | 7/17 [01:25<02:01, 12.13s/it]processing for feature importance:  47%|████▋     | 8/17 [01:37<01:48, 12.08s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:49<01:36, 12.03s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:01<01:23, 11.96s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:12<01:10, 11.77s/it]processing for feature importance:  71%|███████   | 12/17 [02:24<00:59, 11.83s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:36<00:46, 11.73s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:47<00:34, 11.63s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:59<00:23, 11.68s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:10<00:11, 11.55s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 11.45s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 11.88s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:04<15:43,  4.49s/it]visualize 2D latent space:   1%|          | 2/211 [00:06<10:41,  3.07s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:48,  2.52s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:47,  1.63s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:02<08:58,  2.56s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:02<04:32,  1.30s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:03<06:37,  1.90s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:12,  1.98s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:34,  1.43s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▋        | 32/195 [00:00<00:00, 312.94it/s] 34%|███▍      | 67/195 [00:00<00:00, 331.38it/s] 52%|█████▏    | 102/195 [00:00<00:00, 337.33it/s] 70%|███████   | 137/195 [00:00<00:00, 340.19it/s] 88%|████████▊ | 172/195 [00:00<00:00, 341.77it/s]100%|██████████| 195/195 [00:00<00:00, 338.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_smoothing_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 201.05it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 199.25it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 197.07it/s]remove invalid data : null / measurement error:  13%|█▎        | 83/616 [00:00<00:02, 200.83it/s]remove invalid data : null / measurement error:  17%|█▋        | 104/616 [00:00<00:02, 203.28it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 206.26it/s]remove invalid data : null / measurement error:  24%|██▍       | 148/616 [00:00<00:02, 207.69it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 210.06it/s]remove invalid data : null / measurement error:  31%|███       | 192/616 [00:00<00:02, 207.11it/s]remove invalid data : null / measurement error:  35%|███▍      | 213/616 [00:01<00:01, 206.50it/s]remove invalid data : null / measurement error:  38%|███▊      | 234/616 [00:01<00:01, 205.88it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 202.47it/s]remove invalid data : null / measurement error:  45%|████▍     | 276/616 [00:01<00:01, 203.85it/s]remove invalid data : null / measurement error:  48%|████▊     | 297/616 [00:01<00:01, 203.74it/s]remove invalid data : null / measurement error:  52%|█████▏    | 318/616 [00:01<00:01, 202.93it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 202.45it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 201.92it/s]remove invalid data : null / measurement error:  63%|██████▎   | 386/616 [00:01<00:01, 218.20it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:01<00:00, 233.21it/s]remove invalid data : null / measurement error:  71%|███████   | 437/616 [00:02<00:00, 230.29it/s]remove invalid data : null / measurement error:  75%|███████▌  | 462/616 [00:02<00:00, 233.19it/s]remove invalid data : null / measurement error:  79%|███████▉  | 486/616 [00:02<00:00, 225.02it/s]remove invalid data : null / measurement error:  83%|████████▎ | 509/616 [00:02<00:00, 218.76it/s]remove invalid data : null / measurement error:  86%|████████▌ | 531/616 [00:02<00:00, 213.89it/s]remove invalid data : null / measurement error:  90%|████████▉ | 553/616 [00:02<00:00, 209.53it/s]remove invalid data : null / measurement error:  93%|█████████▎| 574/616 [00:02<00:00, 207.09it/s]remove invalid data : null / measurement error:  97%|█████████▋| 595/616 [00:02<00:00, 206.10it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 204.74it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 209.65it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 234.28it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 234.13it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 235.01it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 237.42it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 239.39it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 242.43it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 244.30it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 244.67it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 244.23it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 244.37it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 244.47it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 242.95it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 243.01it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 240.44it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 241.19it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 242.11it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 241.52it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 239.96it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 240.54it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 241.32it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 241.40it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.92it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.72it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.84it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.03it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.61it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.69it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.78it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.06it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.02it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.35it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.59it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.90it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.40it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.95it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.34it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.87it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.83it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.41it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.96it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.57it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.69it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.75it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.02it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.51it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.58it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.87it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.69it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.09it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 88.53it/s]generate index:  49%|████▊     | 251/515 [00:03<00:03, 73.32it/s]generate index:  50%|█████     | 259/515 [00:03<00:03, 71.71it/s]generate index:  52%|█████▏    | 268/515 [00:03<00:03, 75.40it/s]generate index:  54%|█████▍    | 277/515 [00:04<00:03, 74.00it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 64.27it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 67.16it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 62.17it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 62.81it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 60.71it/s]generate index:  63%|██████▎   | 323/515 [00:04<00:03, 63.93it/s]generate index:  64%|██████▍   | 331/515 [00:04<00:02, 63.97it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 52.21it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 47.44it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 42.70it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 58.80it/s]generate index:  73%|███████▎  | 374/515 [00:05<00:01, 71.41it/s]generate index:  74%|███████▍  | 382/515 [00:05<00:01, 73.38it/s]generate index:  76%|███████▌  | 390/515 [00:05<00:01, 68.21it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 75.33it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 64.21it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.39it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.75it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 54.56it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 50.55it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:00, 60.18it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.52it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.69it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 69.06it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.38it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.66it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.29it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.64it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▋         | 10/154 [00:00<00:01, 96.02it/s]remove invalid data : null / measurement error:  20%|██        | 31/154 [00:00<00:00, 160.26it/s]remove invalid data : null / measurement error:  34%|███▍      | 52/154 [00:00<00:00, 181.42it/s]remove invalid data : null / measurement error:  48%|████▊     | 74/154 [00:00<00:00, 193.62it/s]remove invalid data : null / measurement error:  62%|██████▏   | 96/154 [00:00<00:00, 202.71it/s]remove invalid data : null / measurement error:  78%|███████▊  | 120/154 [00:00<00:00, 212.12it/s]remove invalid data : null / measurement error:  92%|█████████▏| 142/154 [00:00<00:00, 209.74it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 197.09it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 24/131 [00:00<00:00, 238.73it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 245.47it/s]replace nan value:  58%|█████▊    | 76/131 [00:00<00:00, 247.67it/s]replace nan value:  77%|███████▋  | 101/131 [00:00<00:00, 245.80it/s]replace nan value:  97%|█████████▋| 127/131 [00:00<00:00, 247.69it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 246.57it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.92it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.66it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.94it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.00it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.15it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.56it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 62.26it/s]generate index:  46%|████▌     | 60/131 [00:00<00:01, 65.93it/s]generate index:  51%|█████     | 67/131 [00:01<00:00, 66.60it/s]generate index:  57%|█████▋    | 75/131 [00:01<00:00, 68.46it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 65.52it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.44it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.10it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.05it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 48.71it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.38it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 67.67it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.07it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 77.04it/s]remove invalid data : null / measurement error:  16%|█▌        | 30/193 [00:00<00:01, 157.16it/s]remove invalid data : null / measurement error:  27%|██▋       | 52/193 [00:00<00:00, 183.37it/s]remove invalid data : null / measurement error:  38%|███▊      | 74/193 [00:00<00:00, 196.95it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 202.32it/s]remove invalid data : null / measurement error:  61%|██████    | 118/193 [00:00<00:00, 206.16it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 218.06it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 213.69it/s]remove invalid data : null / measurement error:  97%|█████████▋| 187/193 [00:00<00:00, 210.95it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 200.11it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 249.95it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 252.26it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 251.71it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 248.73it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 248.08it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 249.43it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.55it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 108.87it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 65.78it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 63.37it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.88it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.33it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.12it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.22it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.98it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.24it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.08it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.68it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.83it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.72it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.86it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.25it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.97it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.16it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.37it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.12it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : -0.004, train acc : 0.739, valid acc : 0.804, train f1 : 0.739, valid f1 : 0.492

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.68it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 338.39it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.41it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.91it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.48it/s][A100%|██████████| 195/195 [00:00<00:00, 339.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.492
training process:   1%|          | 1/128 [02:00<4:15:16, 120.60s/it]Best score increase :0.492 -> 0.536
training process:   2%|▏         | 2/128 [03:32<3:37:11, 103.43s/it]Best score increase :0.536 -> 0.548
training process:   2%|▏         | 3/128 [05:07<3:27:42, 99.70s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:41<3:21:28, 97.49s/it]epoch : 5, train loss : -0.029, valid loss : -0.017, train acc : 0.937, valid acc : 0.896, train f1 : 0.937, valid f1 : 0.564

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.60it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.89it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.31it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.56it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.90it/s][A100%|██████████| 195/195 [00:00<00:00, 330.41it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.548 -> 0.564
training process:   4%|▍         | 5/128 [08:40<3:35:53, 105.31s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [10:13<3:25:37, 101.13s/it]EarlyStopping counter : 2 out of 40
training process:   5%|▌         | 7/128 [11:46<3:18:46, 98.56s/it] EarlyStopping counter : 3 out of 40
training process:   6%|▋         | 8/128 [13:18<3:12:45, 96.38s/it]epoch : 9, train loss : -0.037, valid loss : -0.007, train acc : 0.963, valid acc : 0.879, train f1 : 0.963, valid f1 : 0.549

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.32it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 329.45it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.75it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.58it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.25it/s][A100%|██████████| 195/195 [00:00<00:00, 335.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   7%|▋         | 9/128 [15:18<3:25:46, 103.75s/it]EarlyStopping counter : 5 out of 40
training process:   8%|▊         | 10/128 [16:52<3:17:51, 100.60s/it]EarlyStopping counter : 6 out of 40
training process:   9%|▊         | 11/128 [18:27<3:12:58, 98.96s/it] EarlyStopping counter : 7 out of 40
training process:   9%|▉         | 12/128 [20:01<3:08:39, 97.58s/it]epoch : 13, train loss : -0.041, valid loss : -0.013, train acc : 0.974, valid acc : 0.897, train f1 : 0.974, valid f1 : 0.562

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.12it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.72it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.41it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 325.98it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 328.43it/s][A100%|██████████| 195/195 [00:00<00:00, 328.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  10%|█         | 13/128 [22:00<3:19:34, 104.13s/it]Best score increase :0.564 -> 0.568
training process:  11%|█         | 14/128 [23:34<3:11:51, 100.98s/it]EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [25:08<3:06:17, 98.91s/it] EarlyStopping counter : 2 out of 40
training process:  12%|█▎        | 16/128 [26:42<3:01:44, 97.36s/it]epoch : 17, train loss : -0.043, valid loss : -0.026, train acc : 0.981, valid acc : 0.932, train f1 : 0.981, valid f1 : 0.595

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.26it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.79it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.62it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.06it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.77it/s][A100%|██████████| 195/195 [00:00<00:00, 335.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.568 -> 0.595
training process:  13%|█▎        | 17/128 [28:43<3:13:16, 104.47s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [30:18<3:06:15, 101.60s/it]EarlyStopping counter : 2 out of 40
training process:  15%|█▍        | 19/128 [31:51<3:00:08, 99.16s/it] Best score increase :0.595 -> 0.611
training process:  16%|█▌        | 20/128 [33:26<2:56:03, 97.81s/it]epoch : 21, train loss : -0.044, valid loss : -0.026, train acc : 0.983, valid acc : 0.929, train f1 : 0.983, valid f1 : 0.585

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.41it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.21it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 331.57it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 332.45it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.84it/s][A100%|██████████| 195/195 [00:00<00:00, 332.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [35:24<3:04:58, 103.72s/it]Best score increase :0.611 -> 0.622
training process:  17%|█▋        | 22/128 [36:55<2:56:56, 100.16s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [38:27<2:50:48, 97.60s/it] EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [40:01<2:47:23, 96.57s/it]epoch : 25, train loss : -0.045, valid loss : -0.030, train acc : 0.986, valid acc : 0.942, train f1 : 0.986, valid f1 : 0.610

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.12it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.77it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.47it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.97it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.76it/s][A100%|██████████| 195/195 [00:00<00:00, 334.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [41:59<2:56:47, 102.98s/it]EarlyStopping counter : 4 out of 40
training process:  20%|██        | 26/128 [43:32<2:49:56, 99.96s/it] EarlyStopping counter : 5 out of 40
training process:  21%|██        | 27/128 [45:05<2:44:45, 97.88s/it]EarlyStopping counter : 6 out of 40
training process:  22%|██▏       | 28/128 [46:37<2:40:10, 96.10s/it]epoch : 29, train loss : -0.046, valid loss : -0.029, train acc : 0.988, valid acc : 0.937, train f1 : 0.988, valid f1 : 0.595

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.50it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.41it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.38it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.31it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.80it/s][A100%|██████████| 195/195 [00:00<00:00, 330.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 29/128 [48:38<2:50:57, 103.62s/it]EarlyStopping counter : 8 out of 40
training process:  23%|██▎       | 30/128 [50:11<2:43:53, 100.34s/it]Best score increase :0.622 -> 0.630
training process:  24%|██▍       | 31/128 [51:42<2:37:55, 97.68s/it] EarlyStopping counter : 1 out of 40
training process:  25%|██▌       | 32/128 [53:16<2:34:31, 96.58s/it]epoch : 33, train loss : -0.046, valid loss : -0.033, train acc : 0.990, valid acc : 0.952, train f1 : 0.990, valid f1 : 0.623

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.76it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.79it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.16it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.13it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.99it/s][A100%|██████████| 195/195 [00:00<00:00, 337.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  26%|██▌       | 33/128 [55:18<2:45:01, 104.22s/it]EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 34/128 [56:51<2:37:47, 100.71s/it]EarlyStopping counter : 4 out of 40
training process:  27%|██▋       | 35/128 [58:24<2:32:40, 98.50s/it] Best score increase :0.630 -> 0.654
training process:  28%|██▊       | 36/128 [59:58<2:28:36, 96.92s/it]epoch : 37, train loss : -0.047, valid loss : -0.034, train acc : 0.990, valid acc : 0.955, train f1 : 0.990, valid f1 : 0.640

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.99it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.71it/s][A
 51%|█████     | 99/195 [00:00<00:00, 327.01it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 330.49it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 332.61it/s][A100%|██████████| 195/195 [00:00<00:00, 330.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  29%|██▉       | 37/128 [1:01:58<2:37:47, 104.03s/it]EarlyStopping counter : 2 out of 40
training process:  30%|██▉       | 38/128 [1:03:34<2:32:30, 101.67s/it]EarlyStopping counter : 3 out of 40
training process:  30%|███       | 39/128 [1:05:09<2:27:48, 99.64s/it] EarlyStopping counter : 4 out of 40
training process:  31%|███▏      | 40/128 [1:06:41<2:22:41, 97.28s/it]epoch : 41, train loss : -0.047, valid loss : -0.035, train acc : 0.992, valid acc : 0.959, train f1 : 0.992, valid f1 : 0.649

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.16it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.32it/s][A
 51%|█████     | 99/195 [00:00<00:00, 327.11it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 332.09it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.15it/s][A100%|██████████| 195/195 [00:00<00:00, 333.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  32%|███▏      | 41/128 [1:08:41<2:30:45, 103.97s/it]EarlyStopping counter : 6 out of 40
training process:  33%|███▎      | 42/128 [1:10:14<2:24:32, 100.85s/it]EarlyStopping counter : 7 out of 40
training process:  34%|███▎      | 43/128 [1:11:47<2:19:27, 98.44s/it] EarlyStopping counter : 8 out of 40
training process:  34%|███▍      | 44/128 [1:13:21<2:15:45, 96.97s/it]epoch : 45, train loss : -0.048, valid loss : -0.034, train acc : 0.993, valid acc : 0.956, train f1 : 0.993, valid f1 : 0.638

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.29it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.61it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.37it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.54it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.92it/s][A100%|██████████| 195/195 [00:00<00:00, 333.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  35%|███▌      | 45/128 [1:15:22<2:24:10, 104.22s/it]EarlyStopping counter : 10 out of 40
training process:  36%|███▌      | 46/128 [1:16:55<2:18:05, 101.04s/it]EarlyStopping counter : 11 out of 40
training process:  37%|███▋      | 47/128 [1:18:27<2:12:40, 98.28s/it] Best score increase :0.654 -> 0.661
training process:  38%|███▊      | 48/128 [1:20:00<2:08:54, 96.68s/it]epoch : 49, train loss : -0.048, valid loss : -0.035, train acc : 0.993, valid acc : 0.958, train f1 : 0.993, valid f1 : 0.643

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.60it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 330.13it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 334.26it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.64it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.20it/s][A100%|██████████| 195/195 [00:00<00:00, 336.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  38%|███▊      | 49/128 [1:22:03<2:17:33, 104.48s/it]EarlyStopping counter : 2 out of 40
training process:  39%|███▉      | 50/128 [1:23:36<2:11:35, 101.22s/it]Best score increase :0.661 -> 0.664
training process:  40%|███▉      | 51/128 [1:25:11<2:07:17, 99.19s/it] EarlyStopping counter : 1 out of 40
training process:  41%|████      | 52/128 [1:26:43<2:03:04, 97.17s/it]epoch : 53, train loss : -0.048, valid loss : -0.036, train acc : 0.994, valid acc : 0.959, train f1 : 0.994, valid f1 : 0.647

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.66it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.04it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.05it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.02it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 312.30it/s][A100%|██████████| 195/195 [00:00<00:00, 318.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  41%|████▏     | 53/128 [1:28:42<2:09:38, 103.71s/it]EarlyStopping counter : 3 out of 40
training process:  42%|████▏     | 54/128 [1:30:17<2:04:38, 101.06s/it]EarlyStopping counter : 4 out of 40
training process:  43%|████▎     | 55/128 [1:31:49<1:59:42, 98.39s/it] EarlyStopping counter : 5 out of 40
training process:  44%|████▍     | 56/128 [1:33:22<1:56:07, 96.77s/it]epoch : 57, train loss : -0.048, valid loss : -0.033, train acc : 0.994, valid acc : 0.954, train f1 : 0.994, valid f1 : 0.633

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.33it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.84it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.72it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 337.30it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.64it/s][A100%|██████████| 195/195 [00:00<00:00, 336.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  45%|████▍     | 57/128 [1:35:22<2:02:35, 103.60s/it]EarlyStopping counter : 7 out of 40
training process:  45%|████▌     | 58/128 [1:36:54<1:56:43, 100.05s/it]Best score increase :0.664 -> 0.679
training process:  46%|████▌     | 59/128 [1:38:25<1:52:13, 97.59s/it] EarlyStopping counter : 1 out of 40
training process:  47%|████▋     | 60/128 [1:40:00<1:49:26, 96.56s/it]epoch : 61, train loss : -0.048, valid loss : -0.037, train acc : 0.995, valid acc : 0.968, train f1 : 0.995, valid f1 : 0.671

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.95it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.95it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.93it/s][A
 70%|███████   | 137/195 [00:00<00:00, 339.10it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.91it/s][A100%|██████████| 195/195 [00:00<00:00, 339.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  48%|████▊     | 61/128 [1:41:59<1:55:35, 103.52s/it]EarlyStopping counter : 3 out of 40
training process:  48%|████▊     | 62/128 [1:43:35<1:51:22, 101.25s/it]EarlyStopping counter : 4 out of 40
training process:  49%|████▉     | 63/128 [1:45:07<1:46:44, 98.52s/it] EarlyStopping counter : 5 out of 40
training process:  50%|█████     | 64/128 [1:46:43<1:44:00, 97.51s/it]epoch : 65, train loss : -0.049, valid loss : -0.037, train acc : 0.995, valid acc : 0.963, train f1 : 0.995, valid f1 : 0.653

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.10it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.04it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.28it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.51it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.25it/s][A100%|██████████| 195/195 [00:00<00:00, 336.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  51%|█████     | 65/128 [1:48:41<1:49:07, 103.92s/it]EarlyStopping counter : 7 out of 40
training process:  52%|█████▏    | 66/128 [1:50:14<1:43:48, 100.46s/it]EarlyStopping counter : 8 out of 40
training process:  52%|█████▏    | 67/128 [1:51:47<1:39:57, 98.31s/it] EarlyStopping counter : 9 out of 40
training process:  53%|█████▎    | 68/128 [1:53:19<1:36:28, 96.48s/it]epoch : 69, train loss : -0.049, valid loss : -0.035, train acc : 0.995, valid acc : 0.960, train f1 : 0.995, valid f1 : 0.647

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.48it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.17it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.86it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.57it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.65it/s][A100%|██████████| 195/195 [00:00<00:00, 334.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  54%|█████▍    | 69/128 [1:55:18<1:41:23, 103.10s/it]EarlyStopping counter : 11 out of 40
training process:  55%|█████▍    | 70/128 [1:56:50<1:36:24, 99.73s/it] EarlyStopping counter : 12 out of 40
training process:  55%|█████▌    | 71/128 [1:58:24<1:33:06, 98.00s/it]EarlyStopping counter : 13 out of 40
training process:  56%|█████▋    | 72/128 [1:59:57<1:30:05, 96.52s/it]epoch : 73, train loss : -0.049, valid loss : -0.037, train acc : 0.996, valid acc : 0.965, train f1 : 0.996, valid f1 : 0.663

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.66it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.33it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.26it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 339.65it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 339.93it/s][A100%|██████████| 195/195 [00:00<00:00, 339.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  57%|█████▋    | 73/128 [2:01:56<1:34:42, 103.32s/it]EarlyStopping counter : 15 out of 40
training process:  58%|█████▊    | 74/128 [2:03:28<1:29:57, 99.94s/it] EarlyStopping counter : 16 out of 40
training process:  59%|█████▊    | 75/128 [2:04:59<1:26:01, 97.39s/it]EarlyStopping counter : 17 out of 40
training process:  59%|█████▉    | 76/128 [2:06:33<1:23:25, 96.26s/it]epoch : 77, train loss : -0.049, valid loss : -0.038, train acc : 0.996, valid acc : 0.969, train f1 : 0.996, valid f1 : 0.668

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.00it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.52it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.45it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.51it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.07it/s][A100%|██████████| 195/195 [00:00<00:00, 340.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  60%|██████    | 77/128 [2:08:32<1:27:29, 102.92s/it]EarlyStopping counter : 19 out of 40
training process:  61%|██████    | 78/128 [2:10:03<1:22:49, 99.39s/it] EarlyStopping counter : 20 out of 40
training process:  62%|██████▏   | 79/128 [2:11:35<1:19:25, 97.25s/it]Best score increase :0.679 -> 0.680
training process:  62%|██████▎   | 80/128 [2:13:10<1:17:21, 96.69s/it]epoch : 81, train loss : -0.049, valid loss : -0.037, train acc : 0.996, valid acc : 0.964, train f1 : 0.996, valid f1 : 0.660

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.02it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 335.20it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.74it/s][A
 70%|███████   | 137/195 [00:00<00:00, 339.72it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 341.11it/s][A100%|██████████| 195/195 [00:00<00:00, 339.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  63%|██████▎   | 81/128 [2:15:12<1:21:31, 104.07s/it]EarlyStopping counter : 2 out of 40
training process:  64%|██████▍   | 82/128 [2:16:44<1:17:00, 100.44s/it]EarlyStopping counter : 3 out of 40
training process:  65%|██████▍   | 83/128 [2:18:14<1:13:08, 97.53s/it] EarlyStopping counter : 4 out of 40
training process:  66%|██████▌   | 84/128 [2:19:48<1:10:35, 96.26s/it]epoch : 85, train loss : -0.049, valid loss : -0.038, train acc : 0.996, valid acc : 0.969, train f1 : 0.996, valid f1 : 0.677

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.13it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.75it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.40it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.14it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.22it/s][A100%|██████████| 195/195 [00:00<00:00, 336.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  66%|██████▋   | 85/128 [2:21:49<1:14:17, 103.67s/it]EarlyStopping counter : 6 out of 40
training process:  67%|██████▋   | 86/128 [2:23:21<1:10:10, 100.24s/it]EarlyStopping counter : 7 out of 40
training process:  68%|██████▊   | 87/128 [2:24:52<1:06:37, 97.50s/it] EarlyStopping counter : 8 out of 40
training process:  69%|██████▉   | 88/128 [2:26:25<1:04:08, 96.22s/it]epoch : 89, train loss : -0.049, valid loss : -0.036, train acc : 0.997, valid acc : 0.959, train f1 : 0.997, valid f1 : 0.644

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.74it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.72it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.41it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.69it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.20it/s][A100%|██████████| 195/195 [00:00<00:00, 335.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  70%|██████▉   | 89/128 [2:28:24<1:06:59, 103.07s/it]Best score increase :0.680 -> 0.684
training process:  70%|███████   | 90/128 [2:29:59<1:03:44, 100.64s/it]EarlyStopping counter : 1 out of 40
training process:  71%|███████   | 91/128 [2:31:32<1:00:34, 98.24s/it] EarlyStopping counter : 2 out of 40
training process:  72%|███████▏  | 92/128 [2:33:04<57:55, 96.54s/it]  epoch : 93, train loss : -0.049, valid loss : -0.036, train acc : 0.997, valid acc : 0.964, train f1 : 0.997, valid f1 : 0.660

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 197.33it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 255.67it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 287.89it/s][A
 59%|█████▉    | 116/195 [00:00<00:00, 304.13it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 311.18it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 318.03it/s][A100%|██████████| 195/195 [00:00<00:00, 302.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  73%|███████▎  | 93/128 [2:35:05<1:00:31, 103.75s/it]EarlyStopping counter : 4 out of 40
training process:  73%|███████▎  | 94/128 [2:36:38<56:58, 100.53s/it]  EarlyStopping counter : 5 out of 40
training process:  74%|███████▍  | 95/128 [2:38:11<54:07, 98.39s/it] EarlyStopping counter : 6 out of 40
training process:  75%|███████▌  | 96/128 [2:39:46<51:53, 97.30s/it]epoch : 97, train loss : -0.049, valid loss : -0.037, train acc : 0.997, valid acc : 0.970, train f1 : 0.997, valid f1 : 0.672

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.41it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.92it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 348.86it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 350.32it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 351.18it/s][A100%|██████████| 195/195 [00:00<00:00, 349.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  76%|███████▌  | 97/128 [2:41:43<53:20, 103.24s/it]Best score increase :0.684 -> 0.688
training process:  77%|███████▋  | 98/128 [2:43:18<50:24, 100.83s/it]EarlyStopping counter : 1 out of 40
training process:  77%|███████▋  | 99/128 [2:44:52<47:40, 98.65s/it] EarlyStopping counter : 2 out of 40
training process:  78%|███████▊  | 100/128 [2:46:25<45:18, 97.08s/it]epoch : 101, train loss : -0.049, valid loss : -0.038, train acc : 0.997, valid acc : 0.967, train f1 : 0.997, valid f1 : 0.666

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.25it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.58it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.47it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.62it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 335.61it/s][A100%|██████████| 195/195 [00:00<00:00, 335.41it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  79%|███████▉  | 101/128 [2:48:27<47:03, 104.56s/it]EarlyStopping counter : 4 out of 40
training process:  80%|███████▉  | 102/128 [2:50:00<43:44, 100.96s/it]EarlyStopping counter : 5 out of 40
training process:  80%|████████  | 103/128 [2:51:32<40:55, 98.23s/it] EarlyStopping counter : 6 out of 40
training process:  81%|████████▏ | 104/128 [2:53:05<38:41, 96.74s/it]epoch : 105, train loss : -0.049, valid loss : -0.035, train acc : 0.997, valid acc : 0.959, train f1 : 0.997, valid f1 : 0.644

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 196.07it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 252.84it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 287.04it/s][A
 59%|█████▉    | 116/195 [00:00<00:00, 303.62it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 313.03it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 318.92it/s][A100%|██████████| 195/195 [00:00<00:00, 302.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  82%|████████▏ | 105/128 [2:55:05<39:42, 103.60s/it]Best score increase :0.688 -> 0.689
training process:  83%|████████▎ | 106/128 [2:56:36<36:39, 99.96s/it] EarlyStopping counter : 1 out of 40
training process:  84%|████████▎ | 107/128 [2:58:08<34:08, 97.54s/it]EarlyStopping counter : 2 out of 40
training process:  84%|████████▍ | 108/128 [2:59:44<32:21, 97.05s/it]epoch : 109, train loss : -0.050, valid loss : -0.035, train acc : 0.998, valid acc : 0.959, train f1 : 0.998, valid f1 : 0.643

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.60it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.17it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.79it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.54it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.63it/s][A100%|██████████| 195/195 [00:00<00:00, 340.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  85%|████████▌ | 109/128 [3:01:45<33:00, 104.22s/it]EarlyStopping counter : 4 out of 40
training process:  86%|████████▌ | 110/128 [3:03:18<30:16, 100.89s/it]EarlyStopping counter : 5 out of 40
training process:  87%|████████▋ | 111/128 [3:04:51<27:52, 98.40s/it] EarlyStopping counter : 6 out of 40
training process:  88%|████████▊ | 112/128 [3:06:23<25:45, 96.59s/it]epoch : 113, train loss : -0.050, valid loss : -0.039, train acc : 0.997, valid acc : 0.970, train f1 : 0.997, valid f1 : 0.674

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.29it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.05it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 327.07it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 330.68it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.96it/s][A100%|██████████| 195/195 [00:00<00:00, 331.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  88%|████████▊ | 113/128 [3:08:22<25:51, 103.41s/it]EarlyStopping counter : 8 out of 40
training process:  89%|████████▉ | 114/128 [3:09:57<23:31, 100.81s/it]EarlyStopping counter : 9 out of 40
training process:  90%|████████▉ | 115/128 [3:11:30<21:18, 98.36s/it] EarlyStopping counter : 10 out of 40
training process:  91%|█████████ | 116/128 [3:13:05<19:28, 97.33s/it]epoch : 117, train loss : -0.050, valid loss : -0.038, train acc : 0.998, valid acc : 0.970, train f1 : 0.998, valid f1 : 0.678

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.76it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.04it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.88it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.21it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.42it/s][A100%|██████████| 195/195 [00:00<00:00, 337.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  91%|█████████▏| 117/128 [3:15:04<19:03, 103.93s/it]EarlyStopping counter : 12 out of 40
training process:  92%|█████████▏| 118/128 [3:16:38<16:47, 100.79s/it]EarlyStopping counter : 13 out of 40
training process:  93%|█████████▎| 119/128 [3:18:08<14:39, 97.73s/it] EarlyStopping counter : 14 out of 40
training process:  94%|█████████▍| 120/128 [3:19:39<12:46, 95.75s/it]epoch : 121, train loss : -0.050, valid loss : -0.035, train acc : 0.998, valid acc : 0.961, train f1 : 0.998, valid f1 : 0.646

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.24it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 319.28it/s][A
 51%|█████     | 99/195 [00:00<00:00, 326.63it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 330.86it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 333.29it/s][A100%|██████████| 195/195 [00:00<00:00, 330.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  95%|█████████▍| 121/128 [3:21:40<12:02, 103.20s/it]EarlyStopping counter : 16 out of 40
training process:  95%|█████████▌| 122/128 [3:23:12<09:59, 99.93s/it] EarlyStopping counter : 17 out of 40
training process:  96%|█████████▌| 123/128 [3:24:46<08:10, 98.07s/it]EarlyStopping counter : 18 out of 40
training process:  97%|█████████▋| 124/128 [3:26:20<06:27, 96.89s/it]epoch : 125, train loss : -0.050, valid loss : -0.038, train acc : 0.998, valid acc : 0.969, train f1 : 0.998, valid f1 : 0.679

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.58it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.83it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.87it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.02it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.08it/s][A100%|██████████| 195/195 [00:00<00:00, 339.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  98%|█████████▊| 125/128 [3:28:20<05:11, 103.69s/it]EarlyStopping counter : 20 out of 40
training process:  98%|█████████▊| 126/128 [3:29:51<03:20, 100.06s/it]EarlyStopping counter : 21 out of 40
training process:  99%|█████████▉| 127/128 [3:31:22<01:37, 97.27s/it] EarlyStopping counter : 22 out of 40
training process: 100%|██████████| 128/128 [3:32:56<00:00, 96.35s/it]training process: 100%|██████████| 128/128 [3:32:56<00:00, 99.82s/it]
training process finished, best loss : -0.039 and best acc : 0.972, best f1 : 0.689, best epoch : 105

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.40      0.39      0.39       303
           1       0.99      0.99      0.99     16947

    accuracy                           0.98     17250
   macro avg       0.69      0.69      0.69     17250
weighted avg       0.98      0.98      0.98     17250


# test acc : 0.98, test f1 : 0.69, test AUC : 0.69, test loss : -10.585

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:16, 12.31s/it]processing for feature importance:  12%|█▏        | 2/17 [00:25<03:11, 12.75s/it]processing for feature importance:  18%|█▊        | 3/17 [00:37<02:55, 12.51s/it]processing for feature importance:  24%|██▎       | 4/17 [00:50<02:45, 12.75s/it]processing for feature importance:  29%|██▉       | 5/17 [01:03<02:33, 12.81s/it]processing for feature importance:  35%|███▌      | 6/17 [01:16<02:19, 12.71s/it]processing for feature importance:  41%|████      | 7/17 [01:28<02:06, 12.66s/it]processing for feature importance:  47%|████▋     | 8/17 [01:40<01:52, 12.51s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:54<01:42, 12.75s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:06<01:28, 12.59s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:18<01:15, 12.51s/it]processing for feature importance:  71%|███████   | 12/17 [02:31<01:03, 12.68s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:43<00:49, 12.41s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:56<00:37, 12.54s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:08<00:24, 12.43s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:20<00:12, 12.39s/it]processing for feature importance: 100%|██████████| 17/17 [03:33<00:00, 12.48s/it]processing for feature importance: 100%|██████████| 17/17 [03:33<00:00, 12.57s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:03<11:33,  3.30s/it]visualize 2D latent space:   1%|          | 2/211 [00:03<06:32,  1.88s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:03,  1.84s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:25,  1.30s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:02<08:16,  2.37s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:03<05:32,  1.59s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:03<06:26,  1.85s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<01:59,  1.79s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:26,  1.31s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 17%|█▋        | 33/195 [00:00<00:00, 321.68it/s] 35%|███▍      | 68/195 [00:00<00:00, 336.91it/s] 53%|█████▎    | 103/195 [00:00<00:00, 342.21it/s] 71%|███████   | 138/195 [00:00<00:00, 344.84it/s] 89%|████████▊ | 173/195 [00:00<00:00, 346.30it/s]100%|██████████| 195/195 [00:00<00:00, 343.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_smoothing_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 207.44it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 202.13it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 201.17it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 204.04it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 206.05it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 208.99it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 211.39it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 212.83it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 210.39it/s]remove invalid data : null / measurement error:  35%|███▍      | 215/616 [00:01<00:01, 209.66it/s]remove invalid data : null / measurement error:  38%|███▊      | 236/616 [00:01<00:01, 209.36it/s]remove invalid data : null / measurement error:  42%|████▏     | 257/616 [00:01<00:01, 208.44it/s]remove invalid data : null / measurement error:  45%|████▌     | 279/616 [00:01<00:01, 209.33it/s]remove invalid data : null / measurement error:  49%|████▊     | 300/616 [00:01<00:01, 208.79it/s]remove invalid data : null / measurement error:  52%|█████▏    | 321/616 [00:01<00:01, 207.58it/s]remove invalid data : null / measurement error:  56%|█████▌    | 342/616 [00:01<00:01, 207.13it/s]remove invalid data : null / measurement error:  59%|█████▉    | 364/616 [00:01<00:01, 209.78it/s]remove invalid data : null / measurement error:  63%|██████▎   | 390/616 [00:01<00:01, 222.99it/s]remove invalid data : null / measurement error:  68%|██████▊   | 418/616 [00:01<00:00, 238.14it/s]remove invalid data : null / measurement error:  72%|███████▏  | 442/616 [00:02<00:00, 233.04it/s]remove invalid data : null / measurement error:  76%|███████▌  | 466/616 [00:02<00:00, 232.36it/s]remove invalid data : null / measurement error:  80%|███████▉  | 490/616 [00:02<00:00, 225.10it/s]remove invalid data : null / measurement error:  83%|████████▎ | 513/616 [00:02<00:00, 220.23it/s]remove invalid data : null / measurement error:  87%|████████▋ | 536/616 [00:02<00:00, 215.75it/s]remove invalid data : null / measurement error:  91%|█████████ | 558/616 [00:02<00:00, 212.63it/s]remove invalid data : null / measurement error:  94%|█████████▍| 580/616 [00:02<00:00, 210.81it/s]remove invalid data : null / measurement error:  98%|█████████▊| 602/616 [00:02<00:00, 209.52it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 213.32it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 241.87it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 241.62it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 242.26it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 242.99it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 242.61it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 242.98it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 244.09it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 245.02it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 245.92it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 246.71it/s]replace nan value:  54%|█████▎    | 276/515 [00:01<00:00, 247.64it/s]replace nan value:  58%|█████▊    | 301/515 [00:01<00:00, 246.99it/s]replace nan value:  63%|██████▎   | 326/515 [00:01<00:00, 246.84it/s]replace nan value:  68%|██████▊   | 351/515 [00:01<00:00, 241.77it/s]replace nan value:  73%|███████▎  | 376/515 [00:01<00:00, 242.56it/s]replace nan value:  78%|███████▊  | 401/515 [00:01<00:00, 242.62it/s]replace nan value:  83%|████████▎ | 426/515 [00:01<00:00, 242.33it/s]replace nan value:  88%|████████▊ | 451/515 [00:01<00:00, 242.09it/s]replace nan value:  92%|█████████▏| 476/515 [00:01<00:00, 243.63it/s]replace nan value:  97%|█████████▋| 501/515 [00:02<00:00, 245.23it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 244.20it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.52it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.60it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 76.03it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.41it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.94it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.98it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.11it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.21it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.92it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.83it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.79it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.31it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.06it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.78it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.23it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.90it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.02it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.70it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 71.30it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.03it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.10it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.12it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.25it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.65it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.77it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.17it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.07it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.59it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 89.07it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 74.75it/s]generate index:  50%|█████     | 260/515 [00:03<00:03, 73.05it/s]generate index:  52%|█████▏    | 269/515 [00:03<00:03, 76.40it/s]generate index:  54%|█████▍    | 277/515 [00:04<00:03, 73.48it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 63.40it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.88it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.08it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 60.99it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 61.13it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 60.82it/s]generate index:  64%|██████▎   | 328/515 [00:04<00:02, 64.76it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 57.28it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 46.28it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 44.47it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 50.83it/s]generate index:  71%|███████   | 364/515 [00:05<00:02, 59.23it/s]generate index:  73%|███████▎  | 376/515 [00:05<00:01, 72.54it/s]generate index:  75%|███████▍  | 385/515 [00:05<00:01, 76.12it/s]generate index:  76%|███████▋  | 393/515 [00:05<00:01, 75.10it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.61it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.19it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.45it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.09it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.55it/s]generate index:  86%|████████▌ | 444/515 [00:06<00:01, 48.46it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.55it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.49it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.42it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.46it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.34it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.04it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.84it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.46it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▋         | 10/154 [00:00<00:01, 99.73it/s]remove invalid data : null / measurement error:  21%|██        | 32/154 [00:00<00:00, 165.83it/s]remove invalid data : null / measurement error:  35%|███▌      | 54/154 [00:00<00:00, 186.93it/s]remove invalid data : null / measurement error:  49%|████▉     | 76/154 [00:00<00:00, 198.07it/s]remove invalid data : null / measurement error:  65%|██████▍   | 100/154 [00:00<00:00, 209.45it/s]remove invalid data : null / measurement error:  80%|███████▉  | 123/154 [00:00<00:00, 214.81it/s]remove invalid data : null / measurement error:  94%|█████████▍| 145/154 [00:00<00:00, 212.79it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 201.01it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 255.80it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 255.85it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 254.84it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 251.82it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 254.56it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 254.18it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.02it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.53it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.97it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.13it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.35it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.61it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.91it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 64.05it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 68.08it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 70.02it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.55it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.09it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 47.92it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 47.96it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 48.70it/s]generate index:  89%|████████▊ | 116/131 [00:02<00:00, 58.05it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 69.93it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.93it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   7%|▋         | 13/193 [00:00<00:01, 125.62it/s]remove invalid data : null / measurement error:  18%|█▊        | 34/193 [00:00<00:00, 173.32it/s]remove invalid data : null / measurement error:  29%|██▉       | 56/193 [00:00<00:00, 193.51it/s]remove invalid data : null / measurement error:  40%|████      | 78/193 [00:00<00:00, 202.73it/s]remove invalid data : null / measurement error:  52%|█████▏    | 100/193 [00:00<00:00, 206.41it/s]remove invalid data : null / measurement error:  64%|██████▍   | 124/193 [00:00<00:00, 215.57it/s]remove invalid data : null / measurement error:  76%|███████▌  | 147/193 [00:00<00:00, 220.17it/s]remove invalid data : null / measurement error:  88%|████████▊ | 170/193 [00:00<00:00, 215.76it/s]remove invalid data : null / measurement error:  99%|█████████▉| 192/193 [00:00<00:00, 213.44it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 206.35it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 256.91it/s]replace nan value:  33%|███▎      | 53/160 [00:00<00:00, 258.82it/s]replace nan value:  49%|████▉     | 79/160 [00:00<00:00, 257.57it/s]replace nan value:  66%|██████▌   | 105/160 [00:00<00:00, 254.76it/s]replace nan value:  82%|████████▏ | 131/160 [00:00<00:00, 254.56it/s]replace nan value:  98%|█████████▊| 157/160 [00:00<00:00, 254.63it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 255.31it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.58it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.33it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.58it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.18it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.88it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.89it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.99it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.00it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.18it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.06it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.60it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.78it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.44it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.57it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.15it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.94it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.15it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.46it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.92it/s]
================= Dataset information =================
train data : 53796, disrupt : 962, non-disrupt : 52834
valid data : 14942, disrupt : 250, non-disrupt : 14692
test data : 17250, disrupt : 303, non-disrupt : 16947

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.562, valid loss : -0.826, train acc : 0.561, valid acc : 0.654, train f1 : 0.373, valid f1 : 0.409

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 351.43it/s][A
 37%|███▋      | 72/195 [00:00<00:00, 355.25it/s][A
 55%|█████▌    | 108/195 [00:00<00:00, 352.67it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 354.93it/s][A
 92%|█████████▏| 180/195 [00:00<00:00, 356.18it/s][A100%|██████████| 195/195 [00:00<00:00, 355.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.409
training process:   1%|          | 1/128 [01:58<4:11:14, 118.69s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:25<3:29:20, 99.69s/it] EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:54<3:18:20, 95.20s/it]EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:23<3:11:20, 92.58s/it]epoch : 5, train loss : -3.406, valid loss : -4.168, train acc : 0.466, valid acc : 0.421, train f1 : 0.332, valid f1 : 0.309

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█▏        | 22/195 [00:00<00:00, 212.34it/s][A
 23%|██▎       | 45/195 [00:00<00:00, 221.23it/s][A
 39%|███▉      | 76/195 [00:00<00:00, 258.99it/s][A
 56%|█████▋    | 110/195 [00:00<00:00, 287.89it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 303.86it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 257.13it/s][A100%|██████████| 195/195 [00:00<00:00, 262.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:20<3:27:50, 101.39s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:47<3:16:21, 96.57s/it] EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:19<3:11:25, 94.92s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:47<3:05:22, 92.69s/it]epoch : 9, train loss : -6.952, valid loss : -7.649, train acc : 0.252, valid acc : 0.272, train f1 : 0.215, valid f1 : 0.228

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.17it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.20it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.27it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.27it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.90it/s][A100%|██████████| 195/195 [00:00<00:00, 342.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:40<3:16:50, 99.24s/it]EarlyStopping counter : 9 out of 40
training process:   8%|▊         | 10/128 [16:07<3:07:32, 95.36s/it]EarlyStopping counter : 10 out of 40
training process:   9%|▊         | 11/128 [17:37<3:02:50, 93.77s/it]EarlyStopping counter : 11 out of 40
training process:   9%|▉         | 12/128 [19:05<2:57:58, 92.06s/it]epoch : 13, train loss : -11.917, valid loss : -13.182, train acc : 0.250, valid acc : 0.264, train f1 : 0.214, valid f1 : 0.222

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 203.43it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 252.36it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 290.91it/s][A
 61%|██████    | 118/195 [00:00<00:00, 309.62it/s][A
 77%|███████▋  | 151/195 [00:00<00:00, 316.01it/s][A
 95%|█████████▍| 185/195 [00:00<00:00, 323.39it/s][A100%|██████████| 195/195 [00:00<00:00, 306.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  10%|█         | 13/128 [21:04<3:11:40, 100.00s/it]EarlyStopping counter : 13 out of 40
training process:  11%|█         | 14/128 [22:33<3:03:41, 96.68s/it] EarlyStopping counter : 14 out of 40
training process:  12%|█▏        | 15/128 [23:58<2:55:42, 93.30s/it]EarlyStopping counter : 15 out of 40
training process:  12%|█▎        | 16/128 [25:25<2:50:43, 91.46s/it]epoch : 17, train loss : -17.411, valid loss : -18.746, train acc : 0.214, valid acc : 0.245, train f1 : 0.188, valid f1 : 0.209

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.06it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.58it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.92it/s][A
 70%|███████   | 137/195 [00:00<00:00, 340.47it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 337.35it/s][A100%|██████████| 195/195 [00:00<00:00, 338.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  13%|█▎        | 17/128 [27:24<3:04:16, 99.61s/it]EarlyStopping counter : 17 out of 40
training process:  14%|█▍        | 18/128 [28:51<2:55:40, 95.82s/it]EarlyStopping counter : 18 out of 40
training process:  15%|█▍        | 19/128 [30:21<2:50:54, 94.08s/it]EarlyStopping counter : 19 out of 40
training process:  16%|█▌        | 20/128 [31:51<2:47:28, 93.04s/it]epoch : 21, train loss : -23.865, valid loss : -25.354, train acc : 0.216, valid acc : 0.224, train f1 : 0.190, valid f1 : 0.195

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 193.95it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 251.20it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 281.52it/s][A
 59%|█████▉    | 116/195 [00:00<00:00, 302.43it/s][A
 77%|███████▋  | 150/195 [00:00<00:00, 314.31it/s][A
 94%|█████████▍| 184/195 [00:00<00:00, 321.60it/s][A100%|██████████| 195/195 [00:00<00:00, 302.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  16%|█▋        | 21/128 [33:49<2:59:08, 100.45s/it]EarlyStopping counter : 21 out of 40
training process:  17%|█▋        | 22/128 [35:17<2:50:41, 96.62s/it] EarlyStopping counter : 22 out of 40
training process:  18%|█▊        | 23/128 [36:45<2:44:30, 94.01s/it]EarlyStopping counter : 23 out of 40
training process:  19%|█▉        | 24/128 [38:14<2:40:27, 92.57s/it]epoch : 25, train loss : -29.581, valid loss : -31.498, train acc : 0.215, valid acc : 0.225, train f1 : 0.189, valid f1 : 0.195

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.34it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 341.95it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 343.99it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 344.97it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 345.54it/s][A100%|██████████| 195/195 [00:00<00:00, 344.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  20%|█▉        | 25/128 [40:08<2:50:12, 99.15s/it]EarlyStopping counter : 25 out of 40
training process:  20%|██        | 26/128 [41:40<2:44:46, 96.93s/it]EarlyStopping counter : 26 out of 40
training process:  21%|██        | 27/128 [43:08<2:38:24, 94.10s/it]EarlyStopping counter : 27 out of 40
training process:  22%|██▏       | 28/128 [44:39<2:35:15, 93.16s/it]epoch : 29, train loss : -35.680, valid loss : -39.776, train acc : 0.169, valid acc : 0.180, train f1 : 0.154, valid f1 : 0.162

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 344.38it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 350.48it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 352.63it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 353.82it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 354.24it/s][A100%|██████████| 195/195 [00:00<00:00, 352.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  23%|██▎       | 29/128 [46:35<2:45:07, 100.07s/it]EarlyStopping counter : 29 out of 40
training process:  23%|██▎       | 30/128 [48:04<2:38:06, 96.80s/it] EarlyStopping counter : 30 out of 40
training process:  24%|██▍       | 31/128 [49:34<2:33:21, 94.86s/it]EarlyStopping counter : 31 out of 40
training process:  25%|██▌       | 32/128 [51:03<2:28:53, 93.06s/it]epoch : 33, train loss : -43.800, valid loss : -50.883, train acc : 0.218, valid acc : 0.206, train f1 : 0.191, valid f1 : 0.181

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.21it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.21it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.28it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.33it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.03it/s][A100%|██████████| 195/195 [00:00<00:00, 342.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  26%|██▌       | 33/128 [52:56<2:36:51, 99.07s/it]EarlyStopping counter : 33 out of 40
training process:  27%|██▋       | 34/128 [54:25<2:30:21, 95.97s/it]EarlyStopping counter : 34 out of 40
training process:  27%|██▋       | 35/128 [55:53<2:25:12, 93.68s/it]EarlyStopping counter : 35 out of 40
training process:  28%|██▊       | 36/128 [57:24<2:22:07, 92.69s/it]epoch : 37, train loss : -49.999, valid loss : -58.034, train acc : 0.192, valid acc : 0.151, train f1 : 0.172, valid f1 : 0.139

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.61it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.41it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.46it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.51it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.17it/s][A100%|██████████| 195/195 [00:00<00:00, 343.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  29%|██▉       | 37/128 [59:19<2:30:59, 99.55s/it]EarlyStopping counter : 37 out of 40
training process:  30%|██▉       | 38/128 [1:00:49<2:25:02, 96.70s/it]EarlyStopping counter : 38 out of 40
training process:  30%|███       | 39/128 [1:02:19<2:20:15, 94.56s/it]EarlyStopping counter : 39 out of 40
training process:  31%|███▏      | 40/128 [1:03:49<2:16:32, 93.09s/it]epoch : 41, train loss : -55.911, valid loss : -64.733, train acc : 0.133, valid acc : 0.125, train f1 : 0.125, valid f1 : 0.117

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 196.16it/s][A
 21%|██        | 40/195 [00:00<00:00, 184.89it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 229.27it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 269.27it/s][A
 70%|███████   | 137/195 [00:00<00:00, 291.82it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 305.57it/s][A100%|██████████| 195/195 [00:00<00:00, 279.60it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 40, best f1 score : 0.409
training process:  31%|███▏      | 40/128 [1:05:44<2:24:37, 98.61s/it]
training process finished, best loss : -0.826 and best acc : 0.654, best f1 : 0.409, best epoch : 0

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.01      0.34      0.03       303
           1       0.98      0.57      0.72     16947

    accuracy                           0.57     17250
   macro avg       0.50      0.46      0.37     17250
weighted avg       0.96      0.57      0.71     17250


# test acc : 0.57, test f1 : 0.37, test AUC : 0.46, test loss : -259.333

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:14<03:55, 14.72s/it]processing for feature importance:  12%|█▏        | 2/17 [00:26<03:12, 12.81s/it]processing for feature importance:  18%|█▊        | 3/17 [00:37<02:49, 12.07s/it]processing for feature importance:  24%|██▎       | 4/17 [00:49<02:34, 11.92s/it]processing for feature importance:  29%|██▉       | 5/17 [01:01<02:26, 12.20s/it]processing for feature importance:  35%|███▌      | 6/17 [01:13<02:10, 11.90s/it]processing for feature importance:  41%|████      | 7/17 [01:24<01:59, 11.91s/it]processing for feature importance:  47%|████▋     | 8/17 [01:36<01:45, 11.72s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:48<01:33, 11.72s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:59<01:21, 11.70s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:11<01:10, 11.72s/it]processing for feature importance:  71%|███████   | 12/17 [02:23<00:58, 11.69s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:35<00:47, 11.89s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:47<00:36, 12.04s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:59<00:23, 12.00s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:11<00:12, 12.03s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 11.77s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 11.94s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/211 [00:03<13:53,  3.97s/it]visualize 2D latent space:   1%|          | 2/211 [00:05<09:37,  2.76s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:13,  2.00s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:15,  1.15s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:48,  1.65s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/211 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/211 [00:03<11:55,  3.40s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:04<06:26,  1.85s/it]visualize 2D latent space with decision boundary:   1%|          | 2/211 [00:05<10:05,  2.90s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
Transformer_clip_10_dist_1_Focal_smoothing_RW_Robust_TQ_seed_42 : visualize 2D latent space doesn't work due to stability error

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 302.24it/s] 34%|███▍      | 66/195 [00:00<00:00, 326.74it/s] 52%|█████▏    | 101/195 [00:00<00:00, 334.27it/s] 69%|██████▉   | 135/195 [00:00<00:00, 335.02it/s] 87%|████████▋ | 170/195 [00:00<00:00, 338.25it/s]100%|██████████| 195/195 [00:00<00:00, 329.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 207.02it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 204.06it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 201.74it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 203.96it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 205.57it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.86it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 209.68it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 211.43it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 209.00it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 208.55it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 208.29it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 207.76it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 208.79it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 208.15it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 207.05it/s]remove invalid data : null / measurement error:  55%|█████▌    | 341/616 [00:01<00:01, 206.78it/s]remove invalid data : null / measurement error:  59%|█████▉    | 363/616 [00:01<00:01, 208.94it/s]remove invalid data : null / measurement error:  63%|██████▎   | 389/616 [00:01<00:01, 222.53it/s]remove invalid data : null / measurement error:  68%|██████▊   | 417/616 [00:01<00:00, 237.93it/s]remove invalid data : null / measurement error:  72%|███████▏  | 441/616 [00:02<00:00, 233.49it/s]remove invalid data : null / measurement error:  75%|███████▌  | 465/616 [00:02<00:00, 233.13it/s]remove invalid data : null / measurement error:  79%|███████▉  | 489/616 [00:02<00:00, 225.65it/s]remove invalid data : null / measurement error:  83%|████████▎ | 512/616 [00:02<00:00, 220.18it/s]remove invalid data : null / measurement error:  87%|████████▋ | 535/616 [00:02<00:00, 214.89it/s]remove invalid data : null / measurement error:  90%|█████████ | 557/616 [00:02<00:00, 211.19it/s]remove invalid data : null / measurement error:  94%|█████████▍| 579/616 [00:02<00:00, 209.46it/s]remove invalid data : null / measurement error:  97%|█████████▋| 600/616 [00:02<00:00, 208.33it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 212.68it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.75it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.08it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 235.62it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 237.78it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 238.89it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 240.11it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 240.47it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 240.06it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 239.89it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 240.16it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:01, 240.39it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 239.03it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 239.48it/s]replace nan value:  67%|██████▋   | 346/515 [00:01<00:00, 237.22it/s]replace nan value:  72%|███████▏  | 370/515 [00:01<00:00, 237.66it/s]replace nan value:  77%|███████▋  | 395/515 [00:01<00:00, 238.77it/s]replace nan value:  81%|████████▏ | 419/515 [00:01<00:00, 238.26it/s]replace nan value:  86%|████████▌ | 443/515 [00:01<00:00, 237.31it/s]replace nan value:  91%|█████████ | 468/515 [00:01<00:00, 239.17it/s]replace nan value:  96%|█████████▌| 493/515 [00:02<00:00, 240.03it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 238.90it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.54it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.23it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.38it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 71.98it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.77it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.33it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.54it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.92it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.77it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.69it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.46it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.03it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.79it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.34it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.79it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.84it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 70.30it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.45it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.36it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 70.20it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 71.45it/s]generate index:  34%|███▍      | 175/515 [00:02<00:04, 68.13it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.38it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.64it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.68it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.74it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.41it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.79it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.75it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.46it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.62it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.27it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.15it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.23it/s]generate index:  57%|█████▋    | 291/515 [00:04<00:03, 63.89it/s]generate index:  58%|█████▊    | 298/515 [00:04<00:03, 61.63it/s]generate index:  59%|█████▉    | 305/515 [00:04<00:03, 62.95it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 64.29it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 60.38it/s]generate index:  63%|██████▎   | 327/515 [00:04<00:02, 64.51it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 58.41it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 46.59it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 44.72it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 50.78it/s]generate index:  71%|███████   | 364/515 [00:05<00:02, 58.92it/s]generate index:  73%|███████▎  | 376/515 [00:05<00:01, 71.91it/s]generate index:  75%|███████▍  | 385/515 [00:05<00:01, 75.59it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 74.93it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 62.83it/s]generate index:  79%|███████▉  | 408/515 [00:06<00:02, 53.37it/s]generate index:  81%|████████  | 416/515 [00:06<00:01, 59.06it/s]generate index:  83%|████████▎ | 427/515 [00:06<00:01, 70.28it/s]generate index:  84%|████████▍ | 435/515 [00:06<00:01, 56.37it/s]generate index:  86%|████████▌ | 442/515 [00:07<00:01, 46.02it/s]generate index:  88%|████████▊ | 453/515 [00:07<00:01, 57.48it/s]generate index:  90%|████████▉ | 462/515 [00:07<00:00, 64.42it/s]generate index:  91%|█████████▏| 470/515 [00:07<00:00, 56.54it/s]generate index:  93%|█████████▎| 480/515 [00:07<00:00, 64.63it/s]generate index:  95%|█████████▍| 488/515 [00:07<00:00, 67.64it/s]generate index:  96%|█████████▋| 496/515 [00:07<00:00, 66.78it/s]generate index:  98%|█████████▊| 504/515 [00:07<00:00, 69.57it/s]generate index:  99%|█████████▉| 512/515 [00:07<00:00, 69.18it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.55it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 67.88it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 149.77it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 176.91it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 191.76it/s]remove invalid data : null / measurement error:  60%|██████    | 93/154 [00:00<00:00, 199.48it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 212.94it/s]remove invalid data : null / measurement error:  91%|█████████ | 140/154 [00:00<00:00, 210.62it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 195.23it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.11it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 249.80it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 250.32it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 247.10it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 249.18it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 248.73it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.03it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.37it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.75it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.93it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.30it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.59it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 62.18it/s]generate index:  46%|████▌     | 60/131 [00:00<00:01, 65.37it/s]generate index:  51%|█████     | 67/131 [00:01<00:00, 65.95it/s]generate index:  57%|█████▋    | 75/131 [00:01<00:00, 68.01it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 65.46it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.51it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.37it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.31it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 48.88it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.52it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 70.99it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.10it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 6/193 [00:00<00:03, 59.45it/s]remove invalid data : null / measurement error:  15%|█▍        | 28/193 [00:00<00:01, 150.90it/s]remove invalid data : null / measurement error:  26%|██▌       | 50/193 [00:00<00:00, 179.14it/s]remove invalid data : null / measurement error:  37%|███▋      | 72/193 [00:00<00:00, 194.81it/s]remove invalid data : null / measurement error:  49%|████▊     | 94/193 [00:00<00:00, 200.68it/s]remove invalid data : null / measurement error:  60%|█████▉    | 115/193 [00:00<00:00, 202.66it/s]remove invalid data : null / measurement error:  73%|███████▎  | 140/193 [00:00<00:00, 217.25it/s]remove invalid data : null / measurement error:  84%|████████▍ | 162/193 [00:00<00:00, 215.01it/s]remove invalid data : null / measurement error:  95%|█████████▌| 184/193 [00:00<00:00, 212.24it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 198.99it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 249.73it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 251.94it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 251.04it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 247.92it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 247.55it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 248.70it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 248.84it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.56it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.22it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.49it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.31it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.11it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.82it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.95it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.89it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.26it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.20it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.82it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.93it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.90it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.96it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.27it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.94it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.14it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.50it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.03it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.223, valid loss : 0.083, train acc : 0.958, valid acc : 0.984, train f1 : 0.502, valid f1 : 0.496

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 349.74it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 352.68it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 353.22it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 353.84it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 354.09it/s][A100%|██████████| 195/195 [00:00<00:00, 353.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.496
training process:   1%|          | 1/128 [01:58<4:09:51, 118.05s/it]Best score increase :0.496 -> 0.625
training process:   2%|▏         | 2/128 [03:28<3:33:34, 101.70s/it]Best score increase :0.625 -> 0.816
training process:   2%|▏         | 3/128 [04:57<3:19:58, 95.99s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:26<3:12:50, 93.31s/it]epoch : 5, train loss : 0.040, valid loss : 0.037, train acc : 0.990, valid acc : 0.991, train f1 : 0.821, valid f1 : 0.832

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 346.04it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 349.04it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 350.03it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 350.39it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 350.68it/s][A100%|██████████| 195/195 [00:00<00:00, 350.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.816 -> 0.832
training process:   4%|▍         | 5/128 [08:20<3:26:04, 100.52s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [09:50<3:17:28, 97.12s/it] Best score increase :0.832 -> 0.861
training process:   5%|▌         | 7/128 [11:22<3:12:21, 95.39s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:53<3:08:21, 94.18s/it]epoch : 9, train loss : 0.035, valid loss : 0.031, train acc : 0.991, valid acc : 0.991, train f1 : 0.847, valid f1 : 0.853

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.24it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 343.59it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 344.96it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 343.48it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 344.33it/s][A100%|██████████| 195/195 [00:00<00:00, 344.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:49<3:19:55, 100.81s/it]EarlyStopping counter : 3 out of 40
training process:   8%|▊         | 10/128 [16:20<3:12:07, 97.69s/it]EarlyStopping counter : 4 out of 40
training process:   9%|▊         | 11/128 [17:48<3:05:17, 95.02s/it]EarlyStopping counter : 5 out of 40
training process:   9%|▉         | 12/128 [19:19<3:00:46, 93.51s/it]epoch : 13, train loss : 0.031, valid loss : 0.033, train acc : 0.991, valid acc : 0.992, train f1 : 0.860, valid f1 : 0.858

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.91it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.78it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.07it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.70it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.07it/s][A100%|██████████| 195/195 [00:00<00:00, 343.41it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  10%|█         | 13/128 [21:13<3:11:35, 99.96s/it]EarlyStopping counter : 7 out of 40
training process:  11%|█         | 14/128 [22:42<3:03:39, 96.66s/it]EarlyStopping counter : 8 out of 40
training process:  12%|█▏        | 15/128 [24:11<2:57:18, 94.14s/it]Best score increase :0.861 -> 0.867
training process:  12%|█▎        | 16/128 [25:41<2:53:41, 93.05s/it]epoch : 17, train loss : 0.028, valid loss : 0.031, train acc : 0.992, valid acc : 0.992, train f1 : 0.867, valid f1 : 0.871

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.91it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.93it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.91it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.35it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.46it/s][A100%|██████████| 195/195 [00:00<00:00, 342.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.867 -> 0.871
training process:  13%|█▎        | 17/128 [27:39<3:06:07, 100.61s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [29:08<2:58:06, 97.15s/it] EarlyStopping counter : 2 out of 40
training process:  15%|█▍        | 19/128 [30:39<2:52:49, 95.14s/it]Best score increase :0.871 -> 0.878
training process:  16%|█▌        | 20/128 [32:07<2:47:39, 93.14s/it]epoch : 21, train loss : 0.024, valid loss : 0.032, train acc : 0.993, valid acc : 0.993, train f1 : 0.888, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.20it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.39it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.91it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 331.47it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 332.41it/s][A100%|██████████| 195/195 [00:00<00:00, 330.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.878 -> 0.880
training process:  16%|█▋        | 21/128 [34:00<2:56:28, 98.96s/it]EarlyStopping counter : 1 out of 40
training process:  17%|█▋        | 22/128 [35:30<2:50:14, 96.36s/it]EarlyStopping counter : 2 out of 40
training process:  18%|█▊        | 23/128 [36:59<2:44:50, 94.19s/it]Best score increase :0.880 -> 0.889
training process:  19%|█▉        | 24/128 [38:31<2:42:01, 93.48s/it]epoch : 25, train loss : 0.022, valid loss : 0.027, train acc : 0.993, valid acc : 0.993, train f1 : 0.895, valid f1 : 0.885

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.19it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.00it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.95it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.01it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.12it/s][A100%|██████████| 195/195 [00:00<00:00, 340.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  20%|█▉        | 25/128 [40:24<2:50:28, 99.30s/it]EarlyStopping counter : 2 out of 40
training process:  20%|██        | 26/128 [41:55<2:44:31, 96.78s/it]EarlyStopping counter : 3 out of 40
training process:  21%|██        | 27/128 [43:25<2:39:25, 94.70s/it]EarlyStopping counter : 4 out of 40
training process:  22%|██▏       | 28/128 [44:55<2:35:29, 93.30s/it]epoch : 29, train loss : 0.021, valid loss : 0.029, train acc : 0.993, valid acc : 0.992, train f1 : 0.901, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.99it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.47it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.10it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.75it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.93it/s][A100%|██████████| 195/195 [00:00<00:00, 343.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  23%|██▎       | 29/128 [46:49<2:44:08, 99.48s/it]EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 30/128 [48:16<2:36:15, 95.67s/it]EarlyStopping counter : 7 out of 40
training process:  24%|██▍       | 31/128 [49:49<2:33:30, 94.96s/it]EarlyStopping counter : 8 out of 40
training process:  25%|██▌       | 32/128 [51:20<2:30:18, 93.94s/it]epoch : 33, train loss : 0.019, valid loss : 0.031, train acc : 0.994, valid acc : 0.993, train f1 : 0.915, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.41it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.84it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.38it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 347.28it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 347.86it/s][A100%|██████████| 195/195 [00:00<00:00, 346.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  26%|██▌       | 33/128 [53:17<2:39:40, 100.84s/it]Best score increase :0.889 -> 0.892
training process:  27%|██▋       | 34/128 [54:48<2:33:22, 97.90s/it] EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 35/128 [56:19<2:28:16, 95.67s/it]EarlyStopping counter : 2 out of 40
training process:  28%|██▊       | 36/128 [57:49<2:24:15, 94.08s/it]epoch : 37, train loss : 0.018, valid loss : 0.034, train acc : 0.995, valid acc : 0.993, train f1 : 0.924, valid f1 : 0.881

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.88it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.27it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.93it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.73it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.11it/s][A100%|██████████| 195/195 [00:00<00:00, 342.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  29%|██▉       | 37/128 [59:43<2:31:35, 99.95s/it]EarlyStopping counter : 4 out of 40
training process:  30%|██▉       | 38/128 [1:01:14<2:25:43, 97.15s/it]EarlyStopping counter : 5 out of 40
training process:  30%|███       | 39/128 [1:02:44<2:21:02, 95.08s/it]EarlyStopping counter : 6 out of 40
training process:  31%|███▏      | 40/128 [1:04:13<2:16:56, 93.37s/it]epoch : 41, train loss : 0.016, valid loss : 0.031, train acc : 0.995, valid acc : 0.993, train f1 : 0.929, valid f1 : 0.881

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.73it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.32it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.92it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.90it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.42it/s][A100%|██████████| 195/195 [00:00<00:00, 338.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  32%|███▏      | 41/128 [1:06:08<2:24:42, 99.80s/it]EarlyStopping counter : 8 out of 40
training process:  33%|███▎      | 42/128 [1:07:38<2:19:01, 97.00s/it]EarlyStopping counter : 9 out of 40
training process:  34%|███▎      | 43/128 [1:09:08<2:14:27, 94.92s/it]EarlyStopping counter : 10 out of 40
training process:  34%|███▍      | 44/128 [1:10:38<2:10:30, 93.22s/it]epoch : 45, train loss : 0.015, valid loss : 0.031, train acc : 0.995, valid acc : 0.993, train f1 : 0.929, valid f1 : 0.892

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.02it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.92it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.97it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.92it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 344.99it/s][A100%|██████████| 195/195 [00:00<00:00, 343.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  35%|███▌      | 45/128 [1:12:34<2:18:29, 100.11s/it]EarlyStopping counter : 12 out of 40
training process:  36%|███▌      | 46/128 [1:14:06<2:13:19, 97.55s/it] EarlyStopping counter : 13 out of 40
training process:  37%|███▋      | 47/128 [1:15:35<2:08:24, 95.12s/it]EarlyStopping counter : 14 out of 40
training process:  38%|███▊      | 48/128 [1:17:03<2:03:56, 92.96s/it]epoch : 49, train loss : 0.015, valid loss : 0.041, train acc : 0.996, valid acc : 0.993, train f1 : 0.938, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.57it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 249.10it/s][A
 50%|████▉     | 97/195 [00:00<00:00, 272.26it/s][A
 65%|██████▍   | 126/195 [00:00<00:00, 253.75it/s][A
 78%|███████▊  | 153/195 [00:00<00:00, 255.01it/s][A
 95%|█████████▌| 186/195 [00:00<00:00, 275.76it/s][A100%|██████████| 195/195 [00:00<00:00, 271.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  38%|███▊      | 49/128 [1:18:57<2:10:45, 99.32s/it]EarlyStopping counter : 16 out of 40
training process:  39%|███▉      | 50/128 [1:20:27<2:05:30, 96.54s/it]EarlyStopping counter : 17 out of 40
training process:  40%|███▉      | 51/128 [1:21:57<2:01:24, 94.60s/it]EarlyStopping counter : 18 out of 40
training process:  41%|████      | 52/128 [1:23:26<1:57:29, 92.76s/it]epoch : 53, train loss : 0.013, valid loss : 0.043, train acc : 0.996, valid acc : 0.991, train f1 : 0.947, valid f1 : 0.869

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 193.70it/s][A
 25%|██▍       | 48/195 [00:00<00:00, 243.24it/s][A
 37%|███▋      | 73/195 [00:00<00:00, 214.80it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 241.85it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 271.51it/s][A
 84%|████████▎ | 163/195 [00:00<00:00, 255.95it/s][A
 97%|█████████▋| 190/195 [00:00<00:00, 253.78it/s][A100%|██████████| 195/195 [00:00<00:00, 248.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  41%|████▏     | 53/128 [1:25:23<2:05:04, 100.06s/it]EarlyStopping counter : 20 out of 40
training process:  42%|████▏     | 54/128 [1:26:50<1:58:34, 96.14s/it] EarlyStopping counter : 21 out of 40
training process:  43%|████▎     | 55/128 [1:28:20<1:54:55, 94.46s/it]Best score increase :0.892 -> 0.896
training process:  44%|████▍     | 56/128 [1:29:49<1:51:16, 92.73s/it]epoch : 57, train loss : 0.013, valid loss : 0.042, train acc : 0.996, valid acc : 0.992, train f1 : 0.945, valid f1 : 0.876

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 204.84it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 262.61it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 293.63it/s][A
 62%|██████▏   | 120/195 [00:00<00:00, 308.35it/s][A
 79%|███████▉  | 154/195 [00:00<00:00, 316.50it/s][A
 96%|█████████▋| 188/195 [00:00<00:00, 321.71it/s][A100%|██████████| 195/195 [00:00<00:00, 306.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  45%|████▍     | 57/128 [1:31:43<1:57:21, 99.18s/it]EarlyStopping counter : 2 out of 40
training process:  45%|████▌     | 58/128 [1:33:15<1:53:02, 96.90s/it]EarlyStopping counter : 3 out of 40
training process:  46%|████▌     | 59/128 [1:34:45<1:49:07, 94.89s/it]EarlyStopping counter : 4 out of 40
training process:  47%|████▋     | 60/128 [1:36:16<1:46:05, 93.61s/it]epoch : 61, train loss : 0.013, valid loss : 0.046, train acc : 0.997, valid acc : 0.993, train f1 : 0.952, valid f1 : 0.886

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█▏        | 22/195 [00:00<00:00, 212.29it/s][A
 23%|██▎       | 44/195 [00:00<00:00, 204.19it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 217.16it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 255.33it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 280.67it/s][A
 85%|████████▌ | 166/195 [00:00<00:00, 296.27it/s][A100%|██████████| 195/195 [00:00<00:00, 275.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  48%|████▊     | 61/128 [1:38:12<1:52:06, 100.39s/it]EarlyStopping counter : 6 out of 40
training process:  48%|████▊     | 62/128 [1:39:38<1:45:46, 96.16s/it] EarlyStopping counter : 7 out of 40
training process:  49%|████▉     | 63/128 [1:41:08<1:42:01, 94.17s/it]EarlyStopping counter : 8 out of 40
training process:  50%|█████     | 64/128 [1:42:40<1:39:52, 93.63s/it]epoch : 65, train loss : 0.013, valid loss : 0.052, train acc : 0.997, valid acc : 0.993, train f1 : 0.956, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.52it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.72it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.29it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.22it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.25it/s][A100%|██████████| 195/195 [00:00<00:00, 339.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  51%|█████     | 65/128 [1:44:35<1:44:58, 99.98s/it]EarlyStopping counter : 10 out of 40
training process:  52%|█████▏    | 66/128 [1:46:07<1:40:56, 97.69s/it]EarlyStopping counter : 11 out of 40
training process:  52%|█████▏    | 67/128 [1:47:38<1:37:08, 95.55s/it]EarlyStopping counter : 12 out of 40
training process:  53%|█████▎    | 68/128 [1:49:08<1:34:04, 94.08s/it]epoch : 69, train loss : 0.011, valid loss : 0.053, train acc : 0.997, valid acc : 0.993, train f1 : 0.959, valid f1 : 0.886

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.57it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.99it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.04it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.86it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.87it/s][A100%|██████████| 195/195 [00:00<00:00, 336.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  54%|█████▍    | 69/128 [1:51:04<1:38:56, 100.61s/it]EarlyStopping counter : 14 out of 40
training process:  55%|█████▍    | 70/128 [1:52:31<1:33:24, 96.62s/it] EarlyStopping counter : 15 out of 40
training process:  55%|█████▌    | 71/128 [1:54:00<1:29:33, 94.28s/it]EarlyStopping counter : 16 out of 40
training process:  56%|█████▋    | 72/128 [1:55:28<1:26:13, 92.38s/it]epoch : 73, train loss : 0.011, valid loss : 0.054, train acc : 0.997, valid acc : 0.993, train f1 : 0.963, valid f1 : 0.890

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 313.87it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 318.95it/s][A
 51%|█████     | 99/195 [00:00<00:00, 324.21it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 327.28it/s][A
 85%|████████▌ | 166/195 [00:00<00:00, 326.99it/s][A100%|██████████| 195/195 [00:00<00:00, 325.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  57%|█████▋    | 73/128 [1:57:25<1:31:19, 99.62s/it]EarlyStopping counter : 18 out of 40
training process:  58%|█████▊    | 74/128 [1:58:53<1:26:32, 96.15s/it]EarlyStopping counter : 19 out of 40
training process:  59%|█████▊    | 75/128 [2:00:20<1:22:41, 93.61s/it]EarlyStopping counter : 20 out of 40
training process:  59%|█████▉    | 76/128 [2:01:48<1:19:34, 91.82s/it]epoch : 77, train loss : 0.011, valid loss : 0.057, train acc : 0.997, valid acc : 0.993, train f1 : 0.963, valid f1 : 0.885

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.79it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.75it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.41it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.28it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 339.85it/s][A100%|██████████| 195/195 [00:00<00:00, 340.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  60%|██████    | 77/128 [2:03:41<1:23:23, 98.10s/it]EarlyStopping counter : 22 out of 40
training process:  61%|██████    | 78/128 [2:05:10<1:19:25, 95.30s/it]EarlyStopping counter : 23 out of 40
training process:  62%|██████▏   | 79/128 [2:06:36<1:15:35, 92.57s/it]EarlyStopping counter : 24 out of 40
training process:  62%|██████▎   | 80/128 [2:08:05<1:13:09, 91.45s/it]epoch : 81, train loss : 0.011, valid loss : 0.067, train acc : 0.998, valid acc : 0.993, train f1 : 0.967, valid f1 : 0.883

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.72it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.71it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.60it/s][A
 71%|███████   | 138/195 [00:00<00:00, 337.51it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.21it/s][A100%|██████████| 195/195 [00:00<00:00, 338.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 25 out of 40
training process:  63%|██████▎   | 81/128 [2:09:59<1:17:02, 98.35s/it]Best score increase :0.896 -> 0.898
training process:  64%|██████▍   | 82/128 [2:11:28<1:13:11, 95.47s/it]EarlyStopping counter : 1 out of 40
training process:  65%|██████▍   | 83/128 [2:12:57<1:10:05, 93.44s/it]EarlyStopping counter : 2 out of 40
training process:  66%|██████▌   | 84/128 [2:14:25<1:07:28, 92.02s/it]epoch : 85, train loss : 0.009, valid loss : 0.067, train acc : 0.998, valid acc : 0.993, train f1 : 0.973, valid f1 : 0.887

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.45it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 332.56it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.11it/s][A
 71%|███████   | 138/195 [00:00<00:00, 337.82it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 338.80it/s][A100%|██████████| 195/195 [00:00<00:00, 337.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  66%|██████▋   | 85/128 [2:16:20<1:10:45, 98.74s/it]EarlyStopping counter : 4 out of 40
training process:  67%|██████▋   | 86/128 [2:17:50<1:07:25, 96.33s/it]EarlyStopping counter : 5 out of 40
training process:  68%|██████▊   | 87/128 [2:19:21<1:04:43, 94.73s/it]EarlyStopping counter : 6 out of 40
training process:  69%|██████▉   | 88/128 [2:20:53<1:02:28, 93.72s/it]epoch : 89, train loss : 0.010, valid loss : 0.074, train acc : 0.998, valid acc : 0.993, train f1 : 0.971, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.90it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.91it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 338.89it/s][A
 71%|███████   | 138/195 [00:00<00:00, 336.97it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 334.97it/s][A100%|██████████| 195/195 [00:00<00:00, 336.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  70%|██████▉   | 89/128 [2:22:47<1:04:52, 99.80s/it]EarlyStopping counter : 8 out of 40
training process:  70%|███████   | 90/128 [2:24:16<1:01:17, 96.78s/it]EarlyStopping counter : 9 out of 40
training process:  71%|███████   | 91/128 [2:25:48<58:40, 95.16s/it]  EarlyStopping counter : 10 out of 40
training process:  72%|███████▏  | 92/128 [2:27:17<56:00, 93.35s/it]epoch : 93, train loss : 0.008, valid loss : 0.075, train acc : 0.998, valid acc : 0.993, train f1 : 0.977, valid f1 : 0.888

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.00it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.34it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.37it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.84it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.61it/s][A100%|██████████| 195/195 [00:00<00:00, 339.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  73%|███████▎  | 93/128 [2:29:14<58:35, 100.43s/it]EarlyStopping counter : 12 out of 40
training process:  73%|███████▎  | 94/128 [2:30:41<54:36, 96.37s/it] EarlyStopping counter : 13 out of 40
training process:  74%|███████▍  | 95/128 [2:32:09<51:40, 93.96s/it]EarlyStopping counter : 14 out of 40
training process:  75%|███████▌  | 96/128 [2:33:40<49:32, 92.88s/it]epoch : 97, train loss : 0.010, valid loss : 0.079, train acc : 0.998, valid acc : 0.992, train f1 : 0.972, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.12it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.93it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.61it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.38it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.71it/s][A100%|██████████| 195/195 [00:00<00:00, 341.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  76%|███████▌  | 97/128 [2:35:34<51:21, 99.40s/it]EarlyStopping counter : 16 out of 40
training process:  77%|███████▋  | 98/128 [2:37:01<47:52, 95.74s/it]EarlyStopping counter : 17 out of 40
training process:  77%|███████▋  | 99/128 [2:38:29<45:04, 93.26s/it]EarlyStopping counter : 18 out of 40
training process:  78%|███████▊  | 100/128 [2:39:58<42:55, 91.98s/it]epoch : 101, train loss : 0.008, valid loss : 0.081, train acc : 0.999, valid acc : 0.993, train f1 : 0.979, valid f1 : 0.882

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.58it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.68it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.56it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.32it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.25it/s][A100%|██████████| 195/195 [00:00<00:00, 340.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  79%|███████▉  | 101/128 [2:41:52<44:24, 98.68s/it]EarlyStopping counter : 20 out of 40
training process:  80%|███████▉  | 102/128 [2:43:23<41:47, 96.45s/it]EarlyStopping counter : 21 out of 40
training process:  80%|████████  | 103/128 [2:44:55<39:35, 95.03s/it]EarlyStopping counter : 22 out of 40
training process:  81%|████████▏ | 104/128 [2:46:26<37:33, 93.88s/it]epoch : 105, train loss : 0.008, valid loss : 0.082, train acc : 0.999, valid acc : 0.993, train f1 : 0.978, valid f1 : 0.881

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.21it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.72it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.90it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.95it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.98it/s][A100%|██████████| 195/195 [00:00<00:00, 341.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  82%|████████▏ | 105/128 [2:48:21<38:19, 99.99s/it]EarlyStopping counter : 24 out of 40
training process:  83%|████████▎ | 106/128 [2:49:53<35:51, 97.79s/it]EarlyStopping counter : 25 out of 40
training process:  84%|████████▎ | 107/128 [2:51:24<33:32, 95.82s/it]EarlyStopping counter : 26 out of 40
training process:  84%|████████▍ | 108/128 [2:52:55<31:27, 94.36s/it]epoch : 109, train loss : 0.007, valid loss : 0.083, train acc : 0.999, valid acc : 0.993, train f1 : 0.981, valid f1 : 0.888

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.74it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.12it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.73it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.36it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.45it/s][A100%|██████████| 195/195 [00:00<00:00, 336.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  85%|████████▌ | 109/128 [2:54:51<31:54, 100.77s/it]EarlyStopping counter : 28 out of 40
training process:  86%|████████▌ | 110/128 [2:56:22<29:19, 97.75s/it] EarlyStopping counter : 29 out of 40
training process:  87%|████████▋ | 111/128 [2:57:52<27:02, 95.45s/it]EarlyStopping counter : 30 out of 40
training process:  88%|████████▊ | 112/128 [2:59:23<25:04, 94.02s/it]epoch : 113, train loss : 0.008, valid loss : 0.096, train acc : 0.998, valid acc : 0.991, train f1 : 0.978, valid f1 : 0.865

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.41it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 334.18it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 336.21it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 329.35it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.63it/s][A100%|██████████| 195/195 [00:00<00:00, 333.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  88%|████████▊ | 113/128 [3:01:18<25:05, 100.34s/it]EarlyStopping counter : 32 out of 40
training process:  89%|████████▉ | 114/128 [3:02:48<22:42, 97.36s/it] EarlyStopping counter : 33 out of 40
training process:  90%|████████▉ | 115/128 [3:04:18<20:36, 95.13s/it]EarlyStopping counter : 34 out of 40
training process:  91%|█████████ | 116/128 [3:05:46<18:35, 92.92s/it]epoch : 117, train loss : 0.007, valid loss : 0.088, train acc : 0.999, valid acc : 0.992, train f1 : 0.983, valid f1 : 0.883

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.91it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.58it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.44it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.88it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.01it/s][A100%|██████████| 195/195 [00:00<00:00, 341.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  91%|█████████▏| 117/128 [3:07:40<18:13, 99.45s/it]EarlyStopping counter : 36 out of 40
training process:  92%|█████████▏| 118/128 [3:09:10<16:04, 96.46s/it]EarlyStopping counter : 37 out of 40
training process:  93%|█████████▎| 119/128 [3:10:40<14:11, 94.62s/it]EarlyStopping counter : 38 out of 40
training process:  94%|█████████▍| 120/128 [3:12:12<12:29, 93.63s/it]epoch : 121, train loss : 0.007, valid loss : 0.088, train acc : 0.999, valid acc : 0.993, train f1 : 0.982, valid f1 : 0.891

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.79it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.65it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.94it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.35it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.19it/s][A100%|██████████| 195/195 [00:00<00:00, 340.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  95%|█████████▍| 121/128 [3:14:03<11:32, 98.97s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 121, best f1 score : 0.898
training process:  95%|█████████▍| 121/128 [3:15:31<11:18, 96.96s/it]
training process finished, best loss : 0.064 and best acc : 0.993, best f1 : 0.898, best epoch : 81

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.79      0.77      0.78       304
           1       1.00      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.89      0.88      0.89     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.89, test AUC : 0.88, test loss : 17.395

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:17, 12.36s/it]processing for feature importance:  12%|█▏        | 2/17 [00:25<03:12, 12.86s/it]processing for feature importance:  18%|█▊        | 3/17 [00:37<02:57, 12.65s/it]processing for feature importance:  24%|██▎       | 4/17 [00:49<02:37, 12.08s/it]processing for feature importance:  29%|██▉       | 5/17 [01:00<02:23, 11.93s/it]processing for feature importance:  35%|███▌      | 6/17 [01:12<02:09, 11.82s/it]processing for feature importance:  41%|████      | 7/17 [01:23<01:57, 11.72s/it]processing for feature importance:  47%|████▋     | 8/17 [01:36<01:46, 11.86s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:49<01:37, 12.18s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:02<01:27, 12.44s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:13<01:13, 12.27s/it]processing for feature importance:  71%|███████   | 12/17 [02:27<01:02, 12.59s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:39<00:49, 12.39s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:50<00:36, 12.18s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:02<00:24, 12.02s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:13<00:11, 11.85s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 11.80s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 12.10s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:02<10:14,  2.91s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<04:54,  1.40s/it]visualize 2D latent space:   1%|          | 2/212 [00:04<07:12,  2.06s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:02,  1.83s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:25,  1.29s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:04<14:42,  4.18s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<10:07,  2.89s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:23,  2.14s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:35,  1.45s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▋        | 32/195 [00:00<00:00, 312.03it/s] 34%|███▍      | 67/195 [00:00<00:00, 329.78it/s] 52%|█████▏    | 102/195 [00:00<00:00, 335.04it/s] 70%|███████   | 137/195 [00:00<00:00, 337.14it/s] 88%|████████▊ | 171/195 [00:00<00:00, 337.89it/s]100%|██████████| 195/195 [00:00<00:00, 335.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.07it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 200.59it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 198.60it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 201.24it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.24it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.99it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 210.89it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 212.54it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 209.67it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 208.35it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 207.37it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 206.38it/s]remove invalid data : null / measurement error:  45%|████▍     | 277/616 [00:01<00:01, 207.23it/s]remove invalid data : null / measurement error:  48%|████▊     | 298/616 [00:01<00:01, 206.31it/s]remove invalid data : null / measurement error:  52%|█████▏    | 319/616 [00:01<00:01, 204.82it/s]remove invalid data : null / measurement error:  55%|█████▌    | 340/616 [00:01<00:01, 203.87it/s]remove invalid data : null / measurement error:  59%|█████▊    | 361/616 [00:01<00:01, 204.09it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:01<00:01, 218.65it/s]remove invalid data : null / measurement error:  67%|██████▋   | 415/616 [00:01<00:00, 234.35it/s]remove invalid data : null / measurement error:  71%|███████▏  | 439/616 [00:02<00:00, 231.26it/s]remove invalid data : null / measurement error:  75%|███████▌  | 463/616 [00:02<00:00, 232.93it/s]remove invalid data : null / measurement error:  79%|███████▉  | 487/616 [00:02<00:00, 225.73it/s]remove invalid data : null / measurement error:  83%|████████▎ | 510/616 [00:02<00:00, 220.13it/s]remove invalid data : null / measurement error:  87%|████████▋ | 533/616 [00:02<00:00, 215.10it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 210.86it/s]remove invalid data : null / measurement error:  94%|█████████▎| 577/616 [00:02<00:00, 208.34it/s]remove invalid data : null / measurement error:  97%|█████████▋| 598/616 [00:02<00:00, 207.03it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.26it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 236.36it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.95it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.48it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 238.71it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 239.82it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 241.40it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 242.74it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 244.23it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 245.45it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 246.71it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 247.59it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 245.70it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 245.08it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 241.95it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 242.36it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 243.32it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 244.15it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 243.52it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 244.56it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 244.70it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 243.27it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.59it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.74it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 76.86it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.67it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.88it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.16it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.04it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.14it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.73it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.56it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.38it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.01it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.87it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.90it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.30it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.78it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.77it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.35it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.89it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.55it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.79it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.77it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.04it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.50it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.71it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.10it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.78it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.15it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 87.20it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.71it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.74it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.41it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.40it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.35it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.59it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.75it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 63.00it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 61.25it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 62.95it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 66.34it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 55.29it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.39it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 43.11it/s]generate index:  69%|██████▉   | 357/515 [00:05<00:02, 53.12it/s]generate index:  71%|███████▏  | 367/515 [00:05<00:02, 63.46it/s]generate index:  73%|███████▎  | 378/515 [00:05<00:01, 74.35it/s]generate index:  75%|███████▌  | 387/515 [00:05<00:01, 77.06it/s]generate index:  77%|███████▋  | 396/515 [00:06<00:01, 77.27it/s]generate index:  79%|███████▊  | 405/515 [00:06<00:01, 67.27it/s]generate index:  80%|████████  | 413/515 [00:06<00:01, 65.00it/s]generate index:  83%|████████▎ | 425/515 [00:06<00:01, 75.82it/s]generate index:  84%|████████▍ | 433/515 [00:06<00:01, 65.74it/s]generate index:  85%|████████▌ | 440/515 [00:06<00:01, 52.27it/s]generate index:  87%|████████▋ | 446/515 [00:06<00:01, 50.68it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.26it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.51it/s]generate index:  91%|█████████▏| 471/515 [00:07<00:00, 56.29it/s]generate index:  93%|█████████▎| 481/515 [00:07<00:00, 66.23it/s]generate index:  95%|█████████▍| 489/515 [00:07<00:00, 67.53it/s]generate index:  97%|█████████▋| 497/515 [00:07<00:00, 63.73it/s]generate index:  98%|█████████▊| 507/515 [00:07<00:00, 70.09it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 59.17it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.45it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 69.96it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 150.59it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 176.82it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 191.44it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 197.89it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 212.71it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 210.02it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 194.89it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.52it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.57it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 252.67it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 251.79it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 254.47it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 252.91it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.97it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.85it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 55.00it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.03it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.15it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.29it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.53it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.67it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.66it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.56it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.16it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.53it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.55it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.77it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 49.64it/s]generate index:  89%|████████▊ | 116/131 [00:01<00:00, 59.26it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 71.52it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.42it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 12/193 [00:00<00:01, 116.70it/s]remove invalid data : null / measurement error:  17%|█▋        | 33/193 [00:00<00:00, 169.93it/s]remove invalid data : null / measurement error:  28%|██▊       | 55/193 [00:00<00:00, 191.84it/s]remove invalid data : null / measurement error:  40%|███▉      | 77/193 [00:00<00:00, 201.72it/s]remove invalid data : null / measurement error:  51%|█████▏    | 99/193 [00:00<00:00, 206.14it/s]remove invalid data : null / measurement error:  63%|██████▎   | 122/193 [00:00<00:00, 212.53it/s]remove invalid data : null / measurement error:  76%|███████▌  | 146/193 [00:00<00:00, 219.52it/s]remove invalid data : null / measurement error:  87%|████████▋ | 168/193 [00:00<00:00, 215.60it/s]remove invalid data : null / measurement error:  98%|█████████▊| 190/193 [00:00<00:00, 213.29it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 205.24it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 251.91it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 253.93it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 252.63it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 249.23it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 249.17it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 249.23it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.85it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 102.34it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.31it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.80it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.58it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.23it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.06it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.20it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.35it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.81it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.61it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.31it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.52it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.32it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.37it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.90it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.96it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.43it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 64.07it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.71it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.368, valid loss : 0.266, train acc : 0.830, valid acc : 0.888, train f1 : 0.830, valid f1 : 0.577

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.63it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.18it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.79it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.41it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.54it/s][A100%|██████████| 195/195 [00:00<00:00, 340.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.577
training process:   1%|          | 1/128 [01:59<4:11:56, 119.03s/it]Best score increase :0.577 -> 0.642
training process:   2%|▏         | 2/128 [03:32<3:37:57, 103.79s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [05:04<3:25:21, 98.57s/it] Best score increase :0.642 -> 0.693
training process:   3%|▎         | 4/128 [06:35<3:17:50, 95.73s/it]epoch : 5, train loss : 0.095, valid loss : 0.088, train acc : 0.965, valid acc : 0.964, train f1 : 0.965, valid f1 : 0.708

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.42it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 334.84it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 336.80it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.30it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 339.70it/s][A100%|██████████| 195/195 [00:00<00:00, 338.36it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.693 -> 0.708
training process:   4%|▍         | 5/128 [08:36<3:34:30, 104.64s/it]Best score increase :0.708 -> 0.771
training process:   5%|▍         | 6/128 [10:08<3:23:59, 100.32s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:42<3:18:03, 98.21s/it] EarlyStopping counter : 2 out of 40
training process:   6%|▋         | 8/128 [13:16<3:14:00, 97.01s/it]epoch : 9, train loss : 0.054, valid loss : 0.137, train acc : 0.982, valid acc : 0.947, train f1 : 0.982, valid f1 : 0.664

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 307.90it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.72it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.10it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.32it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 332.75it/s][A100%|██████████| 195/195 [00:00<00:00, 327.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:   7%|▋         | 9/128 [15:17<3:27:07, 104.44s/it]EarlyStopping counter : 4 out of 40
training process:   8%|▊         | 10/128 [16:50<3:18:42, 101.04s/it]EarlyStopping counter : 5 out of 40
training process:   9%|▊         | 11/128 [18:21<3:10:53, 97.89s/it] Best score increase :0.771 -> 0.775
training process:   9%|▉         | 12/128 [19:56<3:07:16, 96.86s/it]epoch : 13, train loss : 0.038, valid loss : 0.156, train acc : 0.989, valid acc : 0.948, train f1 : 0.989, valid f1 : 0.672

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 309.36it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 323.56it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.64it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.82it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 328.79it/s][A100%|██████████| 195/195 [00:00<00:00, 328.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  10%|█         | 13/128 [21:56<3:19:31, 104.10s/it]EarlyStopping counter : 2 out of 40
training process:  11%|█         | 14/128 [23:30<3:12:05, 101.10s/it]EarlyStopping counter : 3 out of 40
training process:  12%|█▏        | 15/128 [25:04<3:06:02, 98.78s/it] Best score increase :0.775 -> 0.790
training process:  12%|█▎        | 16/128 [26:35<3:00:06, 96.49s/it]epoch : 17, train loss : 0.034, valid loss : 0.090, train acc : 0.990, valid acc : 0.976, train f1 : 0.990, valid f1 : 0.767

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.12it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.97it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.74it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.70it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.99it/s][A100%|██████████| 195/195 [00:00<00:00, 335.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:38<3:13:00, 104.33s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [30:12<3:05:47, 101.34s/it]Best score increase :0.790 -> 0.822
training process:  15%|█▍        | 19/128 [31:46<3:00:14, 99.22s/it] EarlyStopping counter : 1 out of 40
training process:  16%|█▌        | 20/128 [33:21<2:56:26, 98.02s/it]epoch : 21, train loss : 0.028, valid loss : 0.065, train acc : 0.992, valid acc : 0.981, train f1 : 0.992, valid f1 : 0.788

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.53it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.84it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.96it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.88it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.68it/s][A100%|██████████| 195/195 [00:00<00:00, 337.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  16%|█▋        | 21/128 [35:23<3:07:37, 105.21s/it]Best score increase :0.822 -> 0.842
training process:  17%|█▋        | 22/128 [36:54<2:58:18, 100.93s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [38:26<2:51:40, 98.10s/it] EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [40:00<2:47:44, 96.78s/it]epoch : 25, train loss : 0.024, valid loss : 0.056, train acc : 0.994, valid acc : 0.987, train f1 : 0.994, valid f1 : 0.839

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.33it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.47it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.77it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.07it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 334.91it/s][A100%|██████████| 195/195 [00:00<00:00, 332.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [41:58<2:57:03, 103.14s/it]EarlyStopping counter : 4 out of 40
training process:  20%|██        | 26/128 [43:32<2:50:46, 100.45s/it]EarlyStopping counter : 5 out of 40
training process:  21%|██        | 27/128 [45:07<2:46:27, 98.89s/it] EarlyStopping counter : 6 out of 40
training process:  22%|██▏       | 28/128 [46:43<2:43:36, 98.17s/it]epoch : 29, train loss : 0.023, valid loss : 0.071, train acc : 0.994, valid acc : 0.985, train f1 : 0.994, valid f1 : 0.820

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 206.79it/s][A
 26%|██▌       | 51/195 [00:00<00:00, 259.00it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 288.87it/s][A
 60%|██████    | 117/195 [00:00<00:00, 303.46it/s][A
 77%|███████▋  | 150/195 [00:00<00:00, 311.68it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 316.78it/s][A100%|██████████| 195/195 [00:00<00:00, 302.30it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 29/128 [48:44<2:53:14, 105.00s/it]Best score increase :0.842 -> 0.849
training process:  23%|██▎       | 30/128 [50:17<2:45:31, 101.34s/it]EarlyStopping counter : 1 out of 40
training process:  24%|██▍       | 31/128 [51:51<2:40:11, 99.09s/it] Best score increase :0.849 -> 0.859
training process:  25%|██▌       | 32/128 [53:25<2:36:17, 97.69s/it]epoch : 33, train loss : 0.020, valid loss : 0.060, train acc : 0.995, valid acc : 0.990, train f1 : 0.995, valid f1 : 0.856

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 199.36it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 257.41it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 288.68it/s][A
 59%|█████▉    | 116/195 [00:00<00:00, 303.88it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 312.44it/s][A
 93%|█████████▎| 182/195 [00:00<00:00, 317.87it/s][A100%|██████████| 195/195 [00:00<00:00, 302.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  26%|██▌       | 33/128 [55:26<2:45:37, 104.61s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 34/128 [56:58<2:37:55, 100.81s/it]EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 35/128 [58:31<2:32:42, 98.52s/it] EarlyStopping counter : 4 out of 40
training process:  28%|██▊       | 36/128 [1:00:03<2:27:58, 96.51s/it]epoch : 37, train loss : 0.017, valid loss : 0.119, train acc : 0.996, valid acc : 0.983, train f1 : 0.996, valid f1 : 0.805

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.12it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.05it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.07it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.48it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 336.06it/s][A100%|██████████| 195/195 [00:00<00:00, 334.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  29%|██▉       | 37/128 [1:02:03<2:36:55, 103.47s/it]EarlyStopping counter : 6 out of 40
training process:  30%|██▉       | 38/128 [1:03:35<2:30:01, 100.01s/it]EarlyStopping counter : 7 out of 40
training process:  30%|███       | 39/128 [1:05:12<2:26:54, 99.04s/it] EarlyStopping counter : 8 out of 40
training process:  31%|███▏      | 40/128 [1:06:46<2:23:05, 97.56s/it]epoch : 41, train loss : 0.017, valid loss : 0.098, train acc : 0.996, valid acc : 0.985, train f1 : 0.996, valid f1 : 0.819

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 314.08it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.34it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.90it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 332.16it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 330.13it/s][A100%|██████████| 195/195 [00:00<00:00, 327.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  32%|███▏      | 41/128 [1:08:46<2:31:27, 104.45s/it]EarlyStopping counter : 10 out of 40
training process:  33%|███▎      | 42/128 [1:10:22<2:25:55, 101.80s/it]EarlyStopping counter : 11 out of 40
training process:  34%|███▎      | 43/128 [1:11:56<2:20:51, 99.42s/it] EarlyStopping counter : 12 out of 40
training process:  34%|███▍      | 44/128 [1:13:30<2:17:04, 97.91s/it]epoch : 45, train loss : 0.016, valid loss : 0.082, train acc : 0.996, valid acc : 0.988, train f1 : 0.996, valid f1 : 0.832

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 312.17it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 321.87it/s][A
 50%|█████     | 98/195 [00:00<00:00, 320.23it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 323.56it/s][A
 84%|████████▍ | 164/195 [00:00<00:00, 325.58it/s][A100%|██████████| 195/195 [00:00<00:00, 324.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  35%|███▌      | 45/128 [1:15:30<2:24:25, 104.40s/it]EarlyStopping counter : 14 out of 40
training process:  36%|███▌      | 46/128 [1:17:01<2:17:30, 100.62s/it]EarlyStopping counter : 15 out of 40
training process:  37%|███▋      | 47/128 [1:18:35<2:12:53, 98.44s/it] Best score increase :0.859 -> 0.870
training process:  38%|███▊      | 48/128 [1:20:10<2:09:51, 97.39s/it]epoch : 49, train loss : 0.015, valid loss : 0.126, train acc : 0.997, valid acc : 0.983, train f1 : 0.997, valid f1 : 0.805

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.06it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.14it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.99it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.23it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.47it/s][A100%|██████████| 195/195 [00:00<00:00, 332.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  38%|███▊      | 49/128 [1:22:07<2:16:01, 103.31s/it]EarlyStopping counter : 2 out of 40
training process:  39%|███▉      | 50/128 [1:23:40<2:10:17, 100.22s/it]EarlyStopping counter : 3 out of 40
training process:  40%|███▉      | 51/128 [1:25:13<2:05:50, 98.06s/it] Best score increase :0.870 -> 0.878
training process:  41%|████      | 52/128 [1:26:47<2:02:50, 96.98s/it]epoch : 53, train loss : 0.014, valid loss : 0.123, train acc : 0.997, valid acc : 0.987, train f1 : 0.997, valid f1 : 0.830

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 309.25it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 323.94it/s][A
 51%|█████     | 99/195 [00:00<00:00, 330.18it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 333.60it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 335.49it/s][A100%|██████████| 195/195 [00:00<00:00, 332.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  41%|████▏     | 53/128 [1:28:48<2:09:55, 103.94s/it]EarlyStopping counter : 2 out of 40
training process:  42%|████▏     | 54/128 [1:30:21<2:04:13, 100.72s/it]EarlyStopping counter : 3 out of 40
training process:  43%|████▎     | 55/128 [1:31:55<2:00:04, 98.69s/it] EarlyStopping counter : 4 out of 40
training process:  44%|████▍     | 56/128 [1:33:28<1:56:39, 97.21s/it]epoch : 57, train loss : 0.013, valid loss : 0.182, train acc : 0.997, valid acc : 0.980, train f1 : 0.997, valid f1 : 0.782

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.73it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.33it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.59it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.41it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 341.84it/s][A100%|██████████| 195/195 [00:00<00:00, 340.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  45%|████▍     | 57/128 [1:35:28<2:03:05, 104.02s/it]EarlyStopping counter : 6 out of 40
training process:  45%|████▌     | 58/128 [1:37:03<1:58:02, 101.18s/it]EarlyStopping counter : 7 out of 40
training process:  46%|████▌     | 59/128 [1:38:38<1:54:15, 99.36s/it] EarlyStopping counter : 8 out of 40
training process:  47%|████▋     | 60/128 [1:40:09<1:49:51, 96.93s/it]epoch : 61, train loss : 0.014, valid loss : 0.113, train acc : 0.998, valid acc : 0.990, train f1 : 0.998, valid f1 : 0.864

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.65it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.53it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.66it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.80it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.33it/s][A100%|██████████| 195/195 [00:00<00:00, 333.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  48%|████▊     | 61/128 [1:42:09<1:55:53, 103.78s/it]EarlyStopping counter : 10 out of 40
training process:  48%|████▊     | 62/128 [1:43:42<1:50:43, 100.67s/it]EarlyStopping counter : 11 out of 40
training process:  49%|████▉     | 63/128 [1:45:17<1:47:02, 98.81s/it] EarlyStopping counter : 12 out of 40
training process:  50%|█████     | 64/128 [1:46:51<1:43:45, 97.28s/it]epoch : 65, train loss : 0.010, valid loss : 0.126, train acc : 0.998, valid acc : 0.990, train f1 : 0.998, valid f1 : 0.853

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.77it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.61it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.00it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.10it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.00it/s][A100%|██████████| 195/195 [00:00<00:00, 333.87it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  51%|█████     | 65/128 [1:48:50<1:48:59, 103.80s/it]EarlyStopping counter : 14 out of 40
training process:  52%|█████▏    | 66/128 [1:50:24<1:44:17, 100.92s/it]EarlyStopping counter : 15 out of 40
training process:  52%|█████▏    | 67/128 [1:51:57<1:40:16, 98.64s/it] EarlyStopping counter : 16 out of 40
training process:  53%|█████▎    | 68/128 [1:53:31<1:37:10, 97.17s/it]epoch : 69, train loss : 0.010, valid loss : 0.135, train acc : 0.998, valid acc : 0.989, train f1 : 0.998, valid f1 : 0.854

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.18it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.34it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 331.05it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 333.74it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.73it/s][A100%|██████████| 195/195 [00:00<00:00, 334.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  54%|█████▍    | 69/128 [1:55:31<1:42:15, 103.98s/it]EarlyStopping counter : 18 out of 40
training process:  55%|█████▍    | 70/128 [1:57:04<1:37:21, 100.71s/it]EarlyStopping counter : 19 out of 40
training process:  55%|█████▌    | 71/128 [1:58:37<1:33:30, 98.42s/it] EarlyStopping counter : 20 out of 40
training process:  56%|█████▋    | 72/128 [2:00:09<1:30:01, 96.45s/it]epoch : 73, train loss : 0.009, valid loss : 0.202, train acc : 0.998, valid acc : 0.981, train f1 : 0.998, valid f1 : 0.786

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.57it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.85it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 331.78it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.19it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.34it/s][A100%|██████████| 195/195 [00:00<00:00, 335.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  57%|█████▋    | 73/128 [2:02:07<1:34:30, 103.11s/it]EarlyStopping counter : 22 out of 40
training process:  58%|█████▊    | 74/128 [2:03:40<1:29:56, 99.94s/it] EarlyStopping counter : 23 out of 40
training process:  59%|█████▊    | 75/128 [2:05:10<1:25:44, 97.07s/it]EarlyStopping counter : 24 out of 40
training process:  59%|█████▉    | 76/128 [2:06:43<1:23:00, 95.79s/it]epoch : 77, train loss : 0.012, valid loss : 0.141, train acc : 0.998, valid acc : 0.990, train f1 : 0.998, valid f1 : 0.856

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|▉         | 19/195 [00:00<00:00, 186.85it/s][A
 25%|██▌       | 49/195 [00:00<00:00, 248.86it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 283.59it/s][A
 57%|█████▋    | 112/195 [00:00<00:00, 288.69it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 250.45it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 263.35it/s][A100%|██████████| 195/195 [00:00<00:00, 250.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 25 out of 40
training process:  60%|██████    | 77/128 [2:08:43<1:27:39, 103.13s/it]EarlyStopping counter : 26 out of 40
training process:  61%|██████    | 78/128 [2:10:15<1:23:09, 99.79s/it] EarlyStopping counter : 27 out of 40
training process:  62%|██████▏   | 79/128 [2:11:49<1:19:51, 97.78s/it]EarlyStopping counter : 28 out of 40
training process:  62%|██████▎   | 80/128 [2:13:24<1:17:44, 97.18s/it]epoch : 81, train loss : 0.009, valid loss : 0.160, train acc : 0.999, valid acc : 0.987, train f1 : 0.999, valid f1 : 0.832

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.15it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.08it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.66it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.96it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.20it/s][A100%|██████████| 195/195 [00:00<00:00, 336.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 29 out of 40
training process:  63%|██████▎   | 81/128 [2:15:24<1:21:25, 103.95s/it]EarlyStopping counter : 30 out of 40
training process:  64%|██████▍   | 82/128 [2:16:56<1:16:54, 100.31s/it]EarlyStopping counter : 31 out of 40
training process:  65%|██████▍   | 83/128 [2:18:30<1:13:50, 98.45s/it] EarlyStopping counter : 32 out of 40
training process:  66%|██████▌   | 84/128 [2:20:02<1:10:53, 96.67s/it]epoch : 85, train loss : 0.007, valid loss : 0.144, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.854

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.12it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.72it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.52it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.26it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.90it/s][A100%|██████████| 195/195 [00:00<00:00, 336.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 33 out of 40
training process:  66%|██████▋   | 85/128 [2:21:59<1:13:36, 102.72s/it]EarlyStopping counter : 34 out of 40
training process:  67%|██████▋   | 86/128 [2:23:30<1:09:21, 99.07s/it] EarlyStopping counter : 35 out of 40
training process:  68%|██████▊   | 87/128 [2:25:06<1:07:06, 98.21s/it]EarlyStopping counter : 36 out of 40
training process:  69%|██████▉   | 88/128 [2:26:40<1:04:35, 96.88s/it]epoch : 89, train loss : 0.010, valid loss : 0.148, train acc : 0.998, valid acc : 0.990, train f1 : 0.998, valid f1 : 0.857

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.02it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.68it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 336.12it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.73it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.48it/s][A100%|██████████| 195/195 [00:00<00:00, 337.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 37 out of 40
training process:  70%|██████▉   | 89/128 [2:28:40<1:07:27, 103.78s/it]EarlyStopping counter : 38 out of 40
training process:  70%|███████   | 90/128 [2:30:12<1:03:31, 100.30s/it]EarlyStopping counter : 39 out of 40
training process:  71%|███████   | 91/128 [2:31:47<1:00:50, 98.66s/it] EarlyStopping counter : 40 out of 40
Early stopping | epoch : 91, best f1 score : 0.878
training process:  71%|███████   | 91/128 [2:33:19<1:02:20, 101.09s/it]
training process finished, best loss : 0.100 and best acc : 0.992, best f1 : 0.878, best epoch : 51

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.77      0.75      0.76       304
           1       1.00      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.88      0.87      0.88     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.88, test AUC : 0.87, test loss : 27.535

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:24, 12.75s/it]processing for feature importance:  12%|█▏        | 2/17 [00:26<03:16, 13.10s/it]processing for feature importance:  18%|█▊        | 3/17 [00:38<02:59, 12.80s/it]processing for feature importance:  24%|██▎       | 4/17 [00:53<02:57, 13.65s/it]processing for feature importance:  29%|██▉       | 5/17 [01:05<02:37, 13.10s/it]processing for feature importance:  35%|███▌      | 6/17 [01:17<02:20, 12.80s/it]processing for feature importance:  41%|████      | 7/17 [01:30<02:06, 12.69s/it]processing for feature importance:  47%|████▋     | 8/17 [01:42<01:53, 12.59s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:55<01:40, 12.61s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:07<01:27, 12.46s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:19<01:14, 12.36s/it]processing for feature importance:  71%|███████   | 12/17 [02:32<01:02, 12.49s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:45<00:50, 12.70s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:57<00:37, 12.54s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:10<00:25, 12.66s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:23<00:12, 12.61s/it]processing for feature importance: 100%|██████████| 17/17 [03:36<00:00, 12.85s/it]processing for feature importance: 100%|██████████| 17/17 [03:36<00:00, 12.74s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:02<10:14,  2.91s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<06:25,  1.84s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:13,  1.99s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:34,  1.43s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<12:10,  3.46s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<08:56,  2.55s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:06,  1.89s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:29,  1.35s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 15%|█▌        | 30/195 [00:00<00:00, 296.66it/s] 33%|███▎      | 64/195 [00:00<00:00, 319.81it/s] 50%|█████     | 98/195 [00:00<00:00, 326.45it/s] 67%|██████▋   | 131/195 [00:00<00:00, 324.97it/s] 84%|████████▍ | 164/195 [00:00<00:00, 323.40it/s]100%|██████████| 195/195 [00:00<00:00, 324.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 14/616 [00:00<00:04, 133.39it/s]remove invalid data : null / measurement error:   5%|▌         | 33/616 [00:00<00:03, 162.54it/s]remove invalid data : null / measurement error:   9%|▊         | 53/616 [00:00<00:03, 177.32it/s]remove invalid data : null / measurement error:  12%|█▏        | 73/616 [00:00<00:02, 185.87it/s]remove invalid data : null / measurement error:  15%|█▌        | 94/616 [00:00<00:02, 193.56it/s]remove invalid data : null / measurement error:  19%|█▊        | 115/616 [00:00<00:02, 198.09it/s]remove invalid data : null / measurement error:  22%|██▏       | 135/616 [00:00<00:02, 198.69it/s]remove invalid data : null / measurement error:  25%|██▌       | 157/616 [00:00<00:02, 202.88it/s]remove invalid data : null / measurement error:  29%|██▉       | 178/616 [00:00<00:02, 202.98it/s]remove invalid data : null / measurement error:  32%|███▏      | 199/616 [00:01<00:02, 201.51it/s]remove invalid data : null / measurement error:  36%|███▌      | 220/616 [00:01<00:01, 201.53it/s]remove invalid data : null / measurement error:  39%|███▉      | 241/616 [00:01<00:01, 201.78it/s]remove invalid data : null / measurement error:  43%|████▎     | 262/616 [00:01<00:01, 202.16it/s]remove invalid data : null / measurement error:  46%|████▌     | 283/616 [00:01<00:01, 202.33it/s]remove invalid data : null / measurement error:  49%|████▉     | 304/616 [00:01<00:01, 201.86it/s]remove invalid data : null / measurement error:  53%|█████▎    | 325/616 [00:01<00:01, 201.03it/s]remove invalid data : null / measurement error:  56%|█████▌    | 346/616 [00:01<00:01, 200.63it/s]remove invalid data : null / measurement error:  60%|█████▉    | 369/616 [00:01<00:01, 207.18it/s]remove invalid data : null / measurement error:  64%|██████▍   | 395/616 [00:01<00:00, 221.10it/s]remove invalid data : null / measurement error:  69%|██████▊   | 422/616 [00:02<00:00, 233.23it/s]remove invalid data : null / measurement error:  72%|███████▏  | 446/616 [00:02<00:00, 229.10it/s]remove invalid data : null / measurement error:  76%|███████▌  | 469/616 [00:02<00:00, 225.30it/s]remove invalid data : null / measurement error:  80%|███████▉  | 492/616 [00:02<00:00, 218.50it/s]remove invalid data : null / measurement error:  83%|████████▎ | 514/616 [00:02<00:00, 213.73it/s]remove invalid data : null / measurement error:  87%|████████▋ | 536/616 [00:02<00:00, 209.30it/s]remove invalid data : null / measurement error:  90%|█████████ | 557/616 [00:02<00:00, 206.12it/s]remove invalid data : null / measurement error:  94%|█████████▍| 578/616 [00:02<00:00, 204.20it/s]remove invalid data : null / measurement error:  97%|█████████▋| 599/616 [00:02<00:00, 203.06it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 204.33it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 234.59it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 234.59it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 235.04it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 234.41it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 233.57it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 236.30it/s]replace nan value:  33%|███▎      | 170/515 [00:00<00:01, 238.29it/s]replace nan value:  38%|███▊      | 195/515 [00:00<00:01, 239.07it/s]replace nan value:  43%|████▎     | 220/515 [00:00<00:01, 240.05it/s]replace nan value:  48%|████▊     | 245/515 [00:01<00:01, 240.80it/s]replace nan value:  52%|█████▏    | 270/515 [00:01<00:01, 241.30it/s]replace nan value:  57%|█████▋    | 295/515 [00:01<00:00, 240.61it/s]replace nan value:  62%|██████▏   | 320/515 [00:01<00:00, 240.59it/s]replace nan value:  67%|██████▋   | 345/515 [00:01<00:00, 239.01it/s]replace nan value:  72%|███████▏  | 369/515 [00:01<00:00, 239.19it/s]replace nan value:  77%|███████▋  | 394/515 [00:01<00:00, 240.52it/s]replace nan value:  81%|████████▏ | 419/515 [00:01<00:00, 241.30it/s]replace nan value:  86%|████████▌ | 444/515 [00:01<00:00, 238.71it/s]replace nan value:  91%|█████████ | 469/515 [00:01<00:00, 239.60it/s]replace nan value:  96%|█████████▌| 494/515 [00:02<00:00, 240.66it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 239.06it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.33it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 55.98it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.98it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.28it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.89it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.23it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 57.35it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.68it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.15it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.07it/s]generate index:  17%|█▋        | 88/515 [00:01<00:07, 60.83it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.51it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.36it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 63.94it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.51it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.56it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 69.97it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.07it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.15it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 70.07it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 71.12it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.78it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.57it/s]generate index:  37%|███▋      | 191/515 [00:03<00:04, 68.51it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 67.42it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 65.97it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 86.57it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 83.04it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 79.67it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 81.84it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 67.23it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 73.48it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.41it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.14it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.22it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.42it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.33it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.62it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 62.28it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 65.72it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 54.88it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.09it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 44.28it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 50.84it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.83it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.74it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 76.15it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 72.62it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.22it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.81it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.25it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.83it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.28it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 48.21it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.54it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.27it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.06it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.82it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.58it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.92it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.30it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.78it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 89.70it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 157.62it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 179.47it/s]remove invalid data : null / measurement error:  47%|████▋     | 73/154 [00:00<00:00, 192.68it/s]remove invalid data : null / measurement error:  62%|██████▏   | 95/154 [00:00<00:00, 200.97it/s]remove invalid data : null / measurement error:  77%|███████▋  | 119/154 [00:00<00:00, 211.18it/s]remove invalid data : null / measurement error:  92%|█████████▏| 141/154 [00:00<00:00, 208.18it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 195.57it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 247.20it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 249.25it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 249.98it/s]replace nan value:  78%|███████▊  | 102/131 [00:00<00:00, 247.49it/s]replace nan value:  98%|█████████▊| 128/131 [00:00<00:00, 249.27it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 248.75it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.36it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.35it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.62it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.84it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.26it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.37it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.51it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.33it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.35it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.27it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.59it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 48.09it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.96it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.53it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 48.01it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.86it/s]generate index:  96%|█████████▌| 126/131 [00:02<00:00, 70.23it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.60it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 6/193 [00:00<00:03, 59.23it/s]remove invalid data : null / measurement error:  14%|█▍        | 27/193 [00:00<00:01, 146.90it/s]remove invalid data : null / measurement error:  25%|██▍       | 48/193 [00:00<00:00, 174.65it/s]remove invalid data : null / measurement error:  36%|███▌      | 69/193 [00:00<00:00, 188.28it/s]remove invalid data : null / measurement error:  47%|████▋     | 91/193 [00:00<00:00, 198.05it/s]remove invalid data : null / measurement error:  58%|█████▊    | 112/193 [00:00<00:00, 198.98it/s]remove invalid data : null / measurement error:  71%|███████   | 137/193 [00:00<00:00, 213.39it/s]remove invalid data : null / measurement error:  82%|████████▏ | 159/193 [00:00<00:00, 212.17it/s]remove invalid data : null / measurement error:  94%|█████████▍| 181/193 [00:00<00:00, 208.78it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 195.58it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 249.86it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 252.45it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 253.62it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 250.41it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 249.20it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 248.95it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.67it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 101.41it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.86it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.39it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.93it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.55it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.49it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.84it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.34it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.08it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.83it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.36it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.53it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.30it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.36it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.75it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.49it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.54it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 62.77it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.33it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.020, valid loss : 0.018, train acc : 0.641, valid acc : 0.964, train f1 : 0.423, valid f1 : 0.647

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.71it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 348.26it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 350.41it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 351.75it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 351.89it/s][A100%|██████████| 195/195 [00:00<00:00, 350.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.647
training process:   1%|          | 1/128 [01:58<4:11:00, 118.58s/it]Best score increase :0.647 -> 0.663
training process:   2%|▏         | 2/128 [03:29<3:35:16, 102.51s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [04:59<3:21:11, 96.57s/it] Best score increase :0.663 -> 0.724
training process:   3%|▎         | 4/128 [06:27<3:12:46, 93.28s/it]epoch : 5, train loss : 0.009, valid loss : 0.010, train acc : 0.951, valid acc : 0.861, train f1 : 0.671, valid f1 : 0.550

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.52it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 343.60it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 344.48it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 345.06it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 345.31it/s][A100%|██████████| 195/195 [00:00<00:00, 344.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   4%|▍         | 5/128 [08:21<3:26:15, 100.62s/it]EarlyStopping counter : 2 out of 40
training process:   5%|▍         | 6/128 [09:52<3:18:03, 97.40s/it] Best score increase :0.724 -> 0.824
training process:   5%|▌         | 7/128 [11:22<3:11:52, 95.15s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:53<3:07:23, 93.70s/it]epoch : 9, train loss : 0.008, valid loss : 0.010, train acc : 0.967, valid acc : 0.956, train f1 : 0.726, valid f1 : 0.678

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 344.17it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 343.38it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 346.47it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 347.76it/s][A
 90%|█████████ | 176/195 [00:00<00:00, 285.77it/s][A100%|██████████| 195/195 [00:00<00:00, 307.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:49<3:19:47, 100.74s/it]EarlyStopping counter : 3 out of 40
training process:   8%|▊         | 10/128 [16:19<3:11:46, 97.52s/it]Best score increase :0.824 -> 0.850
training process:   9%|▊         | 11/128 [17:51<3:06:24, 95.60s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [19:20<3:01:07, 93.69s/it]epoch : 13, train loss : 0.009, valid loss : 0.017, train acc : 0.971, valid acc : 0.989, train f1 : 0.747, valid f1 : 0.841

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 202.82it/s][A
 26%|██▌       | 51/195 [00:00<00:00, 256.97it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 291.39it/s][A
 61%|██████    | 119/195 [00:00<00:00, 307.53it/s][A
 78%|███████▊  | 153/195 [00:00<00:00, 316.48it/s][A
 96%|█████████▌| 187/195 [00:00<00:00, 321.83it/s][A100%|██████████| 195/195 [00:00<00:00, 305.36it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  10%|█         | 13/128 [21:17<3:12:59, 100.69s/it]EarlyStopping counter : 3 out of 40
training process:  11%|█         | 14/128 [22:47<3:05:02, 97.39s/it] EarlyStopping counter : 4 out of 40
training process:  12%|█▏        | 15/128 [24:13<2:57:17, 94.14s/it]Best score increase :0.850 -> 0.871
training process:  12%|█▎        | 16/128 [25:43<2:53:10, 92.77s/it]epoch : 17, train loss : 0.007, valid loss : 0.014, train acc : 0.984, valid acc : 0.991, train f1 : 0.826, valid f1 : 0.866

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.53it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 336.97it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 338.77it/s][A
 71%|███████   | 138/195 [00:00<00:00, 336.76it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 338.39it/s][A100%|██████████| 195/195 [00:00<00:00, 337.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [27:39<3:04:32, 99.76s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [29:06<2:56:04, 96.04s/it]EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [30:36<2:50:48, 94.03s/it]Best score increase :0.871 -> 0.879
training process:  16%|█▌        | 20/128 [32:05<2:46:38, 92.58s/it]epoch : 21, train loss : 0.007, valid loss : 0.013, train acc : 0.989, valid acc : 0.992, train f1 : 0.866, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.63it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 330.92it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.95it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.17it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.92it/s][A100%|██████████| 195/195 [00:00<00:00, 339.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [34:02<2:58:32, 100.12s/it]Best score increase :0.879 -> 0.891
training process:  17%|█▋        | 22/128 [35:32<2:51:03, 96.83s/it] EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [37:05<2:47:32, 95.73s/it]EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [38:37<2:44:03, 94.65s/it]epoch : 25, train loss : 0.007, valid loss : 0.017, train acc : 0.990, valid acc : 0.991, train f1 : 0.876, valid f1 : 0.872

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 351.51it/s][A
 37%|███▋      | 72/195 [00:00<00:00, 353.61it/s][A
 55%|█████▌    | 108/195 [00:00<00:00, 354.49it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 355.06it/s][A
 92%|█████████▏| 180/195 [00:00<00:00, 355.14it/s][A100%|██████████| 195/195 [00:00<00:00, 354.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [40:30<2:52:12, 100.31s/it]Best score increase :0.891 -> 0.897
training process:  20%|██        | 26/128 [42:00<2:45:03, 97.09s/it] EarlyStopping counter : 1 out of 40
training process:  21%|██        | 27/128 [43:30<2:39:52, 94.97s/it]EarlyStopping counter : 2 out of 40
training process:  22%|██▏       | 28/128 [45:00<2:35:36, 93.37s/it]epoch : 29, train loss : 0.006, valid loss : 0.010, train acc : 0.991, valid acc : 0.991, train f1 : 0.886, valid f1 : 0.881

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.65it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.51it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.24it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.97it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.01it/s][A100%|██████████| 195/195 [00:00<00:00, 338.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 29/128 [46:52<2:43:33, 99.12s/it]EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 30/128 [48:26<2:39:03, 97.39s/it]EarlyStopping counter : 5 out of 40
training process:  24%|██▍       | 31/128 [49:59<2:35:29, 96.18s/it]EarlyStopping counter : 6 out of 40
training process:  25%|██▌       | 32/128 [51:32<2:32:33, 95.35s/it]epoch : 33, train loss : 0.006, valid loss : 0.018, train acc : 0.992, valid acc : 0.993, train f1 : 0.901, valid f1 : 0.893

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.82it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.73it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.94it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.52it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.89it/s][A100%|██████████| 195/195 [00:00<00:00, 343.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  26%|██▌       | 33/128 [53:36<2:44:21, 103.80s/it]EarlyStopping counter : 8 out of 40
training process:  27%|██▋       | 34/128 [55:09<2:37:26, 100.49s/it]EarlyStopping counter : 9 out of 40
training process:  27%|██▋       | 35/128 [56:37<2:30:11, 96.89s/it] EarlyStopping counter : 10 out of 40
training process:  28%|██▊       | 36/128 [58:07<2:25:19, 94.78s/it]epoch : 37, train loss : 0.005, valid loss : 0.013, train acc : 0.993, valid acc : 0.990, train f1 : 0.906, valid f1 : 0.866

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.62it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 346.33it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 348.38it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 349.42it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 345.17it/s][A100%|██████████| 195/195 [00:00<00:00, 346.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  29%|██▉       | 37/128 [1:00:02<2:32:59, 100.87s/it]Best score increase :0.897 -> 0.901
training process:  30%|██▉       | 38/128 [1:01:31<2:25:57, 97.31s/it] EarlyStopping counter : 1 out of 40
training process:  30%|███       | 39/128 [1:03:02<2:21:23, 95.33s/it]EarlyStopping counter : 2 out of 40
training process:  31%|███▏      | 40/128 [1:04:33<2:18:02, 94.12s/it]epoch : 41, train loss : 0.005, valid loss : 0.019, train acc : 0.993, valid acc : 0.992, train f1 : 0.915, valid f1 : 0.891

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.21it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.10it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.61it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 345.19it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.38it/s][A100%|██████████| 195/195 [00:00<00:00, 344.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  32%|███▏      | 41/128 [1:06:25<2:24:22, 99.57s/it]EarlyStopping counter : 4 out of 40
training process:  33%|███▎      | 42/128 [1:07:55<2:18:18, 96.49s/it]EarlyStopping counter : 5 out of 40
training process:  34%|███▎      | 43/128 [1:09:27<2:14:48, 95.16s/it]EarlyStopping counter : 6 out of 40
training process:  34%|███▍      | 44/128 [1:10:57<2:11:17, 93.78s/it]epoch : 45, train loss : 0.005, valid loss : 0.014, train acc : 0.993, valid acc : 0.992, train f1 : 0.911, valid f1 : 0.892

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.85it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.25it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.32it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.87it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.73it/s][A100%|██████████| 195/195 [00:00<00:00, 344.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  35%|███▌      | 45/128 [1:12:52<2:18:24, 100.05s/it]EarlyStopping counter : 8 out of 40
training process:  36%|███▌      | 46/128 [1:14:20<2:11:38, 96.32s/it] EarlyStopping counter : 9 out of 40
training process:  37%|███▋      | 47/128 [1:15:50<2:07:38, 94.55s/it]EarlyStopping counter : 10 out of 40
training process:  38%|███▊      | 48/128 [1:17:22<2:04:57, 93.71s/it]epoch : 49, train loss : 0.005, valid loss : 0.017, train acc : 0.994, valid acc : 0.993, train f1 : 0.922, valid f1 : 0.894

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.87it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.06it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.97it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.34it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 335.77it/s][A100%|██████████| 195/195 [00:00<00:00, 334.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  38%|███▊      | 49/128 [1:19:17<2:12:02, 100.29s/it]EarlyStopping counter : 12 out of 40
training process:  39%|███▉      | 50/128 [1:20:49<2:07:09, 97.81s/it] EarlyStopping counter : 13 out of 40
training process:  40%|███▉      | 51/128 [1:22:25<2:04:45, 97.21s/it]EarlyStopping counter : 14 out of 40
training process:  41%|████      | 52/128 [1:24:01<2:02:29, 96.70s/it]epoch : 53, train loss : 0.004, valid loss : 0.014, train acc : 0.995, valid acc : 0.992, train f1 : 0.927, valid f1 : 0.882

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 350.44it/s][A
 37%|███▋      | 72/195 [00:00<00:00, 354.02it/s][A
 55%|█████▌    | 108/195 [00:00<00:00, 355.38it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 356.11it/s][A
 92%|█████████▏| 180/195 [00:00<00:00, 356.71it/s][A100%|██████████| 195/195 [00:00<00:00, 355.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  41%|████▏     | 53/128 [1:26:00<2:09:20, 103.47s/it]EarlyStopping counter : 16 out of 40
training process:  42%|████▏     | 54/128 [1:27:31<2:02:59, 99.73s/it] EarlyStopping counter : 17 out of 40
training process:  43%|████▎     | 55/128 [1:28:59<1:57:10, 96.31s/it]EarlyStopping counter : 18 out of 40
training process:  44%|████▍     | 56/128 [1:30:31<1:53:59, 94.99s/it]epoch : 57, train loss : 0.004, valid loss : 0.024, train acc : 0.995, valid acc : 0.993, train f1 : 0.932, valid f1 : 0.888

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.27it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 252.95it/s][A
 48%|████▊     | 94/195 [00:00<00:00, 262.04it/s][A
 62%|██████▏   | 121/195 [00:00<00:00, 235.11it/s][A
 78%|███████▊  | 152/195 [00:00<00:00, 258.22it/s][A
 95%|█████████▌| 186/195 [00:00<00:00, 280.90it/s][A100%|██████████| 195/195 [00:00<00:00, 271.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  45%|████▍     | 57/128 [1:32:28<2:00:09, 101.54s/it]EarlyStopping counter : 20 out of 40
training process:  45%|████▌     | 58/128 [1:33:57<1:54:00, 97.71s/it] EarlyStopping counter : 21 out of 40
training process:  46%|████▌     | 59/128 [1:35:25<1:49:09, 94.92s/it]EarlyStopping counter : 22 out of 40
training process:  47%|████▋     | 60/128 [1:36:56<1:46:06, 93.63s/it]epoch : 61, train loss : 0.004, valid loss : 0.030, train acc : 0.995, valid acc : 0.993, train f1 : 0.935, valid f1 : 0.888

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.04it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.54it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.47it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.43it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.25it/s][A100%|██████████| 195/195 [00:00<00:00, 340.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  48%|████▊     | 61/128 [1:38:50<1:51:22, 99.74s/it]EarlyStopping counter : 24 out of 40
training process:  48%|████▊     | 62/128 [1:40:14<1:44:39, 95.14s/it]EarlyStopping counter : 25 out of 40
training process:  49%|████▉     | 63/128 [1:41:44<1:41:20, 93.55s/it]EarlyStopping counter : 26 out of 40
training process:  50%|█████     | 64/128 [1:43:13<1:38:09, 92.03s/it]epoch : 65, train loss : 0.003, valid loss : 0.027, train acc : 0.996, valid acc : 0.993, train f1 : 0.944, valid f1 : 0.887

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.94it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 323.93it/s][A
 50%|█████     | 98/195 [00:00<00:00, 326.66it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 325.00it/s][A
 84%|████████▍ | 164/195 [00:00<00:00, 326.44it/s][A100%|██████████| 195/195 [00:00<00:00, 325.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  51%|█████     | 65/128 [1:45:09<1:44:14, 99.27s/it]EarlyStopping counter : 28 out of 40
training process:  52%|█████▏    | 66/128 [1:46:38<1:39:25, 96.22s/it]EarlyStopping counter : 29 out of 40
training process:  52%|█████▏    | 67/128 [1:48:08<1:36:04, 94.51s/it]EarlyStopping counter : 30 out of 40
training process:  53%|█████▎    | 68/128 [1:49:40<1:33:44, 93.75s/it]epoch : 69, train loss : 0.003, valid loss : 0.027, train acc : 0.996, valid acc : 0.993, train f1 : 0.944, valid f1 : 0.888

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.81it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.19it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 338.60it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 339.66it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.15it/s][A100%|██████████| 195/195 [00:00<00:00, 339.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  54%|█████▍    | 69/128 [1:51:35<1:38:17, 99.96s/it]EarlyStopping counter : 32 out of 40
training process:  55%|█████▍    | 70/128 [1:53:06<1:33:59, 97.23s/it]EarlyStopping counter : 33 out of 40
training process:  55%|█████▌    | 71/128 [1:54:38<1:30:54, 95.70s/it]EarlyStopping counter : 34 out of 40
training process:  56%|█████▋    | 72/128 [1:56:10<1:28:15, 94.56s/it]epoch : 73, train loss : 0.003, valid loss : 0.027, train acc : 0.997, valid acc : 0.991, train f1 : 0.957, valid f1 : 0.874

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.54it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.65it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.80it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.37it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.52it/s][A100%|██████████| 195/195 [00:00<00:00, 338.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  57%|█████▋    | 73/128 [1:58:12<1:34:12, 102.77s/it]EarlyStopping counter : 36 out of 40
training process:  58%|█████▊    | 74/128 [1:59:37<1:27:42, 97.46s/it] EarlyStopping counter : 37 out of 40
training process:  59%|█████▊    | 75/128 [2:01:04<1:23:28, 94.51s/it]EarlyStopping counter : 38 out of 40
training process:  59%|█████▉    | 76/128 [2:02:27<1:18:55, 91.06s/it]epoch : 77, train loss : 0.003, valid loss : 0.031, train acc : 0.997, valid acc : 0.993, train f1 : 0.958, valid f1 : 0.893

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 196.09it/s][A
 26%|██▌       | 51/195 [00:00<00:00, 258.25it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 291.55it/s][A
 61%|██████    | 119/195 [00:00<00:00, 307.12it/s][A
 78%|███████▊  | 152/195 [00:00<00:00, 313.41it/s][A
 95%|█████████▌| 186/195 [00:00<00:00, 319.42it/s][A100%|██████████| 195/195 [00:00<00:00, 303.73it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  60%|██████    | 77/128 [2:04:16<1:21:46, 96.21s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 77, best f1 score : 0.901
training process:  60%|██████    | 77/128 [2:05:39<1:23:13, 97.92s/it]
training process finished, best loss : 0.015 and best acc : 0.993, best f1 : 0.901, best epoch : 37

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.79      0.75      0.77       304
           1       1.00      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.89      0.87      0.88     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.88, test AUC : 0.87, test loss : 6.615

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:10, 11.92s/it]processing for feature importance:  12%|█▏        | 2/17 [00:21<02:40, 10.72s/it]processing for feature importance:  18%|█▊        | 3/17 [00:32<02:28, 10.57s/it]processing for feature importance:  24%|██▎       | 4/17 [00:42<02:17, 10.58s/it]processing for feature importance:  29%|██▉       | 5/17 [00:52<02:04, 10.40s/it]processing for feature importance:  35%|███▌      | 6/17 [01:02<01:51, 10.18s/it]processing for feature importance:  41%|████      | 7/17 [01:11<01:38,  9.89s/it]processing for feature importance:  47%|████▋     | 8/17 [01:21<01:27,  9.77s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:31<01:18,  9.78s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:41<01:09,  9.94s/it]processing for feature importance:  65%|██████▍   | 11/17 [01:51<00:59,  9.99s/it]processing for feature importance:  71%|███████   | 12/17 [02:02<00:51, 10.31s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:12<00:40, 10.18s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:23<00:31, 10.45s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:34<00:21, 10.56s/it]processing for feature importance:  94%|█████████▍| 16/17 [02:44<00:10, 10.39s/it]processing for feature importance: 100%|██████████| 17/17 [02:54<00:00, 10.18s/it]processing for feature importance: 100%|██████████| 17/17 [02:54<00:00, 10.24s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<12:54,  3.67s/it]visualize 2D latent space:   1%|          | 2/212 [00:04<08:09,  2.33s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:12,  1.97s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:25,  1.29s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:37,  3.30s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<05:12,  1.49s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<06:47,  1.94s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:23,  2.15s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:33,  1.42s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 309.53it/s] 34%|███▍      | 66/195 [00:00<00:00, 329.47it/s] 52%|█████▏    | 101/195 [00:00<00:00, 336.24it/s] 70%|██████▉   | 136/195 [00:00<00:00, 339.54it/s] 88%|████████▊ | 171/195 [00:00<00:00, 341.24it/s]100%|██████████| 195/195 [00:00<00:00, 338.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_smoothing_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:02, 199.29it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:02, 197.05it/s]remove invalid data : null / measurement error:  10%|▉         | 60/616 [00:00<00:02, 195.34it/s]remove invalid data : null / measurement error:  13%|█▎        | 80/616 [00:00<00:02, 195.42it/s]remove invalid data : null / measurement error:  16%|█▋        | 101/616 [00:00<00:02, 197.90it/s]remove invalid data : null / measurement error:  20%|█▉        | 122/616 [00:00<00:02, 201.29it/s]remove invalid data : null / measurement error:  23%|██▎       | 143/616 [00:00<00:02, 203.23it/s]remove invalid data : null / measurement error:  27%|██▋       | 165/616 [00:00<00:02, 205.75it/s]remove invalid data : null / measurement error:  30%|███       | 186/616 [00:00<00:02, 203.43it/s]remove invalid data : null / measurement error:  34%|███▎      | 207/616 [00:01<00:02, 201.90it/s]remove invalid data : null / measurement error:  37%|███▋      | 228/616 [00:01<00:01, 203.61it/s]remove invalid data : null / measurement error:  40%|████      | 249/616 [00:01<00:01, 203.61it/s]remove invalid data : null / measurement error:  44%|████▍     | 270/616 [00:01<00:01, 205.20it/s]remove invalid data : null / measurement error:  47%|████▋     | 291/616 [00:01<00:01, 203.93it/s]remove invalid data : null / measurement error:  51%|█████     | 312/616 [00:01<00:01, 202.51it/s]remove invalid data : null / measurement error:  54%|█████▍    | 333/616 [00:01<00:01, 201.57it/s]remove invalid data : null / measurement error:  57%|█████▋    | 354/616 [00:01<00:01, 201.09it/s]remove invalid data : null / measurement error:  61%|██████▏   | 378/616 [00:01<00:01, 211.73it/s]remove invalid data : null / measurement error:  66%|██████▌   | 404/616 [00:01<00:00, 224.53it/s]remove invalid data : null / measurement error:  70%|██████▉   | 429/616 [00:02<00:00, 229.05it/s]remove invalid data : null / measurement error:  74%|███████▎  | 453/616 [00:02<00:00, 229.65it/s]remove invalid data : null / measurement error:  77%|███████▋  | 476/616 [00:02<00:00, 223.34it/s]remove invalid data : null / measurement error:  81%|████████  | 499/616 [00:02<00:00, 215.99it/s]remove invalid data : null / measurement error:  85%|████████▍ | 521/616 [00:02<00:00, 212.12it/s]remove invalid data : null / measurement error:  88%|████████▊ | 543/616 [00:02<00:00, 207.72it/s]remove invalid data : null / measurement error:  92%|█████████▏| 564/616 [00:02<00:00, 206.89it/s]remove invalid data : null / measurement error:  95%|█████████▍| 585/616 [00:02<00:00, 206.17it/s]remove invalid data : null / measurement error:  98%|█████████▊| 606/616 [00:02<00:00, 205.16it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 207.39it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 232.84it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 232.53it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 233.02it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 235.31it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 236.46it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 237.74it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 238.43it/s]replace nan value:  37%|███▋      | 193/515 [00:00<00:01, 238.64it/s]replace nan value:  42%|████▏     | 217/515 [00:00<00:01, 238.79it/s]replace nan value:  47%|████▋     | 242/515 [00:01<00:01, 239.32it/s]replace nan value:  52%|█████▏    | 266/515 [00:01<00:01, 239.50it/s]replace nan value:  56%|█████▋    | 290/515 [00:01<00:00, 238.85it/s]replace nan value:  61%|██████    | 315/515 [00:01<00:00, 240.24it/s]replace nan value:  66%|██████▌   | 340/515 [00:01<00:00, 239.64it/s]replace nan value:  71%|███████   | 364/515 [00:01<00:00, 238.66it/s]replace nan value:  76%|███████▌  | 389/515 [00:01<00:00, 239.41it/s]replace nan value:  80%|████████  | 413/515 [00:01<00:00, 238.77it/s]replace nan value:  85%|████████▍ | 437/515 [00:01<00:00, 237.85it/s]replace nan value:  90%|████████▉ | 461/515 [00:01<00:00, 237.63it/s]replace nan value:  94%|█████████▍| 486/515 [00:02<00:00, 238.25it/s]replace nan value:  99%|█████████▉| 510/515 [00:02<00:00, 238.44it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 238.00it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.33it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 55.89it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.83it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.08it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.77it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.75it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.69it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.80it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.29it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.10it/s]generate index:  17%|█▋        | 88/515 [00:01<00:07, 60.83it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.46it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.27it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 63.83it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.36it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.40it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 69.94it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.61it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.12it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.81it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 71.00it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.62it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.78it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 70.10it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.20it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.20it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 80.73it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.20it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.25it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.11it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.70it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.78it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 77.50it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.15it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.30it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.33it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.20it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.44it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 62.01it/s]generate index:  64%|██████▎   | 328/515 [00:04<00:02, 63.98it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.37it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.54it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 43.86it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 50.44it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.38it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.39it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 75.86it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 74.03it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 73.48it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.31it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 63.84it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.26it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 54.99it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 48.00it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.36it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.50it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.15it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.89it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.61it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.91it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.31it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.77it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 88.97it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 156.78it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 178.83it/s]remove invalid data : null / measurement error:  47%|████▋     | 73/154 [00:00<00:00, 191.38it/s]remove invalid data : null / measurement error:  62%|██████▏   | 95/154 [00:00<00:00, 199.72it/s]remove invalid data : null / measurement error:  77%|███████▋  | 119/154 [00:00<00:00, 211.01it/s]remove invalid data : null / measurement error:  92%|█████████▏| 141/154 [00:00<00:00, 209.04it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 195.54it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 246.02it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 247.77it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 248.09it/s]replace nan value:  76%|███████▋  | 100/131 [00:00<00:00, 245.29it/s]replace nan value:  95%|█████████▌| 125/131 [00:00<00:00, 246.75it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 246.76it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.87it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.36it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 53.82it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 59.89it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.07it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.32it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.06it/s]generate index:  45%|████▌     | 59/131 [00:00<00:01, 66.29it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.79it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.67it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 62.93it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.49it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.40it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 45.93it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.40it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 55.17it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 63.87it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.99it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 12/193 [00:00<00:01, 117.72it/s]remove invalid data : null / measurement error:  17%|█▋        | 33/193 [00:00<00:00, 168.84it/s]remove invalid data : null / measurement error:  28%|██▊       | 55/193 [00:00<00:00, 189.95it/s]remove invalid data : null / measurement error:  40%|███▉      | 77/193 [00:00<00:00, 199.40it/s]remove invalid data : null / measurement error:  51%|█████     | 98/193 [00:00<00:00, 203.10it/s]remove invalid data : null / measurement error:  62%|██████▏   | 120/193 [00:00<00:00, 208.05it/s]remove invalid data : null / measurement error:  75%|███████▍  | 144/193 [00:00<00:00, 216.92it/s]remove invalid data : null / measurement error:  86%|████████▌ | 166/193 [00:00<00:00, 211.93it/s]remove invalid data : null / measurement error:  97%|█████████▋| 188/193 [00:00<00:00, 208.60it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 201.81it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 247.34it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 250.05it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 249.54it/s]replace nan value:  64%|██████▍   | 102/160 [00:00<00:00, 246.61it/s]replace nan value:  79%|███████▉  | 127/160 [00:00<00:00, 245.93it/s]replace nan value:  95%|█████████▌| 152/160 [00:00<00:00, 246.22it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 246.71it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 107.31it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.77it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.86it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.37it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.82it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.55it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.79it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 67.89it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.38it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.19it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.16it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.59it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.38it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.36it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.66it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.35it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.35it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 62.49it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.25it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.158, valid loss : 0.029, train acc : 0.958, valid acc : 0.984, train f1 : 0.501, valid f1 : 0.496

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 343.76it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 348.78it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 350.08it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 350.48it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 350.99it/s][A100%|██████████| 195/195 [00:00<00:00, 350.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.496
training process:   1%|          | 1/128 [01:59<4:12:50, 119.45s/it]Best score increase :0.496 -> 0.590
training process:   2%|▏         | 2/128 [03:29<3:34:40, 102.22s/it]Best score increase :0.590 -> 0.803
training process:   2%|▏         | 3/128 [04:57<3:18:59, 95.51s/it] Best score increase :0.803 -> 0.828
training process:   3%|▎         | 4/128 [06:28<3:13:41, 93.72s/it]epoch : 5, train loss : -0.066, valid loss : -0.097, train acc : 0.989, valid acc : 0.991, train f1 : 0.815, valid f1 : 0.834

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.61it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.12it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.61it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.46it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.29it/s][A100%|██████████| 195/195 [00:00<00:00, 344.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.828 -> 0.834
training process:   4%|▍         | 5/128 [08:21<3:26:53, 100.92s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [09:52<3:17:56, 97.34s/it] Best score increase :0.834 -> 0.850
training process:   5%|▌         | 7/128 [11:24<3:12:58, 95.69s/it]Best score increase :0.850 -> 0.856
training process:   6%|▋         | 8/128 [12:54<3:08:01, 94.02s/it]epoch : 9, train loss : -0.198, valid loss : -0.272, train acc : 0.990, valid acc : 0.991, train f1 : 0.837, valid f1 : 0.852

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.07it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 339.23it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 342.95it/s][A
 71%|███████   | 138/195 [00:00<00:00, 344.68it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 345.53it/s][A100%|██████████| 195/195 [00:00<00:00, 343.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [14:52<3:20:46, 101.23s/it]EarlyStopping counter : 2 out of 40
training process:   8%|▊         | 10/128 [16:23<3:13:04, 98.18s/it]Best score increase :0.856 -> 0.859
training process:   9%|▊         | 11/128 [17:57<3:08:50, 96.84s/it]Best score increase :0.859 -> 0.862
training process:   9%|▉         | 12/128 [19:30<3:05:05, 95.73s/it]epoch : 13, train loss : -0.407, valid loss : -0.482, train acc : 0.990, valid acc : 0.991, train f1 : 0.839, valid f1 : 0.857

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.96it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 319.96it/s][A
 50%|█████     | 98/195 [00:00<00:00, 290.58it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 303.72it/s][A
 84%|████████▍ | 164/195 [00:00<00:00, 311.60it/s][A100%|██████████| 195/195 [00:00<00:00, 310.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  10%|█         | 13/128 [21:29<3:16:58, 102.77s/it]EarlyStopping counter : 2 out of 40
training process:  11%|█         | 14/128 [22:58<3:07:10, 98.51s/it] EarlyStopping counter : 3 out of 40
training process:  12%|█▏        | 15/128 [24:25<2:59:24, 95.26s/it]EarlyStopping counter : 4 out of 40
training process:  12%|█▎        | 16/128 [25:55<2:54:36, 93.54s/it]epoch : 17, train loss : -0.672, valid loss : -0.781, train acc : 0.989, valid acc : 0.992, train f1 : 0.845, valid f1 : 0.866

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.35it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.57it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.03it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.06it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 333.50it/s][A100%|██████████| 195/195 [00:00<00:00, 312.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.862 -> 0.866
training process:  13%|█▎        | 17/128 [27:49<3:04:24, 99.68s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [29:20<2:58:09, 97.17s/it]Best score increase :0.866 -> 0.872
training process:  15%|█▍        | 19/128 [30:52<2:53:50, 95.70s/it]EarlyStopping counter : 1 out of 40
training process:  16%|█▌        | 20/128 [32:21<2:48:33, 93.64s/it]epoch : 21, train loss : -1.008, valid loss : -1.139, train acc : 0.989, valid acc : 0.992, train f1 : 0.848, valid f1 : 0.865

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.06it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.60it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 271.74it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 282.04it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 296.90it/s][A100%|██████████| 195/195 [00:00<00:00, 280.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  16%|█▋        | 21/128 [34:16<2:58:16, 99.97s/it]EarlyStopping counter : 3 out of 40
training process:  17%|█▋        | 22/128 [35:44<2:50:24, 96.46s/it]EarlyStopping counter : 4 out of 40
training process:  18%|█▊        | 23/128 [37:13<2:45:02, 94.31s/it]EarlyStopping counter : 5 out of 40
training process:  19%|█▉        | 24/128 [38:43<2:40:49, 92.78s/it]epoch : 25, train loss : -1.371, valid loss : -1.484, train acc : 0.990, valid acc : 0.992, train f1 : 0.855, valid f1 : 0.872

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.42it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.54it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 327.40it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 330.60it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.79it/s][A100%|██████████| 195/195 [00:00<00:00, 331.55it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  20%|█▉        | 25/128 [40:36<2:49:47, 98.91s/it]Best score increase :0.872 -> 0.878
training process:  20%|██        | 26/128 [42:08<2:44:35, 96.82s/it]EarlyStopping counter : 1 out of 40
training process:  21%|██        | 27/128 [43:41<2:41:14, 95.79s/it]Best score increase :0.878 -> 0.879
training process:  22%|██▏       | 28/128 [45:11<2:36:22, 93.83s/it]epoch : 29, train loss : -1.746, valid loss : -1.974, train acc : 0.991, valid acc : 0.991, train f1 : 0.863, valid f1 : 0.865

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.22it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.00it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 330.63it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 332.17it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 333.35it/s][A100%|██████████| 195/195 [00:00<00:00, 331.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 29/128 [47:04<2:44:20, 99.60s/it]EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 30/128 [48:32<2:37:16, 96.29s/it]Best score increase :0.879 -> 0.881
training process:  24%|██▍       | 31/128 [50:00<2:31:25, 93.66s/it]Best score increase :0.881 -> 0.883
training process:  25%|██▌       | 32/128 [51:27<2:26:51, 91.79s/it]epoch : 33, train loss : -2.140, valid loss : -2.352, train acc : 0.991, valid acc : 0.991, train f1 : 0.864, valid f1 : 0.844

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.92it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 243.59it/s][A
 47%|████▋     | 92/195 [00:00<00:00, 239.61it/s][A
 61%|██████    | 119/195 [00:00<00:00, 249.01it/s][A
 75%|███████▌  | 147/195 [00:00<00:00, 257.69it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 263.58it/s][A100%|██████████| 195/195 [00:00<00:00, 260.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  26%|██▌       | 33/128 [53:20<2:35:33, 98.25s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 34/128 [54:49<2:29:32, 95.45s/it]EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 35/128 [56:15<2:23:27, 92.56s/it]EarlyStopping counter : 4 out of 40
training process:  28%|██▊       | 36/128 [57:46<2:21:02, 91.98s/it]epoch : 37, train loss : -2.648, valid loss : -2.696, train acc : 0.990, valid acc : 0.992, train f1 : 0.857, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 342.09it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 346.44it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 344.91it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 341.99it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 342.55it/s][A100%|██████████| 195/195 [00:00<00:00, 341.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  29%|██▉       | 37/128 [59:41<2:30:02, 98.93s/it]Best score increase :0.883 -> 0.894
training process:  30%|██▉       | 38/128 [1:01:09<2:23:29, 95.66s/it]EarlyStopping counter : 1 out of 40
training process:  30%|███       | 39/128 [1:02:41<2:20:11, 94.51s/it]EarlyStopping counter : 2 out of 40
training process:  31%|███▏      | 40/128 [1:04:14<2:17:49, 93.98s/it]epoch : 41, train loss : -3.021, valid loss : -3.236, train acc : 0.991, valid acc : 0.993, train f1 : 0.871, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 311.45it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 314.19it/s][A
 50%|████▉     | 97/195 [00:00<00:00, 320.45it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 325.70it/s][A
 85%|████████▍ | 165/195 [00:00<00:00, 328.69it/s][A100%|██████████| 195/195 [00:00<00:00, 325.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  32%|███▏      | 41/128 [1:06:12<2:26:52, 101.30s/it]EarlyStopping counter : 4 out of 40
training process:  33%|███▎      | 42/128 [1:07:41<2:19:55, 97.62s/it] EarlyStopping counter : 5 out of 40
training process:  34%|███▎      | 43/128 [1:09:11<2:15:12, 95.45s/it]EarlyStopping counter : 6 out of 40
training process:  34%|███▍      | 44/128 [1:10:38<2:10:07, 92.95s/it]epoch : 45, train loss : -3.499, valid loss : -3.396, train acc : 0.991, valid acc : 0.992, train f1 : 0.876, valid f1 : 0.870

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.34it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.50it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.78it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.15it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.97it/s][A100%|██████████| 195/195 [00:00<00:00, 334.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  35%|███▌      | 45/128 [1:12:32<2:17:17, 99.24s/it]EarlyStopping counter : 8 out of 40
training process:  36%|███▌      | 46/128 [1:14:02<2:11:42, 96.38s/it]EarlyStopping counter : 9 out of 40
training process:  37%|███▋      | 47/128 [1:15:31<2:06:54, 94.01s/it]EarlyStopping counter : 10 out of 40
training process:  38%|███▊      | 48/128 [1:17:00<2:03:34, 92.69s/it]epoch : 49, train loss : -3.951, valid loss : -4.176, train acc : 0.992, valid acc : 0.993, train f1 : 0.877, valid f1 : 0.883

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.90it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 341.82it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.23it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.87it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.02it/s][A100%|██████████| 195/195 [00:00<00:00, 342.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  38%|███▊      | 49/128 [1:18:56<2:11:05, 99.56s/it]EarlyStopping counter : 12 out of 40
training process:  39%|███▉      | 50/128 [1:20:31<2:07:36, 98.16s/it]EarlyStopping counter : 13 out of 40
training process:  40%|███▉      | 51/128 [1:22:03<2:03:41, 96.38s/it]EarlyStopping counter : 14 out of 40
training process:  41%|████      | 52/128 [1:23:36<2:01:00, 95.53s/it]epoch : 53, train loss : -4.310, valid loss : -4.771, train acc : 0.991, valid acc : 0.991, train f1 : 0.876, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.03it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.82it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.19it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.85it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.95it/s][A100%|██████████| 195/195 [00:00<00:00, 338.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  41%|████▏     | 53/128 [1:25:36<2:08:23, 102.72s/it]EarlyStopping counter : 16 out of 40
training process:  42%|████▏     | 54/128 [1:26:59<1:59:17, 96.72s/it] EarlyStopping counter : 17 out of 40
training process:  43%|████▎     | 55/128 [1:28:24<1:53:23, 93.20s/it]EarlyStopping counter : 18 out of 40
training process:  44%|████▍     | 56/128 [1:29:49<1:49:06, 90.93s/it]epoch : 57, train loss : -4.785, valid loss : -5.212, train acc : 0.991, valid acc : 0.993, train f1 : 0.870, valid f1 : 0.891

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.85it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.14it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.97it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.41it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 334.23it/s][A100%|██████████| 195/195 [00:00<00:00, 332.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  45%|████▍     | 57/128 [1:31:40<1:54:29, 96.75s/it]EarlyStopping counter : 20 out of 40
training process:  45%|████▌     | 58/128 [1:33:09<1:50:15, 94.50s/it]EarlyStopping counter : 21 out of 40
training process:  46%|████▌     | 59/128 [1:34:38<1:46:46, 92.85s/it]EarlyStopping counter : 22 out of 40
training process:  47%|████▋     | 60/128 [1:36:07<1:44:08, 91.90s/it]epoch : 61, train loss : -5.267, valid loss : -5.692, train acc : 0.993, valid acc : 0.993, train f1 : 0.892, valid f1 : 0.884

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.35it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 342.43it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 346.48it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 345.13it/s][A
 91%|█████████ | 177/195 [00:00<00:00, 347.04it/s][A100%|██████████| 195/195 [00:00<00:00, 345.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  48%|████▊     | 61/128 [1:38:01<1:49:44, 98.27s/it]EarlyStopping counter : 24 out of 40
training process:  48%|████▊     | 62/128 [1:39:31<1:45:22, 95.80s/it]EarlyStopping counter : 25 out of 40
training process:  49%|████▉     | 63/128 [1:40:57<1:40:48, 93.05s/it]EarlyStopping counter : 26 out of 40
training process:  50%|█████     | 64/128 [1:42:28<1:38:23, 92.24s/it]epoch : 65, train loss : -5.746, valid loss : -6.097, train acc : 0.991, valid acc : 0.993, train f1 : 0.880, valid f1 : 0.898

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.38it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.79it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.63it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 332.76it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 333.51it/s][A100%|██████████| 195/195 [00:00<00:00, 333.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.894 -> 0.898
training process:  51%|█████     | 65/128 [1:44:19<1:42:48, 97.91s/it]EarlyStopping counter : 1 out of 40
training process:  52%|█████▏    | 66/128 [1:45:48<1:38:32, 95.36s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 67/128 [1:47:15<1:34:22, 92.83s/it]Best score increase :0.898 -> 0.899
training process:  53%|█████▎    | 68/128 [1:48:43<1:31:16, 91.28s/it]epoch : 69, train loss : -6.125, valid loss : -6.330, train acc : 0.992, valid acc : 0.992, train f1 : 0.890, valid f1 : 0.886

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.99it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.69it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.64it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 343.60it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.11it/s][A100%|██████████| 195/195 [00:00<00:00, 343.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  54%|█████▍    | 69/128 [1:50:37<1:36:40, 98.31s/it]EarlyStopping counter : 2 out of 40
training process:  55%|█████▍    | 70/128 [1:52:11<1:33:40, 96.90s/it]EarlyStopping counter : 3 out of 40
training process:  55%|█████▌    | 71/128 [1:53:43<1:30:41, 95.47s/it]EarlyStopping counter : 4 out of 40
training process:  56%|█████▋    | 72/128 [1:55:13<1:27:28, 93.72s/it]epoch : 73, train loss : -6.545, valid loss : -6.953, train acc : 0.992, valid acc : 0.992, train f1 : 0.893, valid f1 : 0.889

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.23it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.05it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.10it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.56it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.42it/s][A100%|██████████| 195/195 [00:00<00:00, 342.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  57%|█████▋    | 73/128 [1:57:10<1:32:16, 100.67s/it]EarlyStopping counter : 6 out of 40
training process:  58%|█████▊    | 74/128 [1:58:37<1:27:05, 96.77s/it] EarlyStopping counter : 7 out of 40
training process:  59%|█████▊    | 75/128 [2:00:05<1:23:07, 94.11s/it]EarlyStopping counter : 8 out of 40
training process:  59%|█████▉    | 76/128 [2:01:35<1:20:23, 92.76s/it]epoch : 77, train loss : -7.005, valid loss : -6.856, train acc : 0.993, valid acc : 0.992, train f1 : 0.898, valid f1 : 0.863

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.78it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.43it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.65it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.17it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 341.65it/s][A100%|██████████| 195/195 [00:00<00:00, 340.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  60%|██████    | 77/128 [2:03:29<1:24:16, 99.16s/it]EarlyStopping counter : 10 out of 40
training process:  61%|██████    | 78/128 [2:04:59<1:20:14, 96.29s/it]EarlyStopping counter : 11 out of 40
training process:  62%|██████▏   | 79/128 [2:06:31<1:17:42, 95.16s/it]EarlyStopping counter : 12 out of 40
training process:  62%|██████▎   | 80/128 [2:08:02<1:14:58, 93.73s/it]epoch : 81, train loss : -7.356, valid loss : -7.450, train acc : 0.992, valid acc : 0.993, train f1 : 0.892, valid f1 : 0.884

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.65it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.39it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.08it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 333.13it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 329.03it/s][A100%|██████████| 195/195 [00:00<00:00, 330.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  63%|██████▎   | 81/128 [2:09:57<1:18:26, 100.14s/it]EarlyStopping counter : 14 out of 40
training process:  64%|██████▍   | 82/128 [2:11:26<1:14:17, 96.89s/it] EarlyStopping counter : 15 out of 40
training process:  65%|██████▍   | 83/128 [2:12:56<1:11:07, 94.83s/it]EarlyStopping counter : 16 out of 40
training process:  66%|██████▌   | 84/128 [2:14:25<1:08:21, 93.23s/it]epoch : 85, train loss : -7.845, valid loss : -7.812, train acc : 0.993, valid acc : 0.993, train f1 : 0.897, valid f1 : 0.893

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.10it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.75it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.36it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.35it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.90it/s][A100%|██████████| 195/195 [00:00<00:00, 342.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  66%|██████▋   | 85/128 [2:16:22<1:11:53, 100.31s/it]EarlyStopping counter : 18 out of 40
training process:  67%|██████▋   | 86/128 [2:17:51<1:07:44, 96.78s/it] EarlyStopping counter : 19 out of 40
training process:  68%|██████▊   | 87/128 [2:19:20<1:04:29, 94.39s/it]EarlyStopping counter : 20 out of 40
training process:  69%|██████▉   | 88/128 [2:20:50<1:02:07, 93.19s/it]epoch : 89, train loss : -8.142, valid loss : -8.217, train acc : 0.993, valid acc : 0.993, train f1 : 0.901, valid f1 : 0.894

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 273.47it/s][A
 30%|██▉       | 58/195 [00:00<00:00, 283.36it/s][A
 45%|████▌     | 88/195 [00:00<00:00, 286.51it/s][A
 60%|██████    | 117/195 [00:00<00:00, 285.31it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 295.69it/s][A
 93%|█████████▎| 182/195 [00:00<00:00, 305.03it/s][A100%|██████████| 195/195 [00:00<00:00, 297.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  70%|██████▉   | 89/128 [2:22:45<1:04:54, 99.85s/it]EarlyStopping counter : 22 out of 40
training process:  70%|███████   | 90/128 [2:24:14<1:01:03, 96.42s/it]EarlyStopping counter : 23 out of 40
training process:  71%|███████   | 91/128 [2:25:45<58:34, 94.98s/it]  EarlyStopping counter : 24 out of 40
training process:  72%|███████▏  | 92/128 [2:27:15<55:55, 93.21s/it]epoch : 93, train loss : -8.463, valid loss : -8.395, train acc : 0.993, valid acc : 0.993, train f1 : 0.902, valid f1 : 0.873

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.76it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.90it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 346.64it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 345.50it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 346.42it/s][A100%|██████████| 195/195 [00:00<00:00, 345.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 25 out of 40
training process:  73%|███████▎  | 93/128 [2:29:11<58:21, 100.04s/it]EarlyStopping counter : 26 out of 40
training process:  73%|███████▎  | 94/128 [2:30:39<54:47, 96.68s/it] EarlyStopping counter : 27 out of 40
training process:  74%|███████▍  | 95/128 [2:32:08<51:48, 94.19s/it]EarlyStopping counter : 28 out of 40
training process:  75%|███████▌  | 96/128 [2:33:38<49:37, 93.05s/it]epoch : 97, train loss : -8.727, valid loss : -8.966, train acc : 0.993, valid acc : 0.993, train f1 : 0.898, valid f1 : 0.896

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.86it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 335.77it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.49it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.04it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.47it/s][A100%|██████████| 195/195 [00:00<00:00, 337.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 29 out of 40
training process:  76%|███████▌  | 97/128 [2:35:33<51:23, 99.48s/it]EarlyStopping counter : 30 out of 40
training process:  77%|███████▋  | 98/128 [2:36:58<47:34, 95.14s/it]EarlyStopping counter : 31 out of 40
training process:  77%|███████▋  | 99/128 [2:38:29<45:26, 94.00s/it]EarlyStopping counter : 32 out of 40
training process:  78%|███████▊  | 100/128 [2:39:54<42:38, 91.36s/it]epoch : 101, train loss : -9.207, valid loss : -9.118, train acc : 0.994, valid acc : 0.992, train f1 : 0.908, valid f1 : 0.871

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 27/195 [00:00<00:00, 264.40it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 272.94it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 275.29it/s][A
 57%|█████▋    | 111/195 [00:00<00:00, 235.60it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 252.50it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 275.96it/s][A100%|██████████| 195/195 [00:00<00:00, 271.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 33 out of 40
training process:  79%|███████▉  | 101/128 [2:41:45<43:42, 97.14s/it]EarlyStopping counter : 34 out of 40
training process:  80%|███████▉  | 102/128 [2:43:13<40:53, 94.37s/it]EarlyStopping counter : 35 out of 40
training process:  80%|████████  | 103/128 [2:44:45<39:00, 93.63s/it]EarlyStopping counter : 36 out of 40
training process:  81%|████████▏ | 104/128 [2:46:12<36:40, 91.70s/it]epoch : 105, train loss : -9.613, valid loss : -9.256, train acc : 0.994, valid acc : 0.992, train f1 : 0.913, valid f1 : 0.870

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.71it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.68it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.98it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.67it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 341.67it/s][A100%|██████████| 195/195 [00:00<00:00, 341.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 37 out of 40
training process:  82%|████████▏ | 105/128 [2:48:01<37:10, 96.97s/it]EarlyStopping counter : 38 out of 40
training process:  83%|████████▎ | 106/128 [2:49:33<34:57, 95.32s/it]EarlyStopping counter : 39 out of 40
training process:  84%|████████▎ | 107/128 [2:51:03<32:49, 93.79s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 107, best f1 score : 0.899
training process:  84%|████████▎ | 107/128 [2:52:35<33:52, 96.78s/it]
training process finished, best loss : -7.121 and best acc : 0.993, best f1 : 0.899, best epoch : 75

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.73      0.74      0.74       304
           1       1.00      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.86      0.87      0.87     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.87, test AUC : 0.87, test loss : -1344.228

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:06, 11.65s/it]processing for feature importance:  12%|█▏        | 2/17 [00:22<02:50, 11.34s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:41, 11.54s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:30, 11.60s/it]processing for feature importance:  29%|██▉       | 5/17 [00:57<02:18, 11.53s/it]processing for feature importance:  35%|███▌      | 6/17 [01:09<02:06, 11.52s/it]processing for feature importance:  41%|████      | 7/17 [01:20<01:54, 11.47s/it]processing for feature importance:  47%|████▋     | 8/17 [01:33<01:48, 12.09s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:45<01:35, 11.90s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:57<01:22, 11.80s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:09<01:11, 12.00s/it]processing for feature importance:  71%|███████   | 12/17 [02:20<00:58, 11.77s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:32<00:47, 11.81s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:42<00:34, 11.37s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:54<00:23, 11.57s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:06<00:11, 11.63s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.57s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.66s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:04<14:22,  4.09s/it]visualize 2D latent space:   1%|          | 2/212 [00:06<11:24,  3.26s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:14,  2.01s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:29,  1.35s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:42,  3.33s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<05:23,  1.54s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:37,  2.75s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:40,  2.39s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<02:05,  1.91s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 304.87it/s] 33%|███▎      | 65/195 [00:00<00:00, 323.34it/s] 51%|█████     | 99/195 [00:00<00:00, 329.27it/s] 68%|██████▊   | 133/195 [00:00<00:00, 332.07it/s] 86%|████████▌ | 167/195 [00:00<00:00, 333.64it/s]100%|██████████| 195/195 [00:00<00:00, 331.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_smoothing_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 201.08it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 199.28it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 197.45it/s]remove invalid data : null / measurement error:  13%|█▎        | 83/616 [00:00<00:02, 199.39it/s]remove invalid data : null / measurement error:  17%|█▋        | 104/616 [00:00<00:02, 202.00it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 205.09it/s]remove invalid data : null / measurement error:  24%|██▍       | 148/616 [00:00<00:02, 206.79it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 209.06it/s]remove invalid data : null / measurement error:  31%|███       | 191/616 [00:00<00:02, 206.55it/s]remove invalid data : null / measurement error:  34%|███▍      | 212/616 [00:01<00:01, 205.52it/s]remove invalid data : null / measurement error:  38%|███▊      | 233/616 [00:01<00:01, 205.11it/s]remove invalid data : null / measurement error:  41%|████      | 254/616 [00:01<00:01, 204.18it/s]remove invalid data : null / measurement error:  45%|████▍     | 275/616 [00:01<00:01, 202.80it/s]remove invalid data : null / measurement error:  48%|████▊     | 296/616 [00:01<00:01, 202.87it/s]remove invalid data : null / measurement error:  51%|█████▏    | 317/616 [00:01<00:01, 202.15it/s]remove invalid data : null / measurement error:  55%|█████▍    | 338/616 [00:01<00:01, 202.03it/s]remove invalid data : null / measurement error:  58%|█████▊    | 359/616 [00:01<00:01, 202.06it/s]remove invalid data : null / measurement error:  62%|██████▎   | 385/616 [00:01<00:01, 218.67it/s]remove invalid data : null / measurement error:  67%|██████▋   | 412/616 [00:01<00:00, 232.61it/s]remove invalid data : null / measurement error:  71%|███████   | 436/616 [00:02<00:00, 229.81it/s]remove invalid data : null / measurement error:  75%|███████▍  | 461/616 [00:02<00:00, 233.46it/s]remove invalid data : null / measurement error:  79%|███████▊  | 485/616 [00:02<00:00, 224.80it/s]remove invalid data : null / measurement error:  82%|████████▏ | 508/616 [00:02<00:00, 218.67it/s]remove invalid data : null / measurement error:  86%|████████▌ | 530/616 [00:02<00:00, 213.70it/s]remove invalid data : null / measurement error:  90%|████████▉ | 552/616 [00:02<00:00, 209.30it/s]remove invalid data : null / measurement error:  93%|█████████▎| 573/616 [00:02<00:00, 206.85it/s]remove invalid data : null / measurement error:  96%|█████████▋| 594/616 [00:02<00:00, 205.70it/s]remove invalid data : null / measurement error: 100%|█████████▉| 615/616 [00:02<00:00, 204.41it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 209.23it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 236.07it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 236.02it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.81it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 239.00it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 240.87it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 242.54it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 243.20it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 243.22it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 243.38it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 243.98it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 244.57it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 243.38it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 243.26it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 240.64it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 241.53it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 242.61it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 242.29it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 240.89it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 242.81it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 244.74it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 242.48it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.61it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.06it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.82it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.08it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.69it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.01it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 57.05it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.47it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.00it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.11it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.36it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.87it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.54it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.06it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.53it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.51it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 69.87it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 70.90it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 69.81it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.56it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 70.81it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.52it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.90it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 70.70it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.34it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.21it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.68it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.93it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.87it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.29it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.25it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 73.82it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.73it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.77it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.01it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.65it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 61.58it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 61.33it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 60.73it/s]generate index:  64%|██████▎   | 328/515 [00:04<00:02, 64.37it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.91it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.96it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 44.13it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 50.35it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.20it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.15it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 75.87it/s]generate index:  76%|███████▋  | 393/515 [00:06<00:01, 74.61it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.59it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.70it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.50it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 77.69it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 54.29it/s]generate index:  86%|████████▋ | 445/515 [00:07<00:01, 50.14it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.57it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.26it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.90it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.73it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.83it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 62.07it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.40it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.88it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▋         | 10/154 [00:00<00:01, 95.64it/s]remove invalid data : null / measurement error:  20%|██        | 31/154 [00:00<00:00, 160.04it/s]remove invalid data : null / measurement error:  34%|███▍      | 52/154 [00:00<00:00, 181.43it/s]remove invalid data : null / measurement error:  48%|████▊     | 74/154 [00:00<00:00, 193.66it/s]remove invalid data : null / measurement error:  62%|██████▏   | 96/154 [00:00<00:00, 202.34it/s]remove invalid data : null / measurement error:  78%|███████▊  | 120/154 [00:00<00:00, 211.59it/s]remove invalid data : null / measurement error:  92%|█████████▏| 142/154 [00:00<00:00, 208.92it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 196.55it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.41it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 252.44it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 255.21it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 253.07it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 255.19it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 253.87it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 67.02it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.68it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.13it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.31it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.51it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.79it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.05it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.18it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.18it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.13it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.55it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 48.02it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.87it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.46it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.90it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 56.62it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 67.32it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.26it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 77.17it/s]remove invalid data : null / measurement error:  16%|█▌        | 30/193 [00:00<00:01, 155.92it/s]remove invalid data : null / measurement error:  27%|██▋       | 52/193 [00:00<00:00, 181.37it/s]remove invalid data : null / measurement error:  38%|███▊      | 74/193 [00:00<00:00, 194.95it/s]remove invalid data : null / measurement error:  50%|████▉     | 96/193 [00:00<00:00, 201.52it/s]remove invalid data : null / measurement error:  61%|██████    | 118/193 [00:00<00:00, 206.64it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 219.20it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 215.33it/s]remove invalid data : null / measurement error:  97%|█████████▋| 187/193 [00:00<00:00, 213.07it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 200.68it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 253.57it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 255.36it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 254.01it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 250.67it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 250.46it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 250.46it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 251.22it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 102.70it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.11it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.48it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.22it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.82it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.65it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.94it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.08it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.57it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.36it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.07it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.28it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.09it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.51it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.16it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.97it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.91it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.00it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.36it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.275, valid loss : 0.208, train acc : 0.829, valid acc : 0.871, train f1 : 0.829, valid f1 : 0.561

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.65it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 338.92it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 341.63it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 342.78it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 344.66it/s][A100%|██████████| 195/195 [00:00<00:00, 344.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.561
training process:   1%|          | 1/128 [02:00<4:15:20, 120.63s/it]Best score increase :0.561 -> 0.603
training process:   2%|▏         | 2/128 [03:33<3:39:28, 104.51s/it]Best score increase :0.603 -> 0.614
training process:   2%|▏         | 3/128 [05:06<3:26:21, 99.05s/it] Best score increase :0.614 -> 0.668
training process:   3%|▎         | 4/128 [06:39<3:20:11, 96.87s/it]epoch : 5, train loss : 0.001, valid loss : -0.024, train acc : 0.962, valid acc : 0.959, train f1 : 0.962, valid f1 : 0.695

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.89it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.55it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.50it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.91it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 341.94it/s][A100%|██████████| 195/195 [00:00<00:00, 340.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.668 -> 0.695
training process:   4%|▍         | 5/128 [08:39<3:35:05, 104.92s/it]Best score increase :0.695 -> 0.740
training process:   5%|▍         | 6/128 [10:13<3:26:22, 101.50s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:49<3:20:51, 99.60s/it] Best score increase :0.740 -> 0.797
training process:   6%|▋         | 8/128 [13:23<3:15:12, 97.60s/it]epoch : 9, train loss : -0.155, valid loss : -0.101, train acc : 0.978, valid acc : 0.943, train f1 : 0.978, valid f1 : 0.659

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.38it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.42it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.81it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.81it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.67it/s][A100%|██████████| 195/195 [00:00<00:00, 338.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [15:20<3:26:08, 103.94s/it]EarlyStopping counter : 2 out of 40
training process:   8%|▊         | 10/128 [16:52<3:16:50, 100.09s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▊         | 11/128 [18:22<3:09:31, 97.20s/it] EarlyStopping counter : 4 out of 40
training process:   9%|▉         | 12/128 [19:56<3:05:41, 96.05s/it]epoch : 13, train loss : -0.390, valid loss : -0.319, train acc : 0.984, valid acc : 0.967, train f1 : 0.984, valid f1 : 0.727

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.84it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.52it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.58it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.30it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.28it/s][A100%|██████████| 195/195 [00:00<00:00, 339.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  10%|█         | 13/128 [21:55<3:17:22, 102.98s/it]EarlyStopping counter : 6 out of 40
training process:  11%|█         | 14/128 [23:28<3:09:46, 99.89s/it] EarlyStopping counter : 7 out of 40
training process:  12%|█▏        | 15/128 [25:02<3:04:57, 98.21s/it]Best score increase :0.797 -> 0.809
training process:  12%|█▎        | 16/128 [26:34<3:00:06, 96.49s/it]epoch : 17, train loss : -0.668, valid loss : -0.757, train acc : 0.985, valid acc : 0.981, train f1 : 0.985, valid f1 : 0.796

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.43it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 336.87it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 339.41it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.21it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.39it/s][A100%|██████████| 195/195 [00:00<00:00, 340.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:34<3:11:07, 103.32s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [30:05<3:02:43, 99.67s/it] EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [31:36<2:56:43, 97.28s/it]EarlyStopping counter : 4 out of 40
training process:  16%|█▌        | 20/128 [33:11<2:53:28, 96.37s/it]epoch : 21, train loss : -0.940, valid loss : -0.877, train acc : 0.988, valid acc : 0.968, train f1 : 0.987, valid f1 : 0.728

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.14it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.85it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 340.34it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.73it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.47it/s][A100%|██████████| 195/195 [00:00<00:00, 339.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  16%|█▋        | 21/128 [35:09<3:03:32, 102.92s/it]Best score increase :0.809 -> 0.834
training process:  17%|█▋        | 22/128 [36:43<2:57:09, 100.28s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [38:19<2:53:00, 98.86s/it] EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [39:52<2:48:46, 97.37s/it]epoch : 25, train loss : -1.164, valid loss : -1.082, train acc : 0.987, valid acc : 0.972, train f1 : 0.987, valid f1 : 0.750

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.78it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 332.55it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.42it/s][A
 70%|███████   | 137/195 [00:00<00:00, 336.76it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 339.71it/s][A100%|██████████| 195/195 [00:00<00:00, 337.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [41:50<2:57:26, 103.36s/it]Best score increase :0.834 -> 0.836
training process:  20%|██        | 26/128 [43:24<2:50:48, 100.47s/it]EarlyStopping counter : 1 out of 40
training process:  21%|██        | 27/128 [44:56<2:44:54, 97.97s/it] EarlyStopping counter : 2 out of 40
training process:  22%|██▏       | 28/128 [46:30<2:41:32, 96.92s/it]epoch : 29, train loss : -1.487, valid loss : -1.178, train acc : 0.990, valid acc : 0.982, train f1 : 0.990, valid f1 : 0.802

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.44it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.53it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.82it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.42it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.93it/s][A100%|██████████| 195/195 [00:00<00:00, 338.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 29/128 [48:30<2:51:18, 103.82s/it]EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 30/128 [50:04<2:44:36, 100.78s/it]EarlyStopping counter : 5 out of 40
training process:  24%|██▍       | 31/128 [51:36<2:39:00, 98.36s/it] EarlyStopping counter : 6 out of 40
training process:  25%|██▌       | 32/128 [53:10<2:34:58, 96.86s/it]epoch : 33, train loss : -1.782, valid loss : -1.440, train acc : 0.992, valid acc : 0.984, train f1 : 0.992, valid f1 : 0.820

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.12it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.50it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.64it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.66it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.29it/s][A100%|██████████| 195/195 [00:00<00:00, 335.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  26%|██▌       | 33/128 [55:07<2:42:56, 102.91s/it]EarlyStopping counter : 8 out of 40
training process:  27%|██▋       | 34/128 [56:39<2:36:19, 99.78s/it] EarlyStopping counter : 9 out of 40
training process:  27%|██▋       | 35/128 [58:14<2:32:27, 98.36s/it]EarlyStopping counter : 10 out of 40
training process:  28%|██▊       | 36/128 [59:50<2:29:28, 97.48s/it]epoch : 37, train loss : -2.050, valid loss : -1.242, train acc : 0.991, valid acc : 0.984, train f1 : 0.991, valid f1 : 0.810

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.24it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.72it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 340.37it/s][A
 71%|███████   | 138/195 [00:00<00:00, 344.28it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 346.36it/s][A100%|██████████| 195/195 [00:00<00:00, 342.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  29%|██▉       | 37/128 [1:01:47<2:37:01, 103.53s/it]EarlyStopping counter : 12 out of 40
training process:  30%|██▉       | 38/128 [1:03:20<2:30:33, 100.38s/it]EarlyStopping counter : 13 out of 40
training process:  30%|███       | 39/128 [1:04:56<2:26:49, 98.98s/it] EarlyStopping counter : 14 out of 40
training process:  31%|███▏      | 40/128 [1:06:29<2:22:30, 97.16s/it]epoch : 41, train loss : -2.374, valid loss : -1.126, train acc : 0.994, valid acc : 0.982, train f1 : 0.994, valid f1 : 0.801

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.11it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.63it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.21it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.71it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.72it/s][A100%|██████████| 195/195 [00:00<00:00, 336.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  32%|███▏      | 41/128 [1:08:28<2:30:12, 103.59s/it]Best score increase :0.836 -> 0.844
training process:  33%|███▎      | 42/128 [1:10:00<2:23:44, 100.29s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▎      | 43/128 [1:11:35<2:19:39, 98.58s/it] EarlyStopping counter : 2 out of 40
training process:  34%|███▍      | 44/128 [1:13:08<2:15:48, 97.00s/it]epoch : 45, train loss : -2.629, valid loss : -1.968, train acc : 0.994, valid acc : 0.989, train f1 : 0.994, valid f1 : 0.851

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.58it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.96it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.88it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.25it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.62it/s][A100%|██████████| 195/195 [00:00<00:00, 333.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.844 -> 0.851
training process:  35%|███▌      | 45/128 [1:15:08<2:23:27, 103.71s/it]EarlyStopping counter : 1 out of 40
training process:  36%|███▌      | 46/128 [1:16:45<2:19:13, 101.87s/it]EarlyStopping counter : 2 out of 40
training process:  37%|███▋      | 47/128 [1:18:21<2:15:15, 100.19s/it]EarlyStopping counter : 3 out of 40
training process:  38%|███▊      | 48/128 [1:19:54<2:10:40, 98.01s/it] epoch : 49, train loss : -3.115, valid loss : 0.301, train acc : 0.996, valid acc : 0.977, train f1 : 0.996, valid f1 : 0.766

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.15it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.89it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.53it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.75it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.35it/s][A100%|██████████| 195/195 [00:00<00:00, 334.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  38%|███▊      | 49/128 [1:21:56<2:18:14, 104.99s/it]EarlyStopping counter : 5 out of 40
training process:  39%|███▉      | 50/128 [1:23:28<2:11:38, 101.27s/it]EarlyStopping counter : 6 out of 40
training process:  40%|███▉      | 51/128 [1:25:01<2:06:52, 98.87s/it] EarlyStopping counter : 7 out of 40
training process:  41%|████      | 52/128 [1:26:36<2:03:25, 97.44s/it]epoch : 53, train loss : -3.378, valid loss : -1.171, train acc : 0.996, valid acc : 0.986, train f1 : 0.996, valid f1 : 0.823

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.04it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.29it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.62it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.15it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 336.71it/s][A100%|██████████| 195/195 [00:00<00:00, 334.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  41%|████▏     | 53/128 [1:28:34<2:09:37, 103.70s/it]EarlyStopping counter : 9 out of 40
training process:  42%|████▏     | 54/128 [1:30:09<2:04:33, 100.99s/it]EarlyStopping counter : 10 out of 40
training process:  43%|████▎     | 55/128 [1:31:41<1:59:34, 98.29s/it] EarlyStopping counter : 11 out of 40
training process:  44%|████▍     | 56/128 [1:33:14<1:56:09, 96.80s/it]epoch : 57, train loss : -3.806, valid loss : -0.090, train acc : 0.997, valid acc : 0.983, train f1 : 0.997, valid f1 : 0.798

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.25it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.37it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.84it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.08it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 336.32it/s][A100%|██████████| 195/195 [00:00<00:00, 334.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  45%|████▍     | 57/128 [1:35:13<2:02:35, 103.60s/it]EarlyStopping counter : 13 out of 40
training process:  45%|████▌     | 58/128 [1:36:47<1:57:19, 100.56s/it]EarlyStopping counter : 14 out of 40
training process:  46%|████▌     | 59/128 [1:38:22<1:53:42, 98.88s/it] EarlyStopping counter : 15 out of 40
training process:  47%|████▋     | 60/128 [1:39:56<1:50:27, 97.46s/it]epoch : 61, train loss : -4.031, valid loss : -1.481, train acc : 0.997, valid acc : 0.988, train f1 : 0.997, valid f1 : 0.835

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.15it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.28it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 347.98it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 348.75it/s][A
 91%|█████████ | 177/195 [00:00<00:00, 349.27it/s][A100%|██████████| 195/195 [00:00<00:00, 347.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  48%|████▊     | 61/128 [1:41:58<1:57:06, 104.87s/it]EarlyStopping counter : 17 out of 40
training process:  48%|████▊     | 62/128 [1:43:31<1:51:31, 101.38s/it]EarlyStopping counter : 18 out of 40
training process:  49%|████▉     | 63/128 [1:45:06<1:47:37, 99.34s/it] Best score increase :0.851 -> 0.871
training process:  50%|█████     | 64/128 [1:46:38<1:43:47, 97.30s/it]epoch : 65, train loss : -4.523, valid loss : -1.572, train acc : 0.998, valid acc : 0.989, train f1 : 0.998, valid f1 : 0.843

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.15it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 332.72it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.51it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.60it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.77it/s][A100%|██████████| 195/195 [00:00<00:00, 337.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  51%|█████     | 65/128 [1:48:39<1:49:37, 104.41s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 66/128 [1:50:11<1:43:58, 100.62s/it]EarlyStopping counter : 3 out of 40
training process:  52%|█████▏    | 67/128 [1:51:45<1:40:08, 98.50s/it] EarlyStopping counter : 4 out of 40
training process:  53%|█████▎    | 68/128 [1:53:19<1:37:08, 97.15s/it]epoch : 69, train loss : -4.923, valid loss : -2.208, train acc : 0.998, valid acc : 0.991, train f1 : 0.998, valid f1 : 0.866

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.40it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.51it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.94it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 337.28it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.91it/s][A100%|██████████| 195/195 [00:00<00:00, 336.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  54%|█████▍    | 69/128 [1:55:18<1:42:03, 103.79s/it]EarlyStopping counter : 6 out of 40
training process:  55%|█████▍    | 70/128 [1:56:51<1:37:03, 100.41s/it]EarlyStopping counter : 7 out of 40
training process:  55%|█████▌    | 71/128 [1:58:24<1:33:31, 98.44s/it] EarlyStopping counter : 8 out of 40
training process:  56%|█████▋    | 72/128 [1:59:59<1:30:40, 97.16s/it]epoch : 73, train loss : -5.257, valid loss : -2.060, train acc : 0.998, valid acc : 0.990, train f1 : 0.998, valid f1 : 0.859

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.05it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 328.24it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 334.21it/s][A
 70%|███████   | 137/195 [00:00<00:00, 337.21it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.74it/s][A100%|██████████| 195/195 [00:00<00:00, 336.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  57%|█████▋    | 73/128 [2:01:57<1:34:54, 103.54s/it]EarlyStopping counter : 10 out of 40
training process:  58%|█████▊    | 74/128 [2:03:31<1:30:35, 100.67s/it]EarlyStopping counter : 11 out of 40
training process:  59%|█████▊    | 75/128 [2:05:04<1:26:55, 98.41s/it] EarlyStopping counter : 12 out of 40
training process:  59%|█████▉    | 76/128 [2:06:37<1:23:47, 96.69s/it]epoch : 77, train loss : -5.551, valid loss : -0.656, train acc : 0.998, valid acc : 0.986, train f1 : 0.998, valid f1 : 0.827

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.79it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 328.08it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 330.18it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 331.68it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.28it/s][A100%|██████████| 195/195 [00:00<00:00, 331.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  60%|██████    | 77/128 [2:08:35<1:27:45, 103.25s/it]Best score increase :0.871 -> 0.874
training process:  61%|██████    | 78/128 [2:10:08<1:23:30, 100.20s/it]EarlyStopping counter : 1 out of 40
training process:  62%|██████▏   | 79/128 [2:11:43<1:20:20, 98.37s/it] EarlyStopping counter : 2 out of 40
training process:  62%|██████▎   | 80/128 [2:13:18<1:18:02, 97.54s/it]epoch : 81, train loss : -6.089, valid loss : -1.127, train acc : 0.999, valid acc : 0.988, train f1 : 0.999, valid f1 : 0.836

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.13it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.83it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.66it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.23it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.47it/s][A100%|██████████| 195/195 [00:00<00:00, 341.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  63%|██████▎   | 81/128 [2:15:15<1:21:03, 103.47s/it]EarlyStopping counter : 4 out of 40
training process:  64%|██████▍   | 82/128 [2:16:49<1:17:05, 100.55s/it]EarlyStopping counter : 5 out of 40
training process:  65%|██████▍   | 83/128 [2:18:23<1:13:55, 98.56s/it] EarlyStopping counter : 6 out of 40
training process:  66%|██████▌   | 84/128 [2:19:57<1:11:17, 97.21s/it]epoch : 85, train loss : -6.433, valid loss : -3.173, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.873

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.24it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.57it/s][A
 51%|█████     | 99/195 [00:00<00:00, 329.46it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 332.84it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 334.91it/s][A100%|██████████| 195/195 [00:00<00:00, 332.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  66%|██████▋   | 85/128 [2:21:59<1:14:53, 104.49s/it]EarlyStopping counter : 8 out of 40
training process:  67%|██████▋   | 86/128 [2:23:32<1:10:54, 101.30s/it]EarlyStopping counter : 9 out of 40
training process:  68%|██████▊   | 87/128 [2:25:07<1:07:55, 99.40s/it] EarlyStopping counter : 10 out of 40
training process:  69%|██████▉   | 88/128 [2:26:39<1:04:46, 97.15s/it]epoch : 89, train loss : -6.678, valid loss : -3.374, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.875

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 309.32it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 326.58it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.04it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.48it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.54it/s][A100%|██████████| 195/195 [00:00<00:00, 335.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  70%|██████▉   | 89/128 [2:28:38<1:07:24, 103.70s/it]EarlyStopping counter : 12 out of 40
training process:  70%|███████   | 90/128 [2:30:11<1:03:31, 100.31s/it]EarlyStopping counter : 13 out of 40
training process:  71%|███████   | 91/128 [2:31:45<1:00:42, 98.44s/it] EarlyStopping counter : 14 out of 40
training process:  72%|███████▏  | 92/128 [2:33:20<58:24, 97.36s/it]  epoch : 93, train loss : -7.280, valid loss : -2.747, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.863

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.09it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.08it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 327.84it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 331.86it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.28it/s][A100%|██████████| 195/195 [00:00<00:00, 332.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  73%|███████▎  | 93/128 [2:35:20<1:00:53, 104.38s/it]EarlyStopping counter : 16 out of 40
training process:  73%|███████▎  | 94/128 [2:36:55<57:24, 101.31s/it]  EarlyStopping counter : 17 out of 40
training process:  74%|███████▍  | 95/128 [2:38:27<54:14, 98.62s/it] EarlyStopping counter : 18 out of 40
training process:  75%|███████▌  | 96/128 [2:39:59<51:34, 96.70s/it]epoch : 97, train loss : -7.628, valid loss : -2.481, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.862

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.41it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 330.68it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.66it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 332.85it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 336.09it/s][A100%|██████████| 195/195 [00:00<00:00, 334.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  76%|███████▌  | 97/128 [2:41:58<53:21, 103.27s/it]EarlyStopping counter : 20 out of 40
training process:  77%|███████▋  | 98/128 [2:43:30<49:55, 99.87s/it] EarlyStopping counter : 21 out of 40
training process:  77%|███████▋  | 99/128 [2:45:02<47:13, 97.71s/it]EarlyStopping counter : 22 out of 40
training process:  78%|███████▊  | 100/128 [2:46:34<44:42, 95.80s/it]epoch : 101, train loss : -7.888, valid loss : -2.161, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.851

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.69it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.61it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 334.26it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 337.02it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.31it/s][A100%|██████████| 195/195 [00:00<00:00, 336.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  79%|███████▉  | 101/128 [2:48:34<46:28, 103.27s/it]EarlyStopping counter : 24 out of 40
training process:  80%|███████▉  | 102/128 [2:50:08<43:33, 100.53s/it]EarlyStopping counter : 25 out of 40
training process:  80%|████████  | 103/128 [2:51:41<40:54, 98.17s/it] EarlyStopping counter : 26 out of 40
training process:  81%|████████▏ | 104/128 [2:53:16<38:52, 97.17s/it]epoch : 105, train loss : -8.321, valid loss : -1.640, train acc : 0.999, valid acc : 0.988, train f1 : 0.999, valid f1 : 0.838

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.04it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.59it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 328.77it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 332.32it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.22it/s][A100%|██████████| 195/195 [00:00<00:00, 333.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  82%|████████▏ | 105/128 [2:55:13<39:30, 103.05s/it]EarlyStopping counter : 28 out of 40
training process:  83%|████████▎ | 106/128 [2:56:47<36:49, 100.41s/it]EarlyStopping counter : 29 out of 40
training process:  84%|████████▎ | 107/128 [2:58:20<34:24, 98.33s/it] EarlyStopping counter : 30 out of 40
training process:  84%|████████▍ | 108/128 [2:59:53<32:11, 96.56s/it]epoch : 109, train loss : -8.664, valid loss : -3.474, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.869

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.91it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.33it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 340.94it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.35it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 344.73it/s][A100%|██████████| 195/195 [00:00<00:00, 342.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  85%|████████▌ | 109/128 [3:01:51<32:38, 103.10s/it]EarlyStopping counter : 32 out of 40
training process:  86%|████████▌ | 110/128 [3:03:25<30:07, 100.40s/it]EarlyStopping counter : 33 out of 40
training process:  87%|████████▋ | 111/128 [3:04:59<27:50, 98.28s/it] EarlyStopping counter : 34 out of 40
training process:  88%|████████▊ | 112/128 [3:06:31<25:45, 96.61s/it]epoch : 113, train loss : -8.862, valid loss : -2.880, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.860

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.83it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.67it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.55it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.76it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.00it/s][A100%|██████████| 195/195 [00:00<00:00, 337.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  88%|████████▊ | 113/128 [3:08:29<25:43, 102.87s/it]EarlyStopping counter : 36 out of 40
training process:  89%|████████▉ | 114/128 [3:10:01<23:13, 99.57s/it] EarlyStopping counter : 37 out of 40
training process:  90%|████████▉ | 115/128 [3:11:35<21:13, 98.00s/it]EarlyStopping counter : 38 out of 40
training process:  91%|█████████ | 116/128 [3:13:06<19:11, 95.95s/it]epoch : 117, train loss : -9.348, valid loss : -3.398, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.860

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.80it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.22it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.86it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.58it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.53it/s][A100%|██████████| 195/195 [00:00<00:00, 337.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  91%|█████████▏| 117/128 [3:15:05<18:50, 102.74s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 117, best f1 score : 0.875
training process:  91%|█████████▏| 117/128 [3:16:38<18:29, 100.84s/it]
training process finished, best loss : -3.374 and best acc : 0.992, best f1 : 0.875, best epoch : 88

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.72      0.74      0.73       304
           1       1.00      0.99      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.86      0.87      0.86     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.86, test AUC : 0.87, test loss : -643.754

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:22, 12.66s/it]processing for feature importance:  12%|█▏        | 2/17 [00:25<03:09, 12.61s/it]processing for feature importance:  18%|█▊        | 3/17 [00:38<02:57, 12.70s/it]processing for feature importance:  24%|██▎       | 4/17 [00:50<02:45, 12.75s/it]processing for feature importance:  29%|██▉       | 5/17 [01:04<02:35, 12.95s/it]processing for feature importance:  35%|███▌      | 6/17 [01:16<02:20, 12.74s/it]processing for feature importance:  41%|████      | 7/17 [01:29<02:06, 12.69s/it]processing for feature importance:  47%|████▋     | 8/17 [01:42<01:56, 12.90s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:54<01:41, 12.70s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:06<01:27, 12.48s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:19<01:14, 12.47s/it]processing for feature importance:  71%|███████   | 12/17 [02:31<01:02, 12.43s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:43<00:48, 12.24s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:55<00:36, 12.33s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:08<00:24, 12.35s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:20<00:12, 12.42s/it]processing for feature importance: 100%|██████████| 17/17 [03:33<00:00, 12.56s/it]processing for feature importance: 100%|██████████| 17/17 [03:33<00:00, 12.57s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<11:11,  3.18s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<04:57,  1.42s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<08:52,  2.54s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.94s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:28,  1.34s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:02<07:50,  2.23s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<05:27,  1.56s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<08:47,  2.51s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<01:59,  1.78s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<01:44,  1.59s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 308.90it/s] 34%|███▍      | 66/195 [00:00<00:00, 330.35it/s] 52%|█████▏    | 101/195 [00:00<00:00, 337.50it/s] 70%|██████▉   | 136/195 [00:00<00:00, 340.88it/s] 88%|████████▊ | 171/195 [00:00<00:00, 342.81it/s]100%|██████████| 195/195 [00:00<00:00, 339.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_CE_smoothing_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 205.73it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 202.66it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 200.57it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 202.72it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.52it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.53it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 210.04it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 211.36it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 206.73it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 203.93it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 202.35it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 201.59it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 204.27it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 205.86it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 205.78it/s]remove invalid data : null / measurement error:  55%|█████▌    | 341/616 [00:01<00:01, 203.69it/s]remove invalid data : null / measurement error:  59%|█████▉    | 362/616 [00:01<00:01, 205.26it/s]remove invalid data : null / measurement error:  63%|██████▎   | 388/616 [00:01<00:01, 220.12it/s]remove invalid data : null / measurement error:  68%|██████▊   | 416/616 [00:01<00:00, 236.17it/s]remove invalid data : null / measurement error:  71%|███████▏  | 440/616 [00:02<00:00, 231.95it/s]remove invalid data : null / measurement error:  75%|███████▌  | 464/616 [00:02<00:00, 232.86it/s]remove invalid data : null / measurement error:  79%|███████▉  | 488/616 [00:02<00:00, 225.56it/s]remove invalid data : null / measurement error:  83%|████████▎ | 511/616 [00:02<00:00, 221.15it/s]remove invalid data : null / measurement error:  87%|████████▋ | 534/616 [00:02<00:00, 217.33it/s]remove invalid data : null / measurement error:  90%|█████████ | 556/616 [00:02<00:00, 214.20it/s]remove invalid data : null / measurement error:  94%|█████████▍| 578/616 [00:02<00:00, 212.00it/s]remove invalid data : null / measurement error:  97%|█████████▋| 600/616 [00:02<00:00, 210.17it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.62it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 238.02it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 237.99it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.65it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 237.74it/s]replace nan value:  23%|██▎       | 121/515 [00:00<00:01, 240.21it/s]replace nan value:  28%|██▊       | 146/515 [00:00<00:01, 242.46it/s]replace nan value:  33%|███▎      | 171/515 [00:00<00:01, 243.82it/s]replace nan value:  38%|███▊      | 196/515 [00:00<00:01, 244.42it/s]replace nan value:  43%|████▎     | 221/515 [00:00<00:01, 244.99it/s]replace nan value:  48%|████▊     | 246/515 [00:01<00:01, 245.75it/s]replace nan value:  53%|█████▎    | 271/515 [00:01<00:00, 244.95it/s]replace nan value:  57%|█████▋    | 296/515 [00:01<00:00, 242.49it/s]replace nan value:  62%|██████▏   | 321/515 [00:01<00:00, 241.57it/s]replace nan value:  67%|██████▋   | 346/515 [00:01<00:00, 240.41it/s]replace nan value:  72%|███████▏  | 371/515 [00:01<00:00, 241.74it/s]replace nan value:  77%|███████▋  | 396/515 [00:01<00:00, 243.44it/s]replace nan value:  82%|████████▏ | 421/515 [00:01<00:00, 244.81it/s]replace nan value:  87%|████████▋ | 446/515 [00:01<00:00, 244.71it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 246.56it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 247.16it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 243.50it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.60it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.30it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.37it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.05it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.21it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.86it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 59.18it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 49.32it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 56.23it/s]generate index:  15%|█▌        | 78/515 [00:01<00:07, 54.67it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.34it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.64it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.21it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.79it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.19it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.69it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.65it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.02it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.48it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.25it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.57it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.79it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.67it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.54it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.34it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 71.37it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.09it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.47it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 87.43it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.81it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 72.37it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 75.48it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 78.95it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 65.28it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 67.95it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 63.18it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 63.80it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 61.36it/s]generate index:  63%|██████▎   | 323/515 [00:04<00:02, 64.47it/s]generate index:  64%|██████▍   | 331/515 [00:04<00:02, 64.19it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 52.29it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 47.51it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 42.73it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 58.64it/s]generate index:  73%|███████▎  | 374/515 [00:05<00:01, 71.34it/s]generate index:  74%|███████▍  | 382/515 [00:05<00:01, 73.29it/s]generate index:  76%|███████▌  | 390/515 [00:05<00:01, 68.18it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 75.59it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 64.29it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 65.46it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.52it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 54.47it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 50.62it/s]generate index:  89%|████████▊ | 456/515 [00:07<00:00, 61.59it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.60it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.70it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 69.09it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.62it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 65.54it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 71.38it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.98it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:03, 48.53it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 141.46it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 173.41it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 189.94it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 197.53it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 211.94it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 207.92it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 180.13it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 23/131 [00:00<00:00, 228.60it/s]replace nan value:  37%|███▋      | 49/131 [00:00<00:00, 245.58it/s]replace nan value:  57%|█████▋    | 75/131 [00:00<00:00, 250.76it/s]replace nan value:  77%|███████▋  | 101/131 [00:00<00:00, 248.16it/s]replace nan value:  97%|█████████▋| 127/131 [00:00<00:00, 251.90it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 249.27it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 72.11it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 49.79it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 55.97it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 58.03it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 63.96it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 64.86it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 61.74it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 66.95it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 67.03it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 68.70it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 66.49it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 47.70it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 49.66it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 47.70it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 51.69it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 60.33it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 69.65it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.56it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 3/193 [00:00<00:06, 28.93it/s]remove invalid data : null / measurement error:  13%|█▎        | 25/193 [00:00<00:01, 136.68it/s]remove invalid data : null / measurement error:  24%|██▍       | 46/193 [00:00<00:00, 168.36it/s]remove invalid data : null / measurement error:  35%|███▍      | 67/193 [00:00<00:00, 182.99it/s]remove invalid data : null / measurement error:  46%|████▌     | 89/193 [00:00<00:00, 193.29it/s]remove invalid data : null / measurement error:  57%|█████▋    | 110/193 [00:00<00:00, 196.36it/s]remove invalid data : null / measurement error:  70%|██████▉   | 135/193 [00:00<00:00, 212.52it/s]remove invalid data : null / measurement error:  81%|████████▏ | 157/193 [00:00<00:00, 210.88it/s]remove invalid data : null / measurement error:  93%|█████████▎| 179/193 [00:00<00:00, 209.87it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 193.07it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 257.64it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 253.44it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 252.74it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 249.08it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 249.33it/s]replace nan value:  97%|█████████▋| 155/160 [00:00<00:00, 249.60it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.42it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 103.14it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.46it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.85it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.23it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.46it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.25it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.52it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 67.72it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.29it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 58.85it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.76it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.05it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.62it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.70it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.20it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.02it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.22it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 62.65it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.08it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.549, valid loss : -0.843, train acc : 0.542, valid acc : 0.578, train f1 : 0.363, valid f1 : 0.376

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 353.64it/s][A
 37%|███▋      | 72/195 [00:00<00:00, 355.81it/s][A
 55%|█████▌    | 108/195 [00:00<00:00, 357.05it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 357.87it/s][A
 93%|█████████▎| 181/195 [00:00<00:00, 358.66it/s][A100%|██████████| 195/195 [00:00<00:00, 357.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.376
training process:   1%|          | 1/128 [01:59<4:13:05, 119.57s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:27<3:31:35, 100.76s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:56<3:19:13, 95.63s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:24<3:11:26, 92.63s/it]epoch : 5, train loss : -3.440, valid loss : -3.618, train acc : 0.280, valid acc : 0.329, train f1 : 0.232, valid f1 : 0.263

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.96it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.64it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.63it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.94it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.79it/s][A100%|██████████| 195/195 [00:00<00:00, 338.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:17<3:24:53, 99.95s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:45<3:15:03, 95.93s/it]EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:16<3:10:03, 94.24s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:47<3:06:13, 93.11s/it]epoch : 9, train loss : -7.180, valid loss : -8.102, train acc : 0.238, valid acc : 0.240, train f1 : 0.205, valid f1 : 0.206

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.73it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.92it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.46it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.02it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.47it/s][A100%|██████████| 195/195 [00:00<00:00, 336.98it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:43<3:18:51, 100.26s/it]EarlyStopping counter : 9 out of 40
training process:   8%|▊         | 10/128 [16:10<3:09:20, 96.27s/it]EarlyStopping counter : 10 out of 40
training process:   9%|▊         | 11/128 [17:41<3:04:26, 94.58s/it]EarlyStopping counter : 11 out of 40
training process:   9%|▉         | 12/128 [19:09<2:58:50, 92.51s/it]epoch : 13, train loss : -11.729, valid loss : -12.943, train acc : 0.252, valid acc : 0.256, train f1 : 0.215, valid f1 : 0.216

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.07it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 334.44it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 335.72it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.01it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.89it/s][A100%|██████████| 195/195 [00:00<00:00, 337.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  10%|█         | 13/128 [21:04<3:10:39, 99.48s/it]EarlyStopping counter : 13 out of 40
training process:  11%|█         | 14/128 [22:33<3:02:50, 96.24s/it]EarlyStopping counter : 14 out of 40
training process:  12%|█▏        | 15/128 [23:59<2:55:45, 93.33s/it]EarlyStopping counter : 15 out of 40
training process:  12%|█▎        | 16/128 [25:30<2:52:55, 92.64s/it]epoch : 17, train loss : -17.140, valid loss : -17.868, train acc : 0.264, valid acc : 0.330, train f1 : 0.223, valid f1 : 0.264

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.94it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.80it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.48it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 332.99it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 333.03it/s][A100%|██████████| 195/195 [00:00<00:00, 330.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  13%|█▎        | 17/128 [27:26<3:03:59, 99.46s/it]EarlyStopping counter : 17 out of 40
training process:  14%|█▍        | 18/128 [28:57<2:57:45, 96.96s/it]EarlyStopping counter : 18 out of 40
training process:  15%|█▍        | 19/128 [30:25<2:51:24, 94.35s/it]EarlyStopping counter : 19 out of 40
training process:  16%|█▌        | 20/128 [31:54<2:46:54, 92.72s/it]epoch : 21, train loss : -22.944, valid loss : -22.115, train acc : 0.235, valid acc : 0.275, train f1 : 0.203, valid f1 : 0.230

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.52it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.62it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.99it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.10it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.56it/s][A100%|██████████| 195/195 [00:00<00:00, 332.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  16%|█▋        | 21/128 [33:48<2:56:40, 99.07s/it]EarlyStopping counter : 21 out of 40
training process:  17%|█▋        | 22/128 [35:18<2:50:10, 96.32s/it]EarlyStopping counter : 22 out of 40
training process:  18%|█▊        | 23/128 [36:44<2:43:07, 93.21s/it]EarlyStopping counter : 23 out of 40
training process:  19%|█▉        | 24/128 [38:12<2:38:43, 91.57s/it]epoch : 25, train loss : -28.481, valid loss : -34.929, train acc : 0.131, valid acc : 0.161, train f1 : 0.123, valid f1 : 0.147

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 199.77it/s][A
 26%|██▌       | 51/195 [00:00<00:00, 260.86it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 293.77it/s][A
 61%|██████    | 118/195 [00:00<00:00, 306.08it/s][A
 78%|███████▊  | 152/195 [00:00<00:00, 315.66it/s][A
 95%|█████████▌| 186/195 [00:00<00:00, 321.45it/s][A100%|██████████| 195/195 [00:00<00:00, 305.62it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  20%|█▉        | 25/128 [40:02<2:47:07, 97.36s/it]EarlyStopping counter : 25 out of 40
training process:  20%|██        | 26/128 [41:31<2:41:08, 94.79s/it]EarlyStopping counter : 26 out of 40
training process:  21%|██        | 27/128 [43:01<2:37:11, 93.38s/it]EarlyStopping counter : 27 out of 40
training process:  22%|██▏       | 28/128 [44:31<2:34:01, 92.41s/it]epoch : 29, train loss : -35.488, valid loss : -44.117, train acc : 0.196, valid acc : 0.164, train f1 : 0.174, valid f1 : 0.149

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.24it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 323.99it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.51it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.74it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.47it/s][A100%|██████████| 195/195 [00:00<00:00, 333.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  23%|██▎       | 29/128 [46:24<2:42:23, 98.41s/it]EarlyStopping counter : 29 out of 40
training process:  23%|██▎       | 30/128 [47:52<2:35:49, 95.40s/it]EarlyStopping counter : 30 out of 40
training process:  24%|██▍       | 31/128 [49:20<2:30:25, 93.05s/it]EarlyStopping counter : 31 out of 40
training process:  25%|██▌       | 32/128 [50:49<2:26:47, 91.75s/it]epoch : 33, train loss : -41.913, valid loss : -46.962, train acc : 0.185, valid acc : 0.235, train f1 : 0.166, valid f1 : 0.202

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.75it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 335.66it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.55it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.37it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.14it/s][A100%|██████████| 195/195 [00:00<00:00, 335.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  26%|██▌       | 33/128 [52:46<2:37:29, 99.47s/it]EarlyStopping counter : 33 out of 40
training process:  27%|██▋       | 34/128 [54:16<2:31:18, 96.58s/it]EarlyStopping counter : 34 out of 40
training process:  27%|██▋       | 35/128 [55:43<2:25:17, 93.73s/it]EarlyStopping counter : 35 out of 40
training process:  28%|██▊       | 36/128 [57:13<2:22:01, 92.62s/it]epoch : 37, train loss : -48.261, valid loss : -50.866, train acc : 0.166, valid acc : 0.251, train f1 : 0.151, valid f1 : 0.213

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.39it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.37it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.65it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.91it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 337.31it/s][A100%|██████████| 195/195 [00:00<00:00, 338.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  29%|██▉       | 37/128 [59:07<2:30:01, 98.91s/it]EarlyStopping counter : 37 out of 40
training process:  30%|██▉       | 38/128 [1:00:33<2:22:52, 95.25s/it]EarlyStopping counter : 38 out of 40
training process:  30%|███       | 39/128 [1:02:04<2:19:11, 93.84s/it]EarlyStopping counter : 39 out of 40
training process:  31%|███▏      | 40/128 [1:03:35<2:16:16, 92.92s/it]epoch : 41, train loss : -54.170, valid loss : -60.121, train acc : 0.193, valid acc : 0.250, train f1 : 0.173, valid f1 : 0.213

  0%|          | 0/195 [00:00<?, ?it/s][A
  9%|▊         | 17/195 [00:00<00:01, 168.81it/s][A
 19%|█▉        | 38/195 [00:00<00:00, 190.13it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 224.06it/s][A
 47%|████▋     | 92/195 [00:00<00:00, 241.87it/s][A
 62%|██████▏   | 120/195 [00:00<00:00, 253.63it/s][A
 76%|███████▌  | 148/195 [00:00<00:00, 261.15it/s][A
 90%|█████████ | 176/195 [00:00<00:00, 265.94it/s][A100%|██████████| 195/195 [00:00<00:00, 250.10it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 40, best f1 score : 0.376
training process:  31%|███▏      | 40/128 [1:05:31<2:24:08, 98.28s/it]
training process finished, best loss : -0.843 and best acc : 0.578, best f1 : 0.376, best epoch : 0

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.01      0.32      0.02       304
           1       0.98      0.56      0.72     17087

    accuracy                           0.56     17391
   macro avg       0.50      0.44      0.37     17391
weighted avg       0.96      0.56      0.70     17391


# test acc : 0.56, test f1 : 0.37, test AUC : 0.44, test loss : -224.356

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:03, 11.44s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:55, 11.67s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:41, 11.56s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:31, 11.62s/it]processing for feature importance:  29%|██▉       | 5/17 [00:57<02:19, 11.60s/it]processing for feature importance:  35%|███▌      | 6/17 [01:10<02:11, 11.99s/it]processing for feature importance:  41%|████      | 7/17 [01:23<02:02, 12.24s/it]processing for feature importance:  47%|████▋     | 8/17 [01:35<01:50, 12.29s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:48<01:39, 12.45s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:01<01:27, 12.49s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:13<01:14, 12.34s/it]processing for feature importance:  71%|███████   | 12/17 [02:24<01:00, 12.13s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:37<00:48, 12.16s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:49<00:36, 12.10s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:00<00:24, 12.03s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:13<00:12, 12.04s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 12.22s/it]processing for feature importance: 100%|██████████| 17/17 [03:25<00:00, 12.10s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<13:11,  3.75s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<09:35,  2.74s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.94s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<00:56,  1.17it/s]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:54,  1.73s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:55,  3.39s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:13,  2.64s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
Transformer_clip_10_dist_1_CE_smoothing_RW_Robust_CQ_seed_42 : visualize 2D latent space doesn't work due to stability error

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 15%|█▍        | 29/195 [00:00<00:00, 289.28it/s] 32%|███▏      | 62/195 [00:00<00:00, 313.09it/s] 49%|████▊     | 95/195 [00:00<00:00, 320.73it/s] 66%|██████▌   | 128/195 [00:00<00:00, 324.30it/s] 83%|████████▎ | 162/195 [00:00<00:00, 326.53it/s]100%|██████████| 195/195 [00:00<00:00, 323.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 200.75it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 198.94it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 197.10it/s]remove invalid data : null / measurement error:  13%|█▎        | 83/616 [00:00<00:02, 199.55it/s]remove invalid data : null / measurement error:  17%|█▋        | 104/616 [00:00<00:02, 202.78it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 206.57it/s]remove invalid data : null / measurement error:  24%|██▍       | 148/616 [00:00<00:02, 208.89it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 211.28it/s]remove invalid data : null / measurement error:  31%|███       | 192/616 [00:00<00:02, 208.29it/s]remove invalid data : null / measurement error:  35%|███▍      | 213/616 [00:01<00:01, 207.06it/s]remove invalid data : null / measurement error:  38%|███▊      | 234/616 [00:01<00:01, 206.18it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 205.13it/s]remove invalid data : null / measurement error:  45%|████▍     | 276/616 [00:01<00:01, 203.46it/s]remove invalid data : null / measurement error:  48%|████▊     | 297/616 [00:01<00:01, 203.25it/s]remove invalid data : null / measurement error:  52%|█████▏    | 318/616 [00:01<00:01, 202.53it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 202.30it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 202.13it/s]remove invalid data : null / measurement error:  63%|██████▎   | 386/616 [00:01<00:01, 217.75it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:01<00:00, 232.01it/s]remove invalid data : null / measurement error:  71%|███████   | 437/616 [00:02<00:00, 229.09it/s]remove invalid data : null / measurement error:  75%|███████▌  | 462/616 [00:02<00:00, 232.37it/s]remove invalid data : null / measurement error:  79%|███████▉  | 486/616 [00:02<00:00, 225.18it/s]remove invalid data : null / measurement error:  83%|████████▎ | 509/616 [00:02<00:00, 220.09it/s]remove invalid data : null / measurement error:  86%|████████▋ | 532/616 [00:02<00:00, 215.82it/s]remove invalid data : null / measurement error:  90%|████████▉ | 554/616 [00:02<00:00, 212.04it/s]remove invalid data : null / measurement error:  94%|█████████▎| 576/616 [00:02<00:00, 209.50it/s]remove invalid data : null / measurement error:  97%|█████████▋| 597/616 [00:02<00:00, 207.84it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 210.24it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 232.05it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 232.07it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 232.76it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 235.21it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 236.49it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 238.05it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 238.64it/s]replace nan value:  37%|███▋      | 193/515 [00:00<00:01, 238.87it/s]replace nan value:  42%|████▏     | 217/515 [00:00<00:01, 239.03it/s]replace nan value:  47%|████▋     | 242/515 [00:01<00:01, 239.48it/s]replace nan value:  52%|█████▏    | 266/515 [00:01<00:01, 239.46it/s]replace nan value:  56%|█████▋    | 290/515 [00:01<00:00, 238.80it/s]replace nan value:  61%|██████    | 314/515 [00:01<00:00, 238.71it/s]replace nan value:  66%|██████▌   | 338/515 [00:01<00:00, 237.76it/s]replace nan value:  70%|███████   | 362/515 [00:01<00:00, 236.40it/s]replace nan value:  75%|███████▌  | 387/515 [00:01<00:00, 238.03it/s]replace nan value:  80%|███████▉  | 411/515 [00:01<00:00, 237.64it/s]replace nan value:  84%|████████▍ | 435/515 [00:01<00:00, 237.24it/s]replace nan value:  89%|████████▉ | 459/515 [00:01<00:00, 237.03it/s]replace nan value:  94%|█████████▍| 484/515 [00:02<00:00, 239.22it/s]replace nan value:  99%|█████████▉| 509/515 [00:02<00:00, 240.58it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 238.02it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.08it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.42it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.24it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.35it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.91it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.18it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 57.21it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.49it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.05it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.28it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.52it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.49it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.37it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.81it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.06it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.88it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 70.13it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.13it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.01it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.74it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 70.99it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.63it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.81it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.34it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.57it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.51it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 80.96it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.25it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.32it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.10it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.08it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 73.72it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.69it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.82it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.10it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 63.08it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 62.20it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 61.76it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 61.04it/s]generate index:  64%|██████▎   | 328/515 [00:04<00:02, 64.60it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.99it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 46.01it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 44.16it/s]generate index:  69%|██████▊   | 354/515 [00:05<00:03, 49.84it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.23it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.03it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 75.65it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 72.02it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.33it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.55it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.79it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.31it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.43it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 48.22it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.39it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.02it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.90it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.70it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.01it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.17it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.21it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.97it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:02, 49.70it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 141.74it/s]remove invalid data : null / measurement error:  31%|███       | 47/154 [00:00<00:00, 171.54it/s]remove invalid data : null / measurement error:  45%|████▍     | 69/154 [00:00<00:00, 187.69it/s]remove invalid data : null / measurement error:  58%|█████▊    | 90/154 [00:00<00:00, 194.08it/s]remove invalid data : null / measurement error:  75%|███████▍  | 115/154 [00:00<00:00, 210.87it/s]remove invalid data : null / measurement error:  89%|████████▉ | 137/154 [00:00<00:00, 208.34it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 191.56it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 244.31it/s]replace nan value:  38%|███▊      | 50/131 [00:00<00:00, 247.24it/s]replace nan value:  58%|█████▊    | 76/131 [00:00<00:00, 249.61it/s]replace nan value:  77%|███████▋  | 101/131 [00:00<00:00, 246.27it/s]replace nan value:  96%|█████████▌| 126/131 [00:00<00:00, 247.27it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 247.15it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.10it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.04it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.28it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.35it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.48it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.69it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.95it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.10it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.10it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.15it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.57it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.77it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.60it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.20it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.69it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 55.43it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 64.16it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.18it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 98.73it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:01, 161.18it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 185.53it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 197.21it/s]remove invalid data : null / measurement error:  50%|█████     | 97/193 [00:00<00:00, 203.00it/s]remove invalid data : null / measurement error:  62%|██████▏   | 119/193 [00:00<00:00, 208.55it/s]remove invalid data : null / measurement error:  75%|███████▍  | 144/193 [00:00<00:00, 219.62it/s]remove invalid data : null / measurement error:  86%|████████▌ | 166/193 [00:00<00:00, 215.69it/s]remove invalid data : null / measurement error:  97%|█████████▋| 188/193 [00:00<00:00, 212.83it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 202.59it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 247.71it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 250.24it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 249.86it/s]replace nan value:  64%|██████▍   | 102/160 [00:00<00:00, 246.40it/s]replace nan value:  79%|███████▉  | 127/160 [00:00<00:00, 245.80it/s]replace nan value:  95%|█████████▌| 152/160 [00:00<00:00, 246.10it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 246.72it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.19it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.69it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.71it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.35it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.91it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.72it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.01it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.20it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.67it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.49it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.19it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.40it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.35it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.83it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.63it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.31it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.24it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.32it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.61it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.042, valid loss : 0.019, train acc : 0.958, valid acc : 0.985, train f1 : 0.502, valid f1 : 0.570

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 345.43it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 351.70it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 350.79it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 352.70it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 353.86it/s][A100%|██████████| 195/195 [00:00<00:00, 352.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.570
training process:   1%|          | 1/128 [02:00<4:14:13, 120.11s/it]Best score increase :0.570 -> 0.769
training process:   2%|▏         | 2/128 [03:30<3:35:11, 102.47s/it]Best score increase :0.769 -> 0.807
training process:   2%|▏         | 3/128 [05:00<3:21:29, 96.71s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:30<3:14:20, 94.04s/it]epoch : 5, train loss : 0.011, valid loss : 0.010, train acc : 0.990, valid acc : 0.991, train f1 : 0.822, valid f1 : 0.831

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.53it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.58it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.11it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.61it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.48it/s][A100%|██████████| 195/195 [00:00<00:00, 342.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.807 -> 0.831
training process:   4%|▍         | 5/128 [08:25<3:28:21, 101.64s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [09:54<3:18:27, 97.60s/it] Best score increase :0.831 -> 0.858
training process:   5%|▌         | 7/128 [11:23<3:10:53, 94.66s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:54<3:07:08, 93.57s/it]epoch : 9, train loss : 0.009, valid loss : 0.009, train acc : 0.991, valid acc : 0.991, train f1 : 0.849, valid f1 : 0.850

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.40it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.41it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.61it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.76it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.27it/s][A100%|██████████| 195/195 [00:00<00:00, 342.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:52<3:20:26, 101.07s/it]Best score increase :0.858 -> 0.864
training process:   8%|▊         | 10/128 [16:21<3:11:37, 97.44s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [17:53<3:06:25, 95.60s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▉         | 12/128 [19:22<3:00:59, 93.62s/it]epoch : 13, train loss : 0.009, valid loss : 0.010, train acc : 0.992, valid acc : 0.992, train f1 : 0.869, valid f1 : 0.862

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.20it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.70it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.28it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.65it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 347.21it/s][A100%|██████████| 195/195 [00:00<00:00, 345.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  10%|█         | 13/128 [21:19<3:13:11, 100.79s/it]EarlyStopping counter : 4 out of 40
training process:  11%|█         | 14/128 [22:50<3:05:49, 97.80s/it] EarlyStopping counter : 5 out of 40
training process:  12%|█▏        | 15/128 [24:21<3:00:13, 95.69s/it]EarlyStopping counter : 6 out of 40
training process:  12%|█▎        | 16/128 [25:48<2:53:54, 93.16s/it]epoch : 17, train loss : 0.007, valid loss : 0.010, train acc : 0.993, valid acc : 0.992, train f1 : 0.885, valid f1 : 0.875

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.50it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 343.23it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 345.28it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.77it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 345.92it/s][A100%|██████████| 195/195 [00:00<00:00, 345.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.864 -> 0.875
training process:  13%|█▎        | 17/128 [27:42<3:04:08, 99.53s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [29:13<2:57:31, 96.83s/it]Best score increase :0.875 -> 0.877
training process:  15%|█▍        | 19/128 [30:45<2:53:22, 95.43s/it]Best score increase :0.877 -> 0.879
training process:  16%|█▌        | 20/128 [32:15<2:48:50, 93.80s/it]epoch : 21, train loss : 0.006, valid loss : 0.012, train acc : 0.993, valid acc : 0.993, train f1 : 0.900, valid f1 : 0.877

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.93it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.17it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.53it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.94it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.17it/s][A100%|██████████| 195/195 [00:00<00:00, 338.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [34:12<2:59:47, 100.82s/it]EarlyStopping counter : 2 out of 40
training process:  17%|█▋        | 22/128 [35:38<2:50:24, 96.46s/it] EarlyStopping counter : 3 out of 40
training process:  18%|█▊        | 23/128 [37:09<2:45:55, 94.81s/it]EarlyStopping counter : 4 out of 40
training process:  19%|█▉        | 24/128 [38:36<2:39:59, 92.31s/it]epoch : 25, train loss : 0.005, valid loss : 0.009, train acc : 0.994, valid acc : 0.992, train f1 : 0.913, valid f1 : 0.876

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.87it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 266.39it/s][A
 48%|████▊     | 94/195 [00:00<00:00, 263.94it/s][A
 62%|██████▏   | 121/195 [00:00<00:00, 251.36it/s][A
 75%|███████▌  | 147/195 [00:00<00:00, 247.91it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 268.72it/s][A100%|██████████| 195/195 [00:00<00:00, 269.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  20%|█▉        | 25/128 [40:29<2:49:24, 98.68s/it]Best score increase :0.879 -> 0.883
training process:  20%|██        | 26/128 [41:56<2:41:31, 95.01s/it]Best score increase :0.883 -> 0.893
training process:  21%|██        | 27/128 [43:24<2:36:32, 93.00s/it]EarlyStopping counter : 1 out of 40
training process:  22%|██▏       | 28/128 [44:56<2:34:14, 92.55s/it]epoch : 29, train loss : 0.005, valid loss : 0.011, train acc : 0.995, valid acc : 0.993, train f1 : 0.920, valid f1 : 0.883

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 199.03it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 257.70it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 292.05it/s][A
 61%|██████    | 118/195 [00:00<00:00, 307.99it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 308.35it/s][A
 93%|█████████▎| 182/195 [00:00<00:00, 312.61it/s][A100%|██████████| 195/195 [00:00<00:00, 300.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 29/128 [46:51<2:43:57, 99.37s/it]EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 30/128 [48:21<2:37:40, 96.53s/it]EarlyStopping counter : 4 out of 40
training process:  24%|██▍       | 31/128 [49:55<2:35:03, 95.92s/it]EarlyStopping counter : 5 out of 40
training process:  25%|██▌       | 32/128 [51:27<2:31:24, 94.64s/it]epoch : 33, train loss : 0.005, valid loss : 0.012, train acc : 0.995, valid acc : 0.993, train f1 : 0.922, valid f1 : 0.887

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.95it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 239.05it/s][A
 49%|████▉     | 96/195 [00:00<00:00, 268.08it/s][A
 66%|██████▌   | 129/195 [00:00<00:00, 289.54it/s][A
 84%|████████▎ | 163/195 [00:00<00:00, 304.35it/s][A100%|██████████| 195/195 [00:00<00:00, 296.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  26%|██▌       | 33/128 [53:20<2:38:28, 100.09s/it]EarlyStopping counter : 7 out of 40
training process:  27%|██▋       | 34/128 [54:49<2:31:30, 96.70s/it] EarlyStopping counter : 8 out of 40
training process:  27%|██▋       | 35/128 [56:18<2:26:24, 94.46s/it]EarlyStopping counter : 9 out of 40
training process:  28%|██▊       | 36/128 [57:46<2:21:43, 92.43s/it]epoch : 37, train loss : 0.004, valid loss : 0.012, train acc : 0.995, valid acc : 0.993, train f1 : 0.930, valid f1 : 0.893

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 345.60it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 349.43it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 350.57it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 351.13it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 351.44it/s][A100%|██████████| 195/195 [00:00<00:00, 350.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  29%|██▉       | 37/128 [59:38<2:29:24, 98.51s/it]EarlyStopping counter : 11 out of 40
training process:  30%|██▉       | 38/128 [1:01:10<2:24:47, 96.52s/it]EarlyStopping counter : 12 out of 40
training process:  30%|███       | 39/128 [1:02:41<2:20:47, 94.91s/it]EarlyStopping counter : 13 out of 40
training process:  31%|███▏      | 40/128 [1:04:11<2:16:52, 93.33s/it]epoch : 41, train loss : 0.004, valid loss : 0.013, train acc : 0.996, valid acc : 0.993, train f1 : 0.938, valid f1 : 0.895

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.50it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.23it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.87it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.55it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.05it/s][A100%|██████████| 195/195 [00:00<00:00, 334.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.893 -> 0.895
training process:  32%|███▏      | 41/128 [1:06:07<2:25:02, 100.03s/it]EarlyStopping counter : 1 out of 40
training process:  33%|███▎      | 42/128 [1:07:35<2:18:32, 96.65s/it] EarlyStopping counter : 2 out of 40
training process:  34%|███▎      | 43/128 [1:09:03<2:13:13, 94.04s/it]EarlyStopping counter : 3 out of 40
training process:  34%|███▍      | 44/128 [1:10:31<2:09:09, 92.25s/it]epoch : 45, train loss : 0.004, valid loss : 0.013, train acc : 0.996, valid acc : 0.993, train f1 : 0.943, valid f1 : 0.881

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.82it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 328.96it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 330.82it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 327.84it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 329.71it/s][A100%|██████████| 195/195 [00:00<00:00, 329.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  35%|███▌      | 45/128 [1:12:31<2:18:59, 100.47s/it]Best score increase :0.895 -> 0.896
training process:  36%|███▌      | 46/128 [1:14:01<2:13:02, 97.34s/it] EarlyStopping counter : 1 out of 40
training process:  37%|███▋      | 47/128 [1:15:32<2:08:53, 95.48s/it]EarlyStopping counter : 2 out of 40
training process:  38%|███▊      | 48/128 [1:17:03<2:05:30, 94.13s/it]epoch : 49, train loss : 0.004, valid loss : 0.015, train acc : 0.996, valid acc : 0.994, train f1 : 0.946, valid f1 : 0.898

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 338.29it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.26it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 343.37it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 344.04it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 344.36it/s][A100%|██████████| 195/195 [00:00<00:00, 341.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.896 -> 0.898
training process:  38%|███▊      | 49/128 [1:19:01<2:13:07, 101.11s/it]EarlyStopping counter : 1 out of 40
training process:  39%|███▉      | 50/128 [1:20:30<2:06:50, 97.57s/it] EarlyStopping counter : 2 out of 40
training process:  40%|███▉      | 51/128 [1:22:01<2:02:33, 95.50s/it]EarlyStopping counter : 3 out of 40
training process:  41%|████      | 52/128 [1:23:28<1:57:52, 93.06s/it]epoch : 53, train loss : 0.003, valid loss : 0.015, train acc : 0.997, valid acc : 0.993, train f1 : 0.954, valid f1 : 0.885

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.38it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.03it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.57it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.94it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.96it/s][A100%|██████████| 195/195 [00:00<00:00, 342.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  41%|████▏     | 53/128 [1:25:22<2:04:18, 99.45s/it]EarlyStopping counter : 5 out of 40
training process:  42%|████▏     | 54/128 [1:26:57<2:00:44, 97.90s/it]EarlyStopping counter : 6 out of 40
training process:  43%|████▎     | 55/128 [1:28:27<1:56:23, 95.66s/it]EarlyStopping counter : 7 out of 40
training process:  44%|████▍     | 56/128 [1:29:57<1:52:48, 94.01s/it]epoch : 57, train loss : 0.003, valid loss : 0.021, train acc : 0.997, valid acc : 0.993, train f1 : 0.956, valid f1 : 0.877

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.74it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 344.10it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 346.29it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 347.15it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 346.17it/s][A100%|██████████| 195/195 [00:00<00:00, 345.62it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  45%|████▍     | 57/128 [1:31:53<1:58:49, 100.42s/it]EarlyStopping counter : 9 out of 40
training process:  45%|████▌     | 58/128 [1:33:24<1:54:00, 97.72s/it] EarlyStopping counter : 10 out of 40
training process:  46%|████▌     | 59/128 [1:34:55<1:50:09, 95.79s/it]EarlyStopping counter : 11 out of 40
training process:  47%|████▋     | 60/128 [1:36:23<1:45:40, 93.24s/it]epoch : 61, train loss : 0.003, valid loss : 0.022, train acc : 0.997, valid acc : 0.992, train f1 : 0.960, valid f1 : 0.873

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.19it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.25it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 345.37it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 346.25it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 346.68it/s][A100%|██████████| 195/195 [00:00<00:00, 345.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  48%|████▊     | 61/128 [1:38:17<1:51:09, 99.54s/it]EarlyStopping counter : 13 out of 40
training process:  48%|████▊     | 62/128 [1:39:47<1:46:34, 96.89s/it]EarlyStopping counter : 14 out of 40
training process:  49%|████▉     | 63/128 [1:41:17<1:42:36, 94.72s/it]EarlyStopping counter : 15 out of 40
training process:  50%|█████     | 64/128 [1:42:48<1:39:38, 93.41s/it]epoch : 65, train loss : 0.003, valid loss : 0.025, train acc : 0.998, valid acc : 0.994, train f1 : 0.965, valid f1 : 0.894

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█▏        | 22/195 [00:00<00:00, 215.63it/s][A
 28%|██▊       | 54/195 [00:00<00:00, 273.01it/s][A
 45%|████▌     | 88/195 [00:00<00:00, 299.31it/s][A
 62%|██████▏   | 121/195 [00:00<00:00, 311.14it/s][A
 79%|███████▉  | 154/195 [00:00<00:00, 317.80it/s][A
 96%|█████████▌| 187/195 [00:00<00:00, 321.69it/s][A100%|██████████| 195/195 [00:00<00:00, 308.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  51%|█████     | 65/128 [1:44:43<1:45:07, 100.11s/it]EarlyStopping counter : 17 out of 40
training process:  52%|█████▏    | 66/128 [1:46:15<1:40:53, 97.63s/it] EarlyStopping counter : 18 out of 40
training process:  52%|█████▏    | 67/128 [1:47:46<1:37:05, 95.50s/it]EarlyStopping counter : 19 out of 40
training process:  53%|█████▎    | 68/128 [1:49:15<1:33:35, 93.58s/it]epoch : 69, train loss : 0.003, valid loss : 0.026, train acc : 0.998, valid acc : 0.993, train f1 : 0.969, valid f1 : 0.876

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.22it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.93it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 341.01it/s][A
 71%|███████   | 138/195 [00:00<00:00, 342.97it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 343.97it/s][A100%|██████████| 195/195 [00:00<00:00, 341.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  54%|█████▍    | 69/128 [1:51:10<1:38:23, 100.06s/it]EarlyStopping counter : 21 out of 40
training process:  55%|█████▍    | 70/128 [1:52:40<1:33:46, 97.01s/it] EarlyStopping counter : 22 out of 40
training process:  55%|█████▌    | 71/128 [1:54:11<1:30:26, 95.19s/it]EarlyStopping counter : 23 out of 40
training process:  56%|█████▋    | 72/128 [1:55:38<1:26:38, 92.83s/it]epoch : 73, train loss : 0.003, valid loss : 0.027, train acc : 0.998, valid acc : 0.993, train f1 : 0.969, valid f1 : 0.892

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.65it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.68it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 346.99it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 342.10it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 344.28it/s][A100%|██████████| 195/195 [00:00<00:00, 344.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  57%|█████▋    | 73/128 [1:57:33<1:31:15, 99.55s/it]EarlyStopping counter : 25 out of 40
training process:  58%|█████▊    | 74/128 [1:59:04<1:27:04, 96.75s/it]EarlyStopping counter : 26 out of 40
training process:  59%|█████▊    | 75/128 [2:00:34<1:23:54, 95.00s/it]EarlyStopping counter : 27 out of 40
training process:  59%|█████▉    | 76/128 [2:02:01<1:20:16, 92.62s/it]epoch : 77, train loss : 0.002, valid loss : 0.029, train acc : 0.998, valid acc : 0.993, train f1 : 0.974, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.03it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.76it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.86it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.30it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 340.33it/s][A100%|██████████| 195/195 [00:00<00:00, 339.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  60%|██████    | 77/128 [2:03:55<1:24:08, 98.98s/it]EarlyStopping counter : 29 out of 40
training process:  61%|██████    | 78/128 [2:05:22<1:19:24, 95.30s/it]EarlyStopping counter : 30 out of 40
training process:  62%|██████▏   | 79/128 [2:06:49<1:15:41, 92.69s/it]EarlyStopping counter : 31 out of 40
training process:  62%|██████▎   | 80/128 [2:08:18<1:13:24, 91.76s/it]epoch : 81, train loss : 0.002, valid loss : 0.032, train acc : 0.998, valid acc : 0.992, train f1 : 0.975, valid f1 : 0.876

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.79it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 336.90it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 338.70it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.00it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.42it/s][A100%|██████████| 195/195 [00:00<00:00, 337.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  63%|██████▎   | 81/128 [2:10:13<1:17:21, 98.75s/it]EarlyStopping counter : 33 out of 40
training process:  64%|██████▍   | 82/128 [2:11:45<1:14:01, 96.56s/it]EarlyStopping counter : 34 out of 40
training process:  65%|██████▍   | 83/128 [2:13:17<1:11:30, 95.35s/it]EarlyStopping counter : 35 out of 40
training process:  66%|██████▌   | 84/128 [2:14:44<1:08:04, 92.82s/it]epoch : 85, train loss : 0.002, valid loss : 0.032, train acc : 0.998, valid acc : 0.993, train f1 : 0.978, valid f1 : 0.885

  0%|          | 0/195 [00:00<?, ?it/s][A
  9%|▉         | 18/195 [00:00<00:01, 174.11it/s][A
 26%|██▌       | 51/195 [00:00<00:00, 263.84it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 294.82it/s][A
 61%|██████    | 119/195 [00:00<00:00, 309.72it/s][A
 78%|███████▊  | 153/195 [00:00<00:00, 318.27it/s][A
 96%|█████████▌| 187/195 [00:00<00:00, 325.12it/s][A100%|██████████| 195/195 [00:00<00:00, 307.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  66%|██████▋   | 85/128 [2:16:39<1:11:19, 99.52s/it]EarlyStopping counter : 37 out of 40
training process:  67%|██████▋   | 86/128 [2:18:08<1:07:22, 96.24s/it]EarlyStopping counter : 38 out of 40
training process:  68%|██████▊   | 87/128 [2:19:38<1:04:34, 94.51s/it]EarlyStopping counter : 39 out of 40
training process:  69%|██████▉   | 88/128 [2:21:10<1:02:23, 93.59s/it]epoch : 89, train loss : 0.002, valid loss : 0.035, train acc : 0.999, valid acc : 0.993, train f1 : 0.979, valid f1 : 0.892

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.33it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.25it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.76it/s][A
 71%|███████   | 138/195 [00:00<00:00, 341.40it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 342.79it/s][A100%|██████████| 195/195 [00:00<00:00, 341.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 88, best f1 score : 0.898
training process:  69%|██████▉   | 88/128 [2:23:07<1:05:03, 97.59s/it]
training process finished, best loss : 0.015 and best acc : 0.994, best f1 : 0.898, best epoch : 48

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.84      0.69      0.76       304
           1       0.99      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.92      0.84      0.88     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.88, test AUC : 0.84, test loss : 4.251

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:18, 12.43s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:02, 12.18s/it]processing for feature importance:  18%|█▊        | 3/17 [00:37<02:53, 12.37s/it]processing for feature importance:  24%|██▎       | 4/17 [00:49<02:39, 12.25s/it]processing for feature importance:  29%|██▉       | 5/17 [01:01<02:26, 12.18s/it]processing for feature importance:  35%|███▌      | 6/17 [01:13<02:14, 12.25s/it]processing for feature importance:  41%|████      | 7/17 [01:25<02:01, 12.16s/it]processing for feature importance:  47%|████▋     | 8/17 [01:37<01:48, 12.11s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:52<01:43, 12.90s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:05<01:30, 12.89s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:16<01:14, 12.49s/it]processing for feature importance:  71%|███████   | 12/17 [02:29<01:02, 12.49s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:42<00:50, 12.73s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:55<00:38, 12.82s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:07<00:25, 12.63s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:19<00:12, 12.38s/it]processing for feature importance: 100%|██████████| 17/17 [03:31<00:00, 12.21s/it]processing for feature importance: 100%|██████████| 17/17 [03:31<00:00, 12.42s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:04<14:55,  4.24s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<10:25,  2.98s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:24,  2.16s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:36,  1.46s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<10:33,  3.00s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<05:56,  1.70s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:52,  2.82s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:11,  1.96s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<00:59,  1.11it/s]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:38,  1.50s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 303.38it/s] 33%|███▎      | 65/195 [00:00<00:00, 323.86it/s] 51%|█████     | 99/195 [00:00<00:00, 330.86it/s] 68%|██████▊   | 133/195 [00:00<00:00, 334.06it/s] 86%|████████▌ | 167/195 [00:00<00:00, 330.10it/s]100%|██████████| 195/195 [00:00<00:00, 330.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 206.77it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 203.48it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 199.19it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 202.54it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.84it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.99it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 210.49it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 211.35it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 205.57it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 203.01it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 203.37it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 203.12it/s]remove invalid data : null / measurement error:  45%|████▍     | 277/616 [00:01<00:01, 203.99it/s]remove invalid data : null / measurement error:  48%|████▊     | 298/616 [00:01<00:01, 201.50it/s]remove invalid data : null / measurement error:  52%|█████▏    | 319/616 [00:01<00:01, 199.47it/s]remove invalid data : null / measurement error:  55%|█████▌    | 340/616 [00:01<00:01, 199.85it/s]remove invalid data : null / measurement error:  59%|█████▊    | 361/616 [00:01<00:01, 201.00it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:01<00:01, 216.07it/s]remove invalid data : null / measurement error:  67%|██████▋   | 414/616 [00:01<00:00, 231.69it/s]remove invalid data : null / measurement error:  71%|███████   | 438/616 [00:02<00:00, 228.07it/s]remove invalid data : null / measurement error:  75%|███████▌  | 462/616 [00:02<00:00, 230.26it/s]remove invalid data : null / measurement error:  79%|███████▉  | 486/616 [00:02<00:00, 220.63it/s]remove invalid data : null / measurement error:  83%|████████▎ | 509/616 [00:02<00:00, 213.99it/s]remove invalid data : null / measurement error:  86%|████████▌ | 531/616 [00:02<00:00, 208.73it/s]remove invalid data : null / measurement error:  90%|████████▉ | 552/616 [00:02<00:00, 203.36it/s]remove invalid data : null / measurement error:  93%|█████████▎| 573/616 [00:02<00:00, 200.17it/s]remove invalid data : null / measurement error:  96%|█████████▋| 594/616 [00:02<00:00, 198.45it/s]remove invalid data : null / measurement error: 100%|█████████▉| 614/616 [00:02<00:00, 196.76it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 206.89it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/515 [00:00<00:02, 226.66it/s]replace nan value:   9%|▉         | 46/515 [00:00<00:02, 226.04it/s]replace nan value:  13%|█▎        | 69/515 [00:00<00:01, 226.03it/s]replace nan value:  18%|█▊        | 93/515 [00:00<00:01, 229.09it/s]replace nan value:  23%|██▎       | 117/515 [00:00<00:01, 230.32it/s]replace nan value:  27%|██▋       | 141/515 [00:00<00:01, 231.56it/s]replace nan value:  32%|███▏      | 165/515 [00:00<00:01, 233.45it/s]replace nan value:  37%|███▋      | 190/515 [00:00<00:01, 236.04it/s]replace nan value:  42%|████▏     | 215/515 [00:00<00:01, 238.04it/s]replace nan value:  47%|████▋     | 240/515 [00:01<00:01, 240.49it/s]replace nan value:  51%|█████▏    | 265/515 [00:01<00:01, 241.62it/s]replace nan value:  56%|█████▋    | 290/515 [00:01<00:00, 241.19it/s]replace nan value:  61%|██████    | 315/515 [00:01<00:00, 241.15it/s]replace nan value:  66%|██████▌   | 340/515 [00:01<00:00, 239.76it/s]replace nan value:  71%|███████   | 364/515 [00:01<00:00, 238.62it/s]replace nan value:  76%|███████▌  | 389/515 [00:01<00:00, 240.15it/s]replace nan value:  80%|████████  | 414/515 [00:01<00:00, 240.43it/s]replace nan value:  85%|████████▌ | 439/515 [00:01<00:00, 239.62it/s]replace nan value:  90%|█████████ | 464/515 [00:01<00:00, 240.31it/s]replace nan value:  95%|█████████▍| 489/515 [00:02<00:00, 241.21it/s]replace nan value: 100%|█████████▉| 514/515 [00:02<00:00, 240.21it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 237.56it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.52it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.76it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 76.38it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.27it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.62it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.62it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.68it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.94it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.53it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.40it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.21it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.84it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.84it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.05it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.55it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 70.95it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.85it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.38it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.87it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 71.48it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 70.70it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 68.67it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.51it/s]generate index:  37%|███▋      | 191/515 [00:02<00:04, 68.57it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 67.49it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 66.08it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 87.34it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 84.33it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 81.44it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 83.40it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 68.07it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 74.01it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.85it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 62.52it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.64it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 62.75it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 62.62it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 60.89it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 62.59it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 66.28it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 55.55it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 45.48it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 43.11it/s]generate index:  69%|██████▉   | 357/515 [00:05<00:02, 53.11it/s]generate index:  71%|███████▏  | 367/515 [00:05<00:02, 63.37it/s]generate index:  73%|███████▎  | 378/515 [00:05<00:01, 74.25it/s]generate index:  75%|███████▌  | 387/515 [00:05<00:01, 76.88it/s]generate index:  77%|███████▋  | 396/515 [00:06<00:01, 77.05it/s]generate index:  79%|███████▊  | 405/515 [00:06<00:01, 66.48it/s]generate index:  80%|████████  | 413/515 [00:06<00:01, 63.66it/s]generate index:  82%|████████▏ | 424/515 [00:06<00:01, 74.61it/s]generate index:  84%|████████▍ | 432/515 [00:06<00:01, 68.77it/s]generate index:  85%|████████▌ | 440/515 [00:06<00:01, 51.52it/s]generate index:  87%|████████▋ | 447/515 [00:06<00:01, 51.60it/s]generate index:  89%|████████▊ | 456/515 [00:07<00:01, 58.97it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.18it/s]generate index:  91%|█████████▏| 471/515 [00:07<00:00, 55.41it/s]generate index:  94%|█████████▎| 482/515 [00:07<00:00, 66.77it/s]generate index:  95%|█████████▌| 490/515 [00:07<00:00, 66.71it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.45it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.05it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 64.25it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 7/154 [00:00<00:02, 69.46it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 150.99it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 177.15it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 191.26it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 197.43it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 212.04it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 209.40it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 194.45it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.17it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.21it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 250.66it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 248.09it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 249.96it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 249.40it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 68.70it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.71it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 55.23it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.09it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.09it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.18it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.34it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.43it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.40it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 69.28it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.59it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 48.03it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.90it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.62it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 48.36it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 57.14it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 68.03it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.70it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 6/193 [00:00<00:03, 59.92it/s]remove invalid data : null / measurement error:  15%|█▍        | 28/193 [00:00<00:01, 149.86it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 176.52it/s]remove invalid data : null / measurement error:  36%|███▋      | 70/193 [00:00<00:00, 188.35it/s]remove invalid data : null / measurement error:  48%|████▊     | 92/193 [00:00<00:00, 197.25it/s]remove invalid data : null / measurement error:  59%|█████▊    | 113/193 [00:00<00:00, 198.87it/s]remove invalid data : null / measurement error:  72%|███████▏  | 138/193 [00:00<00:00, 213.91it/s]remove invalid data : null / measurement error:  83%|████████▎ | 160/193 [00:00<00:00, 212.91it/s]remove invalid data : null / measurement error:  94%|█████████▍| 182/193 [00:00<00:00, 209.96it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 196.46it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 251.56it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 253.12it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 252.00it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 248.59it/s]replace nan value:  81%|████████  | 129/160 [00:00<00:00, 248.21it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 248.33it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.02it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.45it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.81it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.07it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.67it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.26it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.14it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.75it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.78it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.10it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.87it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.51it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.67it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.53it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.60it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.35it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.23it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.59it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.70it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.86it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.094, valid loss : 0.041, train acc : 0.829, valid acc : 0.943, train f1 : 0.829, valid f1 : 0.649

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.27it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.63it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 342.36it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 346.37it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 347.23it/s][A100%|██████████| 195/195 [00:00<00:00, 345.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.649
training process:   1%|          | 1/128 [01:59<4:13:56, 119.97s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:33<3:39:48, 104.67s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [05:06<3:26:52, 99.30s/it] Best score increase :0.649 -> 0.715
training process:   3%|▎         | 4/128 [06:42<3:22:03, 97.77s/it]epoch : 5, train loss : 0.024, valid loss : 0.038, train acc : 0.969, valid acc : 0.955, train f1 : 0.969, valid f1 : 0.684

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.72it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.37it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.67it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.31it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.37it/s][A100%|██████████| 195/195 [00:00<00:00, 335.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   4%|▍         | 5/128 [08:43<3:37:33, 106.12s/it]EarlyStopping counter : 2 out of 40
training process:   5%|▍         | 6/128 [10:17<3:27:29, 102.04s/it]EarlyStopping counter : 3 out of 40
training process:   5%|▌         | 7/128 [11:52<3:21:05, 99.71s/it] Best score increase :0.715 -> 0.792
training process:   6%|▋         | 8/128 [13:25<3:15:20, 97.67s/it]epoch : 9, train loss : 0.013, valid loss : 0.028, train acc : 0.984, valid acc : 0.973, train f1 : 0.984, valid f1 : 0.755

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 311.85it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 324.32it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 328.13it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.58it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.70it/s][A100%|██████████| 195/195 [00:00<00:00, 329.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [15:25<3:27:26, 104.59s/it]EarlyStopping counter : 2 out of 40
training process:   8%|▊         | 10/128 [16:58<3:18:50, 101.11s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▊         | 11/128 [18:32<3:12:41, 98.82s/it] EarlyStopping counter : 4 out of 40
training process:   9%|▉         | 12/128 [20:07<3:09:04, 97.79s/it]epoch : 13, train loss : 0.010, valid loss : 0.021, train acc : 0.988, valid acc : 0.979, train f1 : 0.988, valid f1 : 0.780

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.59it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.30it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.40it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.56it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.06it/s][A100%|██████████| 195/195 [00:00<00:00, 333.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  10%|█         | 13/128 [22:09<3:21:22, 105.06s/it]Best score increase :0.792 -> 0.800
training process:  11%|█         | 14/128 [23:42<3:12:39, 101.39s/it]EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [25:15<3:06:12, 98.87s/it] EarlyStopping counter : 2 out of 40
training process:  12%|█▎        | 16/128 [26:50<3:02:29, 97.77s/it]epoch : 17, train loss : 0.009, valid loss : 0.020, train acc : 0.991, valid acc : 0.981, train f1 : 0.991, valid f1 : 0.792

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.51it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.40it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 333.82it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.05it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 334.19it/s][A100%|██████████| 195/195 [00:00<00:00, 333.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  13%|█▎        | 17/128 [28:51<3:13:30, 104.60s/it]Best score increase :0.800 -> 0.829
training process:  14%|█▍        | 18/128 [30:22<3:04:35, 100.69s/it]EarlyStopping counter : 1 out of 40
training process:  15%|█▍        | 19/128 [31:58<2:59:58, 99.07s/it] EarlyStopping counter : 2 out of 40
training process:  16%|█▌        | 20/128 [33:33<2:56:37, 98.12s/it]epoch : 21, train loss : 0.007, valid loss : 0.018, train acc : 0.993, valid acc : 0.985, train f1 : 0.993, valid f1 : 0.820

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 307.42it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.12it/s][A
 51%|█████     | 99/195 [00:00<00:00, 327.76it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 330.95it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 333.14it/s][A100%|██████████| 195/195 [00:00<00:00, 329.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  16%|█▋        | 21/128 [35:36<3:08:14, 105.56s/it]EarlyStopping counter : 4 out of 40
training process:  17%|█▋        | 22/128 [37:09<2:59:44, 101.74s/it]EarlyStopping counter : 5 out of 40
training process:  18%|█▊        | 23/128 [38:42<2:53:20, 99.05s/it] EarlyStopping counter : 6 out of 40
training process:  19%|█▉        | 24/128 [40:16<2:49:11, 97.61s/it]epoch : 25, train loss : 0.006, valid loss : 0.017, train acc : 0.993, valid acc : 0.991, train f1 : 0.993, valid f1 : 0.874

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 337.22it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 340.37it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.78it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 342.72it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 343.32it/s][A100%|██████████| 195/195 [00:00<00:00, 342.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.829 -> 0.874
training process:  20%|█▉        | 25/128 [42:21<3:01:32, 105.75s/it]EarlyStopping counter : 1 out of 40
training process:  20%|██        | 26/128 [43:56<2:54:07, 102.43s/it]EarlyStopping counter : 2 out of 40
training process:  21%|██        | 27/128 [45:29<2:47:51, 99.72s/it] EarlyStopping counter : 3 out of 40
training process:  22%|██▏       | 28/128 [47:02<2:42:41, 97.62s/it]epoch : 29, train loss : 0.006, valid loss : 0.020, train acc : 0.995, valid acc : 0.988, train f1 : 0.995, valid f1 : 0.842

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▌        | 30/195 [00:00<00:00, 292.45it/s][A
 32%|███▏      | 63/195 [00:00<00:00, 310.52it/s][A
 49%|████▊     | 95/195 [00:00<00:00, 312.01it/s][A
 66%|██████▌   | 128/195 [00:00<00:00, 317.66it/s][A
 83%|████████▎ | 161/195 [00:00<00:00, 320.84it/s][A
 99%|█████████▉| 194/195 [00:00<00:00, 322.93it/s][A100%|██████████| 195/195 [00:00<00:00, 318.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 29/128 [49:01<2:51:54, 104.19s/it]EarlyStopping counter : 5 out of 40
training process:  23%|██▎       | 30/128 [50:34<2:44:42, 100.84s/it]EarlyStopping counter : 6 out of 40
training process:  24%|██▍       | 31/128 [52:08<2:39:45, 98.82s/it] Best score increase :0.874 -> 0.876
training process:  25%|██▌       | 32/128 [53:44<2:36:34, 97.86s/it]epoch : 33, train loss : 0.005, valid loss : 0.022, train acc : 0.996, valid acc : 0.990, train f1 : 0.996, valid f1 : 0.861

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 313.22it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.17it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.10it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 332.98it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 334.54it/s][A100%|██████████| 195/195 [00:00<00:00, 331.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  26%|██▌       | 33/128 [55:44<2:45:15, 104.38s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 34/128 [57:16<2:37:55, 100.80s/it]EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 35/128 [58:49<2:32:44, 98.54s/it] EarlyStopping counter : 4 out of 40
training process:  28%|██▊       | 36/128 [1:00:22<2:28:29, 96.84s/it]epoch : 37, train loss : 0.004, valid loss : 0.031, train acc : 0.996, valid acc : 0.984, train f1 : 0.996, valid f1 : 0.813

  0%|          | 0/195 [00:00<?, ?it/s][A
 15%|█▌        | 30/195 [00:00<00:00, 298.31it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 317.63it/s][A
 50%|█████     | 98/195 [00:00<00:00, 324.84it/s][A
 68%|██████▊   | 132/195 [00:00<00:00, 328.53it/s][A
 85%|████████▌ | 166/195 [00:00<00:00, 330.53it/s][A100%|██████████| 195/195 [00:00<00:00, 327.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  29%|██▉       | 37/128 [1:02:19<2:36:05, 102.92s/it]EarlyStopping counter : 6 out of 40
training process:  30%|██▉       | 38/128 [1:03:53<2:30:04, 100.05s/it]EarlyStopping counter : 7 out of 40
training process:  30%|███       | 39/128 [1:05:26<2:25:32, 98.12s/it] EarlyStopping counter : 8 out of 40
training process:  31%|███▏      | 40/128 [1:07:01<2:22:12, 96.96s/it]epoch : 41, train loss : 0.005, valid loss : 0.034, train acc : 0.996, valid acc : 0.986, train f1 : 0.996, valid f1 : 0.820

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 304.66it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.12it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.06it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.15it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 332.92it/s][A100%|██████████| 195/195 [00:00<00:00, 330.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  32%|███▏      | 41/128 [1:09:02<2:31:09, 104.25s/it]EarlyStopping counter : 10 out of 40
training process:  33%|███▎      | 42/128 [1:10:35<2:24:40, 100.94s/it]EarlyStopping counter : 11 out of 40
training process:  34%|███▎      | 43/128 [1:12:07<2:19:03, 98.16s/it] EarlyStopping counter : 12 out of 40
training process:  34%|███▍      | 44/128 [1:13:39<2:15:05, 96.50s/it]epoch : 45, train loss : 0.004, valid loss : 0.024, train acc : 0.997, valid acc : 0.992, train f1 : 0.997, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.75it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 328.67it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 331.28it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 331.02it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.65it/s][A100%|██████████| 195/195 [00:00<00:00, 331.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.876 -> 0.879
training process:  35%|███▌      | 45/128 [1:15:39<2:23:08, 103.47s/it]EarlyStopping counter : 1 out of 40
training process:  36%|███▌      | 46/128 [1:17:12<2:16:57, 100.21s/it]EarlyStopping counter : 2 out of 40
training process:  37%|███▋      | 47/128 [1:18:45<2:12:29, 98.14s/it] EarlyStopping counter : 3 out of 40
training process:  38%|███▊      | 48/128 [1:20:18<2:08:49, 96.62s/it]epoch : 49, train loss : 0.003, valid loss : 0.035, train acc : 0.998, valid acc : 0.990, train f1 : 0.998, valid f1 : 0.855

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.50it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.02it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.47it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 331.05it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.90it/s][A100%|██████████| 195/195 [00:00<00:00, 330.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  38%|███▊      | 49/128 [1:22:19<2:16:58, 104.03s/it]EarlyStopping counter : 5 out of 40
training process:  39%|███▉      | 50/128 [1:23:53<2:11:05, 100.84s/it]EarlyStopping counter : 6 out of 40
training process:  40%|███▉      | 51/128 [1:25:27<2:07:03, 99.01s/it] EarlyStopping counter : 7 out of 40
training process:  41%|████      | 52/128 [1:27:02<2:03:47, 97.73s/it]epoch : 53, train loss : 0.004, valid loss : 0.035, train acc : 0.997, valid acc : 0.989, train f1 : 0.997, valid f1 : 0.851

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.05it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.70it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.95it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 333.78it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.01it/s][A100%|██████████| 195/195 [00:00<00:00, 333.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  41%|████▏     | 53/128 [1:29:00<2:09:49, 103.86s/it]EarlyStopping counter : 9 out of 40
training process:  42%|████▏     | 54/128 [1:30:34<2:04:20, 100.82s/it]EarlyStopping counter : 10 out of 40
training process:  43%|████▎     | 55/128 [1:32:08<2:00:13, 98.81s/it] EarlyStopping counter : 11 out of 40
training process:  44%|████▍     | 56/128 [1:33:43<1:57:02, 97.53s/it]epoch : 57, train loss : 0.003, valid loss : 0.042, train acc : 0.998, valid acc : 0.988, train f1 : 0.998, valid f1 : 0.842

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 313.13it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 324.60it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 328.96it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.12it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 326.98it/s][A100%|██████████| 195/195 [00:00<00:00, 326.06it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  45%|████▍     | 57/128 [1:35:46<2:04:21, 105.09s/it]EarlyStopping counter : 13 out of 40
training process:  45%|████▌     | 58/128 [1:37:19<1:58:31, 101.60s/it]EarlyStopping counter : 14 out of 40
training process:  46%|████▌     | 59/128 [1:38:53<1:54:09, 99.27s/it] EarlyStopping counter : 15 out of 40
training process:  47%|████▋     | 60/128 [1:40:28<1:51:14, 98.16s/it]epoch : 61, train loss : 0.003, valid loss : 0.043, train acc : 0.998, valid acc : 0.989, train f1 : 0.998, valid f1 : 0.858

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 327.85it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.08it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.59it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.99it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.72it/s][A100%|██████████| 195/195 [00:00<00:00, 339.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  48%|████▊     | 61/128 [1:42:30<1:57:22, 105.11s/it]EarlyStopping counter : 17 out of 40
training process:  48%|████▊     | 62/128 [1:44:02<1:51:16, 101.16s/it]EarlyStopping counter : 18 out of 40
training process:  49%|████▉     | 63/128 [1:45:35<1:47:04, 98.84s/it] EarlyStopping counter : 19 out of 40
training process:  50%|█████     | 64/128 [1:47:11<1:44:26, 97.91s/it]epoch : 65, train loss : 0.002, valid loss : 0.035, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.883

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 313.71it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.81it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.16it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 332.42it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.60it/s][A100%|██████████| 195/195 [00:00<00:00, 331.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.879 -> 0.883
training process:  51%|█████     | 65/128 [1:49:11<1:49:52, 104.64s/it]EarlyStopping counter : 1 out of 40
training process:  52%|█████▏    | 66/128 [1:50:44<1:44:36, 101.23s/it]Best score increase :0.883 -> 0.885
training process:  52%|█████▏    | 67/128 [1:52:21<1:41:25, 99.77s/it] EarlyStopping counter : 1 out of 40
training process:  53%|█████▎    | 68/128 [1:53:58<1:38:51, 98.86s/it]epoch : 69, train loss : 0.003, valid loss : 0.039, train acc : 0.998, valid acc : 0.991, train f1 : 0.998, valid f1 : 0.869

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.08it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.95it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.71it/s][A
 70%|███████   | 137/195 [00:00<00:00, 337.67it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 338.64it/s][A100%|██████████| 195/195 [00:00<00:00, 336.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  54%|█████▍    | 69/128 [1:56:01<1:44:30, 106.28s/it]EarlyStopping counter : 3 out of 40
training process:  55%|█████▍    | 70/128 [1:57:34<1:38:59, 102.41s/it]EarlyStopping counter : 4 out of 40
training process:  55%|█████▌    | 71/128 [1:59:09<1:34:59, 99.99s/it] EarlyStopping counter : 5 out of 40
training process:  56%|█████▋    | 72/128 [2:00:43<1:31:45, 98.32s/it]epoch : 73, train loss : 0.002, valid loss : 0.043, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.78it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.90it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.48it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.12it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 335.91it/s][A100%|██████████| 195/195 [00:00<00:00, 335.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  57%|█████▋    | 73/128 [2:02:44<1:36:14, 105.00s/it]EarlyStopping counter : 7 out of 40
training process:  58%|█████▊    | 74/128 [2:04:15<1:30:48, 100.90s/it]EarlyStopping counter : 8 out of 40
training process:  59%|█████▊    | 75/128 [2:05:49<1:27:11, 98.70s/it] EarlyStopping counter : 9 out of 40
training process:  59%|█████▉    | 76/128 [2:07:22<1:24:09, 97.10s/it]epoch : 77, train loss : 0.003, valid loss : 0.040, train acc : 0.998, valid acc : 0.992, train f1 : 0.998, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.96it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.36it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.98it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.33it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.87it/s][A100%|██████████| 195/195 [00:00<00:00, 333.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  60%|██████    | 77/128 [2:09:22<1:28:22, 103.97s/it]Best score increase :0.885 -> 0.890
training process:  61%|██████    | 78/128 [2:10:55<1:23:46, 100.53s/it]EarlyStopping counter : 1 out of 40
training process:  62%|██████▏   | 79/128 [2:12:29<1:20:36, 98.70s/it] EarlyStopping counter : 2 out of 40
training process:  62%|██████▎   | 80/128 [2:14:03<1:17:42, 97.14s/it]epoch : 81, train loss : 0.003, valid loss : 0.048, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.856

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.66it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.30it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.05it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 341.45it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 342.20it/s][A100%|██████████| 195/195 [00:00<00:00, 341.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  63%|██████▎   | 81/128 [2:16:02<1:21:21, 103.87s/it]EarlyStopping counter : 4 out of 40
training process:  64%|██████▍   | 82/128 [2:17:34<1:16:49, 100.20s/it]EarlyStopping counter : 5 out of 40
training process:  65%|██████▍   | 83/128 [2:19:07<1:13:28, 97.97s/it] EarlyStopping counter : 6 out of 40
training process:  66%|██████▌   | 84/128 [2:20:39<1:10:41, 96.40s/it]epoch : 85, train loss : 0.002, valid loss : 0.049, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.26it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.46it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.53it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.85it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.72it/s][A100%|██████████| 195/195 [00:00<00:00, 338.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  66%|██████▋   | 85/128 [2:22:37<1:13:44, 102.90s/it]EarlyStopping counter : 8 out of 40
training process:  67%|██████▋   | 86/128 [2:24:12<1:10:21, 100.50s/it]EarlyStopping counter : 9 out of 40
training process:  68%|██████▊   | 87/128 [2:25:46<1:07:11, 98.34s/it] EarlyStopping counter : 10 out of 40
training process:  69%|██████▉   | 88/128 [2:27:18<1:04:28, 96.71s/it]epoch : 89, train loss : 0.002, valid loss : 0.048, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.869

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 312.35it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 324.98it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.38it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 329.03it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 331.48it/s][A100%|██████████| 195/195 [00:00<00:00, 329.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  70%|██████▉   | 89/128 [2:29:18<1:07:21, 103.63s/it]EarlyStopping counter : 12 out of 40
training process:  70%|███████   | 90/128 [2:30:52<1:03:43, 100.62s/it]EarlyStopping counter : 13 out of 40
training process:  71%|███████   | 91/128 [2:32:27<1:01:03, 99.02s/it] EarlyStopping counter : 14 out of 40
training process:  72%|███████▏  | 92/128 [2:34:03<58:51, 98.09s/it]  epoch : 93, train loss : 0.001, valid loss : 0.053, train acc : 0.999, valid acc : 0.993, train f1 : 0.999, valid f1 : 0.890

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.19it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.58it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.22it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.84it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.55it/s][A100%|██████████| 195/195 [00:00<00:00, 335.41it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  73%|███████▎  | 93/128 [2:36:03<1:01:00, 104.58s/it]EarlyStopping counter : 16 out of 40
training process:  73%|███████▎  | 94/128 [2:37:35<57:06, 100.78s/it]  Best score increase :0.890 -> 0.891
training process:  74%|███████▍  | 95/128 [2:39:09<54:17, 98.72s/it] EarlyStopping counter : 1 out of 40
training process:  75%|███████▌  | 96/128 [2:40:42<51:52, 97.28s/it]epoch : 97, train loss : 0.002, valid loss : 0.052, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.883

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.22it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.18it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.97it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.22it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.16it/s][A100%|██████████| 195/195 [00:00<00:00, 335.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  76%|███████▌  | 97/128 [2:42:44<54:02, 104.61s/it]EarlyStopping counter : 3 out of 40
training process:  77%|███████▋  | 98/128 [2:44:17<50:32, 101.09s/it]EarlyStopping counter : 4 out of 40
training process:  77%|███████▋  | 99/128 [2:45:50<47:44, 98.77s/it] EarlyStopping counter : 5 out of 40
training process:  78%|███████▊  | 100/128 [2:47:23<45:12, 96.87s/it]epoch : 101, train loss : 0.002, valid loss : 0.051, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.877

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.74it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.53it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.96it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 332.65it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 334.98it/s][A100%|██████████| 195/195 [00:00<00:00, 333.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  79%|███████▉  | 101/128 [2:49:25<46:59, 104.41s/it]EarlyStopping counter : 7 out of 40
training process:  80%|███████▉  | 102/128 [2:50:58<43:44, 100.94s/it]EarlyStopping counter : 8 out of 40
training process:  80%|████████  | 103/128 [2:52:32<41:12, 98.91s/it] EarlyStopping counter : 9 out of 40
training process:  81%|████████▏ | 104/128 [2:54:09<39:22, 98.46s/it]epoch : 105, train loss : 0.001, valid loss : 0.067, train acc : 0.999, valid acc : 0.989, train f1 : 0.999, valid f1 : 0.848

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.76it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.72it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 339.06it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.93it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.42it/s][A100%|██████████| 195/195 [00:00<00:00, 339.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  82%|████████▏ | 105/128 [2:56:07<40:00, 104.35s/it]EarlyStopping counter : 11 out of 40
training process:  83%|████████▎ | 106/128 [2:57:44<37:22, 101.92s/it]EarlyStopping counter : 12 out of 40
training process:  84%|████████▎ | 107/128 [2:59:19<34:55, 99.80s/it] EarlyStopping counter : 13 out of 40
training process:  84%|████████▍ | 108/128 [3:00:54<32:50, 98.52s/it]epoch : 109, train loss : 0.001, valid loss : 0.051, train acc : 0.999, valid acc : 0.993, train f1 : 0.999, valid f1 : 0.886

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 312.87it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.64it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.65it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.47it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.71it/s][A100%|██████████| 195/195 [00:00<00:00, 331.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  85%|████████▌ | 109/128 [3:02:51<32:57, 104.07s/it]EarlyStopping counter : 15 out of 40
training process:  86%|████████▌ | 110/128 [3:04:25<30:21, 101.17s/it]EarlyStopping counter : 16 out of 40
training process:  87%|████████▋ | 111/128 [3:05:58<27:53, 98.45s/it] EarlyStopping counter : 17 out of 40
training process:  88%|████████▊ | 112/128 [3:07:31<25:48, 96.81s/it]epoch : 113, train loss : 0.001, valid loss : 0.051, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.99it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.73it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.46it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.59it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.47it/s][A100%|██████████| 195/195 [00:00<00:00, 334.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  88%|████████▊ | 113/128 [3:09:30<25:53, 103.54s/it]EarlyStopping counter : 19 out of 40
training process:  89%|████████▉ | 114/128 [3:11:03<23:26, 100.44s/it]EarlyStopping counter : 20 out of 40
training process:  90%|████████▉ | 115/128 [3:12:38<21:24, 98.83s/it] EarlyStopping counter : 21 out of 40
training process:  91%|█████████ | 116/128 [3:14:12<19:28, 97.35s/it]epoch : 117, train loss : 0.001, valid loss : 0.054, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 323.08it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.57it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.57it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.55it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.15it/s][A100%|██████████| 195/195 [00:00<00:00, 334.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  91%|█████████▏| 117/128 [3:16:10<18:58, 103.47s/it]EarlyStopping counter : 23 out of 40
training process:  92%|█████████▏| 118/128 [3:17:44<16:45, 100.59s/it]EarlyStopping counter : 24 out of 40
training process:  93%|█████████▎| 119/128 [3:19:17<14:46, 98.46s/it] EarlyStopping counter : 25 out of 40
training process:  94%|█████████▍| 120/128 [3:20:51<12:55, 96.95s/it]epoch : 121, train loss : 0.001, valid loss : 0.054, train acc : 1.000, valid acc : 0.993, train f1 : 1.000, valid f1 : 0.889

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 307.67it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.30it/s][A
 51%|█████     | 99/195 [00:00<00:00, 327.73it/s][A
 68%|██████▊   | 132/195 [00:00<00:00, 325.94it/s][A
 85%|████████▍ | 165/195 [00:00<00:00, 285.39it/s][A
100%|██████████| 195/195 [00:00<00:00, 276.44it/s][A100%|██████████| 195/195 [00:00<00:00, 293.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  95%|█████████▍| 121/128 [3:22:53<12:12, 104.60s/it]EarlyStopping counter : 27 out of 40
training process:  95%|█████████▌| 122/128 [3:24:26<10:06, 101.02s/it]EarlyStopping counter : 28 out of 40
training process:  96%|█████████▌| 123/128 [3:26:00<08:14, 98.96s/it] EarlyStopping counter : 29 out of 40
training process:  97%|█████████▋| 124/128 [3:27:37<06:33, 98.38s/it]epoch : 125, train loss : 0.001, valid loss : 0.053, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.876

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 328.43it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.17it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.84it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.84it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.50it/s][A100%|██████████| 195/195 [00:00<00:00, 334.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  98%|█████████▊| 125/128 [3:29:36<05:13, 104.51s/it]EarlyStopping counter : 31 out of 40
training process:  98%|█████████▊| 126/128 [3:31:08<03:21, 100.79s/it]EarlyStopping counter : 32 out of 40
training process:  99%|█████████▉| 127/128 [3:32:41<01:38, 98.51s/it] EarlyStopping counter : 33 out of 40
training process: 100%|██████████| 128/128 [3:34:16<00:00, 97.56s/it]training process: 100%|██████████| 128/128 [3:34:16<00:00, 100.44s/it]
training process finished, best loss : 0.050 and best acc : 0.993, best f1 : 0.891, best epoch : 94

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.76      0.72      0.74       304
           1       1.00      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.88      0.86      0.87     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.87, test AUC : 0.86, test loss : 13.559

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:13<03:31, 13.19s/it]processing for feature importance:  12%|█▏        | 2/17 [00:26<03:18, 13.25s/it]processing for feature importance:  18%|█▊        | 3/17 [00:39<03:01, 12.95s/it]processing for feature importance:  24%|██▎       | 4/17 [00:51<02:45, 12.73s/it]processing for feature importance:  29%|██▉       | 5/17 [01:06<02:42, 13.56s/it]processing for feature importance:  35%|███▌      | 6/17 [01:19<02:25, 13.20s/it]processing for feature importance:  41%|████      | 7/17 [01:31<02:08, 12.87s/it]processing for feature importance:  47%|████▋     | 8/17 [01:43<01:54, 12.73s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:56<01:41, 12.63s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:08<01:28, 12.68s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:22<01:18, 13.03s/it]processing for feature importance:  71%|███████   | 12/17 [02:35<01:05, 13.04s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:47<00:51, 12.76s/it]processing for feature importance:  82%|████████▏ | 14/17 [03:02<00:39, 13.31s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:15<00:26, 13.13s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:29<00:13, 13.56s/it]processing for feature importance: 100%|██████████| 17/17 [03:42<00:00, 13.33s/it]processing for feature importance: 100%|██████████| 17/17 [03:42<00:00, 13.09s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:02<07:53,  2.24s/it]visualize 2D latent space:   1%|          | 2/212 [00:02<03:47,  1.08s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<06:37,  1.89s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:21,  2.12s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:36,  1.47s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:02<09:09,  2.60s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:02<04:17,  1.23s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<06:31,  1.86s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:03,  1.85s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:28,  1.34s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 15%|█▌        | 30/195 [00:00<00:00, 295.78it/s] 33%|███▎      | 64/195 [00:00<00:00, 318.68it/s] 50%|█████     | 98/195 [00:00<00:00, 326.58it/s] 68%|██████▊   | 132/195 [00:00<00:00, 330.17it/s] 85%|████████▌ | 166/195 [00:00<00:00, 332.28it/s]100%|██████████| 195/195 [00:00<00:00, 328.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 206.02it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 199.06it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 194.30it/s]remove invalid data : null / measurement error:  13%|█▎        | 82/616 [00:00<00:02, 194.92it/s]remove invalid data : null / measurement error:  17%|█▋        | 102/616 [00:00<00:02, 194.63it/s]remove invalid data : null / measurement error:  20%|██        | 124/616 [00:00<00:02, 200.16it/s]remove invalid data : null / measurement error:  24%|██▎       | 146/616 [00:00<00:02, 203.98it/s]remove invalid data : null / measurement error:  27%|██▋       | 168/616 [00:00<00:02, 208.68it/s]remove invalid data : null / measurement error:  31%|███       | 189/616 [00:00<00:02, 207.86it/s]remove invalid data : null / measurement error:  34%|███▍      | 210/616 [00:01<00:01, 207.89it/s]remove invalid data : null / measurement error:  38%|███▊      | 232/616 [00:01<00:01, 208.85it/s]remove invalid data : null / measurement error:  41%|████      | 253/616 [00:01<00:01, 208.69it/s]remove invalid data : null / measurement error:  45%|████▍     | 275/616 [00:01<00:01, 210.03it/s]remove invalid data : null / measurement error:  48%|████▊     | 297/616 [00:01<00:01, 209.78it/s]remove invalid data : null / measurement error:  52%|█████▏    | 318/616 [00:01<00:01, 208.86it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 207.22it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 207.13it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:01<00:01, 222.67it/s]remove invalid data : null / measurement error:  67%|██████▋   | 415/616 [00:01<00:00, 238.38it/s]remove invalid data : null / measurement error:  71%|███████▏  | 439/616 [00:02<00:00, 234.62it/s]remove invalid data : null / measurement error:  75%|███████▌  | 463/616 [00:02<00:00, 235.65it/s]remove invalid data : null / measurement error:  79%|███████▉  | 487/616 [00:02<00:00, 227.95it/s]remove invalid data : null / measurement error:  83%|████████▎ | 510/616 [00:02<00:00, 222.22it/s]remove invalid data : null / measurement error:  87%|████████▋ | 533/616 [00:02<00:00, 217.72it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 214.04it/s]remove invalid data : null / measurement error:  94%|█████████▎| 577/616 [00:02<00:00, 210.60it/s]remove invalid data : null / measurement error:  97%|█████████▋| 599/616 [00:02<00:00, 209.69it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 212.15it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 241.87it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 240.24it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 241.56it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 244.03it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 245.23it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 246.68it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 247.38it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 247.26it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 245.45it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 246.52it/s]replace nan value:  54%|█████▎    | 276/515 [00:01<00:00, 247.58it/s]replace nan value:  58%|█████▊    | 301/515 [00:01<00:00, 246.93it/s]replace nan value:  63%|██████▎   | 326/515 [00:01<00:00, 247.36it/s]replace nan value:  68%|██████▊   | 351/515 [00:01<00:00, 244.28it/s]replace nan value:  73%|███████▎  | 376/515 [00:01<00:00, 245.96it/s]replace nan value:  78%|███████▊  | 401/515 [00:01<00:00, 246.67it/s]replace nan value:  83%|████████▎ | 426/515 [00:01<00:00, 246.84it/s]replace nan value:  88%|████████▊ | 451/515 [00:01<00:00, 245.16it/s]replace nan value:  92%|█████████▏| 476/515 [00:01<00:00, 245.94it/s]replace nan value:  97%|█████████▋| 501/515 [00:02<00:00, 246.79it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 245.91it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.98it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 58.35it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.72it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 73.62it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.44it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.87it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 59.06it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.79it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.30it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.40it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.60it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.28it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 60.27it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.90it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 64.12it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.99it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.99it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.92it/s]generate index:  30%|██▉       | 152/515 [00:02<00:04, 72.73it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 73.63it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.83it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.91it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 72.27it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.66it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 65.57it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 73.10it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.86it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 89.40it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 89.36it/s]generate index:  49%|████▉     | 253/515 [00:03<00:03, 74.57it/s]generate index:  51%|█████     | 262/515 [00:03<00:03, 77.43it/s]generate index:  53%|█████▎    | 271/515 [00:03<00:03, 80.31it/s]generate index:  54%|█████▍    | 280/515 [00:04<00:03, 66.54it/s]generate index:  56%|█████▌    | 288/515 [00:04<00:03, 66.84it/s]generate index:  57%|█████▋    | 296/515 [00:04<00:03, 66.03it/s]generate index:  59%|█████▉    | 303/515 [00:04<00:03, 64.70it/s]generate index:  60%|██████    | 311/515 [00:04<00:03, 66.26it/s]generate index:  62%|██████▏   | 318/515 [00:04<00:03, 60.79it/s]generate index:  63%|██████▎   | 326/515 [00:04<00:02, 65.09it/s]generate index:  65%|██████▍   | 333/515 [00:04<00:02, 66.18it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 48.79it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 47.04it/s]generate index:  68%|██████▊   | 352/515 [00:05<00:03, 46.33it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 59.08it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 73.61it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 77.53it/s]generate index:  76%|███████▋  | 393/515 [00:05<00:01, 76.16it/s]generate index:  78%|███████▊  | 402/515 [00:05<00:01, 73.57it/s]generate index:  80%|███████▉  | 410/515 [00:06<00:01, 65.08it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 66.26it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 78.31it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 55.35it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 51.25it/s]generate index:  88%|████████▊ | 455/515 [00:06<00:00, 60.99it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.59it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.38it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.68it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.65it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 65.27it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.86it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 65.80it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:03, 49.43it/s]remove invalid data : null / measurement error:  18%|█▊        | 27/154 [00:00<00:00, 145.45it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 176.02it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 189.89it/s]remove invalid data : null / measurement error:  60%|██████    | 93/154 [00:00<00:00, 198.91it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 213.65it/s]remove invalid data : null / measurement error:  91%|█████████ | 140/154 [00:00<00:00, 212.06it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 194.73it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 256.04it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 257.27it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 257.80it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 253.77it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 255.83it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 255.68it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 72.15it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.75it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 57.27it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 59.55it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 65.37it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 65.50it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 61.52it/s]generate index:  47%|████▋     | 62/131 [00:00<00:00, 69.12it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 64.97it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 67.04it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 65.34it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 47.27it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 49.45it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 47.71it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 52.33it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 61.41it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 71.20it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.97it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/193 [00:00<00:03, 48.82it/s]remove invalid data : null / measurement error:  14%|█▍        | 27/193 [00:00<00:01, 146.59it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 177.54it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 193.78it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 202.86it/s]remove invalid data : null / measurement error:  60%|█████▉    | 115/193 [00:00<00:00, 205.46it/s]remove invalid data : null / measurement error:  73%|███████▎  | 141/193 [00:00<00:00, 220.51it/s]remove invalid data : null / measurement error:  85%|████████▍ | 164/193 [00:00<00:00, 217.61it/s]remove invalid data : null / measurement error:  96%|█████████▋| 186/193 [00:00<00:00, 214.91it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 200.20it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 257.95it/s]replace nan value:  33%|███▎      | 53/160 [00:00<00:00, 260.04it/s]replace nan value:  50%|█████     | 80/160 [00:00<00:00, 258.78it/s]replace nan value:  66%|██████▋   | 106/160 [00:00<00:00, 255.90it/s]replace nan value:  82%|████████▎ | 132/160 [00:00<00:00, 255.83it/s]replace nan value:  99%|█████████▉| 158/160 [00:00<00:00, 256.25it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 256.63it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.63it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.91it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.19it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.97it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.21it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.94it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.39it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.87it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.22it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 61.23it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.77it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.55it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.30it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.22it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.36it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.13it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.44it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.61it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.38it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.005, valid loss : 0.004, train acc : 0.663, valid acc : 0.940, train f1 : 0.431, valid f1 : 0.607

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 344.18it/s][A
 37%|███▋      | 72/195 [00:00<00:00, 353.90it/s][A
 56%|█████▌    | 109/195 [00:00<00:00, 353.85it/s][A
 75%|███████▍  | 146/195 [00:00<00:00, 356.51it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 357.78it/s][A100%|██████████| 195/195 [00:00<00:00, 355.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.607
training process:   1%|          | 1/128 [02:02<4:18:31, 122.14s/it]Best score increase :0.607 -> 0.681
training process:   2%|▏         | 2/128 [03:31<3:36:17, 103.00s/it]Best score increase :0.681 -> 0.682
training process:   2%|▏         | 3/128 [04:59<3:20:10, 96.08s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:28<3:12:32, 93.16s/it]epoch : 5, train loss : 0.003, valid loss : 0.002, train acc : 0.950, valid acc : 0.962, train f1 : 0.672, valid f1 : 0.696

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|▉         | 19/195 [00:00<00:00, 187.85it/s][A
 25%|██▌       | 49/195 [00:00<00:00, 252.52it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 287.19it/s][A
 59%|█████▉    | 116/195 [00:00<00:00, 304.49it/s][A
 77%|███████▋  | 150/195 [00:00<00:00, 314.05it/s][A
 94%|█████████▍| 183/195 [00:00<00:00, 316.56it/s][A100%|██████████| 195/195 [00:00<00:00, 301.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.682 -> 0.696
training process:   4%|▍         | 5/128 [08:23<3:27:07, 101.03s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [09:54<3:18:50, 97.79s/it] Best score increase :0.696 -> 0.779
training process:   5%|▌         | 7/128 [11:25<3:12:33, 95.48s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:53<3:06:28, 93.23s/it]epoch : 9, train loss : 0.002, valid loss : 0.004, train acc : 0.963, valid acc : 0.976, train f1 : 0.716, valid f1 : 0.754

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 320.92it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.46it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.98it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 332.73it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 334.65it/s][A100%|██████████| 195/195 [00:00<00:00, 333.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:49<3:18:44, 100.20s/it]EarlyStopping counter : 3 out of 40
training process:   8%|▊         | 10/128 [16:17<3:09:29, 96.35s/it]Best score increase :0.779 -> 0.834
training process:   9%|▊         | 11/128 [17:46<3:03:34, 94.14s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [19:17<3:00:15, 93.23s/it]epoch : 13, train loss : 0.002, valid loss : 0.005, train acc : 0.973, valid acc : 0.988, train f1 : 0.758, valid f1 : 0.838

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 312.98it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.45it/s][A
 51%|█████     | 99/195 [00:00<00:00, 326.66it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.17it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 333.51it/s][A100%|██████████| 195/195 [00:00<00:00, 329.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.834 -> 0.838
training process:  10%|█         | 13/128 [21:13<3:11:47, 100.07s/it]Best score increase :0.838 -> 0.853
training process:  11%|█         | 14/128 [22:42<3:04:11, 96.95s/it] EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [24:09<2:56:34, 93.76s/it]Best score increase :0.853 -> 0.879
training process:  12%|█▎        | 16/128 [25:39<2:52:47, 92.57s/it]epoch : 17, train loss : 0.002, valid loss : 0.003, train acc : 0.988, valid acc : 0.991, train f1 : 0.856, valid f1 : 0.872

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.54it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.12it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.01it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.97it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 334.48it/s][A100%|██████████| 195/195 [00:00<00:00, 333.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [27:32<3:03:05, 98.96s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [29:00<2:55:23, 95.67s/it]EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [30:30<2:50:15, 93.72s/it]EarlyStopping counter : 4 out of 40
training process:  16%|█▌        | 20/128 [31:57<2:45:01, 91.68s/it]epoch : 21, train loss : 0.002, valid loss : 0.005, train acc : 0.988, valid acc : 0.992, train f1 : 0.860, valid f1 : 0.882

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.26it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.67it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.16it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.09it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 334.62it/s][A100%|██████████| 195/195 [00:00<00:00, 331.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.879 -> 0.882
training process:  16%|█▋        | 21/128 [33:51<2:55:27, 98.39s/it]Best score increase :0.882 -> 0.890
training process:  17%|█▋        | 22/128 [35:21<2:49:19, 95.85s/it]EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [36:48<2:43:28, 93.42s/it]EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [38:20<2:40:51, 92.81s/it]epoch : 25, train loss : 0.002, valid loss : 0.006, train acc : 0.990, valid acc : 0.992, train f1 : 0.876, valid f1 : 0.887

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.08it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.22it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.48it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.69it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 332.57it/s][A100%|██████████| 195/195 [00:00<00:00, 332.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [40:14<2:50:15, 99.18s/it]Best score increase :0.890 -> 0.893
training process:  20%|██        | 26/128 [41:45<2:44:36, 96.83s/it]EarlyStopping counter : 1 out of 40
training process:  21%|██        | 27/128 [43:13<2:38:37, 94.23s/it]EarlyStopping counter : 2 out of 40
training process:  22%|██▏       | 28/128 [44:43<2:34:42, 92.83s/it]epoch : 29, train loss : 0.001, valid loss : 0.003, train acc : 0.990, valid acc : 0.992, train f1 : 0.880, valid f1 : 0.885

  0%|          | 0/195 [00:00<?, ?it/s][A
 13%|█▎        | 26/195 [00:00<00:00, 254.72it/s][A
 28%|██▊       | 55/195 [00:00<00:00, 272.23it/s][A
 43%|████▎     | 84/195 [00:00<00:00, 278.00it/s][A
 58%|█████▊    | 113/195 [00:00<00:00, 280.69it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 282.21it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 281.50it/s][A100%|██████████| 195/195 [00:00<00:00, 279.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 29/128 [46:39<2:44:46, 99.86s/it]EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 30/128 [48:13<2:40:16, 98.13s/it]EarlyStopping counter : 5 out of 40
training process:  24%|██▍       | 31/128 [49:47<2:36:41, 96.92s/it]EarlyStopping counter : 6 out of 40
training process:  25%|██▌       | 32/128 [51:21<2:33:26, 95.90s/it]epoch : 33, train loss : 0.001, valid loss : 0.006, train acc : 0.991, valid acc : 0.993, train f1 : 0.895, valid f1 : 0.892

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.90it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.04it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 348.35it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 350.40it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 349.94it/s][A100%|██████████| 195/195 [00:00<00:00, 348.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  26%|██▌       | 33/128 [53:22<2:43:44, 103.42s/it]EarlyStopping counter : 8 out of 40
training process:  27%|██▋       | 34/128 [54:51<2:35:31, 99.28s/it] EarlyStopping counter : 9 out of 40
training process:  27%|██▋       | 35/128 [56:20<2:28:50, 96.03s/it]EarlyStopping counter : 10 out of 40
training process:  28%|██▊       | 36/128 [57:48<2:23:41, 93.71s/it]epoch : 37, train loss : 0.001, valid loss : 0.004, train acc : 0.992, valid acc : 0.992, train f1 : 0.902, valid f1 : 0.890

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.63it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 333.26it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 337.63it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.96it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.25it/s][A100%|██████████| 195/195 [00:00<00:00, 339.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  29%|██▉       | 37/128 [59:40<2:30:30, 99.24s/it]Best score increase :0.893 -> 0.895
training process:  30%|██▉       | 38/128 [1:01:09<2:24:03, 96.04s/it]Best score increase :0.895 -> 0.897
training process:  30%|███       | 39/128 [1:02:40<2:20:23, 94.65s/it]EarlyStopping counter : 1 out of 40
training process:  31%|███▏      | 40/128 [1:04:10<2:16:39, 93.18s/it]epoch : 41, train loss : 0.001, valid loss : 0.005, train acc : 0.992, valid acc : 0.993, train f1 : 0.904, valid f1 : 0.894

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 278.06it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 281.15it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 282.41it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 282.94it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 280.42it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 281.73it/s][A100%|██████████| 195/195 [00:00<00:00, 277.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  32%|███▏      | 41/128 [1:06:06<2:24:57, 99.97s/it]EarlyStopping counter : 3 out of 40
training process:  33%|███▎      | 42/128 [1:07:35<2:18:43, 96.78s/it]EarlyStopping counter : 4 out of 40
training process:  34%|███▎      | 43/128 [1:09:07<2:15:08, 95.39s/it]EarlyStopping counter : 5 out of 40
training process:  34%|███▍      | 44/128 [1:10:36<2:10:48, 93.43s/it]epoch : 45, train loss : 0.001, valid loss : 0.005, train acc : 0.993, valid acc : 0.993, train f1 : 0.911, valid f1 : 0.898

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 344.92it/s][A
 36%|███▋      | 71/195 [00:00<00:00, 348.49it/s][A
 55%|█████▍    | 107/195 [00:00<00:00, 350.00it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 350.71it/s][A
 92%|█████████▏| 179/195 [00:00<00:00, 351.08it/s][A100%|██████████| 195/195 [00:00<00:00, 350.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  35%|███▌      | 45/128 [1:12:31<2:17:58, 99.74s/it]EarlyStopping counter : 7 out of 40
training process:  36%|███▌      | 46/128 [1:13:59<2:11:40, 96.35s/it]EarlyStopping counter : 8 out of 40
training process:  37%|███▋      | 47/128 [1:15:31<2:08:12, 94.96s/it]EarlyStopping counter : 9 out of 40
training process:  38%|███▊      | 48/128 [1:16:59<2:04:06, 93.08s/it]epoch : 49, train loss : 0.001, valid loss : 0.005, train acc : 0.993, valid acc : 0.992, train f1 : 0.913, valid f1 : 0.891

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.69it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 334.89it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 336.60it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 337.30it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 337.56it/s][A100%|██████████| 195/195 [00:00<00:00, 335.86it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  38%|███▊      | 49/128 [1:18:55<2:11:17, 99.72s/it]EarlyStopping counter : 11 out of 40
training process:  39%|███▉      | 50/128 [1:20:26<2:06:24, 97.24s/it]EarlyStopping counter : 12 out of 40
training process:  40%|███▉      | 51/128 [1:21:57<2:02:12, 95.23s/it]EarlyStopping counter : 13 out of 40
training process:  41%|████      | 52/128 [1:23:26<1:58:34, 93.61s/it]epoch : 53, train loss : 0.001, valid loss : 0.005, train acc : 0.994, valid acc : 0.993, train f1 : 0.925, valid f1 : 0.897

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.86it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.10it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.68it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.47it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 341.44it/s][A100%|██████████| 195/195 [00:00<00:00, 340.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  41%|████▏     | 53/128 [1:25:22<2:05:24, 100.33s/it]Best score increase :0.897 -> 0.899
training process:  42%|████▏     | 54/128 [1:26:52<1:59:44, 97.09s/it] EarlyStopping counter : 1 out of 40
training process:  43%|████▎     | 55/128 [1:28:25<1:56:36, 95.84s/it]Best score increase :0.899 -> 0.903
training process:  44%|████▍     | 56/128 [1:29:53<1:52:14, 93.54s/it]epoch : 57, train loss : 0.001, valid loss : 0.007, train acc : 0.995, valid acc : 0.993, train f1 : 0.932, valid f1 : 0.893

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.82it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.73it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 341.59it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 339.15it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.92it/s][A100%|██████████| 195/195 [00:00<00:00, 340.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  45%|████▍     | 57/128 [1:31:45<1:57:10, 99.02s/it]EarlyStopping counter : 2 out of 40
training process:  45%|████▌     | 58/128 [1:33:15<1:52:21, 96.30s/it]EarlyStopping counter : 3 out of 40
training process:  46%|████▌     | 59/128 [1:34:43<1:47:46, 93.72s/it]EarlyStopping counter : 4 out of 40
training process:  47%|████▋     | 60/128 [1:36:12<1:44:48, 92.48s/it]epoch : 61, train loss : 0.001, valid loss : 0.009, train acc : 0.996, valid acc : 0.993, train f1 : 0.942, valid f1 : 0.895

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 271.56it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 277.55it/s][A
 44%|████▍     | 86/195 [00:00<00:00, 279.60it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 280.55it/s][A
 74%|███████▍  | 144/195 [00:00<00:00, 280.94it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 281.16it/s][A100%|██████████| 195/195 [00:00<00:00, 280.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  48%|████▊     | 61/128 [1:38:08<1:51:06, 99.49s/it]EarlyStopping counter : 6 out of 40
training process:  48%|████▊     | 62/128 [1:39:39<1:46:28, 96.80s/it]EarlyStopping counter : 7 out of 40
training process:  49%|████▉     | 63/128 [1:41:11<1:43:20, 95.40s/it]EarlyStopping counter : 8 out of 40
training process:  50%|█████     | 64/128 [1:42:42<1:40:20, 94.07s/it]epoch : 65, train loss : 0.001, valid loss : 0.007, train acc : 0.996, valid acc : 0.992, train f1 : 0.946, valid f1 : 0.885

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 343.34it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 346.81it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 344.61it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 346.35it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 347.54it/s][A100%|██████████| 195/195 [00:00<00:00, 346.89it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  51%|█████     | 65/128 [1:44:35<1:44:59, 100.00s/it]EarlyStopping counter : 10 out of 40
training process:  52%|█████▏    | 66/128 [1:46:06<1:40:25, 97.18s/it] EarlyStopping counter : 11 out of 40
training process:  52%|█████▏    | 67/128 [1:47:38<1:37:15, 95.66s/it]EarlyStopping counter : 12 out of 40
training process:  53%|█████▎    | 68/128 [1:49:07<1:33:44, 93.75s/it]epoch : 69, train loss : 0.001, valid loss : 0.010, train acc : 0.996, valid acc : 0.992, train f1 : 0.947, valid f1 : 0.887

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 340.35it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 343.83it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 345.33it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 346.06it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 346.55it/s][A100%|██████████| 195/195 [00:00<00:00, 345.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  54%|█████▍    | 69/128 [1:51:06<1:39:36, 101.30s/it]EarlyStopping counter : 14 out of 40
training process:  55%|█████▍    | 70/128 [1:52:37<1:34:41, 97.96s/it] EarlyStopping counter : 15 out of 40
training process:  55%|█████▌    | 71/128 [1:54:08<1:31:07, 95.92s/it]EarlyStopping counter : 16 out of 40
training process:  56%|█████▋    | 72/128 [1:55:35<1:27:14, 93.48s/it]epoch : 73, train loss : 0.001, valid loss : 0.009, train acc : 0.997, valid acc : 0.991, train f1 : 0.955, valid f1 : 0.868

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.31it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.54it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 261.98it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 274.15it/s][A
 84%|████████▎ | 163/195 [00:00<00:00, 228.95it/s][A
 97%|█████████▋| 189/195 [00:00<00:00, 237.30it/s][A100%|██████████| 195/195 [00:00<00:00, 254.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  57%|█████▋    | 73/128 [1:57:32<1:32:08, 100.52s/it]EarlyStopping counter : 18 out of 40
training process:  58%|█████▊    | 74/128 [1:59:01<1:27:12, 96.91s/it] EarlyStopping counter : 19 out of 40
training process:  59%|█████▊    | 75/128 [2:00:31<1:23:53, 94.97s/it]EarlyStopping counter : 20 out of 40
training process:  59%|█████▉    | 76/128 [2:01:58<1:20:06, 92.44s/it]epoch : 77, train loss : 0.001, valid loss : 0.008, train acc : 0.997, valid acc : 0.991, train f1 : 0.958, valid f1 : 0.872

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 273.30it/s][A
 29%|██▊       | 56/195 [00:00<00:00, 276.73it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 279.64it/s][A
 58%|█████▊    | 114/195 [00:00<00:00, 281.41it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 282.46it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 283.17it/s][A100%|██████████| 195/195 [00:00<00:00, 281.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  60%|██████    | 77/128 [2:03:53<1:24:23, 99.29s/it]EarlyStopping counter : 22 out of 40
training process:  61%|██████    | 78/128 [2:05:22<1:20:11, 96.22s/it]EarlyStopping counter : 23 out of 40
training process:  62%|██████▏   | 79/128 [2:06:52<1:16:57, 94.23s/it]EarlyStopping counter : 24 out of 40
training process:  62%|██████▎   | 80/128 [2:08:20<1:13:56, 92.42s/it]epoch : 81, train loss : 0.001, valid loss : 0.011, train acc : 0.997, valid acc : 0.993, train f1 : 0.964, valid f1 : 0.897

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 345.26it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 344.26it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 347.53it/s][A
 73%|███████▎  | 142/195 [00:00<00:00, 349.00it/s][A
 91%|█████████▏| 178/195 [00:00<00:00, 349.76it/s][A100%|██████████| 195/195 [00:00<00:00, 348.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 25 out of 40
training process:  63%|██████▎   | 81/128 [2:10:16<1:17:53, 99.44s/it]EarlyStopping counter : 26 out of 40
training process:  64%|██████▍   | 82/128 [2:11:46<1:14:00, 96.54s/it]EarlyStopping counter : 27 out of 40
training process:  65%|██████▍   | 83/128 [2:13:17<1:11:09, 94.87s/it]EarlyStopping counter : 28 out of 40
training process:  66%|██████▌   | 84/128 [2:14:46<1:08:16, 93.10s/it]epoch : 85, train loss : 0.001, valid loss : 0.013, train acc : 0.998, valid acc : 0.993, train f1 : 0.967, valid f1 : 0.893

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 341.54it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 345.97it/s][A
 54%|█████▍    | 106/195 [00:00<00:00, 347.85it/s][A
 72%|███████▏  | 141/195 [00:00<00:00, 347.99it/s][A
 91%|█████████ | 177/195 [00:00<00:00, 348.93it/s][A100%|██████████| 195/195 [00:00<00:00, 348.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 29 out of 40
training process:  66%|██████▋   | 85/128 [2:16:40<1:11:21, 99.58s/it]EarlyStopping counter : 30 out of 40
training process:  67%|██████▋   | 86/128 [2:18:13<1:08:11, 97.42s/it]EarlyStopping counter : 31 out of 40
training process:  68%|██████▊   | 87/128 [2:19:45<1:05:35, 95.98s/it]EarlyStopping counter : 32 out of 40
training process:  69%|██████▉   | 88/128 [2:21:14<1:02:31, 93.78s/it]epoch : 89, train loss : 0.001, valid loss : 0.014, train acc : 0.998, valid acc : 0.994, train f1 : 0.969, valid f1 : 0.901

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.51it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.24it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.54it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.16it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 336.59it/s][A100%|██████████| 195/195 [00:00<00:00, 335.95it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 33 out of 40
training process:  70%|██████▉   | 89/128 [2:23:08<1:04:54, 99.87s/it]EarlyStopping counter : 34 out of 40
training process:  70%|███████   | 90/128 [2:24:38<1:01:25, 96.99s/it]EarlyStopping counter : 35 out of 40
training process:  71%|███████   | 91/128 [2:26:07<58:12, 94.39s/it]  EarlyStopping counter : 36 out of 40
training process:  72%|███████▏  | 92/128 [2:27:36<55:44, 92.90s/it]epoch : 93, train loss : 0.001, valid loss : 0.014, train acc : 0.998, valid acc : 0.994, train f1 : 0.974, valid f1 : 0.900

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.77it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 324.35it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.16it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.41it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.68it/s][A100%|██████████| 195/195 [00:00<00:00, 330.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 37 out of 40
training process:  73%|███████▎  | 93/128 [2:29:30<57:48, 99.10s/it]EarlyStopping counter : 38 out of 40
training process:  73%|███████▎  | 94/128 [2:30:57<54:10, 95.60s/it]EarlyStopping counter : 39 out of 40
training process:  74%|███████▍  | 95/128 [2:32:26<51:32, 93.71s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 95, best f1 score : 0.904
training process:  74%|███████▍  | 95/128 [2:33:56<53:28, 97.22s/it]
training process finished, best loss : 0.009 and best acc : 0.994, best f1 : 0.904, best epoch : 79

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.74      0.78      0.76       304
           1       1.00      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.87      0.89      0.88     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.88, test AUC : 0.89, test loss : 2.605

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:00, 11.27s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:53, 11.55s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:41, 11.54s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:30, 11.61s/it]processing for feature importance:  29%|██▉       | 5/17 [00:58<02:20, 11.71s/it]processing for feature importance:  35%|███▌      | 6/17 [01:09<02:06, 11.47s/it]processing for feature importance:  41%|████      | 7/17 [01:21<01:57, 11.75s/it]processing for feature importance:  47%|████▋     | 8/17 [01:33<01:46, 11.86s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:44<01:33, 11.68s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:55<01:20, 11.43s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:07<01:09, 11.67s/it]processing for feature importance:  71%|███████   | 12/17 [02:18<00:57, 11.45s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:30<00:46, 11.54s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:42<00:35, 11.76s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:54<00:23, 11.83s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:06<00:11, 11.73s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.77s/it]processing for feature importance: 100%|██████████| 17/17 [03:18<00:00, 11.66s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:04<14:06,  4.01s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<09:35,  2.74s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<03:03,  2.75s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:53,  1.72s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:52,  3.38s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<05:14,  1.50s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:09,  2.61s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:12,  1.98s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:34,  1.43s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 309.09it/s] 34%|███▍      | 66/195 [00:00<00:00, 327.72it/s] 52%|█████▏    | 101/195 [00:00<00:00, 333.57it/s] 70%|██████▉   | 136/195 [00:00<00:00, 336.31it/s] 88%|████████▊ | 171/195 [00:00<00:00, 337.93it/s]100%|██████████| 195/195 [00:00<00:00, 335.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_smoothing_Normal_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 202.76it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 200.55it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 195.30it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 198.89it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 201.73it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 205.38it/s]remove invalid data : null / measurement error:  24%|██▍       | 148/616 [00:00<00:02, 206.28it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 209.15it/s]remove invalid data : null / measurement error:  31%|███       | 191/616 [00:00<00:02, 207.32it/s]remove invalid data : null / measurement error:  34%|███▍      | 212/616 [00:01<00:01, 206.82it/s]remove invalid data : null / measurement error:  38%|███▊      | 233/616 [00:01<00:01, 205.26it/s]remove invalid data : null / measurement error:  41%|████      | 254/616 [00:01<00:01, 205.22it/s]remove invalid data : null / measurement error:  45%|████▍     | 275/616 [00:01<00:01, 206.39it/s]remove invalid data : null / measurement error:  48%|████▊     | 296/616 [00:01<00:01, 205.54it/s]remove invalid data : null / measurement error:  51%|█████▏    | 317/616 [00:01<00:01, 203.90it/s]remove invalid data : null / measurement error:  55%|█████▍    | 338/616 [00:01<00:01, 202.52it/s]remove invalid data : null / measurement error:  58%|█████▊    | 359/616 [00:01<00:01, 202.55it/s]remove invalid data : null / measurement error:  62%|██████▎   | 385/616 [00:01<00:01, 218.73it/s]remove invalid data : null / measurement error:  67%|██████▋   | 412/616 [00:01<00:00, 232.60it/s]remove invalid data : null / measurement error:  71%|███████   | 436/616 [00:02<00:00, 229.68it/s]remove invalid data : null / measurement error:  75%|███████▍  | 461/616 [00:02<00:00, 233.70it/s]remove invalid data : null / measurement error:  79%|███████▊  | 485/616 [00:02<00:00, 223.83it/s]remove invalid data : null / measurement error:  82%|████████▏ | 508/616 [00:02<00:00, 218.68it/s]remove invalid data : null / measurement error:  86%|████████▌ | 530/616 [00:02<00:00, 214.81it/s]remove invalid data : null / measurement error:  90%|████████▉ | 552/616 [00:02<00:00, 211.09it/s]remove invalid data : null / measurement error:  93%|█████████▎| 574/616 [00:02<00:00, 208.98it/s]remove invalid data : null / measurement error:  97%|█████████▋| 595/616 [00:02<00:00, 207.68it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 205.80it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 210.04it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 231.89it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 234.84it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 235.90it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 236.85it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 236.40it/s]replace nan value:  28%|██▊       | 145/515 [00:00<00:01, 238.93it/s]replace nan value:  33%|███▎      | 169/515 [00:00<00:01, 238.77it/s]replace nan value:  37%|███▋      | 193/515 [00:00<00:01, 235.39it/s]replace nan value:  42%|████▏     | 217/515 [00:00<00:01, 236.52it/s]replace nan value:  47%|████▋     | 242/515 [00:01<00:01, 237.91it/s]replace nan value:  52%|█████▏    | 266/515 [00:01<00:01, 237.39it/s]replace nan value:  56%|█████▋    | 290/515 [00:01<00:00, 236.10it/s]replace nan value:  61%|██████    | 315/515 [00:01<00:00, 238.79it/s]replace nan value:  66%|██████▌   | 339/515 [00:01<00:00, 238.40it/s]replace nan value:  70%|███████   | 363/515 [00:01<00:00, 235.92it/s]replace nan value:  75%|███████▌  | 388/515 [00:01<00:00, 237.44it/s]replace nan value:  80%|████████  | 412/515 [00:01<00:00, 236.61it/s]replace nan value:  85%|████████▍ | 436/515 [00:01<00:00, 236.27it/s]replace nan value:  90%|████████▉ | 461/515 [00:01<00:00, 238.05it/s]replace nan value:  94%|█████████▍| 486/515 [00:02<00:00, 240.00it/s]replace nan value:  99%|█████████▉| 511/515 [00:02<00:00, 241.35it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 237.74it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.25it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.63it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.52it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 71.21it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.41it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.78it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.17it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.62it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.47it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.50it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.30it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.94it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.28it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.71it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.46it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.44it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.77it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 71.41it/s]generate index:  30%|██▉       | 152/515 [00:02<00:06, 58.56it/s]generate index:  31%|███       | 159/515 [00:02<00:06, 58.87it/s]generate index:  32%|███▏      | 167/515 [00:02<00:05, 63.05it/s]generate index:  34%|███▍      | 174/515 [00:02<00:05, 62.05it/s]generate index:  36%|███▌      | 183/515 [00:02<00:04, 69.27it/s]generate index:  37%|███▋      | 191/515 [00:03<00:04, 66.91it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 66.89it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 66.22it/s]generate index:  43%|████▎     | 220/515 [00:03<00:03, 87.56it/s]generate index:  44%|████▍     | 229/515 [00:03<00:03, 84.47it/s]generate index:  46%|████▌     | 238/515 [00:03<00:03, 81.41it/s]generate index:  48%|████▊     | 247/515 [00:03<00:03, 83.72it/s]generate index:  50%|████▉     | 256/515 [00:03<00:03, 69.06it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 75.35it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 78.43it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 65.24it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 67.73it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 62.97it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 63.76it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 61.59it/s]generate index:  63%|██████▎   | 323/515 [00:04<00:02, 65.01it/s]generate index:  64%|██████▍   | 331/515 [00:05<00:02, 65.08it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 53.20it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 48.10it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 43.01it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 59.23it/s]generate index:  73%|███████▎  | 374/515 [00:05<00:01, 72.24it/s]generate index:  74%|███████▍  | 383/515 [00:05<00:01, 74.70it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 73.38it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 75.34it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 64.67it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 66.25it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 77.94it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 55.42it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 51.42it/s]generate index:  89%|████████▊ | 456/515 [00:07<00:00, 62.28it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 65.68it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.45it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.66it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.32it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.93it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.83it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.49it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 59.75it/s]remove invalid data : null / measurement error:  18%|█▊        | 27/154 [00:00<00:00, 147.03it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 175.18it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 190.31it/s]remove invalid data : null / measurement error:  59%|█████▉    | 91/154 [00:00<00:00, 196.65it/s]remove invalid data : null / measurement error:  75%|███████▌  | 116/154 [00:00<00:00, 211.95it/s]remove invalid data : null / measurement error:  90%|████████▉ | 138/154 [00:00<00:00, 209.81it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 193.96it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.71it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 254.69it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 257.08it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 254.79it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 257.26it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 255.91it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 71.35it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.40it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 56.97it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 59.27it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 65.40it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 66.07it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 62.51it/s]generate index:  48%|████▊     | 63/131 [00:00<00:01, 67.43it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 67.30it/s]generate index:  60%|█████▉    | 78/131 [00:01<00:00, 68.44it/s]generate index:  65%|██████▍   | 85/131 [00:01<00:00, 65.66it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 47.16it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 49.38it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 47.81it/s]generate index:  85%|████████▍ | 111/131 [00:01<00:00, 52.40it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 61.46it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 71.15it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 61.12it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/193 [00:00<00:03, 49.14it/s]remove invalid data : null / measurement error:  14%|█▍        | 27/193 [00:00<00:01, 146.05it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 176.16it/s]remove invalid data : null / measurement error:  37%|███▋      | 71/193 [00:00<00:00, 191.90it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 200.78it/s]remove invalid data : null / measurement error:  59%|█████▉    | 114/193 [00:00<00:00, 203.18it/s]remove invalid data : null / measurement error:  72%|███████▏  | 139/193 [00:00<00:00, 217.35it/s]remove invalid data : null / measurement error:  83%|████████▎ | 161/193 [00:00<00:00, 215.67it/s]remove invalid data : null / measurement error:  95%|█████████▍| 183/193 [00:00<00:00, 212.79it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 198.26it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 27/160 [00:00<00:00, 260.42it/s]replace nan value:  34%|███▍      | 54/160 [00:00<00:00, 262.03it/s]replace nan value:  51%|█████     | 81/160 [00:00<00:00, 260.80it/s]replace nan value:  68%|██████▊   | 108/160 [00:00<00:00, 257.13it/s]replace nan value:  84%|████████▍ | 134/160 [00:00<00:00, 257.41it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 257.75it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 258.39it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 106.81it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.93it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.15it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.88it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.94it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.17it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.76it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.56it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.39it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.05it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.58it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.96it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 60.06it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.40it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 57.02it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.85it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 60.14it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 64.50it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.49it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.034, valid loss : -0.044, train acc : 0.957, valid acc : 0.985, train f1 : 0.503, valid f1 : 0.590

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 36/195 [00:00<00:00, 353.68it/s][A
 37%|███▋      | 73/195 [00:00<00:00, 358.04it/s][A
 56%|█████▋    | 110/195 [00:00<00:00, 359.82it/s][A
 75%|███████▍  | 146/195 [00:00<00:00, 359.38it/s][A
 93%|█████████▎| 182/195 [00:00<00:00, 358.76it/s][A100%|██████████| 195/195 [00:00<00:00, 358.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.590
training process:   1%|          | 1/128 [02:01<4:17:08, 121.48s/it]Best score increase :0.590 -> 0.798
training process:   2%|▏         | 2/128 [03:31<3:36:35, 103.14s/it]Best score increase :0.798 -> 0.820
training process:   2%|▏         | 3/128 [04:58<3:18:55, 95.48s/it] Best score increase :0.820 -> 0.829
training process:   3%|▎         | 4/128 [06:26<3:11:40, 92.75s/it]epoch : 5, train loss : -0.046, valid loss : -0.047, train acc : 0.990, valid acc : 0.991, train f1 : 0.824, valid f1 : 0.836

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 322.86it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 334.80it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.38it/s][A
 71%|███████   | 138/195 [00:00<00:00, 340.11it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 336.89it/s][A100%|██████████| 195/195 [00:00<00:00, 337.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.829 -> 0.836
training process:   4%|▍         | 5/128 [08:23<3:27:49, 101.38s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [09:53<3:18:24, 97.58s/it] Best score increase :0.836 -> 0.855
training process:   5%|▌         | 7/128 [11:27<3:14:02, 96.22s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:58<3:09:21, 94.68s/it]epoch : 9, train loss : -0.047, valid loss : -0.047, train acc : 0.991, valid acc : 0.991, train f1 : 0.854, valid f1 : 0.851

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.48it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.50it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.42it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.95it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 331.71it/s][A100%|██████████| 195/195 [00:00<00:00, 330.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:53<3:20:15, 100.97s/it]Best score increase :0.855 -> 0.866
training process:   8%|▊         | 10/128 [16:24<3:12:58, 98.12s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [17:57<3:08:10, 96.50s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▉         | 12/128 [19:29<3:03:50, 95.09s/it]epoch : 13, train loss : -0.047, valid loss : -0.047, train acc : 0.992, valid acc : 0.992, train f1 : 0.865, valid f1 : 0.865

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.52it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.77it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.47it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.79it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 337.13it/s][A100%|██████████| 195/195 [00:00<00:00, 335.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  10%|█         | 13/128 [21:23<3:12:56, 100.67s/it]EarlyStopping counter : 4 out of 40
training process:  11%|█         | 14/128 [22:53<3:05:38, 97.70s/it] EarlyStopping counter : 5 out of 40
training process:  12%|█▏        | 15/128 [24:24<2:59:54, 95.53s/it]EarlyStopping counter : 6 out of 40
training process:  12%|█▎        | 16/128 [25:55<2:55:43, 94.14s/it]epoch : 17, train loss : -0.048, valid loss : -0.046, train acc : 0.992, valid acc : 0.992, train f1 : 0.873, valid f1 : 0.864

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.72it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 330.19it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.79it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.16it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 336.79it/s][A100%|██████████| 195/195 [00:00<00:00, 335.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  13%|█▎        | 17/128 [27:52<3:06:48, 100.97s/it]EarlyStopping counter : 8 out of 40
training process:  14%|█▍        | 18/128 [29:20<2:58:16, 97.24s/it] Best score increase :0.866 -> 0.879
training process:  15%|█▍        | 19/128 [30:50<2:52:27, 94.94s/it]EarlyStopping counter : 1 out of 40
training process:  16%|█▌        | 20/128 [32:23<2:49:38, 94.25s/it]epoch : 21, train loss : -0.048, valid loss : -0.047, train acc : 0.993, valid acc : 0.993, train f1 : 0.892, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.79it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.90it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.37it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.15it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 336.30it/s][A100%|██████████| 195/195 [00:00<00:00, 333.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  16%|█▋        | 21/128 [34:21<3:00:52, 101.42s/it]Best score increase :0.879 -> 0.883
training process:  17%|█▋        | 22/128 [35:51<2:53:14, 98.06s/it] EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [37:22<2:48:07, 96.07s/it]EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [38:55<2:44:31, 94.92s/it]epoch : 25, train loss : -0.048, valid loss : -0.047, train acc : 0.993, valid acc : 0.992, train f1 : 0.898, valid f1 : 0.873

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.55it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 333.81it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.61it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.22it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.64it/s][A100%|██████████| 195/195 [00:00<00:00, 336.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  20%|█▉        | 25/128 [40:50<2:53:32, 101.09s/it]EarlyStopping counter : 4 out of 40
training process:  20%|██        | 26/128 [42:21<2:46:42, 98.07s/it] EarlyStopping counter : 5 out of 40
training process:  21%|██        | 27/128 [43:51<2:41:02, 95.67s/it]EarlyStopping counter : 6 out of 40
training process:  22%|██▏       | 28/128 [45:20<2:35:50, 93.50s/it]epoch : 29, train loss : -0.048, valid loss : -0.047, train acc : 0.994, valid acc : 0.992, train f1 : 0.910, valid f1 : 0.882

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.63it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 337.71it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.74it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.54it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.03it/s][A100%|██████████| 195/195 [00:00<00:00, 339.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 29/128 [47:17<2:46:03, 100.65s/it]EarlyStopping counter : 8 out of 40
training process:  23%|██▎       | 30/128 [48:47<2:39:17, 97.53s/it] EarlyStopping counter : 9 out of 40
training process:  24%|██▍       | 31/128 [50:17<2:34:05, 95.32s/it]Best score increase :0.883 -> 0.896
training process:  25%|██▌       | 32/128 [51:50<2:31:17, 94.56s/it]epoch : 33, train loss : -0.049, valid loss : -0.046, train acc : 0.995, valid acc : 0.992, train f1 : 0.922, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.07it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.72it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.92it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.59it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.95it/s][A100%|██████████| 195/195 [00:00<00:00, 338.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  26%|██▌       | 33/128 [53:47<2:40:28, 101.35s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 34/128 [55:18<2:33:56, 98.26s/it] EarlyStopping counter : 3 out of 40
training process:  27%|██▋       | 35/128 [56:48<2:28:04, 95.53s/it]EarlyStopping counter : 4 out of 40
training process:  28%|██▊       | 36/128 [58:18<2:24:15, 94.08s/it]epoch : 37, train loss : -0.049, valid loss : -0.047, train acc : 0.995, valid acc : 0.992, train f1 : 0.919, valid f1 : 0.879

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.13it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.58it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.84it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.31it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.49it/s][A100%|██████████| 195/195 [00:00<00:00, 337.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  29%|██▉       | 37/128 [1:00:14<2:32:46, 100.73s/it]EarlyStopping counter : 6 out of 40
training process:  30%|██▉       | 38/128 [1:01:47<2:27:16, 98.18s/it] EarlyStopping counter : 7 out of 40
training process:  30%|███       | 39/128 [1:03:18<2:22:28, 96.05s/it]EarlyStopping counter : 8 out of 40
training process:  31%|███▏      | 40/128 [1:04:46<2:17:39, 93.86s/it]epoch : 41, train loss : -0.049, valid loss : -0.047, train acc : 0.996, valid acc : 0.993, train f1 : 0.932, valid f1 : 0.888

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.53it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.08it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.47it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.14it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 339.48it/s][A100%|██████████| 195/195 [00:00<00:00, 338.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  32%|███▏      | 41/128 [1:06:44<2:26:34, 101.09s/it]EarlyStopping counter : 10 out of 40
training process:  33%|███▎      | 42/128 [1:08:13<2:19:20, 97.21s/it] EarlyStopping counter : 11 out of 40
training process:  34%|███▎      | 43/128 [1:09:46<2:16:02, 96.03s/it]EarlyStopping counter : 12 out of 40
training process:  34%|███▍      | 44/128 [1:11:16<2:12:00, 94.29s/it]epoch : 45, train loss : -0.049, valid loss : -0.046, train acc : 0.996, valid acc : 0.993, train f1 : 0.941, valid f1 : 0.886

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.44it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 335.01it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.61it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.80it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.25it/s][A100%|██████████| 195/195 [00:00<00:00, 336.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  35%|███▌      | 45/128 [1:13:11<2:18:50, 100.37s/it]EarlyStopping counter : 14 out of 40
training process:  36%|███▌      | 46/128 [1:14:42<2:13:38, 97.78s/it] EarlyStopping counter : 15 out of 40
training process:  37%|███▋      | 47/128 [1:16:14<2:09:19, 95.80s/it]EarlyStopping counter : 16 out of 40
training process:  38%|███▊      | 48/128 [1:17:44<2:05:36, 94.20s/it]epoch : 49, train loss : -0.049, valid loss : -0.046, train acc : 0.996, valid acc : 0.992, train f1 : 0.946, valid f1 : 0.869

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.56it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 330.79it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 333.99it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.13it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 335.96it/s][A100%|██████████| 195/195 [00:00<00:00, 335.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  38%|███▊      | 49/128 [1:19:41<2:13:03, 101.05s/it]EarlyStopping counter : 18 out of 40
training process:  39%|███▉      | 50/128 [1:21:13<2:07:52, 98.36s/it] EarlyStopping counter : 19 out of 40
training process:  40%|███▉      | 51/128 [1:22:44<2:03:21, 96.13s/it]EarlyStopping counter : 20 out of 40
training process:  41%|████      | 52/128 [1:24:12<1:58:40, 93.69s/it]epoch : 53, train loss : -0.049, valid loss : -0.047, train acc : 0.997, valid acc : 0.993, train f1 : 0.954, valid f1 : 0.881

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.07it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.24it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.09it/s][A
 71%|███████   | 138/195 [00:00<00:00, 339.01it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 336.04it/s][A100%|██████████| 195/195 [00:00<00:00, 336.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  41%|████▏     | 53/128 [1:26:08<2:05:22, 100.30s/it]EarlyStopping counter : 22 out of 40
training process:  42%|████▏     | 54/128 [1:27:43<2:01:39, 98.64s/it] EarlyStopping counter : 23 out of 40
training process:  43%|████▎     | 55/128 [1:29:13<1:56:54, 96.09s/it]EarlyStopping counter : 24 out of 40
training process:  44%|████▍     | 56/128 [1:30:43<1:53:16, 94.40s/it]epoch : 57, train loss : -0.049, valid loss : -0.047, train acc : 0.997, valid acc : 0.993, train f1 : 0.954, valid f1 : 0.893

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 330.32it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.47it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 332.36it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.03it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 336.52it/s][A100%|██████████| 195/195 [00:00<00:00, 335.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 25 out of 40
training process:  45%|████▍     | 57/128 [1:32:40<1:59:38, 101.10s/it]EarlyStopping counter : 26 out of 40
training process:  45%|████▌     | 58/128 [1:34:11<1:54:18, 97.98s/it] EarlyStopping counter : 27 out of 40
training process:  46%|████▌     | 59/128 [1:35:40<1:49:47, 95.46s/it]EarlyStopping counter : 28 out of 40
training process:  47%|████▋     | 60/128 [1:37:13<1:47:13, 94.61s/it]epoch : 61, train loss : -0.049, valid loss : -0.046, train acc : 0.997, valid acc : 0.993, train f1 : 0.956, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 333.49it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 337.20it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 338.22it/s][A
 70%|███████   | 137/195 [00:00<00:00, 339.10it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.18it/s][A100%|██████████| 195/195 [00:00<00:00, 337.72it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 29 out of 40
training process:  48%|████▊     | 61/128 [1:39:06<1:51:47, 100.11s/it]EarlyStopping counter : 30 out of 40
training process:  48%|████▊     | 62/128 [1:40:36<1:47:00, 97.28s/it] EarlyStopping counter : 31 out of 40
training process:  49%|████▉     | 63/128 [1:42:08<1:43:34, 95.60s/it]EarlyStopping counter : 32 out of 40
training process:  50%|█████     | 64/128 [1:43:39<1:40:23, 94.12s/it]epoch : 65, train loss : -0.050, valid loss : -0.047, train acc : 0.997, valid acc : 0.993, train f1 : 0.963, valid f1 : 0.880

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.23it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.03it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.02it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.88it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.99it/s][A100%|██████████| 195/195 [00:00<00:00, 337.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 33 out of 40
training process:  51%|█████     | 65/128 [1:45:35<1:45:54, 100.87s/it]EarlyStopping counter : 34 out of 40
training process:  52%|█████▏    | 66/128 [1:47:07<1:41:14, 97.98s/it] EarlyStopping counter : 35 out of 40
training process:  52%|█████▏    | 67/128 [1:48:37<1:37:22, 95.78s/it]EarlyStopping counter : 36 out of 40
training process:  53%|█████▎    | 68/128 [1:50:10<1:34:49, 94.82s/it]epoch : 69, train loss : -0.050, valid loss : -0.047, train acc : 0.998, valid acc : 0.993, train f1 : 0.965, valid f1 : 0.884

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.29it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.81it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 336.88it/s][A
 71%|███████   | 138/195 [00:00<00:00, 338.85it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 340.01it/s][A100%|██████████| 195/195 [00:00<00:00, 339.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 37 out of 40
training process:  54%|█████▍    | 69/128 [1:52:05<1:39:14, 100.93s/it]EarlyStopping counter : 38 out of 40
training process:  55%|█████▍    | 70/128 [1:53:36<1:34:38, 97.90s/it] EarlyStopping counter : 39 out of 40
training process:  55%|█████▌    | 71/128 [1:55:09<1:31:44, 96.57s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 71, best f1 score : 0.896
training process:  55%|█████▌    | 71/128 [1:56:43<1:33:42, 98.64s/it]
training process finished, best loss : -0.047 and best acc : 0.993, best f1 : 0.896, best epoch : 31

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.82      0.74      0.78       304
           1       1.00      1.00      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.91      0.87      0.89     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.89, test AUC : 0.87, test loss : -12.063

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:13, 12.08s/it]processing for feature importance:  12%|█▏        | 2/17 [00:27<03:26, 13.76s/it]processing for feature importance:  18%|█▊        | 3/17 [00:39<03:03, 13.10s/it]processing for feature importance:  24%|██▎       | 4/17 [00:51<02:45, 12.70s/it]processing for feature importance:  29%|██▉       | 5/17 [01:03<02:28, 12.36s/it]processing for feature importance:  35%|███▌      | 6/17 [01:15<02:16, 12.39s/it]processing for feature importance:  41%|████      | 7/17 [01:28<02:04, 12.47s/it]processing for feature importance:  47%|████▋     | 8/17 [01:40<01:52, 12.47s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:52<01:37, 12.24s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:04<01:26, 12.30s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:18<01:17, 12.85s/it]processing for feature importance:  71%|███████   | 12/17 [02:31<01:03, 12.67s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:43<00:50, 12.66s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:56<00:37, 12.55s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:08<00:24, 12.35s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:20<00:12, 12.25s/it]processing for feature importance: 100%|██████████| 17/17 [03:32<00:00, 12.15s/it]processing for feature importance: 100%|██████████| 17/17 [03:32<00:00, 12.47s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:02<09:33,  2.72s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<04:39,  1.33s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<06:57,  1.99s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:10,  1.95s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:28,  1.35s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<12:20,  3.51s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:04<07:01,  2.01s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<03:09,  2.83s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<02:01,  1.84s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 15%|█▌        | 30/195 [00:00<00:00, 294.49it/s] 33%|███▎      | 64/195 [00:00<00:00, 316.73it/s] 50%|█████     | 98/195 [00:00<00:00, 325.54it/s] 68%|██████▊   | 132/195 [00:00<00:00, 330.38it/s] 85%|████████▌ | 166/195 [00:00<00:00, 333.39it/s]100%|██████████| 195/195 [00:00<00:00, 329.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_smoothing_RS_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 202.78it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 201.38it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 199.34it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 201.89it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.61it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.60it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 209.63it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 210.83it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 208.16it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 207.12it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 206.70it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 205.93it/s]remove invalid data : null / measurement error:  45%|████▍     | 277/616 [00:01<00:01, 206.96it/s]remove invalid data : null / measurement error:  48%|████▊     | 298/616 [00:01<00:01, 207.37it/s]remove invalid data : null / measurement error:  52%|█████▏    | 319/616 [00:01<00:01, 207.01it/s]remove invalid data : null / measurement error:  55%|█████▌    | 340/616 [00:01<00:01, 206.93it/s]remove invalid data : null / measurement error:  59%|█████▊    | 361/616 [00:01<00:01, 207.64it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:01<00:01, 222.54it/s]remove invalid data : null / measurement error:  67%|██████▋   | 415/616 [00:01<00:00, 238.36it/s]remove invalid data : null / measurement error:  71%|███████▏  | 439/616 [00:02<00:00, 234.00it/s]remove invalid data : null / measurement error:  75%|███████▌  | 463/616 [00:02<00:00, 234.77it/s]remove invalid data : null / measurement error:  79%|███████▉  | 487/616 [00:02<00:00, 226.59it/s]remove invalid data : null / measurement error:  83%|████████▎ | 510/616 [00:02<00:00, 220.33it/s]remove invalid data : null / measurement error:  87%|████████▋ | 533/616 [00:02<00:00, 215.10it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 210.86it/s]remove invalid data : null / measurement error:  94%|█████████▎| 577/616 [00:02<00:00, 208.64it/s]remove invalid data : null / measurement error:  97%|█████████▋| 598/616 [00:02<00:00, 207.05it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.87it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.53it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.13it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.01it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 238.27it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 239.50it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 240.92it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 242.66it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 244.08it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 245.32it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 246.47it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 247.04it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 245.00it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 244.27it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 241.26it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 241.79it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 242.46it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 242.02it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 240.80it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 242.60it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 244.40it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 242.68it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.75it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.18it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.89it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 71.22it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 70.76it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 53.33it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.32it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 46.85it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 53.32it/s]generate index:  15%|█▍        | 77/515 [00:01<00:08, 51.29it/s]generate index:  17%|█▋        | 87/515 [00:01<00:06, 61.56it/s]generate index:  18%|█▊        | 94/515 [00:01<00:06, 60.99it/s]generate index:  20%|█▉        | 101/515 [00:01<00:07, 56.90it/s]generate index:  21%|██▏       | 110/515 [00:01<00:06, 62.83it/s]generate index:  23%|██▎       | 118/515 [00:02<00:06, 61.21it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 68.14it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 68.63it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 69.75it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 69.09it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.54it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 71.24it/s]generate index:  34%|███▍      | 175/515 [00:02<00:04, 68.38it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.85it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 70.98it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.60it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.61it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 80.84it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 84.96it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 85.80it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 71.40it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 70.37it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 72.92it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 75.84it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.02it/s]generate index:  57%|█████▋    | 291/515 [00:04<00:03, 63.08it/s]generate index:  58%|█████▊    | 298/515 [00:04<00:03, 60.63it/s]generate index:  59%|█████▉    | 305/515 [00:04<00:03, 61.87it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 63.15it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 59.30it/s]generate index:  63%|██████▎   | 327/515 [00:05<00:02, 63.20it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 57.11it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 47.27it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 45.36it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.87it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 58.23it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.29it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 75.51it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 71.96it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 73.49it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.75it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.58it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.52it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 53.26it/s]generate index:  86%|████████▋ | 445/515 [00:07<00:01, 49.28it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 58.56it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.28it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.12it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 65.83it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 63.65it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 61.14it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 68.94it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.22it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 87.56it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 158.02it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 181.15it/s]remove invalid data : null / measurement error:  47%|████▋     | 73/154 [00:00<00:00, 194.34it/s]remove invalid data : null / measurement error:  62%|██████▏   | 95/154 [00:00<00:00, 202.74it/s]remove invalid data : null / measurement error:  77%|███████▋  | 119/154 [00:00<00:00, 213.59it/s]remove invalid data : null / measurement error:  92%|█████████▏| 141/154 [00:00<00:00, 211.00it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 197.52it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.39it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.37it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 250.77it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 248.31it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 250.21it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 249.62it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 65.69it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 47.78it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 53.20it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 59.29it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 61.48it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 59.78it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.05it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 62.21it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.16it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.01it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 62.61it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.26it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.11it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 45.67it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 47.11it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 54.78it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 63.40it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.33it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 98.29it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:01, 161.72it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 186.42it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 197.78it/s]remove invalid data : null / measurement error:  50%|█████     | 97/193 [00:00<00:00, 202.63it/s]remove invalid data : null / measurement error:  62%|██████▏   | 119/193 [00:00<00:00, 208.31it/s]remove invalid data : null / measurement error:  74%|███████▍  | 143/193 [00:00<00:00, 218.42it/s]remove invalid data : null / measurement error:  85%|████████▌ | 165/193 [00:00<00:00, 211.74it/s]remove invalid data : null / measurement error:  97%|█████████▋| 187/193 [00:00<00:00, 208.81it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 200.73it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 251.08it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 249.80it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 252.00it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 250.66it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 252.02it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 252.98it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 251.95it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 107.81it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.84it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.84it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.43it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.04it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.92it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.94it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.97it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.13it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.02it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.69it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.91it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.86it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.97it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.37it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.12it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.21it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.51it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.08it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.005, valid loss : -0.027, train acc : 0.826, valid acc : 0.929, train f1 : 0.826, valid f1 : 0.623

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 335.24it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 338.50it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 338.01it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.51it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.98it/s][A100%|██████████| 195/195 [00:00<00:00, 339.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.623
training process:   1%|          | 1/128 [02:00<4:15:28, 120.70s/it]Best score increase :0.623 -> 0.645
training process:   2%|▏         | 2/128 [03:33<3:39:19, 104.44s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [05:07<3:27:43, 99.71s/it] Best score increase :0.645 -> 0.669
training process:   3%|▎         | 4/128 [06:41<3:20:52, 97.20s/it]epoch : 5, train loss : -0.041, valid loss : -0.027, train acc : 0.972, valid acc : 0.937, train f1 : 0.972, valid f1 : 0.647

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|█         | 20/195 [00:00<00:00, 197.73it/s][A
 26%|██▌       | 50/195 [00:00<00:00, 255.74it/s][A
 43%|████▎     | 83/195 [00:00<00:00, 287.70it/s][A
 59%|█████▉    | 116/195 [00:00<00:00, 303.17it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 312.33it/s][A
 93%|█████████▎| 182/195 [00:00<00:00, 316.87it/s][A100%|██████████| 195/195 [00:00<00:00, 301.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   4%|▍         | 5/128 [08:40<3:35:22, 105.06s/it]EarlyStopping counter : 2 out of 40
training process:   5%|▍         | 6/128 [10:12<3:24:57, 100.80s/it]EarlyStopping counter : 3 out of 40
training process:   5%|▌         | 7/128 [11:46<3:18:34, 98.47s/it] Best score increase :0.669 -> 0.766
training process:   6%|▋         | 8/128 [13:19<3:13:23, 96.70s/it]epoch : 9, train loss : -0.045, valid loss : -0.027, train acc : 0.986, valid acc : 0.937, train f1 : 0.986, valid f1 : 0.645

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 309.46it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 322.58it/s][A
 51%|█████     | 99/195 [00:00<00:00, 327.39it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 330.53it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 332.11it/s][A100%|██████████| 195/195 [00:00<00:00, 328.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [15:18<3:25:46, 103.75s/it]EarlyStopping counter : 2 out of 40
training process:   8%|▊         | 10/128 [16:51<3:17:42, 100.53s/it]Best score increase :0.766 -> 0.771
training process:   9%|▊         | 11/128 [18:26<3:12:43, 98.83s/it] Best score increase :0.771 -> 0.790
training process:   9%|▉         | 12/128 [20:00<3:08:01, 97.26s/it]epoch : 13, train loss : -0.046, valid loss : -0.043, train acc : 0.990, valid acc : 0.982, train f1 : 0.990, valid f1 : 0.798

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.69it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.32it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.98it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 336.58it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 338.19it/s][A100%|██████████| 195/195 [00:00<00:00, 336.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.790 -> 0.798
training process:  10%|█         | 13/128 [22:01<3:19:57, 104.33s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [23:34<3:12:05, 101.10s/it]EarlyStopping counter : 2 out of 40
training process:  12%|█▏        | 15/128 [25:08<3:06:04, 98.80s/it] Best score increase :0.798 -> 0.812
training process:  12%|█▎        | 16/128 [26:42<3:02:07, 97.57s/it]epoch : 17, train loss : -0.047, valid loss : -0.041, train acc : 0.991, valid acc : 0.975, train f1 : 0.991, valid f1 : 0.758

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.29it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 329.25it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.37it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 333.89it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.66it/s][A100%|██████████| 195/195 [00:00<00:00, 334.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:43<3:13:08, 104.40s/it]Best score increase :0.812 -> 0.844
training process:  14%|█▍        | 18/128 [30:16<3:05:02, 100.93s/it]EarlyStopping counter : 1 out of 40
training process:  15%|█▍        | 19/128 [31:48<2:58:54, 98.48s/it] EarlyStopping counter : 2 out of 40
training process:  16%|█▌        | 20/128 [33:21<2:54:20, 96.85s/it]epoch : 21, train loss : -0.048, valid loss : -0.044, train acc : 0.994, valid acc : 0.988, train f1 : 0.994, valid f1 : 0.847

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 308.19it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 323.06it/s][A
 51%|█████     | 99/195 [00:00<00:00, 329.24it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 332.46it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 334.58it/s][A100%|██████████| 195/195 [00:00<00:00, 331.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.844 -> 0.847
training process:  16%|█▋        | 21/128 [35:23<3:06:02, 104.33s/it]EarlyStopping counter : 1 out of 40
training process:  17%|█▋        | 22/128 [36:55<2:57:47, 100.64s/it]EarlyStopping counter : 2 out of 40
training process:  18%|█▊        | 23/128 [38:29<2:52:25, 98.53s/it] Best score increase :0.847 -> 0.863
training process:  19%|█▉        | 24/128 [40:03<2:48:21, 97.13s/it]epoch : 25, train loss : -0.048, valid loss : -0.045, train acc : 0.993, valid acc : 0.990, train f1 : 0.993, valid f1 : 0.866

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.11it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.74it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 330.47it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.90it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.96it/s][A100%|██████████| 195/195 [00:00<00:00, 333.73it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.863 -> 0.866
training process:  20%|█▉        | 25/128 [42:03<2:58:39, 104.07s/it]EarlyStopping counter : 1 out of 40
training process:  20%|██        | 26/128 [43:39<2:52:55, 101.72s/it]EarlyStopping counter : 2 out of 40
training process:  21%|██        | 27/128 [45:14<2:47:31, 99.52s/it] EarlyStopping counter : 3 out of 40
training process:  22%|██▏       | 28/128 [46:48<2:43:16, 97.97s/it]epoch : 29, train loss : -0.048, valid loss : -0.039, train acc : 0.995, valid acc : 0.978, train f1 : 0.995, valid f1 : 0.773

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.75it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 336.68it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 338.95it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.33it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 341.35it/s][A100%|██████████| 195/195 [00:00<00:00, 340.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 29/128 [48:46<2:51:24, 103.88s/it]EarlyStopping counter : 5 out of 40
training process:  23%|██▎       | 30/128 [50:20<2:45:01, 101.04s/it]EarlyStopping counter : 6 out of 40
training process:  24%|██▍       | 31/128 [51:54<2:40:04, 99.02s/it] EarlyStopping counter : 7 out of 40
training process:  25%|██▌       | 32/128 [53:29<2:36:15, 97.66s/it]epoch : 33, train loss : -0.049, valid loss : -0.045, train acc : 0.996, valid acc : 0.991, train f1 : 0.996, valid f1 : 0.875

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.57it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 342.06it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 344.76it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 346.44it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 347.42it/s][A100%|██████████| 195/195 [00:00<00:00, 346.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.866 -> 0.875
training process:  26%|██▌       | 33/128 [55:27<2:44:30, 103.90s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [57:00<2:37:20, 100.43s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [58:38<2:34:44, 99.83s/it] EarlyStopping counter : 3 out of 40
training process:  28%|██▊       | 36/128 [1:00:12<2:30:24, 98.09s/it]epoch : 37, train loss : -0.049, valid loss : -0.045, train acc : 0.996, valid acc : 0.986, train f1 : 0.996, valid f1 : 0.830

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 318.15it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.88it/s][A
 51%|█████     | 99/195 [00:00<00:00, 287.75it/s][A
 66%|██████▌   | 129/195 [00:00<00:00, 265.92it/s][A
 81%|████████  | 158/195 [00:00<00:00, 272.36it/s][A
 95%|█████████▌| 186/195 [00:00<00:00, 268.62it/s][A100%|██████████| 195/195 [00:00<00:00, 279.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  29%|██▉       | 37/128 [1:02:10<2:37:56, 104.14s/it]EarlyStopping counter : 5 out of 40
training process:  30%|██▉       | 38/128 [1:03:45<2:32:07, 101.42s/it]EarlyStopping counter : 6 out of 40
training process:  30%|███       | 39/128 [1:05:22<2:28:07, 99.86s/it] EarlyStopping counter : 7 out of 40
training process:  31%|███▏      | 40/128 [1:06:54<2:23:24, 97.78s/it]epoch : 41, train loss : -0.049, valid loss : -0.044, train acc : 0.996, valid acc : 0.986, train f1 : 0.996, valid f1 : 0.824

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 308.04it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 323.34it/s][A
 50%|█████     | 98/195 [00:00<00:00, 320.42it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 292.79it/s][A
 83%|████████▎ | 161/195 [00:00<00:00, 273.24it/s][A
 98%|█████████▊| 191/195 [00:00<00:00, 279.69it/s][A100%|██████████| 195/195 [00:00<00:00, 289.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  32%|███▏      | 41/128 [1:08:53<2:30:59, 104.14s/it]EarlyStopping counter : 9 out of 40
training process:  33%|███▎      | 42/128 [1:10:25<2:23:42, 100.26s/it]EarlyStopping counter : 10 out of 40
training process:  34%|███▎      | 43/128 [1:11:58<2:19:06, 98.19s/it] EarlyStopping counter : 11 out of 40
training process:  34%|███▍      | 44/128 [1:13:30<2:15:01, 96.45s/it]epoch : 45, train loss : -0.049, valid loss : -0.045, train acc : 0.997, valid acc : 0.992, train f1 : 0.997, valid f1 : 0.876

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.24it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 329.52it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 332.87it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.77it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.88it/s][A100%|██████████| 195/195 [00:00<00:00, 334.43it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  35%|███▌      | 45/128 [1:15:31<2:23:22, 103.64s/it]EarlyStopping counter : 13 out of 40
training process:  36%|███▌      | 46/128 [1:17:04<2:17:17, 100.46s/it]Best score increase :0.875 -> 0.880
training process:  37%|███▋      | 47/128 [1:18:38<2:13:14, 98.70s/it] EarlyStopping counter : 1 out of 40
training process:  38%|███▊      | 48/128 [1:20:12<2:09:20, 97.01s/it]epoch : 49, train loss : -0.049, valid loss : -0.044, train acc : 0.998, valid acc : 0.987, train f1 : 0.998, valid f1 : 0.831

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.02it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.85it/s][A
 51%|█████     | 99/195 [00:00<00:00, 328.05it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 331.65it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 333.15it/s][A100%|██████████| 195/195 [00:00<00:00, 331.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  38%|███▊      | 49/128 [1:22:12<2:16:59, 104.05s/it]EarlyStopping counter : 3 out of 40
training process:  39%|███▉      | 50/128 [1:23:44<2:10:38, 100.49s/it]EarlyStopping counter : 4 out of 40
training process:  40%|███▉      | 51/128 [1:25:17<2:06:07, 98.28s/it] EarlyStopping counter : 5 out of 40
training process:  41%|████      | 52/128 [1:26:51<2:02:40, 96.84s/it]epoch : 53, train loss : -0.049, valid loss : -0.044, train acc : 0.997, valid acc : 0.990, train f1 : 0.997, valid f1 : 0.856

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 310.84it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 324.60it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.92it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.01it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.55it/s][A100%|██████████| 195/195 [00:00<00:00, 331.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  41%|████▏     | 53/128 [1:28:50<2:09:30, 103.60s/it]EarlyStopping counter : 7 out of 40
training process:  42%|████▏     | 54/128 [1:30:23<2:03:37, 100.24s/it]EarlyStopping counter : 8 out of 40
training process:  43%|████▎     | 55/128 [1:31:57<1:59:53, 98.53s/it] EarlyStopping counter : 9 out of 40
training process:  44%|████▍     | 56/128 [1:33:31<1:56:23, 96.99s/it]epoch : 57, train loss : -0.050, valid loss : -0.043, train acc : 0.998, valid acc : 0.985, train f1 : 0.998, valid f1 : 0.818

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.86it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.64it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.74it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.53it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 336.78it/s][A100%|██████████| 195/195 [00:00<00:00, 334.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  45%|████▍     | 57/128 [1:35:30<2:02:42, 103.70s/it]EarlyStopping counter : 11 out of 40
training process:  45%|████▌     | 58/128 [1:37:04<1:57:43, 100.90s/it]EarlyStopping counter : 12 out of 40
training process:  46%|████▌     | 59/128 [1:38:37<1:53:13, 98.46s/it] EarlyStopping counter : 13 out of 40
training process:  47%|████▋     | 60/128 [1:40:11<1:49:58, 97.03s/it]epoch : 61, train loss : -0.050, valid loss : -0.043, train acc : 0.998, valid acc : 0.986, train f1 : 0.998, valid f1 : 0.822

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 326.73it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 334.42it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.76it/s][A
 70%|███████   | 137/195 [00:00<00:00, 340.02it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 341.16it/s][A100%|██████████| 195/195 [00:00<00:00, 339.45it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  48%|████▊     | 61/128 [1:42:08<1:55:07, 103.09s/it]EarlyStopping counter : 15 out of 40
training process:  48%|████▊     | 62/128 [1:43:42<1:50:20, 100.30s/it]EarlyStopping counter : 16 out of 40
training process:  49%|████▉     | 63/128 [1:45:14<1:46:06, 97.94s/it] EarlyStopping counter : 17 out of 40
training process:  50%|█████     | 64/128 [1:46:46<1:42:34, 96.16s/it]epoch : 65, train loss : -0.050, valid loss : -0.045, train acc : 0.998, valid acc : 0.992, train f1 : 0.998, valid f1 : 0.887

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 334.30it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.91it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.93it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.70it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.08it/s][A100%|██████████| 195/195 [00:00<00:00, 337.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.880 -> 0.887
training process:  51%|█████     | 65/128 [1:48:47<1:48:39, 103.48s/it]EarlyStopping counter : 1 out of 40
training process:  52%|█████▏    | 66/128 [1:50:21<1:44:00, 100.65s/it]EarlyStopping counter : 2 out of 40
training process:  52%|█████▏    | 67/128 [1:51:55<1:40:19, 98.68s/it] EarlyStopping counter : 3 out of 40
training process:  53%|█████▎    | 68/128 [1:53:30<1:37:41, 97.69s/it]epoch : 69, train loss : -0.050, valid loss : -0.045, train acc : 0.998, valid acc : 0.992, train f1 : 0.998, valid f1 : 0.878

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.25it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 326.78it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.84it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 335.23it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 337.03it/s][A100%|██████████| 195/195 [00:00<00:00, 334.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  54%|█████▍    | 69/128 [1:55:31<1:42:50, 104.58s/it]EarlyStopping counter : 5 out of 40
training process:  55%|█████▍    | 70/128 [1:57:03<1:37:35, 100.96s/it]EarlyStopping counter : 6 out of 40
training process:  55%|█████▌    | 71/128 [1:58:38<1:34:00, 98.96s/it] EarlyStopping counter : 7 out of 40
training process:  56%|█████▋    | 72/128 [2:00:11<1:30:50, 97.33s/it]epoch : 73, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.868

  0%|          | 0/195 [00:00<?, ?it/s][A
 10%|▉         | 19/195 [00:00<00:00, 183.03it/s][A
 25%|██▌       | 49/195 [00:00<00:00, 247.47it/s][A
 42%|████▏     | 82/195 [00:00<00:00, 282.60it/s][A
 59%|█████▉    | 115/195 [00:00<00:00, 299.95it/s][A
 76%|███████▌  | 148/195 [00:00<00:00, 309.72it/s][A
 93%|█████████▎| 181/195 [00:00<00:00, 315.88it/s][A100%|██████████| 195/195 [00:00<00:00, 298.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  57%|█████▋    | 73/128 [2:02:15<1:36:21, 105.13s/it]EarlyStopping counter : 9 out of 40
training process:  58%|█████▊    | 74/128 [2:03:49<1:31:50, 102.05s/it]EarlyStopping counter : 10 out of 40
training process:  59%|█████▊    | 75/128 [2:05:24<1:28:09, 99.80s/it] EarlyStopping counter : 11 out of 40
training process:  59%|█████▉    | 76/128 [2:06:57<1:24:43, 97.76s/it]epoch : 77, train loss : -0.050, valid loss : -0.045, train acc : 0.998, valid acc : 0.991, train f1 : 0.998, valid f1 : 0.871

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 315.12it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 330.13it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 335.76it/s][A
 70%|███████   | 137/195 [00:00<00:00, 338.60it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 336.38it/s][A100%|██████████| 195/195 [00:00<00:00, 335.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  60%|██████    | 77/128 [2:08:56<1:28:36, 104.25s/it]Best score increase :0.887 -> 0.889
training process:  61%|██████    | 78/128 [2:10:30<1:24:14, 101.08s/it]EarlyStopping counter : 1 out of 40
training process:  62%|██████▏   | 79/128 [2:12:04<1:20:49, 98.98s/it] EarlyStopping counter : 2 out of 40
training process:  62%|██████▎   | 80/128 [2:13:38<1:18:01, 97.53s/it]epoch : 81, train loss : -0.050, valid loss : -0.046, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.872

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 316.06it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.55it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.99it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.21it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 334.19it/s][A100%|██████████| 195/195 [00:00<00:00, 333.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  63%|██████▎   | 81/128 [2:15:36<1:21:11, 103.65s/it]EarlyStopping counter : 4 out of 40
training process:  64%|██████▍   | 82/128 [2:17:09<1:16:53, 100.30s/it]EarlyStopping counter : 5 out of 40
training process:  65%|██████▍   | 83/128 [2:18:43<1:13:47, 98.38s/it] EarlyStopping counter : 6 out of 40
training process:  66%|██████▌   | 84/128 [2:20:19<1:11:38, 97.68s/it]epoch : 85, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.992, train f1 : 0.999, valid f1 : 0.876

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.37it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 329.19it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 333.24it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 335.53it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 336.91it/s][A100%|██████████| 195/195 [00:00<00:00, 335.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  66%|██████▋   | 85/128 [2:22:22<1:15:35, 105.47s/it]EarlyStopping counter : 8 out of 40
training process:  67%|██████▋   | 86/128 [2:23:55<1:11:10, 101.69s/it]EarlyStopping counter : 9 out of 40
training process:  68%|██████▊   | 87/128 [2:25:30<1:08:09, 99.73s/it] EarlyStopping counter : 10 out of 40
training process:  69%|██████▉   | 88/128 [2:27:05<1:05:22, 98.06s/it]epoch : 89, train loss : -0.050, valid loss : -0.046, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.875

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 317.10it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.30it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 332.49it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 334.41it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 335.51it/s][A100%|██████████| 195/195 [00:00<00:00, 333.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  70%|██████▉   | 89/128 [2:29:04<1:07:49, 104.35s/it]EarlyStopping counter : 12 out of 40
training process:  70%|███████   | 90/128 [2:30:37<1:04:00, 101.06s/it]EarlyStopping counter : 13 out of 40
training process:  71%|███████   | 91/128 [2:32:11<1:01:02, 98.97s/it] EarlyStopping counter : 14 out of 40
training process:  72%|███████▏  | 92/128 [2:33:45<58:29, 97.48s/it]  epoch : 93, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.867

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 325.48it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 331.68it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 333.83it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 334.91it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 328.89it/s][A100%|██████████| 195/195 [00:00<00:00, 331.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  73%|███████▎  | 93/128 [2:35:42<1:00:18, 103.39s/it]EarlyStopping counter : 16 out of 40
training process:  73%|███████▎  | 94/128 [2:37:15<56:42, 100.08s/it]  EarlyStopping counter : 17 out of 40
training process:  74%|███████▍  | 95/128 [2:38:49<54:06, 98.38s/it] EarlyStopping counter : 18 out of 40
training process:  75%|███████▌  | 96/128 [2:40:21<51:26, 96.44s/it]epoch : 97, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.864

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 314.53it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 328.72it/s][A
 52%|█████▏    | 101/195 [00:00<00:00, 334.42it/s][A
 69%|██████▉   | 135/195 [00:00<00:00, 336.35it/s][A
 87%|████████▋ | 169/195 [00:00<00:00, 335.93it/s][A100%|██████████| 195/195 [00:00<00:00, 334.47it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  76%|███████▌  | 97/128 [2:42:22<53:37, 103.78s/it]EarlyStopping counter : 20 out of 40
training process:  77%|███████▋  | 98/128 [2:43:55<50:21, 100.73s/it]EarlyStopping counter : 21 out of 40
training process:  77%|███████▋  | 99/128 [2:45:29<47:35, 98.46s/it] EarlyStopping counter : 22 out of 40
training process:  78%|███████▊  | 100/128 [2:47:03<45:19, 97.13s/it]epoch : 101, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.989, train f1 : 0.999, valid f1 : 0.851

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 303.91it/s][A
 33%|███▎      | 64/195 [00:00<00:00, 317.59it/s][A
 50%|████▉     | 97/195 [00:00<00:00, 322.91it/s][A
 67%|██████▋   | 131/195 [00:00<00:00, 325.94it/s][A
 84%|████████▍ | 164/195 [00:00<00:00, 326.22it/s][A100%|██████████| 195/195 [00:00<00:00, 318.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  79%|███████▉  | 101/128 [2:49:04<46:55, 104.28s/it]EarlyStopping counter : 24 out of 40
training process:  80%|███████▉  | 102/128 [2:50:37<43:49, 101.15s/it]EarlyStopping counter : 25 out of 40
training process:  80%|████████  | 103/128 [2:52:12<41:17, 99.09s/it] EarlyStopping counter : 26 out of 40
training process:  81%|████████▏ | 104/128 [2:53:45<38:59, 97.47s/it]epoch : 105, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.859

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▌        | 31/195 [00:00<00:00, 308.16it/s][A
 33%|███▎      | 65/195 [00:00<00:00, 321.62it/s][A
 50%|█████     | 98/195 [00:00<00:00, 324.98it/s][A
 68%|██████▊   | 132/195 [00:00<00:00, 328.60it/s][A
 85%|████████▌ | 166/195 [00:00<00:00, 330.60it/s][A100%|██████████| 195/195 [00:00<00:00, 328.21it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  82%|████████▏ | 105/128 [2:55:47<40:07, 104.69s/it]EarlyStopping counter : 28 out of 40
training process:  83%|████████▎ | 106/128 [2:57:20<37:04, 101.09s/it]EarlyStopping counter : 29 out of 40
training process:  84%|████████▎ | 107/128 [2:58:52<34:29, 98.55s/it] EarlyStopping counter : 30 out of 40
training process:  84%|████████▍ | 108/128 [3:00:27<32:25, 97.27s/it]epoch : 109, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.991, train f1 : 0.999, valid f1 : 0.865

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.37it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 327.02it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 329.98it/s][A
 68%|██████▊   | 133/195 [00:00<00:00, 328.26it/s][A
 86%|████████▌ | 167/195 [00:00<00:00, 330.30it/s][A100%|██████████| 195/195 [00:00<00:00, 329.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  85%|████████▌ | 109/128 [3:02:26<32:57, 104.09s/it]EarlyStopping counter : 32 out of 40
training process:  86%|████████▌ | 110/128 [3:04:00<30:13, 100.77s/it]EarlyStopping counter : 33 out of 40
training process:  87%|████████▋ | 111/128 [3:05:32<27:50, 98.28s/it] EarlyStopping counter : 34 out of 40
training process:  88%|████████▊ | 112/128 [3:07:04<25:44, 96.54s/it]epoch : 113, train loss : -0.050, valid loss : -0.045, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.856

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.50it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 338.66it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.90it/s][A
 70%|███████   | 137/195 [00:00<00:00, 341.25it/s][A
 88%|████████▊ | 172/195 [00:00<00:00, 343.53it/s][A100%|██████████| 195/195 [00:00<00:00, 341.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  88%|████████▊ | 113/128 [3:09:06<26:00, 104.01s/it]EarlyStopping counter : 36 out of 40
training process:  89%|████████▉ | 114/128 [3:10:39<23:29, 100.64s/it]EarlyStopping counter : 37 out of 40
training process:  90%|████████▉ | 115/128 [3:12:11<21:15, 98.15s/it] EarlyStopping counter : 38 out of 40
training process:  91%|█████████ | 116/128 [3:13:44<19:17, 96.47s/it]epoch : 117, train loss : -0.050, valid loss : -0.046, train acc : 0.999, valid acc : 0.990, train f1 : 0.999, valid f1 : 0.858

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 310.90it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 323.11it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 327.92it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 330.61it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 332.37it/s][A100%|██████████| 195/195 [00:00<00:00, 330.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  91%|█████████▏| 117/128 [3:15:45<19:03, 103.96s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 117, best f1 score : 0.889
training process:  91%|█████████▏| 117/128 [3:17:20<18:33, 101.20s/it]
training process finished, best loss : -0.046 and best acc : 0.993, best f1 : 0.889, best epoch : 77

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.73      0.76      0.74       304
           1       1.00      0.99      1.00     17087

    accuracy                           0.99     17391
   macro avg       0.86      0.88      0.87     17391
weighted avg       0.99      0.99      0.99     17391


# test acc : 0.99, test f1 : 0.87, test AUC : 0.88, test loss : -11.586

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:12<03:27, 12.98s/it]processing for feature importance:  12%|█▏        | 2/17 [00:25<03:10, 12.67s/it]processing for feature importance:  18%|█▊        | 3/17 [00:38<03:00, 12.89s/it]processing for feature importance:  24%|██▎       | 4/17 [00:52<02:50, 13.14s/it]processing for feature importance:  29%|██▉       | 5/17 [01:04<02:34, 12.85s/it]processing for feature importance:  35%|███▌      | 6/17 [01:18<02:26, 13.33s/it]processing for feature importance:  41%|████      | 7/17 [01:31<02:12, 13.29s/it]processing for feature importance:  47%|████▋     | 8/17 [01:44<01:58, 13.19s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:57<01:44, 13.01s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:11<01:32, 13.22s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:24<01:19, 13.21s/it]processing for feature importance:  71%|███████   | 12/17 [02:37<01:06, 13.31s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:51<00:53, 13.27s/it]processing for feature importance:  82%|████████▏ | 14/17 [03:03<00:38, 12.91s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:15<00:25, 12.79s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:28<00:12, 12.70s/it]processing for feature importance: 100%|██████████| 17/17 [03:40<00:00, 12.74s/it]processing for feature importance: 100%|██████████| 17/17 [03:40<00:00, 13.00s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<11:58,  3.41s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<09:01,  2.58s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:04,  1.86s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:26,  1.31s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<12:22,  3.52s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<08:56,  2.56s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:01,  1.81s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:26,  1.32s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▋        | 32/195 [00:00<00:00, 317.16it/s] 34%|███▍      | 67/195 [00:00<00:00, 333.26it/s] 52%|█████▏    | 102/195 [00:00<00:00, 339.07it/s] 70%|███████   | 137/195 [00:00<00:00, 341.88it/s] 88%|████████▊ | 172/195 [00:00<00:00, 343.45it/s]100%|██████████| 195/195 [00:00<00:00, 340.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_1_Focal_smoothing_RW_Robust_CQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 205.91it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 202.84it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 200.41it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 202.74it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.47it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.32it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 209.63it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 211.11it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 208.59it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 207.88it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 207.51it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 206.80it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 207.82it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 207.27it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 206.01it/s]remove invalid data : null / measurement error:  55%|█████▌    | 341/616 [00:01<00:01, 205.40it/s]remove invalid data : null / measurement error:  59%|█████▉    | 362/616 [00:01<00:01, 206.49it/s]remove invalid data : null / measurement error:  63%|██████▎   | 388/616 [00:01<00:01, 220.62it/s]remove invalid data : null / measurement error:  68%|██████▊   | 416/616 [00:01<00:00, 236.06it/s]remove invalid data : null / measurement error:  71%|███████▏  | 440/616 [00:02<00:00, 231.32it/s]remove invalid data : null / measurement error:  75%|███████▌  | 464/616 [00:02<00:00, 231.94it/s]remove invalid data : null / measurement error:  79%|███████▉  | 488/616 [00:02<00:00, 224.34it/s]remove invalid data : null / measurement error:  83%|████████▎ | 511/616 [00:02<00:00, 218.94it/s]remove invalid data : null / measurement error:  87%|████████▋ | 533/616 [00:02<00:00, 214.63it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 210.96it/s]remove invalid data : null / measurement error:  94%|█████████▎| 577/616 [00:02<00:00, 208.88it/s]remove invalid data : null / measurement error:  97%|█████████▋| 598/616 [00:02<00:00, 207.73it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.67it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 239.90it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 239.51it/s]replace nan value:  14%|█▍        | 73/515 [00:00<00:01, 240.24it/s]replace nan value:  19%|█▉        | 98/515 [00:00<00:01, 241.61it/s]replace nan value:  24%|██▍       | 123/515 [00:00<00:01, 242.94it/s]replace nan value:  29%|██▊       | 148/515 [00:00<00:01, 244.49it/s]replace nan value:  34%|███▎      | 173/515 [00:00<00:01, 245.17it/s]replace nan value:  38%|███▊      | 198/515 [00:00<00:01, 245.52it/s]replace nan value:  43%|████▎     | 223/515 [00:00<00:01, 245.92it/s]replace nan value:  48%|████▊     | 248/515 [00:01<00:01, 246.37it/s]replace nan value:  53%|█████▎    | 273/515 [00:01<00:00, 247.01it/s]replace nan value:  58%|█████▊    | 298/515 [00:01<00:00, 245.87it/s]replace nan value:  63%|██████▎   | 323/515 [00:01<00:00, 246.11it/s]replace nan value:  68%|██████▊   | 348/515 [00:01<00:00, 243.67it/s]replace nan value:  72%|███████▏  | 373/515 [00:01<00:00, 244.77it/s]replace nan value:  77%|███████▋  | 398/515 [00:01<00:00, 245.46it/s]replace nan value:  82%|████████▏ | 423/515 [00:01<00:00, 245.44it/s]replace nan value:  87%|████████▋ | 448/515 [00:01<00:00, 243.94it/s]replace nan value:  92%|█████████▏| 473/515 [00:01<00:00, 244.45it/s]replace nan value:  97%|█████████▋| 498/515 [00:02<00:00, 245.29it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 244.67it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.55it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.79it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 77.48it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.75it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 74.17it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.78it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.98it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 49.07it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 55.90it/s]generate index:  15%|█▌        | 78/515 [00:01<00:07, 54.76it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.77it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.35it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.74it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.68it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 64.28it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 72.11it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 72.27it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.97it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.57it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 73.33it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.42it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.41it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.72it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.12it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.99it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.42it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.33it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 88.89it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 88.68it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.78it/s]generate index:  50%|█████     | 260/515 [00:03<00:03, 74.21it/s]generate index:  52%|█████▏    | 269/515 [00:03<00:03, 77.55it/s]generate index:  54%|█████▍    | 277/515 [00:04<00:03, 74.58it/s]generate index:  55%|█████▌    | 285/515 [00:04<00:03, 64.31it/s]generate index:  57%|█████▋    | 293/515 [00:04<00:03, 67.15it/s]generate index:  58%|█████▊    | 300/515 [00:04<00:03, 63.26it/s]generate index:  60%|█████▉    | 307/515 [00:04<00:03, 63.50it/s]generate index:  61%|██████    | 314/515 [00:04<00:03, 61.94it/s]generate index:  62%|██████▏   | 321/515 [00:04<00:03, 63.97it/s]generate index:  64%|██████▍   | 329/515 [00:04<00:02, 67.72it/s]generate index:  65%|██████▌   | 336/515 [00:05<00:03, 56.28it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 46.11it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 43.83it/s]generate index:  70%|██████▉   | 358/515 [00:05<00:02, 54.35it/s]generate index:  72%|███████▏  | 371/515 [00:05<00:02, 70.70it/s]generate index:  74%|███████▍  | 381/515 [00:05<00:01, 74.74it/s]generate index:  76%|███████▌  | 389/515 [00:05<00:01, 72.00it/s]generate index:  77%|███████▋  | 399/515 [00:05<00:01, 77.79it/s]generate index:  79%|███████▉  | 408/515 [00:06<00:01, 64.27it/s]generate index:  81%|████████  | 416/515 [00:06<00:01, 67.77it/s]generate index:  83%|████████▎ | 427/515 [00:06<00:01, 77.48it/s]generate index:  85%|████████▍ | 436/515 [00:06<00:01, 49.45it/s]generate index:  86%|████████▌ | 443/515 [00:07<00:01, 38.25it/s]generate index:  88%|████████▊ | 453/515 [00:07<00:01, 47.94it/s]generate index:  90%|████████▉ | 462/515 [00:07<00:00, 55.12it/s]generate index:  91%|█████████▏| 470/515 [00:07<00:00, 50.47it/s]generate index:  93%|█████████▎| 480/515 [00:07<00:00, 58.74it/s]generate index:  95%|█████████▍| 488/515 [00:07<00:00, 62.72it/s]generate index:  96%|█████████▋| 496/515 [00:07<00:00, 63.18it/s]generate index:  98%|█████████▊| 504/515 [00:07<00:00, 66.51it/s]generate index:  99%|█████████▉| 512/515 [00:07<00:00, 66.78it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.71it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   7%|▋         | 11/154 [00:00<00:01, 107.91it/s]remove invalid data : null / measurement error:  16%|█▌        | 24/154 [00:00<00:01, 117.83it/s]remove invalid data : null / measurement error:  26%|██▌       | 40/154 [00:00<00:00, 136.59it/s]remove invalid data : null / measurement error:  40%|███▉      | 61/154 [00:00<00:00, 162.96it/s]remove invalid data : null / measurement error:  51%|█████     | 78/154 [00:00<00:00, 157.14it/s]remove invalid data : null / measurement error:  62%|██████▏   | 95/154 [00:00<00:00, 161.06it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 180.41it/s]remove invalid data : null / measurement error:  90%|████████▉ | 138/154 [00:00<00:00, 183.64it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 159.92it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 22/131 [00:00<00:00, 215.80it/s]replace nan value:  37%|███▋      | 48/131 [00:00<00:00, 237.85it/s]replace nan value:  55%|█████▍    | 72/131 [00:00<00:00, 194.29it/s]replace nan value:  73%|███████▎  | 95/131 [00:00<00:00, 204.95it/s]replace nan value:  91%|█████████ | 119/131 [00:00<00:00, 215.81it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 215.33it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:02, 61.41it/s]generate index:  11%|█         | 14/131 [00:00<00:03, 33.32it/s]generate index:  15%|█▌        | 20/131 [00:00<00:02, 39.95it/s]generate index:  20%|█▉        | 26/131 [00:00<00:02, 44.97it/s]generate index:  25%|██▌       | 33/131 [00:00<00:01, 51.67it/s]generate index:  32%|███▏      | 42/131 [00:00<00:01, 53.89it/s]generate index:  37%|███▋      | 48/131 [00:01<00:01, 49.49it/s]generate index:  41%|████      | 54/131 [00:01<00:01, 44.26it/s]generate index:  46%|████▌     | 60/131 [00:01<00:01, 47.25it/s]generate index:  51%|█████     | 67/131 [00:01<00:01, 51.73it/s]generate index:  57%|█████▋    | 75/131 [00:01<00:00, 57.36it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:01, 49.58it/s]generate index:  66%|██████▋   | 87/131 [00:01<00:01, 42.59it/s]generate index:  70%|███████   | 92/131 [00:02<00:00, 40.20it/s]generate index:  74%|███████▍  | 97/131 [00:02<00:00, 37.82it/s]generate index:  77%|███████▋  | 101/131 [00:02<00:00, 36.99it/s]generate index:  81%|████████  | 106/131 [00:02<00:00, 39.06it/s]generate index:  88%|████████▊ | 115/131 [00:02<00:00, 50.25it/s]generate index:  95%|█████████▌| 125/131 [00:02<00:00, 62.86it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 48.80it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 12/193 [00:00<00:01, 118.65it/s]remove invalid data : null / measurement error:  17%|█▋        | 33/193 [00:00<00:00, 169.96it/s]remove invalid data : null / measurement error:  28%|██▊       | 55/193 [00:00<00:00, 190.99it/s]remove invalid data : null / measurement error:  40%|███▉      | 77/193 [00:00<00:00, 200.35it/s]remove invalid data : null / measurement error:  51%|█████▏    | 99/193 [00:00<00:00, 204.45it/s]remove invalid data : null / measurement error:  63%|██████▎   | 122/193 [00:00<00:00, 211.59it/s]remove invalid data : null / measurement error:  76%|███████▌  | 146/193 [00:00<00:00, 218.42it/s]remove invalid data : null / measurement error:  87%|████████▋ | 168/193 [00:00<00:00, 213.75it/s]remove invalid data : null / measurement error:  98%|█████████▊| 190/193 [00:00<00:00, 210.93it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 203.81it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 252.42it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 254.47it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 253.34it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 250.69it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 250.70it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 250.82it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 251.23it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 105.80it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.09it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.58it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.52it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.15it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.96it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.99it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.82it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.08it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.89it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.42it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.57it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.39it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.39it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.73it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.06it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.39it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.05it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.63it/s]
================= Dataset information =================
train data : 54242, disrupt : 956, non-disrupt : 53286
valid data : 15065, disrupt : 248, non-disrupt : 14817
test data : 17391, disrupt : 304, non-disrupt : 17087

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.558, valid loss : -0.826, train acc : 0.566, valid acc : 0.646, train f1 : 0.373, valid f1 : 0.405

  0%|          | 0/195 [00:00<?, ?it/s][A
 18%|█▊        | 35/195 [00:00<00:00, 348.61it/s][A
 36%|███▌      | 70/195 [00:00<00:00, 349.01it/s][A
 54%|█████▍    | 105/195 [00:00<00:00, 349.06it/s][A
 72%|███████▏  | 140/195 [00:00<00:00, 349.29it/s][A
 90%|████████▉ | 175/195 [00:00<00:00, 349.24it/s][A100%|██████████| 195/195 [00:00<00:00, 349.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.405
training process:   1%|          | 1/128 [02:01<4:17:05, 121.46s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:30<3:35:09, 102.46s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:57<3:18:44, 95.40s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:25<3:10:48, 92.33s/it]epoch : 5, train loss : -3.442, valid loss : -3.959, train acc : 0.470, valid acc : 0.429, train f1 : 0.332, valid f1 : 0.312

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 324.86it/s][A
 34%|███▍      | 66/195 [00:00<00:00, 325.56it/s][A
 51%|█████▏    | 100/195 [00:00<00:00, 331.15it/s][A
 69%|██████▊   | 134/195 [00:00<00:00, 333.59it/s][A
 86%|████████▌ | 168/195 [00:00<00:00, 333.18it/s][A100%|██████████| 195/195 [00:00<00:00, 332.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:17<3:24:00, 99.52s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:45<3:14:10, 95.50s/it]EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:15<3:09:21, 93.90s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:47<3:06:14, 93.12s/it]epoch : 9, train loss : -7.326, valid loss : -9.046, train acc : 0.288, valid acc : 0.226, train f1 : 0.236, valid f1 : 0.195

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 329.54it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 339.12it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 342.19it/s][A
 71%|███████   | 138/195 [00:00<00:00, 343.79it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 344.57it/s][A100%|██████████| 195/195 [00:00<00:00, 343.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:40<3:17:19, 99.49s/it]EarlyStopping counter : 9 out of 40
training process:   8%|▊         | 10/128 [16:11<3:10:36, 96.92s/it]EarlyStopping counter : 10 out of 40
training process:   9%|▊         | 11/128 [17:43<3:05:41, 95.23s/it]EarlyStopping counter : 11 out of 40
training process:   9%|▉         | 12/128 [19:12<3:00:39, 93.44s/it]epoch : 13, train loss : -12.438, valid loss : -16.146, train acc : 0.233, valid acc : 0.186, train f1 : 0.200, valid f1 : 0.166

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 332.26it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.42it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.11it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 337.45it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.15it/s][A100%|██████████| 195/195 [00:00<00:00, 337.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  10%|█         | 13/128 [21:06<3:10:43, 99.51s/it]EarlyStopping counter : 13 out of 40
training process:  11%|█         | 14/128 [22:35<3:03:15, 96.45s/it]EarlyStopping counter : 14 out of 40
training process:  12%|█▏        | 15/128 [24:04<2:57:20, 94.16s/it]EarlyStopping counter : 15 out of 40
training process:  12%|█▎        | 16/128 [25:33<2:53:07, 92.75s/it]epoch : 17, train loss : -17.826, valid loss : -19.824, train acc : 0.207, valid acc : 0.150, train f1 : 0.182, valid f1 : 0.138

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 331.39it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 336.10it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 337.50it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 338.21it/s][A
 87%|████████▋ | 170/195 [00:00<00:00, 338.60it/s][A100%|██████████| 195/195 [00:00<00:00, 337.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  13%|█▎        | 17/128 [27:29<3:04:32, 99.75s/it]EarlyStopping counter : 17 out of 40
training process:  14%|█▍        | 18/128 [28:56<2:55:42, 95.85s/it]EarlyStopping counter : 18 out of 40
training process:  15%|█▍        | 19/128 [30:26<2:50:53, 94.07s/it]EarlyStopping counter : 19 out of 40
training process:  16%|█▌        | 20/128 [31:55<2:46:31, 92.51s/it]epoch : 21, train loss : -23.388, valid loss : -29.483, train acc : 0.179, valid acc : 0.132, train f1 : 0.161, valid f1 : 0.123

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 336.42it/s][A
 35%|███▌      | 69/195 [00:00<00:00, 339.30it/s][A
 53%|█████▎    | 104/195 [00:00<00:00, 340.29it/s][A
 71%|███████▏  | 139/195 [00:00<00:00, 340.79it/s][A
 89%|████████▉ | 174/195 [00:00<00:00, 340.99it/s][A100%|██████████| 195/195 [00:00<00:00, 340.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  16%|█▋        | 21/128 [33:52<2:57:59, 99.81s/it]EarlyStopping counter : 21 out of 40
training process:  17%|█▋        | 22/128 [35:21<2:50:32, 96.53s/it]EarlyStopping counter : 22 out of 40
training process:  18%|█▊        | 23/128 [36:55<2:47:33, 95.75s/it]EarlyStopping counter : 23 out of 40
training process:  19%|█▉        | 24/128 [38:26<2:43:32, 94.35s/it]epoch : 25, train loss : -30.511, valid loss : -30.978, train acc : 0.223, valid acc : 0.244, train f1 : 0.194, valid f1 : 0.208

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 34/195 [00:00<00:00, 339.05it/s][A
 35%|███▍      | 68/195 [00:00<00:00, 335.76it/s][A
 53%|█████▎    | 103/195 [00:00<00:00, 340.52it/s][A
 71%|███████   | 138/195 [00:00<00:00, 342.92it/s][A
 89%|████████▊ | 173/195 [00:00<00:00, 343.81it/s][A100%|██████████| 195/195 [00:00<00:00, 342.26it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  20%|█▉        | 25/128 [40:20<2:52:16, 100.36s/it]EarlyStopping counter : 25 out of 40
training process:  20%|██        | 26/128 [41:47<2:43:44, 96.32s/it] EarlyStopping counter : 26 out of 40
training process:  21%|██        | 27/128 [43:21<2:40:50, 95.55s/it]EarlyStopping counter : 27 out of 40
training process:  22%|██▏       | 28/128 [44:49<2:35:48, 93.49s/it]epoch : 29, train loss : -36.659, valid loss : -43.852, train acc : 0.199, valid acc : 0.199, train f1 : 0.177, valid f1 : 0.176

  0%|          | 0/195 [00:00<?, ?it/s][A
 17%|█▋        | 33/195 [00:00<00:00, 321.15it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 328.28it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 334.14it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 335.48it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.69it/s][A100%|██████████| 195/195 [00:00<00:00, 334.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  23%|██▎       | 29/128 [46:49<2:47:17, 101.39s/it]EarlyStopping counter : 29 out of 40
training process:  23%|██▎       | 30/128 [48:20<2:40:14, 98.11s/it] EarlyStopping counter : 30 out of 40
training process:  24%|██▍       | 31/128 [49:50<2:35:00, 95.88s/it]EarlyStopping counter : 31 out of 40
training process:  25%|██▌       | 32/128 [51:19<2:29:44, 93.59s/it]epoch : 33, train loss : -43.648, valid loss : -50.314, train acc : 0.197, valid acc : 0.205, train f1 : 0.175, valid f1 : 0.180

  0%|          | 0/195 [00:00<?, ?it/s][A
 11%|█         | 21/195 [00:00<00:00, 206.13it/s][A
 27%|██▋       | 52/195 [00:00<00:00, 266.53it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 293.12it/s][A
 61%|██████    | 118/195 [00:00<00:00, 305.64it/s][A
 76%|███████▋  | 149/195 [00:00<00:00, 265.28it/s][A
 92%|█████████▏| 180/195 [00:00<00:00, 278.72it/s][A100%|██████████| 195/195 [00:00<00:00, 280.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  26%|██▌       | 33/128 [53:09<2:36:16, 98.70s/it]EarlyStopping counter : 33 out of 40
training process:  27%|██▋       | 34/128 [54:39<2:30:39, 96.17s/it]EarlyStopping counter : 34 out of 40
training process:  27%|██▋       | 35/128 [56:10<2:26:29, 94.51s/it]EarlyStopping counter : 35 out of 40
training process:  28%|██▊       | 36/128 [57:38<2:21:50, 92.51s/it]epoch : 37, train loss : -50.894, valid loss : -57.837, train acc : 0.203, valid acc : 0.216, train f1 : 0.180, valid f1 : 0.188

  0%|          | 0/195 [00:00<?, ?it/s][A
 14%|█▍        | 28/195 [00:00<00:00, 273.47it/s][A
 29%|██▉       | 57/195 [00:00<00:00, 277.76it/s][A
 44%|████▎     | 85/195 [00:00<00:00, 276.46it/s][A
 58%|█████▊    | 114/195 [00:00<00:00, 278.14it/s][A
 73%|███████▎  | 143/195 [00:00<00:00, 279.05it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 277.26it/s][A100%|██████████| 195/195 [00:00<00:00, 277.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  29%|██▉       | 37/128 [59:36<2:31:44, 100.05s/it]EarlyStopping counter : 37 out of 40
training process:  30%|██▉       | 38/128 [1:01:08<2:26:33, 97.71s/it]EarlyStopping counter : 38 out of 40
training process:  30%|███       | 39/128 [1:02:39<2:22:14, 95.90s/it]EarlyStopping counter : 39 out of 40
training process:  31%|███▏      | 40/128 [1:04:08<2:17:24, 93.69s/it]epoch : 41, train loss : -58.299, valid loss : -69.001, train acc : 0.200, valid acc : 0.158, train f1 : 0.177, valid f1 : 0.144

  0%|          | 0/195 [00:00<?, ?it/s][A
 16%|█▋        | 32/195 [00:00<00:00, 319.90it/s][A
 34%|███▍      | 67/195 [00:00<00:00, 332.55it/s][A
 52%|█████▏    | 102/195 [00:00<00:00, 336.62it/s][A
 70%|██████▉   | 136/195 [00:00<00:00, 334.79it/s][A
 88%|████████▊ | 171/195 [00:00<00:00, 337.21it/s][A100%|██████████| 195/195 [00:00<00:00, 334.74it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 40, best f1 score : 0.405
training process:  31%|███▏      | 40/128 [1:06:02<2:25:17, 99.07s/it]
training process finished, best loss : -0.826 and best acc : 0.646, best f1 : 0.405, best epoch : 0

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.01      0.32      0.03       304
           1       0.98      0.57      0.72     17087

    accuracy                           0.57     17391
   macro avg       0.50      0.44      0.37     17391
weighted avg       0.96      0.57      0.71     17391


# test acc : 0.57, test f1 : 0.37, test AUC : 0.44, test loss : -257.570

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:11, 11.94s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:02, 12.17s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:44, 11.76s/it]processing for feature importance:  24%|██▎       | 4/17 [00:47<02:34, 11.90s/it]processing for feature importance:  29%|██▉       | 5/17 [01:00<02:27, 12.28s/it]processing for feature importance:  35%|███▌      | 6/17 [01:12<02:14, 12.20s/it]processing for feature importance:  41%|████      | 7/17 [01:25<02:03, 12.38s/it]processing for feature importance:  47%|████▋     | 8/17 [01:37<01:49, 12.16s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:49<01:36, 12.09s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:00<01:22, 11.85s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:12<01:11, 11.87s/it]processing for feature importance:  71%|███████   | 12/17 [02:24<01:00, 12.01s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:35<00:47, 11.83s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:48<00:35, 11.97s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:59<00:23, 11.71s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:11<00:11, 11.84s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 11.50s/it]processing for feature importance: 100%|██████████| 17/17 [03:22<00:00, 11.90s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<13:01,  3.70s/it]visualize 2D latent space:   1%|          | 2/212 [00:04<07:25,  2.12s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:02<02:15,  2.02s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:30,  1.36s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<13:11,  3.75s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:18,  2.66s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:24,  2.16s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:37,  1.48s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/195 [00:00<?, ?it/s] 16%|█▌        | 31/195 [00:00<00:00, 308.22it/s] 34%|███▍      | 66/195 [00:00<00:00, 328.37it/s] 52%|█████▏    | 101/195 [00:00<00:00, 334.90it/s] 70%|██████▉   | 136/195 [00:00<00:00, 337.83it/s] 88%|████████▊ | 171/195 [00:00<00:00, 339.55it/s]100%|██████████| 195/195 [00:00<00:00, 336.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_CE_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.57it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 202.81it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 201.99it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 204.94it/s]remove invalid data : null / measurement error:  17%|█▋        | 106/616 [00:00<00:02, 207.10it/s]remove invalid data : null / measurement error:  21%|██        | 128/616 [00:00<00:02, 210.15it/s]remove invalid data : null / measurement error:  24%|██▍       | 150/616 [00:00<00:02, 212.56it/s]remove invalid data : null / measurement error:  28%|██▊       | 172/616 [00:00<00:02, 214.17it/s]remove invalid data : null / measurement error:  31%|███▏      | 194/616 [00:00<00:01, 211.60it/s]remove invalid data : null / measurement error:  35%|███▌      | 216/616 [00:01<00:01, 210.11it/s]remove invalid data : null / measurement error:  39%|███▊      | 238/616 [00:01<00:01, 209.10it/s]remove invalid data : null / measurement error:  42%|████▏     | 259/616 [00:01<00:01, 206.47it/s]remove invalid data : null / measurement error:  45%|████▌     | 280/616 [00:01<00:01, 206.35it/s]remove invalid data : null / measurement error:  49%|████▉     | 301/616 [00:01<00:01, 205.76it/s]remove invalid data : null / measurement error:  52%|█████▏    | 322/616 [00:01<00:01, 204.67it/s]remove invalid data : null / measurement error:  56%|█████▌    | 343/616 [00:01<00:01, 204.26it/s]remove invalid data : null / measurement error:  59%|█████▉    | 365/616 [00:01<00:01, 206.99it/s]remove invalid data : null / measurement error:  63%|██████▎   | 391/616 [00:01<00:01, 221.37it/s]remove invalid data : null / measurement error:  68%|██████▊   | 418/616 [00:01<00:00, 235.62it/s]remove invalid data : null / measurement error:  72%|███████▏  | 442/616 [00:02<00:00, 230.67it/s]remove invalid data : null / measurement error:  76%|███████▌  | 466/616 [00:02<00:00, 230.23it/s]remove invalid data : null / measurement error:  80%|███████▉  | 490/616 [00:02<00:00, 222.85it/s]remove invalid data : null / measurement error:  83%|████████▎ | 513/616 [00:02<00:00, 219.00it/s]remove invalid data : null / measurement error:  87%|████████▋ | 535/616 [00:02<00:00, 215.42it/s]remove invalid data : null / measurement error:  90%|█████████ | 557/616 [00:02<00:00, 212.76it/s]remove invalid data : null / measurement error:  94%|█████████▍| 579/616 [00:02<00:00, 210.75it/s]remove invalid data : null / measurement error:  98%|█████████▊| 601/616 [00:02<00:00, 208.75it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 212.31it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.22it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.38it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.25it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 238.58it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 241.44it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 244.22it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 245.88it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 245.20it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 244.60it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 244.77it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 245.18it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 245.04it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 246.15it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 244.56it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 244.67it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 244.78it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 243.54it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 241.36it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 241.52it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 241.06it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 242.77it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.26it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.31it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.55it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.99it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.22it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.71it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 59.05it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 49.20it/s]generate index:  14%|█▍        | 71/515 [00:01<00:07, 55.65it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.58it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.80it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.56it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 60.43it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 66.45it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 65.06it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 72.99it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 73.16it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 73.28it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.25it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.61it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.46it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.30it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.47it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.77it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.64it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.91it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.68it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 86.19it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 88.66it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.20it/s]generate index:  50%|█████     | 260/515 [00:03<00:03, 73.90it/s]generate index:  52%|█████▏    | 269/515 [00:03<00:03, 77.58it/s]generate index:  54%|█████▍    | 278/515 [00:04<00:03, 70.75it/s]generate index:  56%|█████▌    | 286/515 [00:04<00:03, 65.07it/s]generate index:  57%|█████▋    | 294/515 [00:04<00:03, 67.66it/s]generate index:  59%|█████▊    | 302/515 [00:04<00:03, 61.89it/s]generate index:  60%|██████    | 311/515 [00:04<00:03, 65.72it/s]generate index:  62%|██████▏   | 318/515 [00:04<00:03, 60.96it/s]generate index:  63%|██████▎   | 326/515 [00:04<00:02, 65.28it/s]generate index:  65%|██████▍   | 333/515 [00:04<00:02, 66.22it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 48.27it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 46.21it/s]generate index:  68%|██████▊   | 352/515 [00:05<00:03, 45.33it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 57.53it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 71.63it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 75.41it/s]generate index:  76%|███████▋  | 393/515 [00:05<00:01, 74.04it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 73.65it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.81it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.38it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.94it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.72it/s]generate index:  86%|████████▌ | 444/515 [00:06<00:01, 48.94it/s]generate index:  88%|████████▊ | 455/515 [00:06<00:00, 60.22it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.97it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.68it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.55it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.52it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.73it/s]generate index:  99%|█████████▉| 509/515 [00:07<00:00, 68.86it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 65.07it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 57.38it/s]remove invalid data : null / measurement error:  18%|█▊        | 27/154 [00:00<00:00, 144.35it/s]remove invalid data : null / measurement error:  32%|███▏      | 49/154 [00:00<00:00, 175.17it/s]remove invalid data : null / measurement error:  46%|████▌     | 71/154 [00:00<00:00, 191.53it/s]remove invalid data : null / measurement error:  60%|██████    | 93/154 [00:00<00:00, 199.79it/s]remove invalid data : null / measurement error:  77%|███████▋  | 118/154 [00:00<00:00, 213.60it/s]remove invalid data : null / measurement error:  91%|█████████ | 140/154 [00:00<00:00, 211.12it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 194.33it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 248.33it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 250.42it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 251.07it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 247.93it/s]replace nan value:  98%|█████████▊| 128/131 [00:00<00:00, 248.45it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 248.58it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.64it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.86it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.15it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.43it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.97it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 61.72it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 62.44it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 64.52it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 68.36it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 70.07it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 64.50it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.56it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.66it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.93it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 49.53it/s]generate index:  88%|████████▊ | 115/131 [00:01<00:00, 57.04it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 71.53it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.34it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 11/193 [00:00<00:01, 106.69it/s]remove invalid data : null / measurement error:  17%|█▋        | 32/193 [00:00<00:00, 165.98it/s]remove invalid data : null / measurement error:  28%|██▊       | 54/193 [00:00<00:00, 188.70it/s]remove invalid data : null / measurement error:  39%|███▉      | 76/193 [00:00<00:00, 200.17it/s]remove invalid data : null / measurement error:  51%|█████     | 98/193 [00:00<00:00, 204.99it/s]remove invalid data : null / measurement error:  63%|██████▎   | 121/193 [00:00<00:00, 211.45it/s]remove invalid data : null / measurement error:  75%|███████▌  | 145/193 [00:00<00:00, 219.42it/s]remove invalid data : null / measurement error:  87%|████████▋ | 167/193 [00:00<00:00, 213.06it/s]remove invalid data : null / measurement error:  98%|█████████▊| 189/193 [00:00<00:00, 210.65it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 202.94it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 252.36it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 254.88it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 253.83it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 250.26it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 251.18it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 251.30it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 251.57it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.63it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.25it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.54it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.15it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.37it/s]generate index:  38%|███▊      | 61/160 [00:00<00:01, 82.80it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 86.17it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.92it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.79it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.51it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.98it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.08it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.93it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.01it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.37it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.04it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.01it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.28it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.19it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.244, valid loss : 0.118, train acc : 0.951, valid acc : 0.975, train f1 : 0.506, valid f1 : 0.494

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 341.36it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 350.35it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 353.19it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 354.40it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 354.98it/s][A100%|██████████| 194/194 [00:00<00:00, 353.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.494
training process:   1%|          | 1/128 [01:58<4:10:53, 118.53s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:27<3:32:32, 101.21s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:56<3:19:12, 95.62s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:26<3:13:07, 93.45s/it]epoch : 5, train loss : 0.102, valid loss : 0.104, train acc : 0.973, valid acc : 0.975, train f1 : 0.499, valid f1 : 0.515

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 335.83it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 341.02it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 343.19it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 341.40it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 343.45it/s][A100%|██████████| 194/194 [00:00<00:00, 342.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.494 -> 0.515
training process:   4%|▍         | 5/128 [08:24<3:29:12, 102.05s/it]Best score increase :0.515 -> 0.534
training process:   5%|▍         | 6/128 [09:55<3:19:57, 98.34s/it] Best score increase :0.534 -> 0.561
training process:   5%|▌         | 7/128 [11:23<3:12:01, 95.22s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:49<3:04:24, 92.20s/it]epoch : 9, train loss : 0.085, valid loss : 0.094, train acc : 0.975, valid acc : 0.973, train f1 : 0.603, valid f1 : 0.606

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 319.35it/s][A
 33%|███▎      | 64/194 [00:00<00:00, 319.59it/s][A
 50%|█████     | 97/194 [00:00<00:00, 324.28it/s][A
 67%|██████▋   | 130/194 [00:00<00:00, 325.08it/s][A
 84%|████████▍ | 163/194 [00:00<00:00, 326.57it/s][A100%|██████████| 194/194 [00:00<00:00, 325.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.561 -> 0.606
training process:   7%|▋         | 9/128 [14:45<3:17:17, 99.47s/it]Best score increase :0.606 -> 0.627
training process:   8%|▊         | 10/128 [16:15<3:10:12, 96.72s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [17:45<3:04:21, 94.54s/it]Best score increase :0.627 -> 0.629
training process:   9%|▉         | 12/128 [19:14<2:59:50, 93.02s/it]epoch : 13, train loss : 0.074, valid loss : 0.096, train acc : 0.976, valid acc : 0.974, train f1 : 0.669, valid f1 : 0.648

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 340.48it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 343.74it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 344.71it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 345.30it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 345.39it/s][A100%|██████████| 194/194 [00:00<00:00, 344.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.629 -> 0.648
training process:  10%|█         | 13/128 [21:10<3:11:28, 99.90s/it]Best score increase :0.648 -> 0.656
training process:  11%|█         | 14/128 [22:39<3:03:44, 96.71s/it]EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [24:09<2:58:13, 94.63s/it]EarlyStopping counter : 2 out of 40
training process:  12%|█▎        | 16/128 [25:39<2:53:40, 93.04s/it]epoch : 17, train loss : 0.065, valid loss : 0.085, train acc : 0.978, valid acc : 0.974, train f1 : 0.719, valid f1 : 0.644

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 333.82it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 339.69it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 341.87it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 342.87it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 343.38it/s][A100%|██████████| 194/194 [00:00<00:00, 342.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  13%|█▎        | 17/128 [27:32<3:03:39, 99.27s/it]EarlyStopping counter : 4 out of 40
training process:  14%|█▍        | 18/128 [29:02<2:56:44, 96.41s/it]Best score increase :0.656 -> 0.668
training process:  15%|█▍        | 19/128 [30:32<2:51:23, 94.34s/it]Best score increase :0.668 -> 0.676
training process:  16%|█▌        | 20/128 [32:02<2:47:56, 93.30s/it]epoch : 21, train loss : 0.058, valid loss : 0.085, train acc : 0.981, valid acc : 0.974, train f1 : 0.768, valid f1 : 0.663

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 343.52it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 342.62it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 344.85it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 342.49it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 338.43it/s][A100%|██████████| 194/194 [00:00<00:00, 341.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [33:56<2:57:19, 99.44s/it]EarlyStopping counter : 2 out of 40
training process:  17%|█▋        | 22/128 [35:25<2:50:09, 96.32s/it]EarlyStopping counter : 3 out of 40
training process:  18%|█▊        | 23/128 [36:56<2:45:29, 94.57s/it]EarlyStopping counter : 4 out of 40
training process:  19%|█▉        | 24/128 [38:24<2:40:22, 92.53s/it]epoch : 25, train loss : 0.051, valid loss : 0.092, train acc : 0.983, valid acc : 0.967, train f1 : 0.795, valid f1 : 0.662

  0%|          | 0/194 [00:00<?, ?it/s][A
 11%|█         | 21/194 [00:00<00:00, 208.78it/s][A
 27%|██▋       | 52/194 [00:00<00:00, 265.03it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 296.56it/s][A
 62%|██████▏   | 120/194 [00:00<00:00, 311.09it/s][A
 79%|███████▉  | 154/194 [00:00<00:00, 319.16it/s][A
 97%|█████████▋| 188/194 [00:00<00:00, 323.79it/s][A100%|██████████| 194/194 [00:00<00:00, 308.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  20%|█▉        | 25/128 [40:19<2:50:39, 99.42s/it]Best score increase :0.676 -> 0.685
training process:  20%|██        | 26/128 [41:50<2:44:48, 96.95s/it]Best score increase :0.685 -> 0.695
training process:  21%|██        | 27/128 [43:21<2:40:07, 95.12s/it]EarlyStopping counter : 1 out of 40
training process:  22%|██▏       | 28/128 [44:50<2:35:37, 93.38s/it]epoch : 29, train loss : 0.047, valid loss : 0.094, train acc : 0.984, valid acc : 0.974, train f1 : 0.816, valid f1 : 0.718

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 247.73it/s][A
 29%|██▉       | 57/194 [00:00<00:00, 286.19it/s][A
 46%|████▋     | 90/194 [00:00<00:00, 305.65it/s][A
 64%|██████▍   | 124/194 [00:00<00:00, 315.56it/s][A
 81%|████████▏ | 158/194 [00:00<00:00, 321.08it/s][A
 99%|█████████▉| 192/194 [00:00<00:00, 324.19it/s][A100%|██████████| 194/194 [00:00<00:00, 313.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.695 -> 0.718
training process:  23%|██▎       | 29/128 [46:47<2:45:36, 100.37s/it]EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 30/128 [48:17<2:38:41, 97.16s/it] EarlyStopping counter : 2 out of 40
training process:  24%|██▍       | 31/128 [49:47<2:33:55, 95.21s/it]EarlyStopping counter : 3 out of 40
training process:  25%|██▌       | 32/128 [51:19<2:30:41, 94.18s/it]epoch : 33, train loss : 0.043, valid loss : 0.101, train acc : 0.984, valid acc : 0.968, train f1 : 0.829, valid f1 : 0.685

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 340.94it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 344.17it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 345.36it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 345.89it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 345.21it/s][A100%|██████████| 194/194 [00:00<00:00, 344.06it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  26%|██▌       | 33/128 [53:11<2:37:44, 99.63s/it]EarlyStopping counter : 5 out of 40
training process:  27%|██▋       | 34/128 [54:41<2:31:14, 96.54s/it]EarlyStopping counter : 6 out of 40
training process:  27%|██▋       | 35/128 [56:06<2:24:35, 93.28s/it]EarlyStopping counter : 7 out of 40
training process:  28%|██▊       | 36/128 [57:34<2:20:28, 91.62s/it]epoch : 37, train loss : 0.039, valid loss : 0.103, train acc : 0.986, valid acc : 0.972, train f1 : 0.845, valid f1 : 0.690

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 338.68it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 343.98it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 345.48it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 344.48it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 345.01it/s][A100%|██████████| 194/194 [00:00<00:00, 344.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  29%|██▉       | 37/128 [59:26<2:27:57, 97.56s/it]EarlyStopping counter : 9 out of 40
training process:  30%|██▉       | 38/128 [1:00:52<2:21:04, 94.05s/it]EarlyStopping counter : 10 out of 40
training process:  30%|███       | 39/128 [1:02:22<2:17:57, 93.01s/it]EarlyStopping counter : 11 out of 40
training process:  31%|███▏      | 40/128 [1:03:52<2:15:15, 92.22s/it]epoch : 41, train loss : 0.035, valid loss : 0.109, train acc : 0.987, valid acc : 0.974, train f1 : 0.862, valid f1 : 0.691

  0%|          | 0/194 [00:00<?, ?it/s][A
 11%|█         | 21/194 [00:00<00:00, 208.46it/s][A
 27%|██▋       | 52/194 [00:00<00:00, 264.89it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 296.11it/s][A
 62%|██████▏   | 120/194 [00:00<00:00, 310.80it/s][A
 79%|███████▉  | 154/194 [00:00<00:00, 318.93it/s][A
 97%|█████████▋| 188/194 [00:00<00:00, 323.86it/s][A100%|██████████| 194/194 [00:00<00:00, 308.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  32%|███▏      | 41/128 [1:05:51<2:25:17, 100.20s/it]EarlyStopping counter : 13 out of 40
training process:  33%|███▎      | 42/128 [1:07:22<2:19:43, 97.48s/it] EarlyStopping counter : 14 out of 40
training process:  34%|███▎      | 43/128 [1:08:53<2:15:07, 95.38s/it]EarlyStopping counter : 15 out of 40
training process:  34%|███▍      | 44/128 [1:10:20<2:10:06, 92.93s/it]epoch : 45, train loss : 0.033, valid loss : 0.160, train acc : 0.988, valid acc : 0.955, train f1 : 0.874, valid f1 : 0.628

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 327.41it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 334.59it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 340.12it/s][A
 71%|███████   | 137/194 [00:00<00:00, 342.85it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 342.44it/s][A100%|██████████| 194/194 [00:00<00:00, 341.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  35%|███▌      | 45/128 [1:12:15<2:17:42, 99.55s/it]EarlyStopping counter : 17 out of 40
training process:  36%|███▌      | 46/128 [1:13:42<2:11:03, 95.90s/it]EarlyStopping counter : 18 out of 40
training process:  37%|███▋      | 47/128 [1:15:11<2:06:36, 93.78s/it]EarlyStopping counter : 19 out of 40
training process:  38%|███▊      | 48/128 [1:16:39<2:02:30, 91.88s/it]epoch : 49, train loss : 0.031, valid loss : 0.123, train acc : 0.989, valid acc : 0.970, train f1 : 0.885, valid f1 : 0.687

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 267.92it/s][A
 29%|██▉       | 56/194 [00:00<00:00, 275.95it/s][A
 44%|████▍     | 85/194 [00:00<00:00, 278.23it/s][A
 59%|█████▉    | 114/194 [00:00<00:00, 279.45it/s][A
 73%|███████▎  | 142/194 [00:00<00:00, 262.28it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 251.14it/s][A100%|██████████| 194/194 [00:00<00:00, 267.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  38%|███▊      | 49/128 [1:18:31<2:08:53, 97.89s/it]EarlyStopping counter : 21 out of 40
training process:  39%|███▉      | 50/128 [1:20:00<2:04:03, 95.42s/it]EarlyStopping counter : 22 out of 40
training process:  40%|███▉      | 51/128 [1:21:31<2:00:31, 93.91s/it]EarlyStopping counter : 23 out of 40
training process:  41%|████      | 52/128 [1:23:00<1:57:14, 92.56s/it]epoch : 53, train loss : 0.028, valid loss : 0.120, train acc : 0.990, valid acc : 0.969, train f1 : 0.893, valid f1 : 0.687

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 336.67it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 341.87it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 343.81it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 344.66it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 345.07it/s][A100%|██████████| 194/194 [00:00<00:00, 344.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  41%|████▏     | 53/128 [1:24:52<2:02:57, 98.36s/it]EarlyStopping counter : 25 out of 40
training process:  42%|████▏     | 54/128 [1:26:23<1:58:40, 96.22s/it]EarlyStopping counter : 26 out of 40
training process:  43%|████▎     | 55/128 [1:27:55<1:55:29, 94.93s/it]EarlyStopping counter : 27 out of 40
training process:  44%|████▍     | 56/128 [1:29:25<1:52:01, 93.36s/it]epoch : 57, train loss : 0.027, valid loss : 0.141, train acc : 0.990, valid acc : 0.964, train f1 : 0.900, valid f1 : 0.660

  0%|          | 0/194 [00:00<?, ?it/s][A
 15%|█▍        | 29/194 [00:00<00:00, 282.13it/s][A
 30%|██▉       | 58/194 [00:00<00:00, 285.29it/s][A
 45%|████▍     | 87/194 [00:00<00:00, 286.84it/s][A
 60%|█████▉    | 116/194 [00:00<00:00, 287.21it/s][A
 75%|███████▍  | 145/194 [00:00<00:00, 287.04it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 286.83it/s][A100%|██████████| 194/194 [00:00<00:00, 285.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  45%|████▍     | 57/128 [1:31:17<1:57:17, 99.12s/it]EarlyStopping counter : 29 out of 40
training process:  45%|████▌     | 58/128 [1:32:44<1:51:21, 95.45s/it]EarlyStopping counter : 30 out of 40
training process:  46%|████▌     | 59/128 [1:34:13<1:47:32, 93.52s/it]EarlyStopping counter : 31 out of 40
training process:  47%|████▋     | 60/128 [1:35:40<1:43:34, 91.39s/it]epoch : 61, train loss : 0.023, valid loss : 0.165, train acc : 0.991, valid acc : 0.958, train f1 : 0.911, valid f1 : 0.648

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 244.20it/s][A
 28%|██▊       | 54/194 [00:00<00:00, 268.43it/s][A
 42%|████▏     | 82/194 [00:00<00:00, 270.96it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 276.84it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 267.77it/s][A
 86%|████████▌ | 166/194 [00:00<00:00, 247.58it/s][A100%|██████████| 194/194 [00:00<00:00, 264.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  48%|████▊     | 61/128 [1:37:38<1:51:11, 99.58s/it]EarlyStopping counter : 33 out of 40
training process:  48%|████▊     | 62/128 [1:39:11<1:47:07, 97.39s/it]EarlyStopping counter : 34 out of 40
training process:  49%|████▉     | 63/128 [1:40:43<1:43:55, 95.93s/it]EarlyStopping counter : 35 out of 40
training process:  50%|█████     | 64/128 [1:42:11<1:39:49, 93.59s/it]epoch : 65, train loss : 0.023, valid loss : 0.152, train acc : 0.992, valid acc : 0.962, train f1 : 0.914, valid f1 : 0.660

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 324.52it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.78it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 339.39it/s][A
 71%|███████   | 137/194 [00:00<00:00, 337.72it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 340.01it/s][A100%|██████████| 194/194 [00:00<00:00, 338.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  51%|█████     | 65/128 [1:44:08<1:45:26, 100.42s/it]EarlyStopping counter : 37 out of 40
training process:  52%|█████▏    | 66/128 [1:45:43<1:42:10, 98.89s/it] EarlyStopping counter : 38 out of 40
training process:  52%|█████▏    | 67/128 [1:47:17<1:39:05, 97.47s/it]EarlyStopping counter : 39 out of 40
training process:  53%|█████▎    | 68/128 [1:48:53<1:36:51, 96.85s/it]epoch : 69, train loss : 0.023, valid loss : 0.142, train acc : 0.992, valid acc : 0.971, train f1 : 0.918, valid f1 : 0.694

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 335.78it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 345.52it/s][A
 55%|█████▍    | 106/194 [00:00<00:00, 348.34it/s][A
 73%|███████▎  | 141/194 [00:00<00:00, 347.70it/s][A
 91%|█████████ | 176/194 [00:00<00:00, 345.87it/s][A100%|██████████| 194/194 [00:00<00:00, 346.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 68, best f1 score : 0.718
training process:  53%|█████▎    | 68/128 [1:50:51<1:37:48, 97.82s/it]
training process finished, best loss : 0.094 and best acc : 0.974, best f1 : 0.718, best epoch : 28

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.43      0.29      0.35       453
           1       0.98      0.99      0.99     16880

    accuracy                           0.97     17333
   macro avg       0.71      0.64      0.67     17333
weighted avg       0.97      0.97      0.97     17333


# test acc : 0.97, test f1 : 0.67, test AUC : 0.64, test loss : 27.860

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:06, 11.66s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:54, 11.65s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:43, 11.65s/it]processing for feature importance:  24%|██▎       | 4/17 [00:47<02:35, 11.95s/it]processing for feature importance:  29%|██▉       | 5/17 [01:00<02:29, 12.48s/it]processing for feature importance:  35%|███▌      | 6/17 [01:14<02:20, 12.78s/it]processing for feature importance:  41%|████      | 7/17 [01:26<02:07, 12.74s/it]processing for feature importance:  47%|████▋     | 8/17 [01:37<01:47, 11.97s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:48<01:33, 11.70s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:59<01:21, 11.67s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:12<01:12, 12.12s/it]processing for feature importance:  71%|███████   | 12/17 [02:23<00:58, 11.66s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:34<00:45, 11.49s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:45<00:34, 11.38s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:56<00:22, 11.20s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:09<00:11, 11.73s/it]processing for feature importance: 100%|██████████| 17/17 [03:20<00:00, 11.46s/it]processing for feature importance: 100%|██████████| 17/17 [03:20<00:00, 11.79s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<12:38,  3.59s/it]visualize 2D latent space:   1%|          | 2/212 [00:04<07:57,  2.27s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:11,  1.97s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:27,  1.33s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<13:26,  3.82s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:19,  2.67s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:17,  2.05s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:00,  1.09it/s]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:37,  1.48s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 16%|█▋        | 32/194 [00:00<00:00, 318.03it/s] 35%|███▍      | 67/194 [00:00<00:00, 334.86it/s] 53%|█████▎    | 103/194 [00:00<00:00, 342.76it/s] 72%|███████▏  | 139/194 [00:00<00:00, 346.32it/s] 90%|█████████ | 175/194 [00:00<00:00, 348.32it/s]100%|██████████| 194/194 [00:00<00:00, 344.80it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_CE_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 207.32it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 203.04it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 200.03it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 202.69it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.70it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.74it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 210.20it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 211.77it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 209.28it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 208.63it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 208.35it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 207.72it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 208.71it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 208.16it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 206.87it/s]remove invalid data : null / measurement error:  55%|█████▌    | 341/616 [00:01<00:01, 206.29it/s]remove invalid data : null / measurement error:  59%|█████▉    | 362/616 [00:01<00:01, 206.91it/s]remove invalid data : null / measurement error:  63%|██████▎   | 388/616 [00:01<00:01, 220.35it/s]remove invalid data : null / measurement error:  68%|██████▊   | 416/616 [00:01<00:00, 235.93it/s]remove invalid data : null / measurement error:  71%|███████▏  | 440/616 [00:02<00:00, 231.57it/s]remove invalid data : null / measurement error:  75%|███████▌  | 464/616 [00:02<00:00, 232.23it/s]remove invalid data : null / measurement error:  79%|███████▉  | 488/616 [00:02<00:00, 224.83it/s]remove invalid data : null / measurement error:  83%|████████▎ | 511/616 [00:02<00:00, 219.60it/s]remove invalid data : null / measurement error:  87%|████████▋ | 534/616 [00:02<00:00, 214.76it/s]remove invalid data : null / measurement error:  90%|█████████ | 556/616 [00:02<00:00, 211.44it/s]remove invalid data : null / measurement error:  94%|█████████▍| 578/616 [00:02<00:00, 209.11it/s]remove invalid data : null / measurement error:  97%|█████████▋| 599/616 [00:02<00:00, 207.03it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.90it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.98it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.29it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 234.56it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 236.85it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 239.10it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 241.25it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 242.64it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 243.19it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 243.62it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 244.49it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 244.97it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 244.15it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 244.47it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 242.33it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 243.10it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 244.01it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 243.81it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 242.47it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 242.44it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 242.10it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 241.97it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 41.07it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 57.32it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 76.79it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.13it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.78it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.25it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.99it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.87it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.45it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.54it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.61it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.43it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.28it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.21it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.83it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.62it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.77it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.45it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.09it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 72.89it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 71.99it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.71it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.42it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 69.43it/s]generate index:  39%|███▊      | 199/515 [00:03<00:05, 58.17it/s]generate index:  40%|████      | 206/515 [00:03<00:05, 59.36it/s]generate index:  43%|████▎     | 221/515 [00:03<00:03, 78.24it/s]generate index:  45%|████▍     | 231/515 [00:03<00:03, 80.73it/s]generate index:  47%|████▋     | 240/515 [00:03<00:03, 80.45it/s]generate index:  48%|████▊     | 249/515 [00:03<00:03, 70.67it/s]generate index:  50%|████▉     | 257/515 [00:03<00:03, 66.24it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 70.93it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 74.82it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.08it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 64.39it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.57it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 61.98it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 62.06it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 61.78it/s]generate index:  64%|██████▎   | 328/515 [00:04<00:02, 65.60it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 58.17it/s]generate index:  66%|██████▋   | 342/515 [00:05<00:03, 46.30it/s]generate index:  68%|██████▊   | 348/515 [00:05<00:03, 44.01it/s]generate index:  70%|██████▉   | 358/515 [00:05<00:02, 54.15it/s]generate index:  72%|███████▏  | 369/515 [00:05<00:02, 66.72it/s]generate index:  74%|███████▍  | 380/515 [00:05<00:01, 75.87it/s]generate index:  76%|███████▌  | 389/515 [00:06<00:01, 70.49it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 75.71it/s]generate index:  79%|███████▉  | 408/515 [00:06<00:01, 62.57it/s]generate index:  81%|████████  | 416/515 [00:06<00:01, 66.10it/s]generate index:  83%|████████▎ | 427/515 [00:06<00:01, 75.86it/s]generate index:  85%|████████▍ | 436/515 [00:06<00:01, 57.40it/s]generate index:  86%|████████▌ | 443/515 [00:07<00:01, 47.70it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.49it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.37it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.32it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.23it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.32it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.27it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.16it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.89it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   7%|▋         | 11/154 [00:00<00:01, 109.00it/s]remove invalid data : null / measurement error:  21%|██        | 32/154 [00:00<00:00, 166.84it/s]remove invalid data : null / measurement error:  35%|███▌      | 54/154 [00:00<00:00, 187.09it/s]remove invalid data : null / measurement error:  49%|████▉     | 76/154 [00:00<00:00, 197.73it/s]remove invalid data : null / measurement error:  64%|██████▍   | 99/154 [00:00<00:00, 208.93it/s]remove invalid data : null / measurement error:  79%|███████▉  | 122/154 [00:00<00:00, 213.84it/s]remove invalid data : null / measurement error:  94%|█████████▎| 144/154 [00:00<00:00, 211.75it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 200.80it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 251.10it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 250.23it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 249.79it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 247.78it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 250.81it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 250.00it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 71.94it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.49it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 56.82it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 58.99it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 64.88it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 65.56it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 62.02it/s]generate index:  48%|████▊     | 63/131 [00:00<00:01, 66.89it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 66.55it/s]generate index:  59%|█████▉    | 77/131 [00:01<00:00, 66.90it/s]generate index:  64%|██████▍   | 84/131 [00:01<00:00, 67.27it/s]generate index:  69%|██████▉   | 91/131 [00:01<00:00, 47.06it/s]generate index:  74%|███████▍  | 97/131 [00:01<00:00, 49.05it/s]generate index:  79%|███████▊  | 103/131 [00:01<00:00, 47.84it/s]generate index:  83%|████████▎ | 109/131 [00:01<00:00, 50.47it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 60.40it/s]generate index:  99%|█████████▉| 130/131 [00:02<00:00, 72.69it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.52it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 39.99it/s]remove invalid data : null / measurement error:  13%|█▎        | 26/193 [00:00<00:01, 143.24it/s]remove invalid data : null / measurement error:  24%|██▍       | 47/193 [00:00<00:00, 170.34it/s]remove invalid data : null / measurement error:  36%|███▌      | 69/193 [00:00<00:00, 187.05it/s]remove invalid data : null / measurement error:  47%|████▋     | 91/193 [00:00<00:00, 196.62it/s]remove invalid data : null / measurement error:  58%|█████▊    | 112/193 [00:00<00:00, 198.11it/s]remove invalid data : null / measurement error:  70%|███████   | 136/193 [00:00<00:00, 211.45it/s]remove invalid data : null / measurement error:  82%|████████▏ | 158/193 [00:00<00:00, 210.58it/s]remove invalid data : null / measurement error:  93%|█████████▎| 180/193 [00:00<00:00, 207.72it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 193.58it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 246.67it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 252.09it/s]replace nan value:  48%|████▊     | 77/160 [00:00<00:00, 252.93it/s]replace nan value:  64%|██████▍   | 103/160 [00:00<00:00, 245.57it/s]replace nan value:  80%|████████  | 128/160 [00:00<00:00, 246.92it/s]replace nan value:  96%|█████████▋| 154/160 [00:00<00:00, 248.63it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 248.46it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 108.08it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.53it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.77it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.46it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.32it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.41it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.81it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.01it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.18it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.16it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.88it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.10it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.83it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.59it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.02it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.33it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.65it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.17it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.78it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.524, valid loss : 0.577, train acc : 0.730, valid acc : 0.701, train f1 : 0.729, valid f1 : 0.469

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 338.69it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 344.41it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 345.82it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 346.78it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 346.90it/s][A100%|██████████| 194/194 [00:00<00:00, 347.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.469
training process:   1%|          | 1/128 [01:59<4:13:19, 119.68s/it]Best score increase :0.469 -> 0.536
training process:   2%|▏         | 2/128 [03:31<3:37:25, 103.53s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [05:04<3:25:17, 98.54s/it] EarlyStopping counter : 2 out of 40
training process:   3%|▎         | 4/128 [06:36<3:18:25, 96.01s/it]epoch : 5, train loss : 0.203, valid loss : 0.404, train acc : 0.922, valid acc : 0.823, train f1 : 0.922, valid f1 : 0.545

  0%|          | 0/194 [00:00<?, ?it/s][A
 15%|█▌        | 30/194 [00:00<00:00, 292.85it/s][A
 32%|███▏      | 63/194 [00:00<00:00, 310.20it/s][A
 50%|█████     | 97/194 [00:00<00:00, 322.21it/s][A
 68%|██████▊   | 131/194 [00:00<00:00, 329.14it/s][A
 86%|████████▌ | 166/194 [00:00<00:00, 333.76it/s][A100%|██████████| 194/194 [00:00<00:00, 328.30it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.536 -> 0.545
training process:   4%|▍         | 5/128 [08:37<3:35:01, 104.89s/it]Best score increase :0.545 -> 0.562
training process:   5%|▍         | 6/128 [10:10<3:25:17, 100.97s/it]Best score increase :0.562 -> 0.581
training process:   5%|▌         | 7/128 [11:43<3:18:30, 98.43s/it] Best score increase :0.581 -> 0.590
training process:   6%|▋         | 8/128 [13:16<3:13:14, 96.62s/it]epoch : 9, train loss : 0.131, valid loss : 0.253, train acc : 0.954, valid acc : 0.916, train f1 : 0.954, valid f1 : 0.617

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 321.33it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.47it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 340.74it/s][A
 71%|███████   | 138/194 [00:00<00:00, 343.51it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 344.73it/s][A100%|██████████| 194/194 [00:00<00:00, 342.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.590 -> 0.617
training process:   7%|▋         | 9/128 [15:15<3:25:37, 103.67s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:48<3:17:01, 100.18s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [18:20<3:10:28, 97.68s/it] EarlyStopping counter : 3 out of 40
training process:   9%|▉         | 12/128 [19:51<3:05:25, 95.91s/it]epoch : 13, train loss : 0.099, valid loss : 0.306, train acc : 0.966, valid acc : 0.894, train f1 : 0.966, valid f1 : 0.592

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 247.17it/s][A
 27%|██▋       | 52/194 [00:00<00:00, 259.93it/s][A
 41%|████      | 80/194 [00:00<00:00, 265.68it/s][A
 56%|█████▌    | 108/194 [00:00<00:00, 268.54it/s][A
 70%|███████   | 136/194 [00:00<00:00, 270.34it/s][A
 85%|████████▍ | 164/194 [00:00<00:00, 271.37it/s][A
 99%|█████████▉| 192/194 [00:00<00:00, 271.67it/s][A100%|██████████| 194/194 [00:00<00:00, 268.63it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  10%|█         | 13/128 [21:51<3:17:22, 102.98s/it]EarlyStopping counter : 5 out of 40
training process:  11%|█         | 14/128 [23:24<3:10:20, 100.18s/it]EarlyStopping counter : 6 out of 40
training process:  12%|█▏        | 15/128 [24:57<3:04:25, 97.93s/it] Best score increase :0.617 -> 0.619
training process:  12%|█▎        | 16/128 [26:32<3:00:56, 96.93s/it]epoch : 17, train loss : 0.077, valid loss : 0.293, train acc : 0.974, valid acc : 0.910, train f1 : 0.974, valid f1 : 0.600

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 304.78it/s][A
 34%|███▎      | 65/194 [00:00<00:00, 322.35it/s][A
 51%|█████     | 99/194 [00:00<00:00, 328.11it/s][A
 69%|██████▊   | 133/194 [00:00<00:00, 330.35it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 331.30it/s][A100%|██████████| 194/194 [00:00<00:00, 329.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:34<3:13:17, 104.49s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [30:08<3:06:03, 101.49s/it]EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [31:42<3:00:01, 99.10s/it] Best score increase :0.619 -> 0.632
training process:  16%|█▌        | 20/128 [33:15<2:55:17, 97.38s/it]epoch : 21, train loss : 0.063, valid loss : 0.315, train acc : 0.979, valid acc : 0.909, train f1 : 0.979, valid f1 : 0.599

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 334.44it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 338.61it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 339.95it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 340.97it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 341.76it/s][A100%|██████████| 194/194 [00:00<00:00, 340.81it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [35:13<3:04:39, 103.54s/it]EarlyStopping counter : 2 out of 40
training process:  17%|█▋        | 22/128 [36:44<2:56:11, 99.73s/it] EarlyStopping counter : 3 out of 40
training process:  18%|█▊        | 23/128 [38:16<2:50:20, 97.34s/it]EarlyStopping counter : 4 out of 40
training process:  19%|█▉        | 24/128 [39:50<2:47:17, 96.51s/it]epoch : 25, train loss : 0.057, valid loss : 0.345, train acc : 0.981, valid acc : 0.903, train f1 : 0.981, valid f1 : 0.592

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 317.58it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 331.65it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 336.53it/s][A
 70%|███████   | 136/194 [00:00<00:00, 335.27it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 337.41it/s][A100%|██████████| 194/194 [00:00<00:00, 335.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  20%|█▉        | 25/128 [41:47<2:56:06, 102.59s/it]EarlyStopping counter : 6 out of 40
training process:  20%|██        | 26/128 [43:19<2:49:03, 99.44s/it] EarlyStopping counter : 7 out of 40
training process:  21%|██        | 27/128 [44:52<2:44:11, 97.54s/it]EarlyStopping counter : 8 out of 40
training process:  22%|██▏       | 28/128 [46:26<2:40:36, 96.37s/it]epoch : 29, train loss : 0.048, valid loss : 0.291, train acc : 0.984, valid acc : 0.920, train f1 : 0.984, valid f1 : 0.618

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 311.70it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 327.54it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 333.28it/s][A
 70%|███████   | 136/194 [00:00<00:00, 336.34it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 337.92it/s][A100%|██████████| 194/194 [00:00<00:00, 335.04it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  23%|██▎       | 29/128 [48:25<2:50:04, 103.08s/it]EarlyStopping counter : 10 out of 40
training process:  23%|██▎       | 30/128 [49:58<2:43:30, 100.10s/it]EarlyStopping counter : 11 out of 40
training process:  24%|██▍       | 31/128 [51:30<2:37:56, 97.69s/it] EarlyStopping counter : 12 out of 40
training process:  25%|██▌       | 32/128 [53:04<2:34:43, 96.70s/it]epoch : 33, train loss : 0.045, valid loss : 0.332, train acc : 0.985, valid acc : 0.917, train f1 : 0.985, valid f1 : 0.604

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 247.18it/s][A
 27%|██▋       | 53/194 [00:00<00:00, 261.53it/s][A
 42%|████▏     | 81/194 [00:00<00:00, 267.20it/s][A
 56%|█████▌    | 109/194 [00:00<00:00, 270.43it/s][A
 71%|███████   | 137/194 [00:00<00:00, 272.15it/s][A
 85%|████████▌ | 165/194 [00:00<00:00, 273.25it/s][A
 99%|█████████▉| 193/194 [00:00<00:00, 273.92it/s][A100%|██████████| 194/194 [00:00<00:00, 270.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  26%|██▌       | 33/128 [55:01<2:42:43, 102.77s/it]EarlyStopping counter : 14 out of 40
training process:  27%|██▋       | 34/128 [56:34<2:36:12, 99.71s/it] EarlyStopping counter : 15 out of 40
training process:  27%|██▋       | 35/128 [58:08<2:32:00, 98.07s/it]EarlyStopping counter : 16 out of 40
training process:  28%|██▊       | 36/128 [59:42<2:28:24, 96.79s/it]epoch : 37, train loss : 0.041, valid loss : 0.303, train acc : 0.986, valid acc : 0.923, train f1 : 0.986, valid f1 : 0.615

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 338.75it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 343.85it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 346.27it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 347.74it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 348.62it/s][A100%|██████████| 194/194 [00:00<00:00, 347.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  29%|██▉       | 37/128 [1:01:40<2:36:40, 103.30s/it]Best score increase :0.632 -> 0.639
training process:  30%|██▉       | 38/128 [1:03:17<2:31:51, 101.24s/it]EarlyStopping counter : 1 out of 40
training process:  30%|███       | 39/128 [1:04:50<2:26:24, 98.70s/it] Best score increase :0.639 -> 0.645
training process:  31%|███▏      | 40/128 [1:06:21<2:21:38, 96.57s/it]epoch : 41, train loss : 0.036, valid loss : 0.259, train acc : 0.988, valid acc : 0.938, train f1 : 0.988, valid f1 : 0.635

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 324.85it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.19it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 339.40it/s][A
 71%|███████   | 138/194 [00:00<00:00, 341.33it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 340.16it/s][A100%|██████████| 194/194 [00:00<00:00, 339.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  32%|███▏      | 41/128 [1:08:23<2:31:01, 104.15s/it]EarlyStopping counter : 2 out of 40
training process:  33%|███▎      | 42/128 [1:09:57<2:25:07, 101.25s/it]EarlyStopping counter : 3 out of 40
training process:  34%|███▎      | 43/128 [1:11:30<2:19:49, 98.70s/it] EarlyStopping counter : 4 out of 40
training process:  34%|███▍      | 44/128 [1:13:02<2:15:22, 96.70s/it]epoch : 45, train loss : 0.033, valid loss : 0.272, train acc : 0.990, valid acc : 0.936, train f1 : 0.990, valid f1 : 0.627

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 337.29it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 340.85it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 341.90it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 342.70it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 343.12it/s][A100%|██████████| 194/194 [00:00<00:00, 342.30it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  35%|███▌      | 45/128 [1:15:02<2:23:31, 103.75s/it]EarlyStopping counter : 6 out of 40
training process:  36%|███▌      | 46/128 [1:16:37<2:17:52, 100.88s/it]EarlyStopping counter : 7 out of 40
training process:  37%|███▋      | 47/128 [1:18:11<2:13:22, 98.79s/it] EarlyStopping counter : 8 out of 40
training process:  38%|███▊      | 48/128 [1:19:45<2:09:55, 97.45s/it]epoch : 49, train loss : 0.033, valid loss : 0.282, train acc : 0.989, valid acc : 0.939, train f1 : 0.989, valid f1 : 0.626

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 303.32it/s][A
 34%|███▎      | 65/194 [00:00<00:00, 323.20it/s][A
 51%|█████     | 99/194 [00:00<00:00, 330.48it/s][A
 69%|██████▉   | 134/194 [00:00<00:00, 334.32it/s][A
 87%|████████▋ | 168/194 [00:00<00:00, 336.29it/s][A100%|██████████| 194/194 [00:00<00:00, 332.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  38%|███▊      | 49/128 [1:21:46<2:17:37, 104.52s/it]EarlyStopping counter : 10 out of 40
training process:  39%|███▉      | 50/128 [1:23:20<2:11:56, 101.50s/it]EarlyStopping counter : 11 out of 40
training process:  40%|███▉      | 51/128 [1:24:54<2:07:07, 99.06s/it] EarlyStopping counter : 12 out of 40
training process:  41%|████      | 52/128 [1:26:25<2:02:30, 96.71s/it]epoch : 53, train loss : 0.030, valid loss : 0.282, train acc : 0.990, valid acc : 0.939, train f1 : 0.990, valid f1 : 0.629

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 321.02it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 331.58it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 336.52it/s][A
 71%|███████   | 137/194 [00:00<00:00, 339.54it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 341.16it/s][A100%|██████████| 194/194 [00:00<00:00, 338.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  41%|████▏     | 53/128 [1:28:26<2:09:53, 103.92s/it]EarlyStopping counter : 14 out of 40
training process:  42%|████▏     | 54/128 [1:29:59<2:04:13, 100.72s/it]EarlyStopping counter : 15 out of 40
training process:  43%|████▎     | 55/128 [1:31:31<1:59:23, 98.13s/it] EarlyStopping counter : 16 out of 40
training process:  44%|████▍     | 56/128 [1:33:04<1:55:49, 96.52s/it]epoch : 57, train loss : 0.028, valid loss : 0.306, train acc : 0.991, valid acc : 0.934, train f1 : 0.991, valid f1 : 0.621

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 325.49it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.78it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 340.05it/s][A
 71%|███████   | 138/194 [00:00<00:00, 342.56it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 344.07it/s][A100%|██████████| 194/194 [00:00<00:00, 341.77it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  45%|████▍     | 57/128 [1:35:03<2:02:22, 103.42s/it]Best score increase :0.645 -> 0.661
training process:  45%|████▌     | 58/128 [1:36:34<1:56:19, 99.70s/it] EarlyStopping counter : 1 out of 40
training process:  46%|████▌     | 59/128 [1:38:06<1:51:44, 97.17s/it]EarlyStopping counter : 2 out of 40
training process:  47%|████▋     | 60/128 [1:39:38<1:48:31, 95.76s/it]epoch : 61, train loss : 0.025, valid loss : 0.270, train acc : 0.992, valid acc : 0.948, train f1 : 0.992, valid f1 : 0.648

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 266.04it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 271.77it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 273.92it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 275.21it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 277.12it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 278.62it/s][A100%|██████████| 194/194 [00:00<00:00, 276.88it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  48%|████▊     | 61/128 [1:41:36<1:54:30, 102.55s/it]EarlyStopping counter : 4 out of 40
training process:  48%|████▊     | 62/128 [1:43:09<1:49:37, 99.66s/it] EarlyStopping counter : 5 out of 40
training process:  49%|████▉     | 63/128 [1:44:41<1:45:23, 97.29s/it]EarlyStopping counter : 6 out of 40
training process:  50%|█████     | 64/128 [1:46:16<1:43:02, 96.60s/it]epoch : 65, train loss : 0.025, valid loss : 0.309, train acc : 0.992, valid acc : 0.938, train f1 : 0.992, valid f1 : 0.635

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 269.83it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 275.10it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 275.12it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 276.15it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 276.75it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 277.27it/s][A100%|██████████| 194/194 [00:00<00:00, 276.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  51%|█████     | 65/128 [1:48:13<1:47:57, 102.82s/it]EarlyStopping counter : 8 out of 40
training process:  52%|█████▏    | 66/128 [1:49:46<1:43:06, 99.77s/it] EarlyStopping counter : 9 out of 40
training process:  52%|█████▏    | 67/128 [1:51:19<1:39:20, 97.72s/it]EarlyStopping counter : 10 out of 40
training process:  53%|█████▎    | 68/128 [1:52:54<1:36:51, 96.85s/it]epoch : 69, train loss : 0.022, valid loss : 0.259, train acc : 0.993, valid acc : 0.950, train f1 : 0.993, valid f1 : 0.651

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 339.37it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 345.23it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 347.36it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 348.39it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 349.29it/s][A100%|██████████| 194/194 [00:00<00:00, 346.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  54%|█████▍    | 69/128 [1:54:57<1:42:57, 104.71s/it]EarlyStopping counter : 12 out of 40
training process:  55%|█████▍    | 70/128 [1:56:30<1:37:55, 101.29s/it]EarlyStopping counter : 13 out of 40
training process:  55%|█████▌    | 71/128 [1:58:05<1:34:18, 99.27s/it] EarlyStopping counter : 14 out of 40
training process:  56%|█████▋    | 72/128 [1:59:36<1:30:21, 96.82s/it]epoch : 73, train loss : 0.021, valid loss : 0.298, train acc : 0.993, valid acc : 0.945, train f1 : 0.993, valid f1 : 0.646

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 327.43it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 336.08it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 339.18it/s][A
 71%|███████   | 138/194 [00:00<00:00, 341.24it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 342.83it/s][A100%|██████████| 194/194 [00:00<00:00, 340.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  57%|█████▋    | 73/128 [2:01:34<1:34:43, 103.33s/it]EarlyStopping counter : 16 out of 40
training process:  58%|█████▊    | 74/128 [2:03:07<1:30:06, 100.12s/it]EarlyStopping counter : 17 out of 40
training process:  59%|█████▊    | 75/128 [2:04:41<1:26:46, 98.24s/it] EarlyStopping counter : 18 out of 40
training process:  59%|█████▉    | 76/128 [2:06:13<1:23:25, 96.27s/it]epoch : 77, train loss : 0.018, valid loss : 0.305, train acc : 0.994, valid acc : 0.947, train f1 : 0.994, valid f1 : 0.651

  0%|          | 0/194 [00:00<?, ?it/s][A
 11%|█         | 21/194 [00:00<00:00, 207.49it/s][A
 27%|██▋       | 52/194 [00:00<00:00, 265.67it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 297.04it/s][A
 62%|██████▏   | 120/194 [00:00<00:00, 311.96it/s][A
 79%|███████▉  | 154/194 [00:00<00:00, 320.03it/s][A
 97%|█████████▋| 188/194 [00:00<00:00, 325.32it/s][A100%|██████████| 194/194 [00:00<00:00, 309.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  60%|██████    | 77/128 [2:08:13<1:27:58, 103.50s/it]EarlyStopping counter : 20 out of 40
training process:  61%|██████    | 78/128 [2:09:46<1:23:36, 100.32s/it]EarlyStopping counter : 21 out of 40
training process:  62%|██████▏   | 79/128 [2:11:20<1:20:19, 98.36s/it] EarlyStopping counter : 22 out of 40
training process:  62%|██████▎   | 80/128 [2:12:53<1:17:33, 96.94s/it]epoch : 81, train loss : 0.021, valid loss : 0.342, train acc : 0.994, valid acc : 0.938, train f1 : 0.994, valid f1 : 0.629

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 346.12it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 351.45it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 349.01it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 350.42it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 351.97it/s][A100%|██████████| 194/194 [00:00<00:00, 351.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  63%|██████▎   | 81/128 [2:14:54<1:21:27, 103.99s/it]EarlyStopping counter : 24 out of 40
training process:  64%|██████▍   | 82/128 [2:16:26<1:17:00, 100.45s/it]EarlyStopping counter : 25 out of 40
training process:  65%|██████▍   | 83/128 [2:18:00<1:13:48, 98.40s/it] EarlyStopping counter : 26 out of 40
training process:  66%|██████▌   | 84/128 [2:19:35<1:11:31, 97.53s/it]epoch : 85, train loss : 0.017, valid loss : 0.315, train acc : 0.994, valid acc : 0.948, train f1 : 0.994, valid f1 : 0.644

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 335.59it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 342.17it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 344.12it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 344.61it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 345.26it/s][A100%|██████████| 194/194 [00:00<00:00, 344.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  66%|██████▋   | 85/128 [2:21:34<1:14:32, 104.02s/it]EarlyStopping counter : 28 out of 40
training process:  67%|██████▋   | 86/128 [2:23:07<1:10:30, 100.74s/it]EarlyStopping counter : 29 out of 40
training process:  68%|██████▊   | 87/128 [2:24:41<1:07:22, 98.59s/it] EarlyStopping counter : 30 out of 40
training process:  69%|██████▉   | 88/128 [2:26:13<1:04:31, 96.79s/it]epoch : 89, train loss : 0.018, valid loss : 0.314, train acc : 0.995, valid acc : 0.945, train f1 : 0.995, valid f1 : 0.646

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 334.84it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 341.84it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 344.59it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 346.06it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 347.15it/s][A100%|██████████| 194/194 [00:00<00:00, 345.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  70%|██████▉   | 89/128 [2:28:14<1:07:35, 103.98s/it]EarlyStopping counter : 32 out of 40
training process:  70%|███████   | 90/128 [2:29:46<1:03:28, 100.22s/it]EarlyStopping counter : 33 out of 40
training process:  71%|███████   | 91/128 [2:31:18<1:00:20, 97.86s/it] EarlyStopping counter : 34 out of 40
training process:  72%|███████▏  | 92/128 [2:32:51<57:54, 96.51s/it]  epoch : 93, train loss : 0.014, valid loss : 0.318, train acc : 0.996, valid acc : 0.950, train f1 : 0.996, valid f1 : 0.658

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 262.68it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 270.25it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 272.83it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 274.51it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 275.54it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 275.96it/s][A100%|██████████| 194/194 [00:00<00:00, 274.69it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  73%|███████▎  | 93/128 [2:34:49<1:00:02, 102.93s/it]EarlyStopping counter : 36 out of 40
training process:  73%|███████▎  | 94/128 [2:36:23<56:42, 100.07s/it]  EarlyStopping counter : 37 out of 40
training process:  74%|███████▍  | 95/128 [2:37:54<53:32, 97.34s/it] EarlyStopping counter : 38 out of 40
training process:  75%|███████▌  | 96/128 [2:39:28<51:23, 96.36s/it]epoch : 97, train loss : 0.016, valid loss : 0.348, train acc : 0.995, valid acc : 0.947, train f1 : 0.995, valid f1 : 0.645

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 337.13it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 342.85it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 345.32it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 342.78it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 344.71it/s][A100%|██████████| 194/194 [00:00<00:00, 344.24it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  76%|███████▌  | 97/128 [2:41:25<53:03, 102.68s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 97, best f1 score : 0.661
training process:  76%|███████▌  | 97/128 [2:42:57<52:04, 100.80s/it]
training process finished, best loss : 0.261 and best acc : 0.952, best f1 : 0.661, best epoch : 57

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.37      0.39      0.38       453
           1       0.98      0.98      0.98     16880

    accuracy                           0.97     17333
   macro avg       0.68      0.69      0.68     17333
weighted avg       0.97      0.97      0.97     17333


# test acc : 0.97, test f1 : 0.68, test AUC : 0.69, test loss : 57.414

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:14<03:44, 14.06s/it]processing for feature importance:  12%|█▏        | 2/17 [00:26<03:16, 13.10s/it]processing for feature importance:  18%|█▊        | 3/17 [00:40<03:07, 13.36s/it]processing for feature importance:  24%|██▎       | 4/17 [00:52<02:50, 13.10s/it]processing for feature importance:  29%|██▉       | 5/17 [01:07<02:45, 13.75s/it]processing for feature importance:  35%|███▌      | 6/17 [01:19<02:25, 13.21s/it]processing for feature importance:  41%|████      | 7/17 [01:32<02:09, 12.99s/it]processing for feature importance:  47%|████▋     | 8/17 [01:45<01:56, 12.94s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:57<01:42, 12.81s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:10<01:30, 12.86s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:24<01:17, 12.97s/it]processing for feature importance:  71%|███████   | 12/17 [02:36<01:04, 12.91s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:50<00:52, 13.10s/it]processing for feature importance:  82%|████████▏ | 14/17 [03:04<00:40, 13.34s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:16<00:26, 13.17s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:29<00:12, 12.98s/it]processing for feature importance: 100%|██████████| 17/17 [03:43<00:00, 13.15s/it]processing for feature importance: 100%|██████████| 17/17 [03:43<00:00, 13.12s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<12:12,  3.47s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<08:51,  2.53s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:04,  1.85s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:26,  1.31s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:15,  3.20s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<06:38,  1.90s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:07,  1.90s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:27,  1.32s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 16%|█▋        | 32/194 [00:00<00:00, 315.60it/s] 35%|███▍      | 67/194 [00:00<00:00, 334.32it/s] 53%|█████▎    | 102/194 [00:00<00:00, 340.11it/s] 71%|███████   | 137/194 [00:00<00:00, 343.34it/s] 89%|████████▊ | 172/194 [00:00<00:00, 344.95it/s]100%|██████████| 194/194 [00:00<00:00, 340.28it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_CE_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 20/616 [00:00<00:03, 191.47it/s]remove invalid data : null / measurement error:   6%|▋         | 40/616 [00:00<00:03, 187.15it/s]remove invalid data : null / measurement error:  10%|▉         | 59/616 [00:00<00:03, 184.95it/s]remove invalid data : null / measurement error:  13%|█▎        | 78/616 [00:00<00:02, 185.86it/s]remove invalid data : null / measurement error:  16%|█▌        | 98/616 [00:00<00:02, 189.04it/s]remove invalid data : null / measurement error:  19%|█▉        | 118/616 [00:00<00:02, 192.07it/s]remove invalid data : null / measurement error:  22%|██▏       | 138/616 [00:00<00:02, 192.94it/s]remove invalid data : null / measurement error:  26%|██▌       | 158/616 [00:00<00:02, 192.91it/s]remove invalid data : null / measurement error:  29%|██▉       | 178/616 [00:00<00:02, 189.38it/s]remove invalid data : null / measurement error:  32%|███▏      | 197/616 [00:01<00:02, 186.68it/s]remove invalid data : null / measurement error:  35%|███▌      | 216/616 [00:01<00:02, 187.64it/s]remove invalid data : null / measurement error:  38%|███▊      | 236/616 [00:01<00:02, 188.50it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 188.53it/s]remove invalid data : null / measurement error:  45%|████▍     | 275/616 [00:01<00:01, 190.09it/s]remove invalid data : null / measurement error:  48%|████▊     | 295/616 [00:01<00:01, 189.72it/s]remove invalid data : null / measurement error:  51%|█████     | 314/616 [00:01<00:01, 188.99it/s]remove invalid data : null / measurement error:  54%|█████▍    | 333/616 [00:01<00:01, 187.63it/s]remove invalid data : null / measurement error:  57%|█████▋    | 352/616 [00:01<00:01, 187.80it/s]remove invalid data : null / measurement error:  61%|██████    | 374/616 [00:01<00:01, 195.97it/s]remove invalid data : null / measurement error:  65%|██████▍   | 399/616 [00:02<00:01, 209.49it/s]remove invalid data : null / measurement error:  69%|██████▉   | 424/616 [00:02<00:00, 219.33it/s]remove invalid data : null / measurement error:  72%|███████▏  | 446/616 [00:02<00:00, 217.12it/s]remove invalid data : null / measurement error:  76%|███████▌  | 468/616 [00:02<00:00, 214.17it/s]remove invalid data : null / measurement error:  80%|███████▉  | 490/616 [00:02<00:00, 208.23it/s]remove invalid data : null / measurement error:  83%|████████▎ | 511/616 [00:02<00:00, 202.33it/s]remove invalid data : null / measurement error:  86%|████████▋ | 532/616 [00:02<00:00, 198.40it/s]remove invalid data : null / measurement error:  90%|████████▉ | 552/616 [00:02<00:00, 194.64it/s]remove invalid data : null / measurement error:  93%|█████████▎| 572/616 [00:02<00:00, 192.46it/s]remove invalid data : null / measurement error:  96%|█████████▌| 592/616 [00:03<00:00, 191.82it/s]remove invalid data : null / measurement error:  99%|█████████▉| 612/616 [00:03<00:00, 191.89it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 194.75it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/515 [00:00<00:02, 225.82it/s]replace nan value:   9%|▉         | 46/515 [00:00<00:02, 225.73it/s]replace nan value:  13%|█▎        | 69/515 [00:00<00:01, 223.31it/s]replace nan value:  18%|█▊        | 93/515 [00:00<00:01, 226.40it/s]replace nan value:  23%|██▎       | 117/515 [00:00<00:01, 227.85it/s]replace nan value:  27%|██▋       | 141/515 [00:00<00:01, 229.20it/s]replace nan value:  32%|███▏      | 165/515 [00:00<00:01, 230.27it/s]replace nan value:  37%|███▋      | 189/515 [00:00<00:01, 230.69it/s]replace nan value:  41%|████▏     | 213/515 [00:00<00:01, 230.90it/s]replace nan value:  46%|████▌     | 237/515 [00:01<00:01, 231.57it/s]replace nan value:  51%|█████     | 261/515 [00:01<00:01, 231.72it/s]replace nan value:  55%|█████▌    | 285/515 [00:01<00:00, 231.55it/s]replace nan value:  60%|██████    | 309/515 [00:01<00:00, 231.54it/s]replace nan value:  65%|██████▍   | 333/515 [00:01<00:00, 231.50it/s]replace nan value:  69%|██████▉   | 357/515 [00:01<00:00, 228.92it/s]replace nan value:  74%|███████▍  | 380/515 [00:01<00:00, 228.30it/s]replace nan value:  78%|███████▊  | 404/515 [00:01<00:00, 229.13it/s]replace nan value:  83%|████████▎ | 428/515 [00:01<00:00, 229.94it/s]replace nan value:  88%|████████▊ | 451/515 [00:01<00:00, 228.68it/s]replace nan value:  92%|█████████▏| 475/515 [00:02<00:00, 229.55it/s]replace nan value:  97%|█████████▋| 499/515 [00:02<00:00, 230.57it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 229.68it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.32it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.02it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.01it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.36it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.92it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 53.94it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 57.02it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.57it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.12it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.04it/s]generate index:  17%|█▋        | 88/515 [00:01<00:07, 60.76it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 60.38it/s]generate index:  20%|█▉        | 102/515 [00:01<00:07, 58.22it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 63.90it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.44it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.04it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 69.58it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 70.76it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 69.79it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.63it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 70.82it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.63it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 69.84it/s]generate index:  37%|███▋      | 192/515 [00:03<00:04, 70.16it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.29it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.37it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 80.71it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 84.98it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.21it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 71.91it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 70.90it/s]generate index:  52%|█████▏    | 267/515 [00:04<00:03, 73.27it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.00it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 60.74it/s]generate index:  57%|█████▋    | 291/515 [00:04<00:03, 62.66it/s]generate index:  58%|█████▊    | 298/515 [00:04<00:03, 60.08it/s]generate index:  59%|█████▉    | 305/515 [00:04<00:03, 61.13it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 62.36it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 58.56it/s]generate index:  63%|██████▎   | 327/515 [00:05<00:03, 62.37it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 56.65it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 47.09it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 44.86it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 41.72it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 56.35it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 70.04it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 73.44it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 70.20it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 71.78it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 60.97it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 62.34it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 73.59it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 53.86it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 46.96it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 57.91it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 62.68it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 55.80it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 65.52it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 63.06it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 60.40it/s]generate index:  99%|█████████▊| 508/515 [00:08<00:00, 67.56it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.82it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 58.64it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 138.36it/s]remove invalid data : null / measurement error:  30%|██▉       | 46/154 [00:00<00:00, 164.29it/s]remove invalid data : null / measurement error:  43%|████▎     | 66/154 [00:00<00:00, 176.19it/s]remove invalid data : null / measurement error:  56%|█████▋    | 87/154 [00:00<00:00, 185.04it/s]remove invalid data : null / measurement error:  71%|███████▏  | 110/154 [00:00<00:00, 197.88it/s]remove invalid data : null / measurement error:  85%|████████▌ | 131/154 [00:00<00:00, 199.11it/s]remove invalid data : null / measurement error:  98%|█████████▊| 151/154 [00:00<00:00, 197.65it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 182.95it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 24/131 [00:00<00:00, 233.26it/s]replace nan value:  37%|███▋      | 48/131 [00:00<00:00, 235.70it/s]replace nan value:  55%|█████▍    | 72/131 [00:00<00:00, 236.25it/s]replace nan value:  73%|███████▎  | 96/131 [00:00<00:00, 234.01it/s]replace nan value:  92%|█████████▏| 120/131 [00:00<00:00, 234.60it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 235.08it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 67.32it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 47.52it/s]generate index:  16%|█▌        | 21/131 [00:00<00:01, 55.57it/s]generate index:  21%|██        | 27/131 [00:00<00:01, 56.48it/s]generate index:  26%|██▌       | 34/131 [00:00<00:01, 59.18it/s]generate index:  32%|███▏      | 42/131 [00:00<00:01, 61.03it/s]generate index:  37%|███▋      | 49/131 [00:00<00:01, 61.64it/s]generate index:  43%|████▎     | 56/131 [00:00<00:01, 61.61it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 63.18it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 63.03it/s]generate index:  59%|█████▉    | 77/131 [00:01<00:00, 64.46it/s]generate index:  64%|██████▍   | 84/131 [00:01<00:00, 64.92it/s]generate index:  69%|██████▉   | 91/131 [00:01<00:00, 44.92it/s]generate index:  74%|███████▍  | 97/131 [00:01<00:00, 47.11it/s]generate index:  79%|███████▊  | 103/131 [00:01<00:00, 45.87it/s]generate index:  83%|████████▎ | 109/131 [00:01<00:00, 48.51it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 58.23it/s]generate index:  98%|█████████▊| 129/131 [00:02<00:00, 71.51it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.11it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 39.34it/s]remove invalid data : null / measurement error:  12%|█▏        | 24/193 [00:00<00:01, 132.72it/s]remove invalid data : null / measurement error:  23%|██▎       | 44/193 [00:00<00:00, 162.13it/s]remove invalid data : null / measurement error:  34%|███▎      | 65/193 [00:00<00:00, 177.90it/s]remove invalid data : null / measurement error:  45%|████▍     | 86/193 [00:00<00:00, 188.31it/s]remove invalid data : null / measurement error:  55%|█████▍    | 106/193 [00:00<00:00, 189.66it/s]remove invalid data : null / measurement error:  67%|██████▋   | 129/193 [00:00<00:00, 201.29it/s]remove invalid data : null / measurement error:  78%|███████▊  | 150/193 [00:00<00:00, 203.51it/s]remove invalid data : null / measurement error:  89%|████████▊ | 171/193 [00:00<00:00, 199.72it/s]remove invalid data : null / measurement error:  99%|█████████▉| 191/193 [00:01<00:00, 197.81it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 185.58it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 24/160 [00:00<00:00, 236.66it/s]replace nan value:  30%|███       | 48/160 [00:00<00:00, 238.19it/s]replace nan value:  45%|████▌     | 72/160 [00:00<00:00, 237.98it/s]replace nan value:  60%|██████    | 96/160 [00:00<00:00, 235.48it/s]replace nan value:  75%|███████▌  | 120/160 [00:00<00:00, 234.29it/s]replace nan value:  90%|█████████ | 144/160 [00:00<00:00, 234.39it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 235.33it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 101.69it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 62.11it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 60.35it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 72.47it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 78.97it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 80.93it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 81.22it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 67.02it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 57.79it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 58.75it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.65it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 48.72it/s]generate index:  73%|███████▎  | 117/160 [00:01<00:00, 57.38it/s]generate index:  78%|███████▊  | 124/160 [00:01<00:00, 59.86it/s]generate index:  82%|████████▏ | 131/160 [00:02<00:00, 54.97it/s]generate index:  86%|████████▌ | 137/160 [00:02<00:00, 51.91it/s]generate index:  91%|█████████ | 145/160 [00:02<00:00, 57.38it/s]generate index:  95%|█████████▌| 152/160 [00:02<00:00, 58.84it/s]generate index:  99%|█████████▉| 159/160 [00:02<00:00, 57.62it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 60.75it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.033, valid loss : 0.031, train acc : 0.582, valid acc : 0.812, train f1 : 0.405, valid f1 : 0.505

  0%|          | 0/194 [00:00<?, ?it/s][A
 19%|█▊        | 36/194 [00:00<00:00, 351.46it/s][A
 37%|███▋      | 72/194 [00:00<00:00, 355.63it/s][A
 56%|█████▌    | 109/194 [00:00<00:00, 358.06it/s][A
 75%|███████▌  | 146/194 [00:00<00:00, 358.88it/s][A
 94%|█████████▍| 182/194 [00:00<00:00, 357.60it/s][A100%|██████████| 194/194 [00:00<00:00, 357.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.505
training process:   1%|          | 1/128 [02:00<4:15:32, 120.73s/it]Best score increase :0.505 -> 0.526
training process:   2%|▏         | 2/128 [03:30<3:35:07, 102.44s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [04:59<3:20:41, 96.33s/it] EarlyStopping counter : 2 out of 40
training process:   3%|▎         | 4/128 [06:29<3:14:18, 94.02s/it]epoch : 5, train loss : 0.023, valid loss : 0.025, train acc : 0.782, valid acc : 0.713, train f1 : 0.519, valid f1 : 0.476

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 345.58it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 346.51it/s][A
 55%|█████▍    | 106/194 [00:00<00:00, 348.92it/s][A
 73%|███████▎  | 142/194 [00:00<00:00, 350.12it/s][A
 92%|█████████▏| 178/194 [00:00<00:00, 350.69it/s][A100%|██████████| 194/194 [00:00<00:00, 349.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:   4%|▍         | 5/128 [08:22<3:26:44, 100.85s/it]EarlyStopping counter : 4 out of 40
training process:   5%|▍         | 6/128 [09:56<3:19:56, 98.33s/it] EarlyStopping counter : 5 out of 40
training process:   5%|▌         | 7/128 [11:29<3:14:42, 96.55s/it]Best score increase :0.526 -> 0.596
training process:   6%|▋         | 8/128 [13:02<3:10:55, 95.46s/it]epoch : 9, train loss : 0.019, valid loss : 0.022, train acc : 0.851, valid acc : 0.789, train f1 : 0.571, valid f1 : 0.522

  0%|          | 0/194 [00:00<?, ?it/s][A
 10%|█         | 20/194 [00:00<00:00, 192.68it/s][A
 24%|██▍       | 47/194 [00:00<00:00, 234.19it/s][A
 39%|███▊      | 75/194 [00:00<00:00, 251.74it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 259.48it/s][A
 67%|██████▋   | 130/194 [00:00<00:00, 262.98it/s][A
 81%|████████▏ | 158/194 [00:00<00:00, 264.95it/s][A
 96%|█████████▌| 186/194 [00:00<00:00, 269.32it/s][A100%|██████████| 194/194 [00:00<00:00, 260.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [15:00<3:23:36, 102.66s/it]EarlyStopping counter : 2 out of 40
training process:   8%|▊         | 10/128 [16:33<3:15:57, 99.64s/it]Best score increase :0.596 -> 0.608
training process:   9%|▊         | 11/128 [18:08<3:11:36, 98.26s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▉         | 12/128 [19:42<3:07:28, 96.97s/it]epoch : 13, train loss : 0.016, valid loss : 0.024, train acc : 0.898, valid acc : 0.774, train f1 : 0.625, valid f1 : 0.511

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 273.38it/s][A
 29%|██▉       | 56/194 [00:00<00:00, 276.47it/s][A
 43%|████▎     | 84/194 [00:00<00:00, 276.09it/s][A
 58%|█████▊    | 112/194 [00:00<00:00, 277.22it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 277.79it/s][A
 87%|████████▋ | 168/194 [00:00<00:00, 277.92it/s][A100%|██████████| 194/194 [00:00<00:00, 277.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  10%|█         | 13/128 [21:43<3:19:31, 104.10s/it]EarlyStopping counter : 3 out of 40
training process:  11%|█         | 14/128 [23:06<3:05:32, 97.65s/it] EarlyStopping counter : 4 out of 40
training process:  12%|█▏        | 15/128 [24:33<2:57:53, 94.45s/it]EarlyStopping counter : 5 out of 40
training process:  12%|█▎        | 16/128 [25:55<2:49:45, 90.94s/it]epoch : 17, train loss : 0.014, valid loss : 0.031, train acc : 0.903, valid acc : 0.906, train f1 : 0.635, valid f1 : 0.608

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 337.32it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 343.36it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 345.50it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 346.57it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 347.10it/s][A100%|██████████| 194/194 [00:00<00:00, 346.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  13%|█▎        | 17/128 [27:42<2:56:57, 95.66s/it]EarlyStopping counter : 7 out of 40
training process:  14%|█▍        | 18/128 [29:08<2:50:09, 92.82s/it]EarlyStopping counter : 8 out of 40
training process:  15%|█▍        | 19/128 [30:36<2:45:49, 91.28s/it]EarlyStopping counter : 9 out of 40
training process:  16%|█▌        | 20/128 [32:02<2:41:25, 89.68s/it]epoch : 21, train loss : 0.012, valid loss : 0.031, train acc : 0.924, valid acc : 0.891, train f1 : 0.671, valid f1 : 0.591

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 348.80it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 351.54it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 352.61it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 353.06it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 352.98it/s][A100%|██████████| 194/194 [00:00<00:00, 352.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  16%|█▋        | 21/128 [33:54<2:52:01, 96.47s/it]EarlyStopping counter : 11 out of 40
training process:  17%|█▋        | 22/128 [35:22<2:45:59, 93.96s/it]EarlyStopping counter : 12 out of 40
training process:  18%|█▊        | 23/128 [36:52<2:42:06, 92.64s/it]EarlyStopping counter : 13 out of 40
training process:  19%|█▉        | 24/128 [38:21<2:38:35, 91.49s/it]epoch : 25, train loss : 0.012, valid loss : 0.033, train acc : 0.931, valid acc : 0.914, train f1 : 0.684, valid f1 : 0.619

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 273.60it/s][A
 29%|██▉       | 56/194 [00:00<00:00, 276.64it/s][A
 43%|████▎     | 84/194 [00:00<00:00, 277.64it/s][A
 58%|█████▊    | 112/194 [00:00<00:00, 277.85it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 278.27it/s][A
 87%|████████▋ | 168/194 [00:00<00:00, 278.45it/s][A100%|██████████| 194/194 [00:00<00:00, 278.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.608 -> 0.619
training process:  20%|█▉        | 25/128 [40:14<2:48:16, 98.02s/it]EarlyStopping counter : 1 out of 40
training process:  20%|██        | 26/128 [41:45<2:43:20, 96.08s/it]EarlyStopping counter : 2 out of 40
training process:  21%|██        | 27/128 [43:17<2:39:10, 94.56s/it]Best score increase :0.619 -> 0.623
training process:  22%|██▏       | 28/128 [44:46<2:35:10, 93.10s/it]epoch : 29, train loss : 0.010, valid loss : 0.040, train acc : 0.948, valid acc : 0.903, train f1 : 0.725, valid f1 : 0.602

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 341.09it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 344.56it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 345.28it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 345.59it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 344.25it/s][A100%|██████████| 194/194 [00:00<00:00, 344.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  23%|██▎       | 29/128 [46:40<2:43:50, 99.30s/it]EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 30/128 [48:11<2:37:59, 96.73s/it]EarlyStopping counter : 3 out of 40
training process:  24%|██▍       | 31/128 [49:42<2:33:41, 95.07s/it]EarlyStopping counter : 4 out of 40
training process:  25%|██▌       | 32/128 [51:14<2:30:35, 94.12s/it]epoch : 33, train loss : 0.010, valid loss : 0.034, train acc : 0.949, valid acc : 0.930, train f1 : 0.729, valid f1 : 0.648

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 265.20it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 271.92it/s][A
 43%|████▎     | 84/194 [00:00<00:00, 276.66it/s][A
 58%|█████▊    | 113/194 [00:00<00:00, 278.51it/s][A
 73%|███████▎  | 141/194 [00:00<00:00, 278.23it/s][A
 88%|████████▊ | 170/194 [00:00<00:00, 279.48it/s][A100%|██████████| 194/194 [00:00<00:00, 278.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.623 -> 0.648
training process:  26%|██▌       | 33/128 [53:11<2:39:50, 100.95s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [54:37<2:31:21, 96.61s/it] EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [56:08<2:27:04, 94.88s/it]EarlyStopping counter : 3 out of 40
training process:  28%|██▊       | 36/128 [57:37<2:22:37, 93.02s/it]epoch : 37, train loss : 0.009, valid loss : 0.045, train acc : 0.956, valid acc : 0.923, train f1 : 0.750, valid f1 : 0.628

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 273.31it/s][A
 29%|██▉       | 56/194 [00:00<00:00, 276.58it/s][A
 43%|████▎     | 84/194 [00:00<00:00, 277.91it/s][A
 58%|█████▊    | 112/194 [00:00<00:00, 278.59it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 278.96it/s][A
 87%|████████▋ | 168/194 [00:00<00:00, 277.66it/s][A100%|██████████| 194/194 [00:00<00:00, 277.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  29%|██▉       | 37/128 [59:32<2:31:20, 99.79s/it]EarlyStopping counter : 5 out of 40
training process:  30%|██▉       | 38/128 [1:01:00<2:24:28, 96.32s/it]EarlyStopping counter : 6 out of 40
training process:  30%|███       | 39/128 [1:02:32<2:20:38, 94.82s/it]EarlyStopping counter : 7 out of 40
training process:  31%|███▏      | 40/128 [1:04:02<2:16:56, 93.37s/it]epoch : 41, train loss : 0.008, valid loss : 0.049, train acc : 0.961, valid acc : 0.927, train f1 : 0.768, valid f1 : 0.632

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 333.84it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 339.26it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 341.09it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 342.34it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 341.86it/s][A100%|██████████| 194/194 [00:00<00:00, 341.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  32%|███▏      | 41/128 [1:05:58<2:25:19, 100.22s/it]EarlyStopping counter : 9 out of 40
training process:  33%|███▎      | 42/128 [1:07:27<2:19:00, 96.98s/it] Best score increase :0.648 -> 0.661
training process:  34%|███▎      | 43/128 [1:08:57<2:14:02, 94.62s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▍      | 44/128 [1:10:25<2:09:58, 92.84s/it]epoch : 45, train loss : 0.008, valid loss : 0.053, train acc : 0.966, valid acc : 0.915, train f1 : 0.787, valid f1 : 0.612

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 328.98it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 336.10it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 278.96it/s][A
 68%|██████▊   | 131/194 [00:00<00:00, 256.12it/s][A
 82%|████████▏ | 159/194 [00:00<00:00, 260.70it/s][A
 96%|█████████▌| 186/194 [00:00<00:00, 262.01it/s][A100%|██████████| 194/194 [00:00<00:00, 271.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  35%|███▌      | 45/128 [1:12:18<2:16:40, 98.80s/it]EarlyStopping counter : 3 out of 40
training process:  36%|███▌      | 46/128 [1:13:47<2:10:58, 95.84s/it]EarlyStopping counter : 4 out of 40
training process:  37%|███▋      | 47/128 [1:15:15<2:06:05, 93.40s/it]EarlyStopping counter : 5 out of 40
training process:  38%|███▊      | 48/128 [1:16:44<2:02:55, 92.19s/it]epoch : 49, train loss : 0.006, valid loss : 0.056, train acc : 0.969, valid acc : 0.914, train f1 : 0.802, valid f1 : 0.609

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 340.56it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 340.19it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 344.45it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 346.18it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 347.42it/s][A100%|██████████| 194/194 [00:00<00:00, 345.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  38%|███▊      | 49/128 [1:18:37<2:09:43, 98.53s/it]EarlyStopping counter : 7 out of 40
training process:  39%|███▉      | 50/128 [1:20:09<2:05:16, 96.36s/it]EarlyStopping counter : 8 out of 40
training process:  40%|███▉      | 51/128 [1:21:40<2:01:55, 95.00s/it]EarlyStopping counter : 9 out of 40
training process:  41%|████      | 52/128 [1:23:13<1:59:32, 94.37s/it]epoch : 53, train loss : 0.006, valid loss : 0.060, train acc : 0.970, valid acc : 0.935, train f1 : 0.804, valid f1 : 0.641

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 341.02it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 342.46it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 344.78it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 345.90it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 346.60it/s][A100%|██████████| 194/194 [00:00<00:00, 345.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  41%|████▏     | 53/128 [1:25:13<2:07:33, 102.05s/it]EarlyStopping counter : 11 out of 40
training process:  42%|████▏     | 54/128 [1:26:44<2:01:32, 98.54s/it] EarlyStopping counter : 12 out of 40
training process:  43%|████▎     | 55/128 [1:28:13<1:56:35, 95.83s/it]EarlyStopping counter : 13 out of 40
training process:  44%|████▍     | 56/128 [1:29:44<1:53:22, 94.48s/it]epoch : 57, train loss : 0.006, valid loss : 0.065, train acc : 0.974, valid acc : 0.933, train f1 : 0.821, valid f1 : 0.629

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 341.57it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 347.19it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 349.35it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 350.15it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 350.78it/s][A100%|██████████| 194/194 [00:00<00:00, 349.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  45%|████▍     | 57/128 [1:31:40<1:59:17, 100.81s/it]EarlyStopping counter : 15 out of 40
training process:  45%|████▌     | 58/128 [1:33:07<1:52:46, 96.67s/it] EarlyStopping counter : 16 out of 40
training process:  46%|████▌     | 59/128 [1:34:37<1:48:41, 94.52s/it]EarlyStopping counter : 17 out of 40
training process:  47%|████▋     | 60/128 [1:36:07<1:45:45, 93.31s/it]epoch : 61, train loss : 0.006, valid loss : 0.068, train acc : 0.976, valid acc : 0.944, train f1 : 0.831, valid f1 : 0.650

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 328.94it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 337.80it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 336.62it/s][A
 71%|███████   | 137/194 [00:00<00:00, 339.56it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 338.64it/s][A100%|██████████| 194/194 [00:00<00:00, 338.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  48%|████▊     | 61/128 [1:38:02<1:51:21, 99.73s/it]EarlyStopping counter : 19 out of 40
training process:  48%|████▊     | 62/128 [1:39:31<1:46:17, 96.63s/it]EarlyStopping counter : 20 out of 40
training process:  49%|████▉     | 63/128 [1:41:01<1:42:28, 94.60s/it]EarlyStopping counter : 21 out of 40
training process:  50%|█████     | 64/128 [1:42:31<1:39:31, 93.30s/it]epoch : 65, train loss : 0.005, valid loss : 0.076, train acc : 0.979, valid acc : 0.907, train f1 : 0.847, valid f1 : 0.594

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 323.90it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 338.66it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 344.01it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 346.82it/s][A
 91%|█████████ | 176/194 [00:00<00:00, 348.01it/s][A100%|██████████| 194/194 [00:00<00:00, 345.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  51%|█████     | 65/128 [1:44:25<1:44:22, 99.41s/it]EarlyStopping counter : 23 out of 40
training process:  52%|█████▏    | 66/128 [1:45:56<1:40:07, 96.89s/it]EarlyStopping counter : 24 out of 40
training process:  52%|█████▏    | 67/128 [1:47:26<1:36:33, 94.98s/it]EarlyStopping counter : 25 out of 40
training process:  53%|█████▎    | 68/128 [1:48:55<1:33:06, 93.10s/it]epoch : 69, train loss : 0.006, valid loss : 0.066, train acc : 0.980, valid acc : 0.919, train f1 : 0.851, valid f1 : 0.614

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 26/194 [00:00<00:00, 259.79it/s][A
 28%|██▊       | 54/194 [00:00<00:00, 270.01it/s][A
 42%|████▏     | 82/194 [00:00<00:00, 273.87it/s][A
 57%|█████▋    | 110/194 [00:00<00:00, 275.51it/s][A
 71%|███████   | 138/194 [00:00<00:00, 276.40it/s][A
 86%|████████▌ | 166/194 [00:00<00:00, 277.01it/s][A
100%|██████████| 194/194 [00:00<00:00, 277.42it/s][A100%|██████████| 194/194 [00:00<00:00, 275.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  54%|█████▍    | 69/128 [1:50:51<1:38:16, 99.95s/it]EarlyStopping counter : 27 out of 40
training process:  55%|█████▍    | 70/128 [1:52:22<1:33:56, 97.18s/it]EarlyStopping counter : 28 out of 40
training process:  55%|█████▌    | 71/128 [1:53:47<1:28:59, 93.68s/it]EarlyStopping counter : 29 out of 40
training process:  56%|█████▋    | 72/128 [1:55:18<1:26:30, 92.70s/it]epoch : 73, train loss : 0.005, valid loss : 0.079, train acc : 0.981, valid acc : 0.928, train f1 : 0.859, valid f1 : 0.619

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 326.59it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 337.36it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 340.84it/s][A
 71%|███████   | 138/194 [00:00<00:00, 339.34it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 341.31it/s][A100%|██████████| 194/194 [00:00<00:00, 340.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  57%|█████▋    | 73/128 [1:57:10<1:30:28, 98.69s/it]EarlyStopping counter : 31 out of 40
training process:  58%|█████▊    | 74/128 [1:58:38<1:25:41, 95.21s/it]EarlyStopping counter : 32 out of 40
training process:  59%|█████▊    | 75/128 [2:00:07<1:22:37, 93.55s/it]EarlyStopping counter : 33 out of 40
training process:  59%|█████▉    | 76/128 [2:01:36<1:19:53, 92.19s/it]epoch : 77, train loss : 0.005, valid loss : 0.083, train acc : 0.983, valid acc : 0.923, train f1 : 0.871, valid f1 : 0.610

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 327.16it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 338.24it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 342.46it/s][A
 71%|███████   | 138/194 [00:00<00:00, 344.64it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 345.75it/s][A100%|██████████| 194/194 [00:00<00:00, 343.64it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 34 out of 40
training process:  60%|██████    | 77/128 [2:03:28<1:23:26, 98.17s/it]EarlyStopping counter : 35 out of 40
training process:  61%|██████    | 78/128 [2:04:57<1:19:21, 95.23s/it]EarlyStopping counter : 36 out of 40
training process:  62%|██████▏   | 79/128 [2:06:26<1:16:14, 93.35s/it]EarlyStopping counter : 37 out of 40
training process:  62%|██████▎   | 80/128 [2:07:52<1:13:01, 91.29s/it]epoch : 81, train loss : 0.004, valid loss : 0.092, train acc : 0.984, valid acc : 0.922, train f1 : 0.879, valid f1 : 0.609

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 334.04it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 339.76it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 341.31it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 342.13it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 343.19it/s][A100%|██████████| 194/194 [00:00<00:00, 342.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 38 out of 40
training process:  63%|██████▎   | 81/128 [2:09:48<1:17:10, 98.52s/it]EarlyStopping counter : 39 out of 40
training process:  64%|██████▍   | 82/128 [2:11:19<1:13:56, 96.45s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 82, best f1 score : 0.661
training process:  64%|██████▍   | 82/128 [2:12:47<1:14:29, 97.16s/it]
training process finished, best loss : 0.057 and best acc : 0.948, best f1 : 0.661, best epoch : 42

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.29      0.48      0.36       453
           1       0.99      0.97      0.98     16880

    accuracy                           0.96     17333
   macro avg       0.64      0.73      0.67     17333
weighted avg       0.97      0.96      0.96     17333


# test acc : 0.96, test f1 : 0.67, test AUC : 0.73, test loss : 19.092

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:01, 11.37s/it]processing for feature importance:  12%|█▏        | 2/17 [00:23<02:55, 11.68s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:41, 11.53s/it]processing for feature importance:  24%|██▎       | 4/17 [00:45<02:27, 11.33s/it]processing for feature importance:  29%|██▉       | 5/17 [00:56<02:14, 11.22s/it]processing for feature importance:  35%|███▌      | 6/17 [01:08<02:04, 11.32s/it]processing for feature importance:  41%|████      | 7/17 [01:19<01:52, 11.23s/it]processing for feature importance:  47%|████▋     | 8/17 [01:30<01:41, 11.25s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:41<01:30, 11.29s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:53<01:20, 11.43s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:04<01:07, 11.27s/it]processing for feature importance:  71%|███████   | 12/17 [02:16<00:56, 11.34s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:26<00:44, 11.14s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:40<00:35, 11.81s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:51<00:23, 11.65s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:02<00:11, 11.59s/it]processing for feature importance: 100%|██████████| 17/17 [03:14<00:00, 11.51s/it]processing for feature importance: 100%|██████████| 17/17 [03:14<00:00, 11.42s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<12:45,  3.63s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<05:43,  1.64s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<09:34,  2.73s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:08,  1.92s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:03<01:42,  1.55s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<12:26,  3.54s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<08:57,  2.56s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:12,  1.98s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:32,  1.40s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 13%|█▎        | 26/194 [00:00<00:00, 253.32it/s] 28%|██▊       | 54/194 [00:00<00:00, 266.24it/s] 42%|████▏     | 81/194 [00:00<00:00, 264.09it/s] 56%|█████▌    | 108/194 [00:00<00:00, 264.92it/s] 70%|███████   | 136/194 [00:00<00:00, 270.00it/s] 85%|████████▍ | 164/194 [00:00<00:00, 273.34it/s] 99%|█████████▉| 192/194 [00:00<00:00, 275.23it/s]100%|██████████| 194/194 [00:00<00:00, 270.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_CE_smoothing_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 201.02it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 199.20it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 197.34it/s]remove invalid data : null / measurement error:  13%|█▎        | 83/616 [00:00<00:02, 199.75it/s]remove invalid data : null / measurement error:  17%|█▋        | 104/616 [00:00<00:02, 201.70it/s]remove invalid data : null / measurement error:  20%|██        | 125/616 [00:00<00:02, 197.47it/s]remove invalid data : null / measurement error:  24%|██▎       | 145/616 [00:00<00:02, 193.78it/s]remove invalid data : null / measurement error:  27%|██▋       | 165/616 [00:00<00:02, 195.53it/s]remove invalid data : null / measurement error:  30%|███       | 185/616 [00:00<00:02, 192.81it/s]remove invalid data : null / measurement error:  33%|███▎      | 205/616 [00:01<00:02, 190.92it/s]remove invalid data : null / measurement error:  37%|███▋      | 225/616 [00:01<00:02, 190.27it/s]remove invalid data : null / measurement error:  40%|███▉      | 245/616 [00:01<00:01, 190.94it/s]remove invalid data : null / measurement error:  43%|████▎     | 265/616 [00:01<00:01, 193.09it/s]remove invalid data : null / measurement error:  46%|████▋     | 285/616 [00:01<00:01, 192.79it/s]remove invalid data : null / measurement error:  50%|████▉     | 305/616 [00:01<00:01, 175.99it/s]remove invalid data : null / measurement error:  53%|█████▎    | 324/616 [00:01<00:01, 179.50it/s]remove invalid data : null / measurement error:  56%|█████▌    | 343/616 [00:01<00:01, 181.93it/s]remove invalid data : null / measurement error:  59%|█████▉    | 363/616 [00:01<00:01, 185.67it/s]remove invalid data : null / measurement error:  63%|██████▎   | 387/616 [00:02<00:01, 199.40it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:02<00:00, 215.20it/s]remove invalid data : null / measurement error:  71%|███████   | 435/616 [00:02<00:00, 212.55it/s]remove invalid data : null / measurement error:  74%|███████▍  | 458/616 [00:02<00:00, 216.71it/s]remove invalid data : null / measurement error:  78%|███████▊  | 480/616 [00:02<00:00, 208.79it/s]remove invalid data : null / measurement error:  81%|████████▏ | 501/616 [00:02<00:00, 202.23it/s]remove invalid data : null / measurement error:  85%|████████▍ | 522/616 [00:02<00:00, 198.64it/s]remove invalid data : null / measurement error:  88%|████████▊ | 542/616 [00:02<00:00, 194.39it/s]remove invalid data : null / measurement error:  91%|█████████ | 562/616 [00:02<00:00, 192.41it/s]remove invalid data : null / measurement error:  94%|█████████▍| 582/616 [00:02<00:00, 181.76it/s]remove invalid data : null / measurement error:  98%|█████████▊| 601/616 [00:03<00:00, 167.37it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:03<00:00, 191.85it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 232.80it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:02, 232.74it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 228.04it/s]replace nan value:  19%|█▊        | 96/515 [00:00<00:01, 231.35it/s]replace nan value:  23%|██▎       | 120/515 [00:00<00:01, 222.57it/s]replace nan value:  28%|██▊       | 143/515 [00:00<00:01, 223.04it/s]replace nan value:  32%|███▏      | 167/515 [00:00<00:01, 227.49it/s]replace nan value:  37%|███▋      | 191/515 [00:00<00:01, 230.23it/s]replace nan value:  42%|████▏     | 215/515 [00:00<00:01, 232.03it/s]replace nan value:  46%|████▋     | 239/515 [00:01<00:01, 233.55it/s]replace nan value:  51%|█████     | 263/515 [00:01<00:01, 234.87it/s]replace nan value:  56%|█████▌    | 287/515 [00:01<00:00, 235.66it/s]replace nan value:  61%|██████    | 312/515 [00:01<00:00, 237.34it/s]replace nan value:  65%|██████▌   | 336/515 [00:01<00:00, 237.65it/s]replace nan value:  70%|██████▉   | 360/515 [00:01<00:00, 236.71it/s]replace nan value:  75%|███████▍  | 385/515 [00:01<00:00, 239.02it/s]replace nan value:  79%|███████▉  | 409/515 [00:01<00:00, 239.24it/s]replace nan value:  84%|████████▍ | 434/515 [00:01<00:00, 239.41it/s]replace nan value:  89%|████████▉ | 458/515 [00:01<00:00, 238.71it/s]replace nan value:  94%|█████████▎| 482/515 [00:02<00:00, 238.54it/s]replace nan value:  98%|█████████▊| 506/515 [00:02<00:00, 237.70it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 234.22it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.24it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 54.87it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.54it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 70.96it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 70.72it/s]generate index:  10%|▉         | 49/515 [00:00<00:10, 45.04it/s]generate index:  11%|█         | 56/515 [00:01<00:09, 49.80it/s]generate index:  12%|█▏        | 62/515 [00:01<00:10, 42.72it/s]generate index:  14%|█▎        | 70/515 [00:01<00:08, 50.12it/s]generate index:  15%|█▍        | 76/515 [00:01<00:08, 51.31it/s]generate index:  17%|█▋        | 85/515 [00:01<00:07, 60.46it/s]generate index:  18%|█▊        | 92/515 [00:01<00:08, 49.54it/s]generate index:  19%|█▉        | 98/515 [00:01<00:09, 46.03it/s]generate index:  21%|██        | 106/515 [00:02<00:07, 52.78it/s]generate index:  23%|██▎       | 116/515 [00:02<00:06, 61.44it/s]generate index:  24%|██▍       | 123/515 [00:02<00:06, 60.94it/s]generate index:  26%|██▌       | 132/515 [00:02<00:05, 65.83it/s]generate index:  27%|██▋       | 140/515 [00:02<00:05, 66.04it/s]generate index:  29%|██▊       | 147/515 [00:02<00:05, 65.63it/s]generate index:  30%|███       | 155/515 [00:02<00:05, 69.37it/s]generate index:  32%|███▏      | 164/515 [00:02<00:04, 71.54it/s]generate index:  33%|███▎      | 172/515 [00:02<00:05, 66.91it/s]generate index:  35%|███▍      | 179/515 [00:03<00:05, 65.90it/s]generate index:  37%|███▋      | 188/515 [00:03<00:04, 68.95it/s]generate index:  38%|███▊      | 195/515 [00:03<00:04, 67.01it/s]generate index:  39%|███▉      | 202/515 [00:03<00:05, 59.78it/s]generate index:  42%|████▏     | 214/515 [00:03<00:04, 74.58it/s]generate index:  43%|████▎     | 223/515 [00:03<00:03, 75.38it/s]generate index:  45%|████▍     | 231/515 [00:03<00:03, 71.04it/s]generate index:  46%|████▋     | 239/515 [00:03<00:04, 68.56it/s]generate index:  48%|████▊     | 247/515 [00:04<00:03, 70.75it/s]generate index:  50%|████▉     | 255/515 [00:04<00:04, 60.44it/s]generate index:  52%|█████▏    | 266/515 [00:04<00:03, 71.12it/s]generate index:  53%|█████▎    | 275/515 [00:04<00:03, 75.48it/s]generate index:  55%|█████▍    | 283/515 [00:04<00:04, 54.31it/s]generate index:  56%|█████▋    | 290/515 [00:04<00:03, 57.23it/s]generate index:  58%|█████▊    | 297/515 [00:04<00:03, 58.67it/s]generate index:  59%|█████▉    | 304/515 [00:04<00:03, 59.19it/s]generate index:  61%|██████    | 312/515 [00:05<00:03, 61.19it/s]generate index:  62%|██████▏   | 319/515 [00:05<00:03, 58.55it/s]generate index:  63%|██████▎   | 327/515 [00:05<00:02, 63.02it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 55.85it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 47.18it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 45.35it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 42.45it/s]generate index:  70%|███████   | 363/515 [00:06<00:02, 57.07it/s]generate index:  73%|███████▎  | 375/515 [00:06<00:01, 70.76it/s]generate index:  75%|███████▍  | 384/515 [00:06<00:01, 74.26it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 71.17it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 72.84it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 61.95it/s]generate index:  81%|████████  | 416/515 [00:06<00:01, 62.48it/s]generate index:  82%|████████▏ | 424/515 [00:06<00:01, 64.50it/s]generate index:  84%|████████▎ | 431/515 [00:07<00:01, 60.50it/s]generate index:  85%|████████▌ | 438/515 [00:07<00:01, 46.43it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 43.42it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 56.28it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 61.52it/s]generate index:  91%|█████████▏| 471/515 [00:07<00:00, 53.78it/s]generate index:  93%|█████████▎| 480/515 [00:08<00:00, 61.65it/s]generate index:  95%|█████████▍| 488/515 [00:08<00:00, 64.17it/s]generate index:  96%|█████████▌| 495/515 [00:08<00:00, 62.18it/s]generate index:  97%|█████████▋| 502/515 [00:08<00:00, 56.71it/s]generate index:  99%|█████████▉| 509/515 [00:08<00:00, 57.17it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 52.36it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 59.53it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 59.14it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 139.52it/s]remove invalid data : null / measurement error:  30%|██▉       | 46/154 [00:00<00:00, 165.66it/s]remove invalid data : null / measurement error:  43%|████▎     | 66/154 [00:00<00:00, 177.41it/s]remove invalid data : null / measurement error:  56%|█████▋    | 87/154 [00:00<00:00, 186.24it/s]remove invalid data : null / measurement error:  71%|███████▏  | 110/154 [00:00<00:00, 198.76it/s]remove invalid data : null / measurement error:  84%|████████▍ | 130/154 [00:00<00:00, 199.15it/s]remove invalid data : null / measurement error:  97%|█████████▋| 150/154 [00:00<00:00, 197.21it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 183.36it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 24/131 [00:00<00:00, 230.25it/s]replace nan value:  37%|███▋      | 48/131 [00:00<00:00, 232.87it/s]replace nan value:  55%|█████▍    | 72/131 [00:00<00:00, 233.49it/s]replace nan value:  73%|███████▎  | 96/131 [00:00<00:00, 228.13it/s]replace nan value:  91%|█████████ | 119/131 [00:00<00:00, 214.53it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 223.81it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.91it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 50.20it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 55.41it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 61.58it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 63.58it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.33it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 52.59it/s]generate index:  44%|████▎     | 57/131 [00:01<00:01, 52.38it/s]generate index:  50%|████▉     | 65/131 [00:01<00:01, 57.99it/s]generate index:  55%|█████▍    | 72/131 [00:01<00:00, 60.56it/s]generate index:  60%|██████    | 79/131 [00:01<00:00, 59.06it/s]generate index:  66%|██████▌   | 86/131 [00:01<00:00, 55.92it/s]generate index:  70%|███████   | 92/131 [00:01<00:00, 44.68it/s]generate index:  75%|███████▍  | 98/131 [00:01<00:00, 47.39it/s]generate index:  79%|███████▉  | 104/131 [00:01<00:00, 46.21it/s]generate index:  85%|████████▍ | 111/131 [00:02<00:00, 50.99it/s]generate index:  92%|█████████▏| 120/131 [00:02<00:00, 60.17it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 69.77it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 57.35it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 8/193 [00:00<00:02, 79.44it/s]remove invalid data : null / measurement error:  15%|█▌        | 29/193 [00:00<00:01, 154.92it/s]remove invalid data : null / measurement error:  26%|██▌       | 50/193 [00:00<00:00, 178.47it/s]remove invalid data : null / measurement error:  37%|███▋      | 72/193 [00:00<00:00, 192.80it/s]remove invalid data : null / measurement error:  48%|████▊     | 93/193 [00:00<00:00, 197.40it/s]remove invalid data : null / measurement error:  59%|█████▊    | 113/193 [00:00<00:00, 197.80it/s]remove invalid data : null / measurement error:  69%|██████▉   | 133/193 [00:00<00:00, 191.59it/s]remove invalid data : null / measurement error:  79%|███████▉  | 153/193 [00:00<00:00, 180.10it/s]remove invalid data : null / measurement error:  90%|████████▉ | 173/193 [00:00<00:00, 185.68it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 184.72it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 247.14it/s]replace nan value:  32%|███▏      | 51/160 [00:00<00:00, 249.40it/s]replace nan value:  48%|████▊     | 76/160 [00:00<00:00, 249.00it/s]replace nan value:  63%|██████▎   | 101/160 [00:00<00:00, 245.43it/s]replace nan value:  79%|███████▉  | 126/160 [00:00<00:00, 242.47it/s]replace nan value:  94%|█████████▍| 151/160 [00:00<00:00, 200.49it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 220.35it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 98.49it/s]generate index:  13%|█▎        | 21/160 [00:00<00:02, 61.33it/s]generate index:  18%|█▊        | 28/160 [00:00<00:02, 58.24it/s]generate index:  24%|██▍       | 38/160 [00:00<00:01, 69.88it/s]generate index:  29%|██▉       | 47/160 [00:00<00:01, 74.61it/s]generate index:  36%|███▌      | 57/160 [00:00<00:01, 80.83it/s]generate index:  41%|████▏     | 66/160 [00:00<00:01, 81.03it/s]generate index:  47%|████▋     | 75/160 [00:01<00:01, 73.86it/s]generate index:  52%|█████▏    | 83/160 [00:01<00:01, 60.41it/s]generate index:  56%|█████▋    | 90/160 [00:01<00:01, 48.76it/s]generate index:  60%|██████    | 96/160 [00:01<00:01, 47.90it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 45.21it/s]generate index:  67%|██████▋   | 107/160 [00:01<00:01, 43.34it/s]generate index:  71%|███████   | 113/160 [00:01<00:01, 44.02it/s]generate index:  76%|███████▌  | 121/160 [00:02<00:00, 50.27it/s]generate index:  79%|███████▉  | 127/160 [00:02<00:00, 48.59it/s]generate index:  84%|████████▍ | 134/160 [00:02<00:00, 52.02it/s]generate index:  88%|████████▊ | 140/160 [00:02<00:00, 50.74it/s]generate index:  92%|█████████▎| 148/160 [00:02<00:00, 57.07it/s]generate index:  97%|█████████▋| 155/160 [00:02<00:00, 56.71it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 56.87it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.176, valid loss : 0.061, train acc : 0.951, valid acc : 0.975, train f1 : 0.506, valid f1 : 0.494

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 334.58it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 347.09it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 345.96it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 346.40it/s][A
 91%|█████████ | 176/194 [00:00<00:00, 349.69it/s][A100%|██████████| 194/194 [00:00<00:00, 348.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.494
training process:   1%|          | 1/128 [02:00<4:14:24, 120.19s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:28<3:32:42, 101.29s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:55<3:17:19, 94.72s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:27<3:13:38, 93.70s/it]epoch : 5, train loss : 0.013, valid loss : 0.012, train acc : 0.973, valid acc : 0.975, train f1 : 0.502, valid f1 : 0.501

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 262.78it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 268.19it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 269.97it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 270.96it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 268.88it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 270.90it/s][A100%|██████████| 194/194 [00:00<00:00, 270.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.494 -> 0.501
training process:   4%|▍         | 5/128 [08:23<3:28:53, 101.89s/it]Best score increase :0.501 -> 0.530
training process:   5%|▍         | 6/128 [09:51<3:17:36, 97.18s/it] Best score increase :0.530 -> 0.531
training process:   5%|▌         | 7/128 [11:22<3:11:44, 95.08s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:51<3:06:24, 93.20s/it]epoch : 9, train loss : -0.079, valid loss : -0.071, train acc : 0.974, valid acc : 0.971, train f1 : 0.573, valid f1 : 0.616

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 330.45it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.44it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 337.19it/s][A
 70%|███████   | 136/194 [00:00<00:00, 338.13it/s][A
 88%|████████▊ | 170/194 [00:00<00:00, 338.66it/s][A100%|██████████| 194/194 [00:00<00:00, 336.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.531 -> 0.616
training process:   7%|▋         | 9/128 [14:47<3:18:49, 100.25s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:14<3:09:26, 96.32s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [17:44<3:03:42, 94.21s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▉         | 12/128 [19:12<2:58:42, 92.44s/it]epoch : 13, train loss : -0.218, valid loss : -0.209, train acc : 0.973, valid acc : 0.975, train f1 : 0.635, valid f1 : 0.547

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 334.76it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 331.74it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 335.84it/s][A
 71%|███████   | 137/194 [00:00<00:00, 337.28it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 338.32it/s][A100%|██████████| 194/194 [00:00<00:00, 337.15it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  10%|█         | 13/128 [21:06<3:09:49, 99.04s/it]EarlyStopping counter : 5 out of 40
training process:  11%|█         | 14/128 [22:36<3:02:40, 96.15s/it]EarlyStopping counter : 6 out of 40
training process:  12%|█▏        | 15/128 [24:05<2:57:12, 94.09s/it]Best score increase :0.616 -> 0.647
training process:  12%|█▎        | 16/128 [25:34<2:52:21, 92.33s/it]epoch : 17, train loss : -0.418, valid loss : -0.445, train acc : 0.973, valid acc : 0.975, train f1 : 0.663, valid f1 : 0.602

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 267.38it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 272.65it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 274.63it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 275.61it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 276.00it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 276.25it/s][A100%|██████████| 194/194 [00:00<00:00, 275.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [27:25<3:01:43, 98.23s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [28:53<2:54:04, 94.95s/it]Best score increase :0.647 -> 0.664
training process:  15%|█▍        | 19/128 [30:22<2:49:20, 93.22s/it]EarlyStopping counter : 1 out of 40
training process:  16%|█▌        | 20/128 [31:57<2:48:48, 93.79s/it]epoch : 21, train loss : -0.659, valid loss : -0.671, train acc : 0.970, valid acc : 0.964, train f1 : 0.682, valid f1 : 0.661

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 322.07it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 333.68it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 337.52it/s][A
 71%|███████   | 138/194 [00:00<00:00, 339.86it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 341.06it/s][A100%|██████████| 194/194 [00:00<00:00, 338.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  16%|█▋        | 21/128 [33:51<2:57:48, 99.71s/it]EarlyStopping counter : 3 out of 40
training process:  17%|█▋        | 22/128 [35:18<2:49:33, 95.97s/it]Best score increase :0.664 -> 0.674
training process:  18%|█▊        | 23/128 [36:46<2:44:04, 93.76s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [38:19<2:41:38, 93.26s/it]epoch : 25, train loss : -0.933, valid loss : -0.916, train acc : 0.967, valid acc : 0.974, train f1 : 0.692, valid f1 : 0.632

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 324.00it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 329.56it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 327.53it/s][A
 69%|██████▊   | 133/194 [00:00<00:00, 327.41it/s][A
 86%|████████▌ | 166/194 [00:00<00:00, 324.52it/s][A100%|██████████| 194/194 [00:00<00:00, 326.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  20%|█▉        | 25/128 [40:12<2:50:24, 99.26s/it]EarlyStopping counter : 3 out of 40
training process:  20%|██        | 26/128 [41:41<2:43:25, 96.13s/it]EarlyStopping counter : 4 out of 40
training process:  21%|██        | 27/128 [43:11<2:38:43, 94.30s/it]EarlyStopping counter : 5 out of 40
training process:  22%|██▏       | 28/128 [44:39<2:34:23, 92.64s/it]epoch : 29, train loss : -1.219, valid loss : -1.106, train acc : 0.969, valid acc : 0.974, train f1 : 0.692, valid f1 : 0.660

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 273.07it/s][A
 29%|██▉       | 56/194 [00:00<00:00, 275.35it/s][A
 44%|████▍     | 85/194 [00:00<00:00, 278.97it/s][A
 59%|█████▉    | 114/194 [00:00<00:00, 280.83it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 282.10it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 282.69it/s][A100%|██████████| 194/194 [00:00<00:00, 280.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 29/128 [46:31<2:42:13, 98.31s/it]EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 30/128 [48:00<2:36:02, 95.53s/it]EarlyStopping counter : 8 out of 40
training process:  24%|██▍       | 31/128 [49:32<2:32:45, 94.49s/it]EarlyStopping counter : 9 out of 40
training process:  25%|██▌       | 32/128 [51:02<2:29:09, 93.23s/it]epoch : 33, train loss : -1.538, valid loss : -1.111, train acc : 0.963, valid acc : 0.974, train f1 : 0.691, valid f1 : 0.669

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 328.65it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 331.26it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 334.11it/s][A
 70%|██████▉   | 135/194 [00:00<00:00, 335.58it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 336.55it/s][A100%|██████████| 194/194 [00:00<00:00, 335.36it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  26%|██▌       | 33/128 [52:58<2:38:07, 99.87s/it]EarlyStopping counter : 11 out of 40
training process:  27%|██▋       | 34/128 [54:26<2:31:05, 96.44s/it]Best score increase :0.674 -> 0.693
training process:  27%|██▋       | 35/128 [55:55<2:25:52, 94.11s/it]EarlyStopping counter : 1 out of 40
training process:  28%|██▊       | 36/128 [57:25<2:22:42, 93.07s/it]epoch : 37, train loss : -1.870, valid loss : -1.305, train acc : 0.966, valid acc : 0.972, train f1 : 0.695, valid f1 : 0.684

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 330.58it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.56it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 337.35it/s][A
 70%|███████   | 136/194 [00:00<00:00, 335.41it/s][A
 88%|████████▊ | 170/194 [00:00<00:00, 336.98it/s][A100%|██████████| 194/194 [00:00<00:00, 336.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  29%|██▉       | 37/128 [59:19<2:30:18, 99.10s/it]EarlyStopping counter : 3 out of 40
training process:  30%|██▉       | 38/128 [1:00:49<2:24:32, 96.37s/it]EarlyStopping counter : 4 out of 40
training process:  30%|███       | 39/128 [1:02:18<2:19:59, 94.37s/it]EarlyStopping counter : 5 out of 40
training process:  31%|███▏      | 40/128 [1:03:50<2:17:07, 93.50s/it]epoch : 41, train loss : -2.217, valid loss : -1.408, train acc : 0.966, valid acc : 0.968, train f1 : 0.696, valid f1 : 0.629

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 331.72it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 336.37it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 333.19it/s][A
 70%|███████   | 136/194 [00:00<00:00, 335.34it/s][A
 88%|████████▊ | 170/194 [00:00<00:00, 336.85it/s][A100%|██████████| 194/194 [00:00<00:00, 336.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  32%|███▏      | 41/128 [1:05:43<2:24:06, 99.39s/it]EarlyStopping counter : 7 out of 40
training process:  33%|███▎      | 42/128 [1:07:16<2:19:32, 97.36s/it]EarlyStopping counter : 8 out of 40
training process:  34%|███▎      | 43/128 [1:08:43<2:13:37, 94.32s/it]EarlyStopping counter : 9 out of 40
training process:  34%|███▍      | 44/128 [1:10:14<2:10:48, 93.43s/it]epoch : 45, train loss : -2.589, valid loss : -2.025, train acc : 0.969, valid acc : 0.962, train f1 : 0.699, valid f1 : 0.655

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 323.06it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 331.93it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 330.42it/s][A
 70%|██████▉   | 135/194 [00:00<00:00, 333.85it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 335.81it/s][A100%|██████████| 194/194 [00:00<00:00, 332.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  35%|███▌      | 45/128 [1:12:10<2:18:38, 100.22s/it]EarlyStopping counter : 11 out of 40
training process:  36%|███▌      | 46/128 [1:13:42<2:13:19, 97.56s/it] EarlyStopping counter : 12 out of 40
training process:  37%|███▋      | 47/128 [1:15:13<2:09:03, 95.60s/it]EarlyStopping counter : 13 out of 40
training process:  38%|███▊      | 48/128 [1:16:42<2:05:08, 93.86s/it]epoch : 49, train loss : -2.971, valid loss : -1.790, train acc : 0.968, valid acc : 0.974, train f1 : 0.701, valid f1 : 0.661

  0%|          | 0/194 [00:00<?, ?it/s][A
 12%|█▏        | 24/194 [00:00<00:00, 239.07it/s][A
 29%|██▉       | 57/194 [00:00<00:00, 291.07it/s][A
 47%|████▋     | 91/194 [00:00<00:00, 305.02it/s][A
 64%|██████▍   | 125/194 [00:00<00:00, 315.10it/s][A
 82%|████████▏ | 159/194 [00:00<00:00, 320.69it/s][A
 99%|█████████▉| 192/194 [00:00<00:00, 322.49it/s][A100%|██████████| 194/194 [00:00<00:00, 312.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  38%|███▊      | 49/128 [1:18:40<2:12:55, 100.96s/it]EarlyStopping counter : 15 out of 40
training process:  39%|███▉      | 50/128 [1:20:09<2:06:42, 97.47s/it] EarlyStopping counter : 16 out of 40
training process:  40%|███▉      | 51/128 [1:21:39<2:02:11, 95.22s/it]EarlyStopping counter : 17 out of 40
training process:  41%|████      | 52/128 [1:23:10<1:59:00, 93.96s/it]epoch : 53, train loss : -3.395, valid loss : -2.350, train acc : 0.969, valid acc : 0.959, train f1 : 0.712, valid f1 : 0.680

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 316.40it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 329.80it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 334.33it/s][A
 69%|██████▉   | 134/194 [00:00<00:00, 336.51it/s][A
 87%|████████▋ | 168/194 [00:00<00:00, 336.57it/s][A100%|██████████| 194/194 [00:00<00:00, 335.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  41%|████▏     | 53/128 [1:25:03<2:04:27, 99.57s/it]EarlyStopping counter : 19 out of 40
training process:  42%|████▏     | 54/128 [1:26:31<1:58:44, 96.27s/it]EarlyStopping counter : 20 out of 40
training process:  43%|████▎     | 55/128 [1:28:01<1:54:49, 94.37s/it]EarlyStopping counter : 21 out of 40
training process:  44%|████▍     | 56/128 [1:29:32<1:52:01, 93.35s/it]epoch : 57, train loss : -3.724, valid loss : -2.695, train acc : 0.968, valid acc : 0.975, train f1 : 0.693, valid f1 : 0.679

  0%|          | 0/194 [00:00<?, ?it/s][A
 12%|█▏        | 23/194 [00:00<00:00, 228.80it/s][A
 28%|██▊       | 54/194 [00:00<00:00, 273.11it/s][A
 45%|████▍     | 87/194 [00:00<00:00, 297.10it/s][A
 62%|██████▏   | 120/194 [00:00<00:00, 308.61it/s][A
 79%|███████▉  | 153/194 [00:00<00:00, 315.06it/s][A
 95%|█████████▌| 185/194 [00:00<00:00, 315.92it/s][A100%|██████████| 194/194 [00:00<00:00, 305.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  45%|████▍     | 57/128 [1:31:27<1:57:57, 99.68s/it]EarlyStopping counter : 23 out of 40
training process:  45%|████▌     | 58/128 [1:32:56<1:52:32, 96.47s/it]EarlyStopping counter : 24 out of 40
training process:  46%|████▌     | 59/128 [1:34:25<1:48:28, 94.32s/it]EarlyStopping counter : 25 out of 40
training process:  47%|████▋     | 60/128 [1:35:54<1:44:56, 92.60s/it]epoch : 61, train loss : -4.211, valid loss : -2.942, train acc : 0.966, valid acc : 0.972, train f1 : 0.698, valid f1 : 0.719

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 308.49it/s][A
 34%|███▎      | 65/194 [00:00<00:00, 322.15it/s][A
 51%|█████     | 99/194 [00:00<00:00, 326.71it/s][A
 68%|██████▊   | 132/194 [00:00<00:00, 326.73it/s][A
 85%|████████▌ | 165/194 [00:00<00:00, 322.87it/s][A100%|██████████| 194/194 [00:00<00:00, 298.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.693 -> 0.719
training process:  48%|████▊     | 61/128 [1:37:50<1:51:18, 99.68s/it]EarlyStopping counter : 1 out of 40
training process:  48%|████▊     | 62/128 [1:39:21<1:46:53, 97.17s/it]EarlyStopping counter : 2 out of 40
training process:  49%|████▉     | 63/128 [1:40:50<1:42:26, 94.56s/it]EarlyStopping counter : 3 out of 40
training process:  50%|█████     | 64/128 [1:42:17<1:38:37, 92.46s/it]epoch : 65, train loss : -4.569, valid loss : -2.590, train acc : 0.968, valid acc : 0.975, train f1 : 0.720, valid f1 : 0.669

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 329.41it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 336.93it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 337.28it/s][A
 71%|███████   | 137/194 [00:00<00:00, 338.99it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 340.01it/s][A100%|██████████| 194/194 [00:00<00:00, 338.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  51%|█████     | 65/128 [1:44:06<1:42:10, 97.31s/it]EarlyStopping counter : 5 out of 40
training process:  52%|█████▏    | 66/128 [1:45:37<1:38:33, 95.37s/it]EarlyStopping counter : 6 out of 40
training process:  52%|█████▏    | 67/128 [1:47:08<1:35:46, 94.21s/it]EarlyStopping counter : 7 out of 40
training process:  53%|█████▎    | 68/128 [1:48:38<1:32:58, 92.97s/it]epoch : 69, train loss : -4.967, valid loss : -2.914, train acc : 0.973, valid acc : 0.971, train f1 : 0.727, valid f1 : 0.675

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 274.67it/s][A
 29%|██▉       | 57/194 [00:00<00:00, 278.03it/s][A
 44%|████▍     | 85/194 [00:00<00:00, 278.82it/s][A
 58%|█████▊    | 113/194 [00:00<00:00, 278.60it/s][A
 73%|███████▎  | 141/194 [00:00<00:00, 278.39it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 278.12it/s][A100%|██████████| 194/194 [00:00<00:00, 278.12it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  54%|█████▍    | 69/128 [1:50:34<1:38:15, 99.93s/it]EarlyStopping counter : 9 out of 40
training process:  55%|█████▍    | 70/128 [1:52:05<1:33:50, 97.07s/it]EarlyStopping counter : 10 out of 40
training process:  55%|█████▌    | 71/128 [1:53:34<1:29:51, 94.59s/it]EarlyStopping counter : 11 out of 40
training process:  56%|█████▋    | 72/128 [1:55:01<1:26:14, 92.39s/it]epoch : 73, train loss : -5.352, valid loss : -3.137, train acc : 0.971, valid acc : 0.975, train f1 : 0.735, valid f1 : 0.616

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 337.30it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 341.27it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 342.57it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 342.96it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 343.06it/s][A100%|██████████| 194/194 [00:00<00:00, 342.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  57%|█████▋    | 73/128 [1:56:57<1:31:09, 99.44s/it]EarlyStopping counter : 13 out of 40
training process:  58%|█████▊    | 74/128 [1:58:26<1:26:43, 96.36s/it]EarlyStopping counter : 14 out of 40
training process:  59%|█████▊    | 75/128 [1:59:55<1:23:06, 94.09s/it]EarlyStopping counter : 15 out of 40
training process:  59%|█████▉    | 76/128 [2:01:26<1:20:43, 93.15s/it]epoch : 77, train loss : -5.748, valid loss : -4.101, train acc : 0.974, valid acc : 0.972, train f1 : 0.727, valid f1 : 0.689

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 333.35it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 337.83it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 339.42it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 340.30it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 340.93it/s][A100%|██████████| 194/194 [00:00<00:00, 339.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  60%|██████    | 77/128 [2:03:20<1:24:34, 99.49s/it]EarlyStopping counter : 17 out of 40
training process:  61%|██████    | 78/128 [2:04:48<1:20:00, 96.01s/it]EarlyStopping counter : 18 out of 40
training process:  62%|██████▏   | 79/128 [2:06:18<1:16:55, 94.20s/it]EarlyStopping counter : 19 out of 40
training process:  62%|██████▎   | 80/128 [2:07:44<1:13:20, 91.68s/it]epoch : 81, train loss : -6.038, valid loss : -4.055, train acc : 0.970, valid acc : 0.957, train f1 : 0.720, valid f1 : 0.655

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 328.74it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 334.78it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 336.95it/s][A
 70%|███████   | 136/194 [00:00<00:00, 338.46it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 339.11it/s][A100%|██████████| 194/194 [00:00<00:00, 337.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  63%|██████▎   | 81/128 [2:09:36<1:16:36, 97.80s/it]EarlyStopping counter : 21 out of 40
training process:  64%|██████▍   | 82/128 [2:11:02<1:12:20, 94.36s/it]EarlyStopping counter : 22 out of 40
training process:  65%|██████▍   | 83/128 [2:12:28<1:08:45, 91.68s/it]EarlyStopping counter : 23 out of 40
training process:  66%|██████▌   | 84/128 [2:13:56<1:06:28, 90.64s/it]epoch : 85, train loss : -6.156, valid loss : -4.408, train acc : 0.972, valid acc : 0.974, train f1 : 0.721, valid f1 : 0.682

  0%|          | 0/194 [00:00<?, ?it/s][A
 12%|█▏        | 24/194 [00:00<00:00, 231.72it/s][A
 26%|██▋       | 51/194 [00:00<00:00, 253.57it/s][A
 41%|████      | 79/194 [00:00<00:00, 261.50it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 265.14it/s][A
 69%|██████▉   | 134/194 [00:00<00:00, 237.77it/s][A
 84%|████████▎ | 162/194 [00:00<00:00, 248.91it/s][A100%|██████████| 194/194 [00:00<00:00, 260.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  66%|██████▋   | 85/128 [2:15:51<1:10:17, 98.07s/it]EarlyStopping counter : 25 out of 40
training process:  67%|██████▋   | 86/128 [2:17:27<1:08:08, 97.34s/it]EarlyStopping counter : 26 out of 40
training process:  68%|██████▊   | 87/128 [2:19:02<1:06:10, 96.85s/it]EarlyStopping counter : 27 out of 40
training process:  69%|██████▉   | 88/128 [2:20:35<1:03:37, 95.44s/it]epoch : 89, train loss : -6.677, valid loss : -3.676, train acc : 0.977, valid acc : 0.969, train f1 : 0.753, valid f1 : 0.646

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 328.78it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 336.87it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 339.72it/s][A
 71%|███████   | 137/194 [00:00<00:00, 338.07it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 339.94it/s][A100%|██████████| 194/194 [00:00<00:00, 338.94it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  70%|██████▉   | 89/128 [2:22:35<1:06:52, 102.88s/it]EarlyStopping counter : 29 out of 40
training process:  70%|███████   | 90/128 [2:24:07<1:03:02, 99.54s/it] EarlyStopping counter : 30 out of 40
training process:  71%|███████   | 91/128 [2:25:40<1:00:17, 97.76s/it]EarlyStopping counter : 31 out of 40
training process:  72%|███████▏  | 92/128 [2:27:13<57:41, 96.16s/it]  epoch : 93, train loss : -7.027, valid loss : -5.044, train acc : 0.973, valid acc : 0.972, train f1 : 0.744, valid f1 : 0.678

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 329.23it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 327.76it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 332.78it/s][A
 69%|██████▉   | 134/194 [00:00<00:00, 335.44it/s][A
 87%|████████▋ | 168/194 [00:00<00:00, 337.01it/s][A100%|██████████| 194/194 [00:00<00:00, 335.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  73%|███████▎  | 93/128 [2:29:13<1:00:16, 103.32s/it]EarlyStopping counter : 33 out of 40
training process:  73%|███████▎  | 94/128 [2:30:36<55:13, 97.45s/it]   EarlyStopping counter : 34 out of 40
training process:  74%|███████▍  | 95/128 [2:32:03<51:44, 94.08s/it]EarlyStopping counter : 35 out of 40
training process:  75%|███████▌  | 96/128 [2:33:30<49:01, 91.92s/it]epoch : 97, train loss : -7.485, valid loss : -4.244, train acc : 0.971, valid acc : 0.975, train f1 : 0.725, valid f1 : 0.674

  0%|          | 0/194 [00:00<?, ?it/s][A
 12%|█▏        | 24/194 [00:00<00:00, 236.26it/s][A
 25%|██▍       | 48/194 [00:00<00:00, 238.15it/s][A
 39%|███▊      | 75/194 [00:00<00:00, 249.65it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 254.31it/s][A
 67%|██████▋   | 130/194 [00:00<00:00, 261.16it/s][A
 82%|████████▏ | 159/194 [00:00<00:00, 268.53it/s][A
 96%|█████████▌| 186/194 [00:00<00:00, 268.52it/s][A100%|██████████| 194/194 [00:00<00:00, 261.32it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  76%|███████▌  | 97/128 [2:35:26<51:18, 99.32s/it]EarlyStopping counter : 37 out of 40
training process:  77%|███████▋  | 98/128 [2:36:56<48:12, 96.40s/it]EarlyStopping counter : 38 out of 40
training process:  77%|███████▋  | 99/128 [2:38:25<45:30, 94.14s/it]EarlyStopping counter : 39 out of 40
training process:  78%|███████▊  | 100/128 [2:39:54<43:20, 92.87s/it]epoch : 101, train loss : -7.823, valid loss : -4.829, train acc : 0.976, valid acc : 0.976, train f1 : 0.757, valid f1 : 0.658

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 329.00it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 328.37it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 332.72it/s][A
 69%|██████▉   | 134/194 [00:00<00:00, 334.81it/s][A
 87%|████████▋ | 168/194 [00:00<00:00, 335.93it/s][A100%|██████████| 194/194 [00:00<00:00, 334.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 100, best f1 score : 0.719
training process:  78%|███████▊  | 100/128 [2:41:49<45:18, 97.10s/it]
training process finished, best loss : -2.942 and best acc : 0.972, best f1 : 0.719, best epoch : 60

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.38      0.39      0.39       453
           1       0.98      0.98      0.98     16880

    accuracy                           0.97     17333
   macro avg       0.68      0.69      0.69     17333
weighted avg       0.97      0.97      0.97     17333


# test acc : 0.97, test f1 : 0.69, test AUC : 0.69, test loss : -661.531

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:11, 11.98s/it]processing for feature importance:  12%|█▏        | 2/17 [00:24<03:02, 12.15s/it]processing for feature importance:  18%|█▊        | 3/17 [00:35<02:47, 11.95s/it]processing for feature importance:  24%|██▎       | 4/17 [00:48<02:37, 12.09s/it]processing for feature importance:  29%|██▉       | 5/17 [00:59<02:22, 11.92s/it]processing for feature importance:  35%|███▌      | 6/17 [01:11<02:09, 11.79s/it]processing for feature importance:  41%|████      | 7/17 [01:23<01:59, 11.95s/it]processing for feature importance:  47%|████▋     | 8/17 [01:36<01:49, 12.16s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:47<01:35, 11.98s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:00<01:24, 12.08s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:12<01:13, 12.18s/it]processing for feature importance:  71%|███████   | 12/17 [02:24<00:59, 11.97s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:36<00:48, 12.19s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:48<00:36, 12.10s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:01<00:24, 12.24s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:12<00:11, 11.97s/it]processing for feature importance: 100%|██████████| 17/17 [03:24<00:00, 12.06s/it]processing for feature importance: 100%|██████████| 17/17 [03:24<00:00, 12.05s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:02<09:38,  2.74s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<05:59,  1.71s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<09:46,  2.79s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:11,  1.97s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:29,  1.36s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:29,  3.27s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<06:42,  1.92s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:26,  2.18s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:03<01:40,  1.52s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 12%|█▏        | 24/194 [00:00<00:00, 236.53it/s] 26%|██▋       | 51/194 [00:00<00:00, 252.21it/s] 40%|███▉      | 77/194 [00:00<00:00, 226.90it/s] 53%|█████▎    | 102/194 [00:00<00:00, 234.91it/s] 70%|██████▉   | 135/194 [00:00<00:00, 265.46it/s] 87%|████████▋ | 168/194 [00:00<00:00, 284.27it/s]100%|██████████| 194/194 [00:00<00:00, 270.71it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_CE_smoothing_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 202.03it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 201.68it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 200.81it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 203.23it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.73it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 206.95it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 208.76it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 209.95it/s]remove invalid data : null / measurement error:  31%|███       | 192/616 [00:00<00:02, 206.94it/s]remove invalid data : null / measurement error:  35%|███▍      | 213/616 [00:01<00:01, 205.85it/s]remove invalid data : null / measurement error:  38%|███▊      | 234/616 [00:01<00:01, 205.37it/s]remove invalid data : null / measurement error:  41%|████▏     | 255/616 [00:01<00:01, 204.66it/s]remove invalid data : null / measurement error:  45%|████▍     | 276/616 [00:01<00:01, 205.78it/s]remove invalid data : null / measurement error:  48%|████▊     | 297/616 [00:01<00:01, 205.17it/s]remove invalid data : null / measurement error:  52%|█████▏    | 318/616 [00:01<00:01, 203.87it/s]remove invalid data : null / measurement error:  55%|█████▌    | 339/616 [00:01<00:01, 203.17it/s]remove invalid data : null / measurement error:  58%|█████▊    | 360/616 [00:01<00:01, 203.52it/s]remove invalid data : null / measurement error:  63%|██████▎   | 386/616 [00:01<00:01, 219.48it/s]remove invalid data : null / measurement error:  67%|██████▋   | 413/616 [00:01<00:00, 233.47it/s]remove invalid data : null / measurement error:  71%|███████   | 437/616 [00:02<00:00, 229.38it/s]remove invalid data : null / measurement error:  75%|███████▍  | 461/616 [00:02<00:00, 232.11it/s]remove invalid data : null / measurement error:  79%|███████▊  | 485/616 [00:02<00:00, 223.53it/s]remove invalid data : null / measurement error:  82%|████████▏ | 508/616 [00:02<00:00, 217.64it/s]remove invalid data : null / measurement error:  86%|████████▌ | 530/616 [00:02<00:00, 213.24it/s]remove invalid data : null / measurement error:  90%|████████▉ | 552/616 [00:02<00:00, 208.43it/s]remove invalid data : null / measurement error:  93%|█████████▎| 573/616 [00:02<00:00, 206.11it/s]remove invalid data : null / measurement error:  96%|█████████▋| 594/616 [00:02<00:00, 205.03it/s]remove invalid data : null / measurement error: 100%|█████████▉| 615/616 [00:02<00:00, 203.96it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 209.84it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.46it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 235.26it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 236.79it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 240.04it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 241.04it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 242.18it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 242.72it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 242.76it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 242.30it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 242.82it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 243.33it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 242.04it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 242.03it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 239.56it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 240.41it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 241.43it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 241.11it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 239.97it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 241.57it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 242.39it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 241.31it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.59it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.22it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.17it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.40it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.03it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.14it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 57.18it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.63it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.20it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.43it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.62it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.46it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.04it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 64.51it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.87it/s]generate index:  25%|██▍       | 127/515 [00:02<00:05, 69.85it/s]generate index:  26%|██▌       | 135/515 [00:02<00:05, 70.20it/s]generate index:  28%|██▊       | 143/515 [00:02<00:05, 71.19it/s]generate index:  29%|██▉       | 151/515 [00:02<00:05, 70.09it/s]generate index:  31%|███       | 159/515 [00:02<00:05, 69.83it/s]generate index:  32%|███▏      | 167/515 [00:02<00:04, 70.97it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 67.72it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 70.12it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 70.81it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 63.90it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 70.89it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 81.42it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 85.70it/s]generate index:  47%|████▋     | 241/515 [00:03<00:03, 86.69it/s]generate index:  49%|████▊     | 250/515 [00:03<00:03, 72.29it/s]generate index:  50%|█████     | 258/515 [00:03<00:03, 71.16it/s]generate index:  52%|█████▏    | 267/515 [00:03<00:03, 73.77it/s]generate index:  54%|█████▎    | 276/515 [00:04<00:03, 76.68it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 61.77it/s]generate index:  57%|█████▋    | 292/515 [00:04<00:03, 65.00it/s]generate index:  58%|█████▊    | 299/515 [00:04<00:03, 62.78it/s]generate index:  59%|█████▉    | 306/515 [00:04<00:03, 61.84it/s]generate index:  61%|██████    | 313/515 [00:04<00:03, 61.55it/s]generate index:  62%|██████▏   | 320/515 [00:04<00:03, 60.94it/s]generate index:  64%|██████▎   | 328/515 [00:04<00:02, 63.98it/s]generate index:  65%|██████▌   | 335/515 [00:05<00:03, 56.73it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 45.89it/s]generate index:  67%|██████▋   | 346/515 [00:05<00:03, 46.00it/s]generate index:  68%|██████▊   | 351/515 [00:05<00:03, 43.01it/s]generate index:  70%|███████   | 363/515 [00:05<00:02, 58.31it/s]generate index:  73%|███████▎  | 375/515 [00:05<00:01, 72.61it/s]generate index:  75%|███████▍  | 384/515 [00:05<00:01, 75.98it/s]generate index:  76%|███████▌  | 392/515 [00:06<00:01, 72.93it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.21it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 62.92it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.30it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 75.71it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 55.30it/s]generate index:  86%|████████▌ | 444/515 [00:07<00:01, 48.09it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.19it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 63.95it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 56.92it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 66.91it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 64.78it/s]generate index:  97%|█████████▋| 498/515 [00:07<00:00, 62.11it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 69.45it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 63.84it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▌         | 9/154 [00:00<00:01, 88.11it/s]remove invalid data : null / measurement error:  19%|█▉        | 30/154 [00:00<00:00, 157.42it/s]remove invalid data : null / measurement error:  33%|███▎      | 51/154 [00:00<00:00, 180.25it/s]remove invalid data : null / measurement error:  47%|████▋     | 73/154 [00:00<00:00, 193.21it/s]remove invalid data : null / measurement error:  62%|██████▏   | 95/154 [00:00<00:00, 201.51it/s]remove invalid data : null / measurement error:  77%|███████▋  | 119/154 [00:00<00:00, 212.13it/s]remove invalid data : null / measurement error:  92%|█████████▏| 141/154 [00:00<00:00, 209.62it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 196.41it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 25/131 [00:00<00:00, 249.15it/s]replace nan value:  39%|███▉      | 51/131 [00:00<00:00, 251.16it/s]replace nan value:  59%|█████▉    | 77/131 [00:00<00:00, 253.39it/s]replace nan value:  79%|███████▊  | 103/131 [00:00<00:00, 252.34it/s]replace nan value:  98%|█████████▊| 129/131 [00:00<00:00, 254.94it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 253.42it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.33it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 49.47it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 54.60it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.66it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.74it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.89it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 61.05it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 63.19it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 67.21it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.71it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 63.27it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 48.06it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 48.19it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 46.63it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 48.09it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 55.85it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 64.56it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 59.48it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▎         | 7/193 [00:00<00:02, 68.73it/s]remove invalid data : null / measurement error:  15%|█▌        | 29/193 [00:00<00:01, 153.00it/s]remove invalid data : null / measurement error:  26%|██▌       | 50/193 [00:00<00:00, 178.45it/s]remove invalid data : null / measurement error:  37%|███▋      | 72/193 [00:00<00:00, 193.78it/s]remove invalid data : null / measurement error:  49%|████▊     | 94/193 [00:00<00:00, 199.94it/s]remove invalid data : null / measurement error:  60%|█████▉    | 115/193 [00:00<00:00, 201.70it/s]remove invalid data : null / measurement error:  73%|███████▎  | 140/193 [00:00<00:00, 216.10it/s]remove invalid data : null / measurement error:  84%|████████▍ | 162/193 [00:00<00:00, 213.90it/s]remove invalid data : null / measurement error:  95%|█████████▌| 184/193 [00:00<00:00, 210.60it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 198.20it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 251.33it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 253.62it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 252.60it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 249.00it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 249.57it/s]replace nan value:  97%|█████████▋| 155/160 [00:00<00:00, 249.09it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 249.74it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 102.67it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.15it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.63it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 74.23it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.40it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.21it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 83.44it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 68.45it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.84it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.63it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.32it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.51it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.31it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 60.40it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 55.91it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 54.78it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 58.84it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.03it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.50it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.412, valid loss : 0.456, train acc : 0.729, valid acc : 0.701, train f1 : 0.728, valid f1 : 0.469

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 345.30it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 350.94it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 352.66it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 350.22it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 353.54it/s][A100%|██████████| 194/194 [00:00<00:00, 352.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.469
training process:   1%|          | 1/128 [01:57<4:07:52, 117.11s/it]Best score increase :0.469 -> 0.535
training process:   2%|▏         | 2/128 [03:31<3:37:53, 103.76s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [05:04<3:25:37, 98.70s/it] EarlyStopping counter : 2 out of 40
training process:   3%|▎         | 4/128 [06:37<3:19:40, 96.62s/it]epoch : 5, train loss : 0.121, valid loss : 0.268, train acc : 0.918, valid acc : 0.832, train f1 : 0.918, valid f1 : 0.550

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 307.39it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 330.48it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 337.50it/s][A
 70%|███████   | 136/194 [00:00<00:00, 340.36it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 338.08it/s][A100%|██████████| 194/194 [00:00<00:00, 335.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.535 -> 0.550
training process:   4%|▍         | 5/128 [08:35<3:33:59, 104.38s/it]Best score increase :0.550 -> 0.556
training process:   5%|▍         | 6/128 [10:10<3:25:31, 101.08s/it]Best score increase :0.556 -> 0.576
training process:   5%|▌         | 7/128 [11:47<3:21:00, 99.67s/it] Best score increase :0.576 -> 0.593
training process:   6%|▋         | 8/128 [13:20<3:15:24, 97.70s/it]epoch : 9, train loss : 0.020, valid loss : 0.070, train acc : 0.949, valid acc : 0.903, train f1 : 0.949, valid f1 : 0.606

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 328.01it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 338.13it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 341.47it/s][A
 71%|███████   | 138/194 [00:00<00:00, 343.22it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 344.04it/s][A100%|██████████| 194/194 [00:00<00:00, 342.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.593 -> 0.606
training process:   7%|▋         | 9/128 [15:20<3:27:40, 104.71s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:54<3:19:10, 101.28s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [18:27<3:12:20, 98.64s/it] EarlyStopping counter : 3 out of 40
training process:   9%|▉         | 12/128 [20:02<3:08:40, 97.59s/it]epoch : 13, train loss : -0.086, valid loss : -0.027, train acc : 0.958, valid acc : 0.901, train f1 : 0.958, valid f1 : 0.601

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 312.66it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 323.85it/s][A
 51%|█████     | 99/194 [00:00<00:00, 324.38it/s][A
 68%|██████▊   | 132/194 [00:00<00:00, 324.98it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 330.76it/s][A100%|██████████| 194/194 [00:00<00:00, 329.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  10%|█         | 13/128 [22:00<3:19:15, 103.96s/it]EarlyStopping counter : 5 out of 40
training process:  11%|█         | 14/128 [23:34<3:11:33, 100.82s/it]EarlyStopping counter : 6 out of 40
training process:  12%|█▏        | 15/128 [25:07<3:05:44, 98.62s/it] Best score increase :0.606 -> 0.624
training process:  12%|█▎        | 16/128 [26:42<3:01:48, 97.40s/it]epoch : 17, train loss : -0.245, valid loss : 0.088, train acc : 0.966, valid acc : 0.891, train f1 : 0.966, valid f1 : 0.586

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 247.18it/s][A
 27%|██▋       | 52/194 [00:00<00:00, 258.31it/s][A
 41%|████      | 79/194 [00:00<00:00, 263.37it/s][A
 55%|█████▍    | 106/194 [00:00<00:00, 264.23it/s][A
 69%|██████▊   | 133/194 [00:00<00:00, 266.15it/s][A
 83%|████████▎ | 161/194 [00:00<00:00, 267.60it/s][A
 97%|█████████▋| 189/194 [00:00<00:00, 268.58it/s][A100%|██████████| 194/194 [00:00<00:00, 265.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  13%|█▎        | 17/128 [28:41<3:12:27, 104.04s/it]EarlyStopping counter : 2 out of 40
training process:  14%|█▍        | 18/128 [30:15<3:04:58, 100.89s/it]EarlyStopping counter : 3 out of 40
training process:  15%|█▍        | 19/128 [31:49<2:59:26, 98.77s/it] EarlyStopping counter : 4 out of 40
training process:  16%|█▌        | 20/128 [33:24<2:55:37, 97.57s/it]epoch : 21, train loss : -0.458, valid loss : 0.422, train acc : 0.969, valid acc : 0.879, train f1 : 0.969, valid f1 : 0.579

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 305.95it/s][A
 32%|███▏      | 63/194 [00:00<00:00, 311.42it/s][A
 49%|████▉     | 96/194 [00:00<00:00, 318.77it/s][A
 67%|██████▋   | 130/194 [00:00<00:00, 325.31it/s][A
 85%|████████▍ | 164/194 [00:00<00:00, 329.09it/s][A100%|██████████| 194/194 [00:00<00:00, 324.49it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  16%|█▋        | 21/128 [35:22<3:05:14, 103.88s/it]EarlyStopping counter : 6 out of 40
training process:  17%|█▋        | 22/128 [36:55<2:57:37, 100.55s/it]EarlyStopping counter : 7 out of 40
training process:  18%|█▊        | 23/128 [38:29<2:52:38, 98.65s/it] EarlyStopping counter : 8 out of 40
training process:  19%|█▉        | 24/128 [40:02<2:47:42, 96.75s/it]epoch : 25, train loss : -0.691, valid loss : -0.281, train acc : 0.972, valid acc : 0.919, train f1 : 0.972, valid f1 : 0.622

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 320.50it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 334.28it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 339.77it/s][A
 71%|███████   | 138/194 [00:00<00:00, 342.70it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 344.37it/s][A100%|██████████| 194/194 [00:00<00:00, 341.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  20%|█▉        | 25/128 [42:02<2:58:15, 103.84s/it]EarlyStopping counter : 10 out of 40
training process:  20%|██        | 26/128 [43:35<2:50:55, 100.55s/it]EarlyStopping counter : 11 out of 40
training process:  21%|██        | 27/128 [45:09<2:45:53, 98.55s/it] EarlyStopping counter : 12 out of 40
training process:  22%|██▏       | 28/128 [46:41<2:41:20, 96.80s/it]epoch : 29, train loss : -0.970, valid loss : -0.315, train acc : 0.976, valid acc : 0.903, train f1 : 0.976, valid f1 : 0.601

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 345.64it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 348.78it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 349.54it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 350.20it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 350.54it/s][A100%|██████████| 194/194 [00:00<00:00, 349.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  23%|██▎       | 29/128 [48:41<2:51:04, 103.69s/it]EarlyStopping counter : 14 out of 40
training process:  23%|██▎       | 30/128 [50:14<2:43:51, 100.32s/it]EarlyStopping counter : 15 out of 40
training process:  24%|██▍       | 31/128 [51:47<2:38:54, 98.29s/it] EarlyStopping counter : 16 out of 40
training process:  25%|██▌       | 32/128 [53:20<2:34:30, 96.56s/it]epoch : 33, train loss : -1.207, valid loss : -0.459, train acc : 0.976, valid acc : 0.927, train f1 : 0.976, valid f1 : 0.627

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 331.62it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 340.23it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 343.55it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 345.28it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 345.27it/s][A100%|██████████| 194/194 [00:00<00:00, 344.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.624 -> 0.627
training process:  26%|██▌       | 33/128 [55:22<2:44:57, 104.18s/it]EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 34/128 [56:53<2:37:01, 100.23s/it]EarlyStopping counter : 2 out of 40
training process:  27%|██▋       | 35/128 [58:27<2:32:41, 98.51s/it] EarlyStopping counter : 3 out of 40
training process:  28%|██▊       | 36/128 [1:00:00<2:28:14, 96.68s/it]epoch : 37, train loss : -1.506, valid loss : -0.058, train acc : 0.978, valid acc : 0.910, train f1 : 0.978, valid f1 : 0.604

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 322.94it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 334.48it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 336.91it/s][A
 71%|███████   | 137/194 [00:00<00:00, 340.03it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 341.74it/s][A100%|██████████| 194/194 [00:00<00:00, 339.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  29%|██▉       | 37/128 [1:02:01<2:37:47, 104.04s/it]EarlyStopping counter : 5 out of 40
training process:  30%|██▉       | 38/128 [1:03:34<2:31:04, 100.72s/it]EarlyStopping counter : 6 out of 40
training process:  30%|███       | 39/128 [1:05:07<2:25:54, 98.37s/it] Best score increase :0.627 -> 0.636
training process:  31%|███▏      | 40/128 [1:06:37<2:20:52, 96.05s/it]epoch : 41, train loss : -1.759, valid loss : 0.279, train acc : 0.980, valid acc : 0.925, train f1 : 0.980, valid f1 : 0.621

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 336.97it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 345.46it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 345.20it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 345.51it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 345.21it/s][A100%|██████████| 194/194 [00:00<00:00, 345.20it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  32%|███▏      | 41/128 [1:08:34<2:28:03, 102.10s/it]EarlyStopping counter : 2 out of 40
training process:  33%|███▎      | 42/128 [1:10:05<2:21:45, 98.90s/it] EarlyStopping counter : 3 out of 40
training process:  34%|███▎      | 43/128 [1:11:37<2:17:06, 96.78s/it]EarlyStopping counter : 4 out of 40
training process:  34%|███▍      | 44/128 [1:13:11<2:14:12, 95.86s/it]epoch : 45, train loss : -2.022, valid loss : 0.255, train acc : 0.980, valid acc : 0.933, train f1 : 0.980, valid f1 : 0.624

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 326.28it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 331.00it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 332.29it/s][A
 70%|██████▉   | 135/194 [00:00<00:00, 332.84it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 333.42it/s][A100%|██████████| 194/194 [00:00<00:00, 332.91it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  35%|███▌      | 45/128 [1:15:09<2:21:56, 102.61s/it]EarlyStopping counter : 6 out of 40
training process:  36%|███▌      | 46/128 [1:16:42<2:16:27, 99.85s/it] EarlyStopping counter : 7 out of 40
training process:  37%|███▋      | 47/128 [1:18:15<2:11:48, 97.64s/it]EarlyStopping counter : 8 out of 40
training process:  38%|███▊      | 48/128 [1:19:47<2:08:02, 96.03s/it]epoch : 49, train loss : -2.272, valid loss : 0.308, train acc : 0.982, valid acc : 0.927, train f1 : 0.982, valid f1 : 0.616

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 303.71it/s][A
 34%|███▎      | 65/194 [00:00<00:00, 324.52it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 332.06it/s][A
 70%|██████▉   | 135/194 [00:00<00:00, 335.69it/s][A
 88%|████████▊ | 170/194 [00:00<00:00, 337.67it/s][A100%|██████████| 194/194 [00:00<00:00, 334.11it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  38%|███▊      | 49/128 [1:21:48<2:16:26, 103.63s/it]EarlyStopping counter : 10 out of 40
training process:  39%|███▉      | 50/128 [1:23:25<2:12:06, 101.62s/it]EarlyStopping counter : 11 out of 40
training process:  40%|███▉      | 51/128 [1:24:59<2:07:13, 99.13s/it] EarlyStopping counter : 12 out of 40
training process:  41%|████      | 52/128 [1:26:33<2:03:48, 97.75s/it]epoch : 53, train loss : -2.532, valid loss : 0.706, train acc : 0.983, valid acc : 0.927, train f1 : 0.983, valid f1 : 0.615

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 321.46it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 333.32it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 332.68it/s][A
 71%|███████   | 137/194 [00:00<00:00, 336.85it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 339.18it/s][A100%|██████████| 194/194 [00:00<00:00, 337.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  41%|████▏     | 53/128 [1:28:34<2:10:39, 104.52s/it]EarlyStopping counter : 14 out of 40
training process:  42%|████▏     | 54/128 [1:30:08<2:05:07, 101.45s/it]EarlyStopping counter : 15 out of 40
training process:  43%|████▎     | 55/128 [1:31:41<2:00:31, 99.06s/it] EarlyStopping counter : 16 out of 40
training process:  44%|████▍     | 56/128 [1:33:15<1:57:01, 97.51s/it]epoch : 57, train loss : -2.759, valid loss : 1.201, train acc : 0.984, valid acc : 0.931, train f1 : 0.984, valid f1 : 0.632

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 330.81it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 337.09it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 339.56it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 340.99it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 341.85it/s][A100%|██████████| 194/194 [00:00<00:00, 340.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  45%|████▍     | 57/128 [1:35:13<2:02:45, 103.74s/it]Best score increase :0.636 -> 0.654
training process:  45%|████▌     | 58/128 [1:36:48<1:57:46, 100.94s/it]EarlyStopping counter : 1 out of 40
training process:  46%|████▌     | 59/128 [1:38:19<1:52:36, 97.93s/it] EarlyStopping counter : 2 out of 40
training process:  47%|████▋     | 60/128 [1:39:51<1:49:11, 96.34s/it]epoch : 61, train loss : -3.055, valid loss : 0.792, train acc : 0.986, valid acc : 0.947, train f1 : 0.986, valid f1 : 0.654

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 324.69it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 338.12it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 342.34it/s][A
 71%|███████   | 138/194 [00:00<00:00, 344.64it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 345.87it/s][A100%|██████████| 194/194 [00:00<00:00, 343.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  48%|████▊     | 61/128 [1:41:50<1:55:08, 103.11s/it]EarlyStopping counter : 4 out of 40
training process:  48%|████▊     | 62/128 [1:43:23<1:49:51, 99.88s/it] EarlyStopping counter : 5 out of 40
training process:  49%|████▉     | 63/128 [1:44:54<1:45:33, 97.45s/it]EarlyStopping counter : 6 out of 40
training process:  50%|█████     | 64/128 [1:46:28<1:42:34, 96.16s/it]epoch : 65, train loss : -3.249, valid loss : 1.628, train acc : 0.985, valid acc : 0.943, train f1 : 0.985, valid f1 : 0.649

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 314.11it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 329.95it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 335.89it/s][A
 71%|███████   | 137/194 [00:00<00:00, 338.94it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 340.70it/s][A100%|██████████| 194/194 [00:00<00:00, 337.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  51%|█████     | 65/128 [1:48:28<1:48:44, 103.56s/it]EarlyStopping counter : 8 out of 40
training process:  52%|█████▏    | 66/128 [1:50:01<1:43:31, 100.19s/it]EarlyStopping counter : 9 out of 40
training process:  52%|█████▏    | 67/128 [1:51:32<1:39:09, 97.54s/it] EarlyStopping counter : 10 out of 40
training process:  53%|█████▎    | 68/128 [1:53:05<1:36:04, 96.08s/it]epoch : 69, train loss : -3.501, valid loss : 1.640, train acc : 0.987, valid acc : 0.948, train f1 : 0.987, valid f1 : 0.651

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 263.60it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 271.27it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 271.44it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 273.00it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 275.06it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 276.21it/s][A100%|██████████| 194/194 [00:00<00:00, 274.66it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  54%|█████▍    | 69/128 [1:55:01<1:40:33, 102.26s/it]EarlyStopping counter : 12 out of 40
training process:  55%|█████▍    | 70/128 [1:56:34<1:35:55, 99.23s/it] EarlyStopping counter : 13 out of 40
training process:  55%|█████▌    | 71/128 [1:58:06<1:32:14, 97.09s/it]Best score increase :0.654 -> 0.671
training process:  56%|█████▋    | 72/128 [1:59:38<1:29:15, 95.64s/it]epoch : 73, train loss : -3.760, valid loss : 2.844, train acc : 0.987, valid acc : 0.946, train f1 : 0.987, valid f1 : 0.650

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 318.15it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 330.44it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 331.03it/s][A
 69%|██████▉   | 134/194 [00:00<00:00, 288.52it/s][A
 85%|████████▍ | 164/194 [00:00<00:00, 275.20it/s][A100%|██████████| 194/194 [00:00<00:00, 296.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  57%|█████▋    | 73/128 [2:01:42<1:35:28, 104.16s/it]EarlyStopping counter : 2 out of 40
training process:  58%|█████▊    | 74/128 [2:03:14<1:30:30, 100.57s/it]EarlyStopping counter : 3 out of 40
training process:  59%|█████▊    | 75/128 [2:04:50<1:27:32, 99.10s/it] EarlyStopping counter : 4 out of 40
training process:  59%|█████▉    | 76/128 [2:06:25<1:24:51, 97.91s/it]epoch : 77, train loss : -3.932, valid loss : 3.305, train acc : 0.988, valid acc : 0.940, train f1 : 0.988, valid f1 : 0.647

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 267.66it/s][A
 29%|██▉       | 56/194 [00:00<00:00, 275.32it/s][A
 44%|████▍     | 85/194 [00:00<00:00, 278.13it/s][A
 58%|█████▊    | 113/194 [00:00<00:00, 278.29it/s][A
 73%|███████▎  | 142/194 [00:00<00:00, 279.93it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 281.03it/s][A100%|██████████| 194/194 [00:00<00:00, 279.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  60%|██████    | 77/128 [2:08:25<1:28:46, 104.44s/it]EarlyStopping counter : 6 out of 40
training process:  61%|██████    | 78/128 [2:09:58<1:24:10, 101.00s/it]EarlyStopping counter : 7 out of 40
training process:  62%|██████▏   | 79/128 [2:11:31<1:20:42, 98.84s/it] EarlyStopping counter : 8 out of 40
training process:  62%|██████▎   | 80/128 [2:13:04<1:17:35, 97.00s/it]epoch : 81, train loss : -4.089, valid loss : 3.348, train acc : 0.989, valid acc : 0.943, train f1 : 0.989, valid f1 : 0.644

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 336.39it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 340.48it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 342.84it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 344.37it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 345.26it/s][A100%|██████████| 194/194 [00:00<00:00, 344.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  63%|██████▎   | 81/128 [2:15:03<1:21:11, 103.64s/it]EarlyStopping counter : 10 out of 40
training process:  64%|██████▍   | 82/128 [2:16:37<1:17:04, 100.52s/it]EarlyStopping counter : 11 out of 40
training process:  65%|██████▍   | 83/128 [2:18:09<1:13:38, 98.18s/it] EarlyStopping counter : 12 out of 40
training process:  66%|██████▌   | 84/128 [2:19:43<1:11:01, 96.86s/it]epoch : 85, train loss : -4.399, valid loss : 5.580, train acc : 0.990, valid acc : 0.941, train f1 : 0.990, valid f1 : 0.644

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 275.96it/s][A
 29%|██▉       | 56/194 [00:00<00:00, 277.61it/s][A
 44%|████▍     | 85/194 [00:00<00:00, 280.19it/s][A
 59%|█████▉    | 114/194 [00:00<00:00, 281.79it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 282.53it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 282.97it/s][A100%|██████████| 194/194 [00:00<00:00, 282.27it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  66%|██████▋   | 85/128 [2:21:42<1:14:15, 103.62s/it]EarlyStopping counter : 14 out of 40
training process:  67%|██████▋   | 86/128 [2:23:15<1:10:07, 100.18s/it]EarlyStopping counter : 15 out of 40
training process:  68%|██████▊   | 87/128 [2:24:49<1:07:17, 98.47s/it] EarlyStopping counter : 16 out of 40
training process:  69%|██████▉   | 88/128 [2:26:23<1:04:38, 96.97s/it]epoch : 89, train loss : -4.500, valid loss : 5.093, train acc : 0.990, valid acc : 0.944, train f1 : 0.990, valid f1 : 0.647

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 327.35it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 338.66it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 336.75it/s][A
 71%|███████   | 137/194 [00:00<00:00, 340.83it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 343.47it/s][A100%|██████████| 194/194 [00:00<00:00, 341.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  70%|██████▉   | 89/128 [2:28:21<1:07:12, 103.39s/it]EarlyStopping counter : 18 out of 40
training process:  70%|███████   | 90/128 [2:29:55<1:03:47, 100.73s/it]EarlyStopping counter : 19 out of 40
training process:  71%|███████   | 91/128 [2:31:29<1:00:42, 98.43s/it] EarlyStopping counter : 20 out of 40
training process:  72%|███████▏  | 92/128 [2:33:00<57:46, 96.30s/it]  epoch : 93, train loss : -4.742, valid loss : 6.164, train acc : 0.991, valid acc : 0.942, train f1 : 0.991, valid f1 : 0.649

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 261.64it/s][A
 31%|███       | 60/194 [00:00<00:00, 297.13it/s][A
 48%|████▊     | 93/194 [00:00<00:00, 309.38it/s][A
 64%|██████▍   | 125/194 [00:00<00:00, 313.07it/s][A
 81%|████████▏ | 158/194 [00:00<00:00, 316.94it/s][A
 98%|█████████▊| 191/194 [00:00<00:00, 319.56it/s][A100%|██████████| 194/194 [00:00<00:00, 312.51it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  73%|███████▎  | 93/128 [2:35:03<1:00:52, 104.35s/it]EarlyStopping counter : 22 out of 40
training process:  73%|███████▎  | 94/128 [2:36:38<57:31, 101.51s/it]  EarlyStopping counter : 23 out of 40
training process:  74%|███████▍  | 95/128 [2:38:11<54:25, 98.96s/it] EarlyStopping counter : 24 out of 40
training process:  75%|███████▌  | 96/128 [2:39:46<52:08, 97.78s/it]epoch : 97, train loss : -4.864, valid loss : 6.110, train acc : 0.991, valid acc : 0.944, train f1 : 0.991, valid f1 : 0.641

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 322.26it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.10it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 336.71it/s][A
 71%|███████   | 137/194 [00:00<00:00, 339.74it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 341.45it/s][A100%|██████████| 194/194 [00:00<00:00, 339.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 25 out of 40
training process:  76%|███████▌  | 97/128 [2:41:45<53:51, 104.24s/it]EarlyStopping counter : 26 out of 40
training process:  77%|███████▋  | 98/128 [2:43:21<50:52, 101.74s/it]EarlyStopping counter : 27 out of 40
training process:  77%|███████▋  | 99/128 [2:44:55<48:02, 99.40s/it] EarlyStopping counter : 28 out of 40
training process:  78%|███████▊  | 100/128 [2:46:27<45:17, 97.05s/it]epoch : 101, train loss : -5.092, valid loss : 7.621, train acc : 0.991, valid acc : 0.946, train f1 : 0.991, valid f1 : 0.637

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 304.62it/s][A
 34%|███▎      | 65/194 [00:00<00:00, 320.70it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 330.39it/s][A
 70%|██████▉   | 135/194 [00:00<00:00, 335.13it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 335.46it/s][A100%|██████████| 194/194 [00:00<00:00, 332.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 29 out of 40
training process:  79%|███████▉  | 101/128 [2:48:28<46:55, 104.28s/it]EarlyStopping counter : 30 out of 40
training process:  80%|███████▉  | 102/128 [2:50:01<43:44, 100.95s/it]EarlyStopping counter : 31 out of 40
training process:  80%|████████  | 103/128 [2:51:37<41:24, 99.38s/it] EarlyStopping counter : 32 out of 40
training process:  81%|████████▏ | 104/128 [2:53:08<38:47, 96.96s/it]epoch : 105, train loss : -5.290, valid loss : 5.806, train acc : 0.992, valid acc : 0.950, train f1 : 0.992, valid f1 : 0.655

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 340.73it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 347.44it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 350.17it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 351.59it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 352.30it/s][A100%|██████████| 194/194 [00:00<00:00, 350.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 33 out of 40
training process:  82%|████████▏ | 105/128 [2:55:07<39:40, 103.51s/it]EarlyStopping counter : 34 out of 40
training process:  83%|████████▎ | 106/128 [2:56:40<36:49, 100.44s/it]EarlyStopping counter : 35 out of 40
training process:  84%|████████▎ | 107/128 [2:58:16<34:42, 99.17s/it] EarlyStopping counter : 36 out of 40
training process:  84%|████████▍ | 108/128 [2:59:49<32:21, 97.10s/it]epoch : 109, train loss : -5.397, valid loss : 9.494, train acc : 0.992, valid acc : 0.942, train f1 : 0.992, valid f1 : 0.640

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 332.30it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 341.21it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 344.51it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 343.11it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 344.65it/s][A100%|██████████| 194/194 [00:00<00:00, 343.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 37 out of 40
training process:  85%|████████▌ | 109/128 [3:01:47<32:47, 103.54s/it]EarlyStopping counter : 38 out of 40
training process:  86%|████████▌ | 110/128 [3:03:20<30:03, 100.22s/it]EarlyStopping counter : 39 out of 40
training process:  87%|████████▋ | 111/128 [3:04:52<27:46, 98.02s/it] EarlyStopping counter : 40 out of 40
Early stopping | epoch : 111, best f1 score : 0.671
training process:  87%|████████▋ | 111/128 [3:06:26<28:33, 100.78s/it]
training process finished, best loss : 1.908 and best acc : 0.955, best f1 : 0.671, best epoch : 71

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.33      0.39      0.36       453
           1       0.98      0.98      0.98     16880

    accuracy                           0.96     17333
   macro avg       0.66      0.69      0.67     17333
weighted avg       0.97      0.96      0.96     17333


# test acc : 0.96, test f1 : 0.67, test AUC : 0.69, test loss : 610.587

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:13<03:30, 13.18s/it]processing for feature importance:  12%|█▏        | 2/17 [00:25<03:10, 12.73s/it]processing for feature importance:  18%|█▊        | 3/17 [00:39<03:05, 13.27s/it]processing for feature importance:  24%|██▎       | 4/17 [00:51<02:47, 12.86s/it]processing for feature importance:  29%|██▉       | 5/17 [01:03<02:31, 12.63s/it]processing for feature importance:  35%|███▌      | 6/17 [01:16<02:18, 12.59s/it]processing for feature importance:  41%|████      | 7/17 [01:28<02:04, 12.49s/it]processing for feature importance:  47%|████▋     | 8/17 [01:41<01:52, 12.45s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:53<01:40, 12.53s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:06<01:27, 12.47s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:18<01:14, 12.37s/it]processing for feature importance:  71%|███████   | 12/17 [02:31<01:03, 12.61s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:44<00:50, 12.63s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:56<00:37, 12.55s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:09<00:25, 12.83s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:22<00:12, 12.78s/it]processing for feature importance: 100%|██████████| 17/17 [03:36<00:00, 13.06s/it]processing for feature importance: 100%|██████████| 17/17 [03:36<00:00, 12.73s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<12:20,  3.51s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<08:46,  2.51s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:06,  1.88s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:29,  1.36s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:02<10:16,  2.92s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<04:47,  1.37s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<06:27,  1.84s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:05,  1.87s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:29,  1.35s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 16%|█▋        | 32/194 [00:00<00:00, 318.62it/s] 35%|███▌      | 68/194 [00:00<00:00, 337.35it/s] 54%|█████▎    | 104/194 [00:00<00:00, 343.51it/s] 72%|███████▏  | 140/194 [00:00<00:00, 346.29it/s] 91%|█████████ | 176/194 [00:00<00:00, 348.53it/s]100%|██████████| 194/194 [00:00<00:00, 345.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_CE_smoothing_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 207.75it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 204.88it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 202.70it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 204.45it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 206.00it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 208.65it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 211.24it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 212.94it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 210.41it/s]remove invalid data : null / measurement error:  35%|███▍      | 215/616 [00:01<00:01, 209.73it/s]remove invalid data : null / measurement error:  38%|███▊      | 236/616 [00:01<00:01, 209.58it/s]remove invalid data : null / measurement error:  42%|████▏     | 257/616 [00:01<00:01, 208.81it/s]remove invalid data : null / measurement error:  45%|████▌     | 279/616 [00:01<00:01, 209.28it/s]remove invalid data : null / measurement error:  49%|████▊     | 300/616 [00:01<00:01, 207.82it/s]remove invalid data : null / measurement error:  52%|█████▏    | 321/616 [00:01<00:01, 205.71it/s]remove invalid data : null / measurement error:  56%|█████▌    | 342/616 [00:01<00:01, 204.63it/s]remove invalid data : null / measurement error:  59%|█████▉    | 363/616 [00:01<00:01, 206.13it/s]remove invalid data : null / measurement error:  63%|██████▎   | 389/616 [00:01<00:01, 219.95it/s]remove invalid data : null / measurement error:  68%|██████▊   | 417/616 [00:01<00:00, 235.39it/s]remove invalid data : null / measurement error:  72%|███████▏  | 441/616 [00:02<00:00, 230.55it/s]remove invalid data : null / measurement error:  75%|███████▌  | 465/616 [00:02<00:00, 230.12it/s]remove invalid data : null / measurement error:  79%|███████▉  | 489/616 [00:02<00:00, 222.20it/s]remove invalid data : null / measurement error:  83%|████████▎ | 512/616 [00:02<00:00, 214.77it/s]remove invalid data : null / measurement error:  87%|████████▋ | 534/616 [00:02<00:00, 210.78it/s]remove invalid data : null / measurement error:  90%|█████████ | 556/616 [00:02<00:00, 207.96it/s]remove invalid data : null / measurement error:  94%|█████████▎| 577/616 [00:02<00:00, 207.38it/s]remove invalid data : null / measurement error:  97%|█████████▋| 598/616 [00:02<00:00, 207.23it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 211.65it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 25/515 [00:00<00:02, 241.08it/s]replace nan value:  10%|▉         | 50/515 [00:00<00:01, 241.11it/s]replace nan value:  15%|█▍        | 75/515 [00:00<00:01, 241.93it/s]replace nan value:  19%|█▉        | 100/515 [00:00<00:01, 244.04it/s]replace nan value:  24%|██▍       | 125/515 [00:00<00:01, 245.17it/s]replace nan value:  29%|██▉       | 150/515 [00:00<00:01, 246.38it/s]replace nan value:  34%|███▍      | 175/515 [00:00<00:01, 247.10it/s]replace nan value:  39%|███▉      | 200/515 [00:00<00:01, 247.16it/s]replace nan value:  44%|████▎     | 225/515 [00:00<00:01, 247.55it/s]replace nan value:  49%|████▊     | 250/515 [00:01<00:01, 247.87it/s]replace nan value:  54%|█████▎    | 276/515 [00:01<00:00, 248.55it/s]replace nan value:  58%|█████▊    | 301/515 [00:01<00:00, 247.62it/s]replace nan value:  63%|██████▎   | 326/515 [00:01<00:00, 247.84it/s]replace nan value:  68%|██████▊   | 351/515 [00:01<00:00, 244.16it/s]replace nan value:  73%|███████▎  | 376/515 [00:01<00:00, 245.74it/s]replace nan value:  78%|███████▊  | 401/515 [00:01<00:00, 246.50it/s]replace nan value:  83%|████████▎ | 426/515 [00:01<00:00, 246.65it/s]replace nan value:  88%|████████▊ | 451/515 [00:01<00:00, 244.47it/s]replace nan value:  92%|█████████▏| 476/515 [00:01<00:00, 243.79it/s]replace nan value:  97%|█████████▋| 501/515 [00:02<00:00, 243.88it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 245.37it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.13it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 55.70it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 74.60it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 71.84it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 71.95it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.11it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 57.06it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.59it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 54.14it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 53.50it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 61.63it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 61.42it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 59.43it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.34it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 63.92it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 71.71it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 71.88it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 72.56it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 72.20it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 73.01it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.07it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 69.86it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.09it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 71.55it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 64.61it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.12it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 82.71it/s]generate index:  45%|████▌     | 232/515 [00:03<00:03, 87.36it/s]generate index:  47%|████▋     | 242/515 [00:03<00:03, 89.99it/s]generate index:  49%|████▉     | 252/515 [00:03<00:03, 75.34it/s]generate index:  51%|█████     | 261/515 [00:03<00:03, 73.96it/s]generate index:  52%|█████▏    | 270/515 [00:03<00:03, 76.79it/s]generate index:  54%|█████▍    | 278/515 [00:04<00:03, 68.23it/s]generate index:  56%|█████▌    | 286/515 [00:04<00:03, 63.05it/s]generate index:  57%|█████▋    | 294/515 [00:04<00:03, 65.81it/s]generate index:  58%|█████▊    | 301/515 [00:04<00:03, 59.83it/s]generate index:  60%|█████▉    | 308/515 [00:04<00:03, 61.04it/s]generate index:  61%|██████    | 315/515 [00:04<00:03, 59.71it/s]generate index:  63%|██████▎   | 323/515 [00:04<00:03, 63.54it/s]generate index:  64%|██████▍   | 331/515 [00:04<00:02, 63.85it/s]generate index:  66%|██████▌   | 338/515 [00:05<00:03, 52.28it/s]generate index:  67%|██████▋   | 344/515 [00:05<00:03, 47.68it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:03, 42.81it/s]generate index:  70%|███████   | 362/515 [00:05<00:02, 59.09it/s]generate index:  73%|███████▎  | 374/515 [00:05<00:01, 71.94it/s]generate index:  74%|███████▍  | 383/515 [00:05<00:01, 74.37it/s]generate index:  76%|███████▌  | 392/515 [00:05<00:01, 73.08it/s]generate index:  78%|███████▊  | 401/515 [00:06<00:01, 74.96it/s]generate index:  79%|███████▉  | 409/515 [00:06<00:01, 63.86it/s]generate index:  81%|████████  | 417/515 [00:06<00:01, 64.90it/s]generate index:  83%|████████▎ | 429/515 [00:06<00:01, 76.14it/s]generate index:  85%|████████▍ | 437/515 [00:06<00:01, 56.16it/s]generate index:  86%|████████▌ | 444/515 [00:06<00:01, 48.98it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 59.74it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.30it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.44it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 67.57it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 65.50it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.37it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.28it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.61it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 5/154 [00:00<00:03, 48.26it/s]remove invalid data : null / measurement error:  17%|█▋        | 26/154 [00:00<00:00, 141.83it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 174.05it/s]remove invalid data : null / measurement error:  45%|████▌     | 70/154 [00:00<00:00, 190.73it/s]remove invalid data : null / measurement error:  60%|█████▉    | 92/154 [00:00<00:00, 197.88it/s]remove invalid data : null / measurement error:  76%|███████▌  | 117/154 [00:00<00:00, 212.53it/s]remove invalid data : null / measurement error:  90%|█████████ | 139/154 [00:00<00:00, 210.72it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 193.55it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 254.16it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 255.64it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 256.42it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 253.28it/s]replace nan value:  99%|█████████▉| 130/131 [00:00<00:00, 255.31it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 254.91it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   6%|▌         | 8/131 [00:00<00:01, 71.89it/s]generate index:  12%|█▏        | 16/131 [00:00<00:02, 50.38it/s]generate index:  18%|█▊        | 23/131 [00:00<00:01, 56.40it/s]generate index:  24%|██▎       | 31/131 [00:00<00:01, 58.73it/s]generate index:  30%|██▉       | 39/131 [00:00<00:01, 64.30it/s]generate index:  35%|███▌      | 46/131 [00:00<00:01, 64.33it/s]generate index:  40%|████      | 53/131 [00:00<00:01, 60.45it/s]generate index:  47%|████▋     | 62/131 [00:00<00:01, 67.99it/s]generate index:  53%|█████▎    | 69/131 [00:01<00:00, 67.82it/s]generate index:  58%|█████▊    | 76/131 [00:01<00:00, 65.41it/s]generate index:  63%|██████▎   | 83/131 [00:01<00:00, 64.49it/s]generate index:  69%|██████▊   | 90/131 [00:01<00:00, 46.50it/s]generate index:  73%|███████▎  | 96/131 [00:01<00:00, 48.50it/s]generate index:  78%|███████▊  | 102/131 [00:01<00:00, 48.97it/s]generate index:  82%|████████▏ | 108/131 [00:01<00:00, 50.59it/s]generate index:  89%|████████▊ | 116/131 [00:02<00:00, 57.59it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 70.44it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.10it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 10/193 [00:00<00:01, 99.16it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:00, 163.18it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 188.39it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 200.19it/s]remove invalid data : null / measurement error:  50%|█████     | 97/193 [00:00<00:00, 205.31it/s]remove invalid data : null / measurement error:  62%|██████▏   | 120/193 [00:00<00:00, 211.45it/s]remove invalid data : null / measurement error:  75%|███████▌  | 145/193 [00:00<00:00, 220.89it/s]remove invalid data : null / measurement error:  87%|████████▋ | 168/193 [00:00<00:00, 215.88it/s]remove invalid data : null / measurement error:  98%|█████████▊| 190/193 [00:00<00:00, 212.85it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 203.92it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 255.82it/s]replace nan value:  33%|███▎      | 53/160 [00:00<00:00, 258.51it/s]replace nan value:  49%|████▉     | 79/160 [00:00<00:00, 257.56it/s]replace nan value:  66%|██████▌   | 105/160 [00:00<00:00, 251.78it/s]replace nan value:  82%|████████▏ | 131/160 [00:00<00:00, 252.18it/s]replace nan value:  98%|█████████▊| 157/160 [00:00<00:00, 251.50it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 252.92it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 102.71it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.91it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.33it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.04it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 81.93it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 83.98it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.45it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.54it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.74it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.64it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.88it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 49.99it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.98it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.22it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.80it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.52it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.76it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 64.14it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 63.34it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : -0.505, valid loss : -0.858, train acc : 0.574, valid acc : 0.507, train f1 : 0.386, valid f1 : 0.358

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 341.94it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 350.15it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 353.44it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 355.11it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 356.18it/s][A100%|██████████| 194/194 [00:00<00:00, 354.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.358
training process:   1%|          | 1/128 [01:59<4:13:13, 119.64s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:29<3:34:01, 101.92s/it]EarlyStopping counter : 2 out of 40
training process:   2%|▏         | 3/128 [04:57<3:19:21, 95.69s/it] EarlyStopping counter : 3 out of 40
training process:   3%|▎         | 4/128 [06:27<3:12:52, 93.32s/it]epoch : 5, train loss : -3.182, valid loss : -4.233, train acc : 0.452, valid acc : 0.428, train f1 : 0.337, valid f1 : 0.323

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 329.14it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 340.25it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 341.05it/s][A
 71%|███████   | 138/194 [00:00<00:00, 343.89it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 345.61it/s][A100%|██████████| 194/194 [00:00<00:00, 343.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:   4%|▍         | 5/128 [08:22<3:27:18, 101.13s/it]EarlyStopping counter : 5 out of 40
training process:   5%|▍         | 6/128 [09:52<3:17:59, 97.37s/it] EarlyStopping counter : 6 out of 40
training process:   5%|▌         | 7/128 [11:20<3:10:35, 94.51s/it]EarlyStopping counter : 7 out of 40
training process:   6%|▋         | 8/128 [12:49<3:05:32, 92.77s/it]epoch : 9, train loss : -6.688, valid loss : -7.908, train acc : 0.295, valid acc : 0.205, train f1 : 0.249, valid f1 : 0.185

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 333.20it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 337.28it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 338.37it/s][A
 71%|███████   | 137/194 [00:00<00:00, 337.00it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 338.46it/s][A100%|██████████| 194/194 [00:00<00:00, 338.05it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:   7%|▋         | 9/128 [14:41<3:15:51, 98.76s/it]EarlyStopping counter : 9 out of 40
training process:   8%|▊         | 10/128 [16:12<3:09:24, 96.31s/it]EarlyStopping counter : 10 out of 40
training process:   9%|▊         | 11/128 [17:44<3:05:21, 95.06s/it]EarlyStopping counter : 11 out of 40
training process:   9%|▉         | 12/128 [19:17<3:02:23, 94.34s/it]epoch : 13, train loss : -11.217, valid loss : -13.282, train acc : 0.294, valid acc : 0.209, train f1 : 0.250, valid f1 : 0.188

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 332.84it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 338.12it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 339.87it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 340.84it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 341.20it/s][A100%|██████████| 194/194 [00:00<00:00, 340.17it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  10%|█         | 13/128 [21:15<3:14:22, 101.41s/it]EarlyStopping counter : 13 out of 40
training process:  11%|█         | 14/128 [22:43<3:05:22, 97.57s/it] EarlyStopping counter : 14 out of 40
training process:  12%|█▏        | 15/128 [24:13<2:59:09, 95.13s/it]EarlyStopping counter : 15 out of 40
training process:  12%|█▎        | 16/128 [25:40<2:52:50, 92.59s/it]epoch : 17, train loss : -16.607, valid loss : -19.548, train acc : 0.253, valid acc : 0.202, train f1 : 0.222, valid f1 : 0.182

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 303.64it/s][A
 33%|███▎      | 64/194 [00:00<00:00, 318.88it/s][A
 51%|█████     | 98/194 [00:00<00:00, 324.99it/s][A
 68%|██████▊   | 132/194 [00:00<00:00, 330.76it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 335.81it/s][A100%|██████████| 194/194 [00:00<00:00, 330.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  13%|█▎        | 17/128 [27:33<3:02:44, 98.78s/it]EarlyStopping counter : 17 out of 40
training process:  14%|█▍        | 18/128 [29:01<2:55:30, 95.73s/it]EarlyStopping counter : 18 out of 40
training process:  15%|█▍        | 19/128 [30:31<2:50:23, 93.79s/it]EarlyStopping counter : 19 out of 40
training process:  16%|█▌        | 20/128 [32:01<2:46:51, 92.70s/it]epoch : 21, train loss : -22.631, valid loss : -24.295, train acc : 0.221, valid acc : 0.183, train f1 : 0.198, valid f1 : 0.168

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 266.32it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 272.04it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 273.86it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 274.54it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 274.72it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 274.16it/s][A100%|██████████| 194/194 [00:00<00:00, 273.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 20 out of 40
training process:  16%|█▋        | 21/128 [33:57<2:57:44, 99.67s/it]EarlyStopping counter : 21 out of 40
training process:  17%|█▋        | 22/128 [35:27<2:51:06, 96.85s/it]EarlyStopping counter : 22 out of 40
training process:  18%|█▊        | 23/128 [36:55<2:45:02, 94.30s/it]EarlyStopping counter : 23 out of 40
training process:  19%|█▉        | 24/128 [38:25<2:40:52, 92.82s/it]epoch : 25, train loss : -28.341, valid loss : -34.247, train acc : 0.230, valid acc : 0.162, train f1 : 0.205, valid f1 : 0.151

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 332.39it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 336.49it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 338.37it/s][A
 71%|███████   | 138/194 [00:00<00:00, 339.31it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 339.66it/s][A100%|██████████| 194/194 [00:00<00:00, 338.68it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 24 out of 40
training process:  20%|█▉        | 25/128 [40:20<2:50:57, 99.58s/it]EarlyStopping counter : 25 out of 40
training process:  20%|██        | 26/128 [41:47<2:42:45, 95.74s/it]EarlyStopping counter : 26 out of 40
training process:  21%|██        | 27/128 [43:16<2:38:04, 93.91s/it]EarlyStopping counter : 27 out of 40
training process:  22%|██▏       | 28/128 [44:47<2:34:48, 92.89s/it]epoch : 29, train loss : -33.980, valid loss : -39.768, train acc : 0.218, valid acc : 0.132, train f1 : 0.196, valid f1 : 0.126

  0%|          | 0/194 [00:00<?, ?it/s][A
 15%|█▍        | 29/194 [00:00<00:00, 282.92it/s][A
 30%|██▉       | 58/194 [00:00<00:00, 286.15it/s][A
 45%|████▍     | 87/194 [00:00<00:00, 286.59it/s][A
 60%|█████▉    | 116/194 [00:00<00:00, 287.08it/s][A
 75%|███████▍  | 145/194 [00:00<00:00, 287.34it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 287.39it/s][A100%|██████████| 194/194 [00:00<00:00, 287.02it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 28 out of 40
training process:  23%|██▎       | 29/128 [46:45<2:45:33, 100.34s/it]EarlyStopping counter : 29 out of 40
training process:  23%|██▎       | 30/128 [48:15<2:39:04, 97.39s/it] EarlyStopping counter : 30 out of 40
training process:  24%|██▍       | 31/128 [49:42<2:32:28, 94.32s/it]EarlyStopping counter : 31 out of 40
training process:  25%|██▌       | 32/128 [51:10<2:27:43, 92.33s/it]epoch : 33, train loss : -40.012, valid loss : -48.012, train acc : 0.204, valid acc : 0.181, train f1 : 0.185, valid f1 : 0.166

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 333.12it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 338.04it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 339.88it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 340.72it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 338.90it/s][A100%|██████████| 194/194 [00:00<00:00, 339.14it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 32 out of 40
training process:  26%|██▌       | 33/128 [53:05<2:36:44, 98.99s/it]EarlyStopping counter : 33 out of 40
training process:  27%|██▋       | 34/128 [54:31<2:29:19, 95.31s/it]EarlyStopping counter : 34 out of 40
training process:  27%|██▋       | 35/128 [56:01<2:25:00, 93.55s/it]EarlyStopping counter : 35 out of 40
training process:  28%|██▊       | 36/128 [57:30<2:21:26, 92.24s/it]epoch : 37, train loss : -46.604, valid loss : -63.349, train acc : 0.231, valid acc : 0.169, train f1 : 0.206, valid f1 : 0.157

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 332.96it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 338.08it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 339.03it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 340.12it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 340.80it/s][A100%|██████████| 194/194 [00:00<00:00, 339.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 36 out of 40
training process:  29%|██▉       | 37/128 [59:23<2:29:34, 98.62s/it]EarlyStopping counter : 37 out of 40
training process:  30%|██▉       | 38/128 [1:00:52<2:23:30, 95.67s/it]EarlyStopping counter : 38 out of 40
training process:  30%|███       | 39/128 [1:02:20<2:18:29, 93.37s/it]EarlyStopping counter : 39 out of 40
training process:  31%|███▏      | 40/128 [1:03:48<2:14:29, 91.70s/it]epoch : 41, train loss : -52.723, valid loss : -76.707, train acc : 0.195, valid acc : 0.164, train f1 : 0.178, valid f1 : 0.153

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 331.73it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 330.54it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 279.56it/s][A
 69%|██████▉   | 134/194 [00:00<00:00, 293.63it/s][A
 85%|████████▌ | 165/194 [00:00<00:00, 272.82it/s][A100%|██████████| 194/194 [00:00<00:00, 287.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 40 out of 40
Early stopping | epoch : 40, best f1 score : 0.358
training process:  31%|███▏      | 40/128 [1:05:41<2:24:30, 98.53s/it]
training process finished, best loss : -0.858 and best acc : 0.507, best f1 : 0.358, best epoch : 0

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.03      0.55      0.05       453
           1       0.98      0.50      0.66     16880

    accuracy                           0.50     17333
   macro avg       0.50      0.52      0.36     17333
weighted avg       0.95      0.50      0.64     17333


# test acc : 0.50, test f1 : 0.36, test AUC : 0.52, test loss : -227.256

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:00, 11.29s/it]processing for feature importance:  12%|█▏        | 2/17 [00:22<02:52, 11.53s/it]processing for feature importance:  18%|█▊        | 3/17 [00:34<02:41, 11.54s/it]processing for feature importance:  24%|██▎       | 4/17 [00:46<02:30, 11.57s/it]processing for feature importance:  29%|██▉       | 5/17 [00:57<02:19, 11.59s/it]processing for feature importance:  35%|███▌      | 6/17 [01:09<02:06, 11.47s/it]processing for feature importance:  41%|████      | 7/17 [01:19<01:52, 11.28s/it]processing for feature importance:  47%|████▋     | 8/17 [01:31<01:42, 11.38s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:42<01:29, 11.13s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:53<01:18, 11.25s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:04<01:06, 11.08s/it]processing for feature importance:  71%|███████   | 12/17 [02:16<00:56, 11.38s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:28<00:46, 11.66s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:40<00:35, 11.77s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:53<00:23, 11.95s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:04<00:11, 11.91s/it]processing for feature importance: 100%|██████████| 17/17 [03:16<00:00, 11.79s/it]processing for feature importance: 100%|██████████| 17/17 [03:16<00:00, 11.55s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:02<09:41,  2.76s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<05:26,  1.56s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<09:26,  2.70s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.94s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:25,  1.29s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:15,  3.20s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<05:57,  1.70s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:13,  2.63s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
Transformer_clip_10_dist_2_CE_smoothing_RW_Robust_TQ_seed_42 : visualize 2D latent space doesn't work due to stability error

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 16%|█▌        | 31/194 [00:00<00:00, 308.92it/s] 34%|███▍      | 66/194 [00:00<00:00, 329.29it/s] 52%|█████▏    | 100/194 [00:00<00:00, 333.94it/s] 70%|██████▉   | 135/194 [00:00<00:00, 338.69it/s] 88%|████████▊ | 170/194 [00:00<00:00, 341.36it/s]100%|██████████| 194/194 [00:00<00:00, 337.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_Focal_Normal_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 203.93it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 201.92it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 200.08it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 202.35it/s]remove invalid data : null / measurement error:  17%|█▋        | 105/616 [00:00<00:02, 204.14it/s]remove invalid data : null / measurement error:  21%|██        | 127/616 [00:00<00:02, 207.36it/s]remove invalid data : null / measurement error:  24%|██▍       | 149/616 [00:00<00:02, 209.72it/s]remove invalid data : null / measurement error:  28%|██▊       | 171/616 [00:00<00:02, 211.28it/s]remove invalid data : null / measurement error:  31%|███▏      | 193/616 [00:00<00:02, 208.72it/s]remove invalid data : null / measurement error:  35%|███▍      | 214/616 [00:01<00:01, 208.40it/s]remove invalid data : null / measurement error:  38%|███▊      | 235/616 [00:01<00:01, 208.74it/s]remove invalid data : null / measurement error:  42%|████▏     | 256/616 [00:01<00:01, 207.80it/s]remove invalid data : null / measurement error:  45%|████▌     | 278/616 [00:01<00:01, 208.48it/s]remove invalid data : null / measurement error:  49%|████▊     | 299/616 [00:01<00:01, 207.79it/s]remove invalid data : null / measurement error:  52%|█████▏    | 320/616 [00:01<00:01, 206.42it/s]remove invalid data : null / measurement error:  55%|█████▌    | 341/616 [00:01<00:01, 205.69it/s]remove invalid data : null / measurement error:  59%|█████▉    | 362/616 [00:01<00:01, 206.73it/s]remove invalid data : null / measurement error:  63%|██████▎   | 388/616 [00:01<00:01, 221.07it/s]remove invalid data : null / measurement error:  68%|██████▊   | 416/616 [00:01<00:00, 236.77it/s]remove invalid data : null / measurement error:  71%|███████▏  | 440/616 [00:02<00:00, 232.16it/s]remove invalid data : null / measurement error:  75%|███████▌  | 464/616 [00:02<00:00, 233.00it/s]remove invalid data : null / measurement error:  79%|███████▉  | 488/616 [00:02<00:00, 225.27it/s]remove invalid data : null / measurement error:  83%|████████▎ | 511/616 [00:02<00:00, 219.38it/s]remove invalid data : null / measurement error:  87%|████████▋ | 533/616 [00:02<00:00, 215.35it/s]remove invalid data : null / measurement error:  90%|█████████ | 555/616 [00:02<00:00, 212.43it/s]remove invalid data : null / measurement error:  94%|█████████▎| 577/616 [00:02<00:00, 210.05it/s]remove invalid data : null / measurement error:  97%|█████████▋| 599/616 [00:02<00:00, 208.48it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 212.15it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 237.99it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 237.56it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 238.28it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 240.26it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 241.50it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 243.09it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 244.04it/s]replace nan value:  38%|███▊      | 197/515 [00:00<00:01, 244.05it/s]replace nan value:  43%|████▎     | 222/515 [00:00<00:01, 244.24it/s]replace nan value:  48%|████▊     | 247/515 [00:01<00:01, 244.82it/s]replace nan value:  53%|█████▎    | 272/515 [00:01<00:00, 245.55it/s]replace nan value:  58%|█████▊    | 297/515 [00:01<00:00, 245.67it/s]replace nan value:  63%|██████▎   | 322/515 [00:01<00:00, 246.83it/s]replace nan value:  67%|██████▋   | 347/515 [00:01<00:00, 244.79it/s]replace nan value:  72%|███████▏  | 372/515 [00:01<00:00, 245.12it/s]replace nan value:  77%|███████▋  | 397/515 [00:01<00:00, 245.48it/s]replace nan value:  82%|████████▏ | 422/515 [00:01<00:00, 244.58it/s]replace nan value:  87%|████████▋ | 447/515 [00:01<00:00, 242.60it/s]replace nan value:  92%|█████████▏| 472/515 [00:01<00:00, 243.01it/s]replace nan value:  97%|█████████▋| 497/515 [00:02<00:00, 243.84it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 243.64it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.85it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.65it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 75.76it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 72.92it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 72.57it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 54.93it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 57.91it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.35it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.32it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.53it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.75it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.44it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 60.34it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 66.37it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 64.92it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 72.87it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 73.05it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 73.74it/s]generate index:  30%|██▉       | 152/515 [00:02<00:04, 73.34it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 74.15it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 73.24it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 71.25it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 72.59it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.99it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 65.80it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 73.41it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 84.51it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 90.27it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 90.17it/s]generate index:  49%|████▉     | 253/515 [00:03<00:03, 75.11it/s]generate index:  51%|█████     | 262/515 [00:03<00:03, 77.94it/s]generate index:  53%|█████▎    | 272/515 [00:03<00:02, 81.99it/s]generate index:  55%|█████▍    | 281/515 [00:04<00:03, 65.94it/s]generate index:  56%|█████▌    | 289/515 [00:04<00:03, 67.52it/s]generate index:  58%|█████▊    | 297/515 [00:04<00:03, 64.80it/s]generate index:  59%|█████▉    | 304/515 [00:04<00:03, 64.65it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 66.08it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 62.59it/s]generate index:  63%|██████▎   | 327/515 [00:04<00:02, 66.51it/s]generate index:  65%|██████▍   | 334/515 [00:04<00:02, 60.35it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 48.51it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 46.48it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 52.72it/s]generate index:  71%|███████   | 364/515 [00:05<00:02, 61.07it/s]generate index:  73%|███████▎  | 376/515 [00:05<00:01, 74.54it/s]generate index:  75%|███████▍  | 385/515 [00:05<00:01, 78.20it/s]generate index:  77%|███████▋  | 394/515 [00:05<00:01, 78.68it/s]generate index:  78%|███████▊  | 403/515 [00:05<00:01, 73.59it/s]generate index:  80%|███████▉  | 411/515 [00:06<00:01, 65.71it/s]generate index:  82%|████████▏ | 422/515 [00:06<00:01, 76.13it/s]generate index:  84%|████████▎ | 431/515 [00:06<00:01, 73.47it/s]generate index:  85%|████████▌ | 439/515 [00:06<00:01, 52.83it/s]generate index:  87%|████████▋ | 446/515 [00:06<00:01, 52.75it/s]generate index:  89%|████████▊ | 456/515 [00:06<00:00, 62.14it/s]generate index:  90%|█████████ | 464/515 [00:06<00:00, 66.22it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 58.83it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 69.40it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 67.19it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 55.27it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 57.68it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 47.19it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 64.66it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▌         | 8/154 [00:00<00:01, 79.87it/s]remove invalid data : null / measurement error:  18%|█▊        | 28/154 [00:00<00:00, 149.71it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 172.45it/s]remove invalid data : null / measurement error:  45%|████▍     | 69/154 [00:00<00:00, 185.22it/s]remove invalid data : null / measurement error:  58%|█████▊    | 89/154 [00:00<00:00, 189.81it/s]remove invalid data : null / measurement error:  73%|███████▎  | 113/154 [00:00<00:00, 204.56it/s]remove invalid data : null / measurement error:  87%|████████▋ | 134/154 [00:00<00:00, 202.39it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 188.90it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 24/131 [00:00<00:00, 237.78it/s]replace nan value:  37%|███▋      | 49/131 [00:00<00:00, 240.39it/s]replace nan value:  56%|█████▋    | 74/131 [00:00<00:00, 241.79it/s]replace nan value:  76%|███████▌  | 99/131 [00:00<00:00, 239.43it/s]replace nan value:  95%|█████████▍| 124/131 [00:00<00:00, 240.71it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 240.52it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 67.93it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 48.92it/s]generate index:  17%|█▋        | 22/131 [00:00<00:02, 54.24it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 60.53it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 62.70it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 60.61it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 60.64it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 62.65it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 66.49it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 68.33it/s]generate index:  62%|██████▏   | 81/131 [00:01<00:00, 62.77it/s]generate index:  67%|██████▋   | 88/131 [00:01<00:00, 47.32it/s]generate index:  72%|███████▏  | 94/131 [00:01<00:00, 47.16it/s]generate index:  76%|███████▋  | 100/131 [00:01<00:00, 45.85it/s]generate index:  81%|████████  | 106/131 [00:01<00:00, 46.99it/s]generate index:  87%|████████▋ | 114/131 [00:02<00:00, 54.62it/s]generate index:  94%|█████████▍| 123/131 [00:02<00:00, 63.27it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.67it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▎         | 7/193 [00:00<00:02, 68.82it/s]remove invalid data : null / measurement error:  15%|█▍        | 28/193 [00:00<00:01, 148.64it/s]remove invalid data : null / measurement error:  25%|██▌       | 49/193 [00:00<00:00, 173.07it/s]remove invalid data : null / measurement error:  36%|███▋      | 70/193 [00:00<00:00, 186.05it/s]remove invalid data : null / measurement error:  47%|████▋     | 91/193 [00:00<00:00, 193.35it/s]remove invalid data : null / measurement error:  58%|█████▊    | 111/193 [00:00<00:00, 194.24it/s]remove invalid data : null / measurement error:  70%|██████▉   | 135/193 [00:00<00:00, 208.26it/s]remove invalid data : null / measurement error:  81%|████████  | 156/193 [00:00<00:00, 207.05it/s]remove invalid data : null / measurement error:  92%|█████████▏| 177/193 [00:00<00:00, 203.82it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 191.79it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 25/160 [00:00<00:00, 240.61it/s]replace nan value:  31%|███▏      | 50/160 [00:00<00:00, 205.26it/s]replace nan value:  44%|████▍     | 71/160 [00:00<00:00, 202.19it/s]replace nan value:  60%|██████    | 96/160 [00:00<00:00, 218.76it/s]replace nan value:  76%|███████▌  | 121/160 [00:00<00:00, 229.09it/s]replace nan value:  91%|█████████▏| 146/160 [00:00<00:00, 234.80it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 227.22it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 99.52it/s]generate index:  13%|█▎        | 21/160 [00:00<00:02, 63.35it/s]generate index:  18%|█▊        | 29/160 [00:00<00:02, 60.64it/s]generate index:  25%|██▌       | 40/160 [00:00<00:01, 74.72it/s]generate index:  31%|███▏      | 50/160 [00:00<00:01, 80.84it/s]generate index:  37%|███▋      | 59/160 [00:00<00:01, 81.61it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 84.40it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 69.31it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 59.76it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 60.47it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 53.95it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.01it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 59.88it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 61.06it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 56.38it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 55.09it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 59.17it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 63.45it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 62.85it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.050, valid loss : 0.033, train acc : 0.951, valid acc : 0.975, train f1 : 0.504, valid f1 : 0.494

  0%|          | 0/194 [00:00<?, ?it/s][A
 19%|█▊        | 36/194 [00:00<00:00, 353.51it/s][A
 38%|███▊      | 73/194 [00:00<00:00, 358.55it/s][A
 56%|█████▌    | 109/194 [00:00<00:00, 358.37it/s][A
 75%|███████▍  | 145/194 [00:00<00:00, 358.85it/s][A
 94%|█████████▍| 182/194 [00:00<00:00, 360.62it/s][A100%|██████████| 194/194 [00:00<00:00, 359.53it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.494
training process:   1%|          | 1/128 [02:00<4:15:32, 120.73s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 2/128 [03:28<3:32:12, 101.06s/it]Best score increase :0.494 -> 0.501
training process:   2%|▏         | 3/128 [04:52<3:15:08, 93.67s/it] EarlyStopping counter : 1 out of 40
training process:   3%|▎         | 4/128 [06:23<3:10:48, 92.32s/it]epoch : 5, train loss : 0.026, valid loss : 0.028, train acc : 0.974, valid acc : 0.973, train f1 : 0.554, valid f1 : 0.553

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 333.33it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 340.70it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 343.16it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 344.48it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 344.99it/s][A100%|██████████| 194/194 [00:00<00:00, 343.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.501 -> 0.553
training process:   4%|▍         | 5/128 [08:14<3:23:41, 99.36s/it]Best score increase :0.553 -> 0.583
training process:   5%|▍         | 6/128 [09:42<3:14:10, 95.50s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▌         | 7/128 [11:11<3:08:02, 93.24s/it]EarlyStopping counter : 2 out of 40
training process:   6%|▋         | 8/128 [12:40<3:03:53, 91.95s/it]epoch : 9, train loss : 0.022, valid loss : 0.025, train acc : 0.975, valid acc : 0.973, train f1 : 0.630, valid f1 : 0.629

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 340.97it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 345.21it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 346.59it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 347.21it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 346.12it/s][A100%|██████████| 194/194 [00:00<00:00, 346.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.583 -> 0.629
training process:   7%|▋         | 9/128 [14:36<3:16:51, 99.26s/it]EarlyStopping counter : 1 out of 40
training process:   8%|▊         | 10/128 [16:08<3:10:53, 97.06s/it]EarlyStopping counter : 2 out of 40
training process:   9%|▊         | 11/128 [17:42<3:07:28, 96.15s/it]Best score increase :0.629 -> 0.639
training process:   9%|▉         | 12/128 [19:14<3:03:48, 95.07s/it]epoch : 13, train loss : 0.019, valid loss : 0.026, train acc : 0.977, valid acc : 0.973, train f1 : 0.686, valid f1 : 0.681

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 346.91it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 350.61it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 351.43it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 351.72it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 352.30it/s][A100%|██████████| 194/194 [00:00<00:00, 351.56it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.639 -> 0.681
training process:  10%|█         | 13/128 [21:13<3:15:49, 102.17s/it]EarlyStopping counter : 1 out of 40
training process:  11%|█         | 14/128 [22:42<3:06:25, 98.11s/it] EarlyStopping counter : 2 out of 40
training process:  12%|█▏        | 15/128 [24:09<2:58:22, 94.71s/it]EarlyStopping counter : 3 out of 40
training process:  12%|█▎        | 16/128 [25:36<2:52:45, 92.55s/it]epoch : 17, train loss : 0.017, valid loss : 0.024, train acc : 0.979, valid acc : 0.975, train f1 : 0.731, valid f1 : 0.688

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 336.26it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 341.90it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 344.45it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 345.41it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 346.78it/s][A100%|██████████| 194/194 [00:00<00:00, 345.46it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.681 -> 0.688
training process:  13%|█▎        | 17/128 [27:28<3:02:12, 98.49s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [28:58<2:55:35, 95.78s/it]EarlyStopping counter : 2 out of 40
training process:  15%|█▍        | 19/128 [30:27<2:50:40, 93.95s/it]EarlyStopping counter : 3 out of 40
training process:  16%|█▌        | 20/128 [31:59<2:47:39, 93.15s/it]epoch : 21, train loss : 0.015, valid loss : 0.026, train acc : 0.981, valid acc : 0.972, train f1 : 0.770, valid f1 : 0.680

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 330.22it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.48it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 337.31it/s][A
 70%|███████   | 136/194 [00:00<00:00, 338.07it/s][A
 88%|████████▊ | 170/194 [00:00<00:00, 338.65it/s][A100%|██████████| 194/194 [00:00<00:00, 337.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  16%|█▋        | 21/128 [33:51<2:56:21, 98.89s/it]EarlyStopping counter : 5 out of 40
training process:  17%|█▋        | 22/128 [35:19<2:48:55, 95.62s/it]Best score increase :0.688 -> 0.704
training process:  18%|█▊        | 23/128 [36:49<2:44:08, 93.80s/it]EarlyStopping counter : 1 out of 40
training process:  19%|█▉        | 24/128 [38:17<2:39:52, 92.24s/it]epoch : 25, train loss : 0.013, valid loss : 0.030, train acc : 0.983, valid acc : 0.974, train f1 : 0.809, valid f1 : 0.673

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 339.69it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 344.04it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 345.61it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 346.36it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 346.73it/s][A100%|██████████| 194/194 [00:00<00:00, 345.92it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  20%|█▉        | 25/128 [40:11<2:49:15, 98.60s/it]EarlyStopping counter : 3 out of 40
training process:  20%|██        | 26/128 [41:38<2:42:05, 95.34s/it]EarlyStopping counter : 4 out of 40
training process:  21%|██        | 27/128 [43:08<2:37:46, 93.73s/it]EarlyStopping counter : 5 out of 40
training process:  22%|██▏       | 28/128 [44:37<2:33:42, 92.22s/it]epoch : 29, train loss : 0.011, valid loss : 0.034, train acc : 0.984, valid acc : 0.962, train f1 : 0.828, valid f1 : 0.668

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 341.78it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 345.16it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 346.45it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 347.18it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 347.42it/s][A100%|██████████| 194/194 [00:00<00:00, 346.65it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  23%|██▎       | 29/128 [46:31<2:42:49, 98.68s/it]EarlyStopping counter : 7 out of 40
training process:  23%|██▎       | 30/128 [48:02<2:37:38, 96.52s/it]EarlyStopping counter : 8 out of 40
training process:  24%|██▍       | 31/128 [49:33<2:32:59, 94.63s/it]EarlyStopping counter : 9 out of 40
training process:  25%|██▌       | 32/128 [51:02<2:28:57, 93.10s/it]epoch : 33, train loss : 0.010, valid loss : 0.031, train acc : 0.986, valid acc : 0.969, train f1 : 0.853, valid f1 : 0.682

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 343.46it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 348.02it/s][A
 55%|█████▍    | 106/194 [00:00<00:00, 341.38it/s][A
 73%|███████▎  | 141/194 [00:00<00:00, 344.48it/s][A
 91%|█████████ | 176/194 [00:00<00:00, 346.20it/s][A100%|██████████| 194/194 [00:00<00:00, 345.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  26%|██▌       | 33/128 [52:57<2:37:57, 99.76s/it]EarlyStopping counter : 11 out of 40
training process:  27%|██▋       | 34/128 [54:26<2:31:10, 96.49s/it]EarlyStopping counter : 12 out of 40
training process:  27%|██▋       | 35/128 [55:54<2:25:30, 93.88s/it]EarlyStopping counter : 13 out of 40
training process:  28%|██▊       | 36/128 [57:22<2:21:10, 92.07s/it]epoch : 37, train loss : 0.009, valid loss : 0.036, train acc : 0.987, valid acc : 0.962, train f1 : 0.867, valid f1 : 0.662

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 344.47it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 348.10it/s][A
 55%|█████▍    | 106/194 [00:00<00:00, 348.92it/s][A
 73%|███████▎  | 142/194 [00:00<00:00, 349.96it/s][A
 91%|█████████ | 177/194 [00:00<00:00, 347.58it/s][A100%|██████████| 194/194 [00:00<00:00, 348.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  29%|██▉       | 37/128 [59:14<2:28:43, 98.06s/it]EarlyStopping counter : 15 out of 40
training process:  30%|██▉       | 38/128 [1:00:43<2:23:10, 95.45s/it]EarlyStopping counter : 16 out of 40
training process:  30%|███       | 39/128 [1:02:15<2:19:43, 94.20s/it]EarlyStopping counter : 17 out of 40
training process:  31%|███▏      | 40/128 [1:03:41<2:14:48, 91.91s/it]epoch : 41, train loss : 0.008, valid loss : 0.041, train acc : 0.989, valid acc : 0.970, train f1 : 0.888, valid f1 : 0.690

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 342.44it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 348.60it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 351.19it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 348.45it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 350.34it/s][A100%|██████████| 194/194 [00:00<00:00, 349.73it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  32%|███▏      | 41/128 [1:05:33<2:21:59, 97.93s/it]Best score increase :0.704 -> 0.710
training process:  33%|███▎      | 42/128 [1:07:02<2:16:23, 95.15s/it]EarlyStopping counter : 1 out of 40
training process:  34%|███▎      | 43/128 [1:08:32<2:12:53, 93.81s/it]EarlyStopping counter : 2 out of 40
training process:  34%|███▍      | 44/128 [1:10:00<2:08:46, 91.98s/it]epoch : 45, train loss : 0.008, valid loss : 0.062, train acc : 0.989, valid acc : 0.954, train f1 : 0.889, valid f1 : 0.646

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 334.27it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 283.59it/s][A
 50%|█████     | 97/194 [00:00<00:00, 254.64it/s][A
 63%|██████▎   | 123/194 [00:00<00:00, 237.86it/s][A
 77%|███████▋  | 150/194 [00:00<00:00, 246.43it/s][A
 94%|█████████▍| 183/194 [00:00<00:00, 271.16it/s][A100%|██████████| 194/194 [00:00<00:00, 256.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  35%|███▌      | 45/128 [1:11:57<2:17:24, 99.34s/it]EarlyStopping counter : 4 out of 40
training process:  36%|███▌      | 46/128 [1:13:26<2:11:49, 96.46s/it]Best score increase :0.710 -> 0.712
training process:  37%|███▋      | 47/128 [1:14:55<2:07:00, 94.08s/it]EarlyStopping counter : 1 out of 40
training process:  38%|███▊      | 48/128 [1:16:24<2:03:27, 92.59s/it]epoch : 49, train loss : 0.007, valid loss : 0.044, train acc : 0.990, valid acc : 0.969, train f1 : 0.900, valid f1 : 0.700

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 270.45it/s][A
 29%|██▉       | 57/194 [00:00<00:00, 278.86it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 281.77it/s][A
 59%|█████▉    | 115/194 [00:00<00:00, 281.12it/s][A
 74%|███████▍  | 144/194 [00:00<00:00, 282.83it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 283.71it/s][A100%|██████████| 194/194 [00:00<00:00, 282.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  38%|███▊      | 49/128 [1:18:19<2:10:46, 99.33s/it]EarlyStopping counter : 3 out of 40
training process:  39%|███▉      | 50/128 [1:19:48<2:05:02, 96.19s/it]EarlyStopping counter : 4 out of 40
training process:  40%|███▉      | 51/128 [1:21:20<2:02:02, 95.09s/it]EarlyStopping counter : 5 out of 40
training process:  41%|████      | 52/128 [1:22:50<1:58:17, 93.39s/it]epoch : 53, train loss : 0.006, valid loss : 0.043, train acc : 0.991, valid acc : 0.974, train f1 : 0.912, valid f1 : 0.706

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 314.17it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 329.15it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 334.43it/s][A
 70%|██████▉   | 135/194 [00:00<00:00, 334.25it/s][A
 88%|████████▊ | 170/194 [00:00<00:00, 337.10it/s][A100%|██████████| 194/194 [00:00<00:00, 335.07it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  41%|████▏     | 53/128 [1:24:45<2:04:42, 99.77s/it]EarlyStopping counter : 7 out of 40
training process:  42%|████▏     | 54/128 [1:26:12<1:58:22, 95.99s/it]EarlyStopping counter : 8 out of 40
training process:  43%|████▎     | 55/128 [1:27:41<1:54:24, 94.04s/it]EarlyStopping counter : 9 out of 40
training process:  44%|████▍     | 56/128 [1:29:12<1:51:35, 93.00s/it]epoch : 57, train loss : 0.006, valid loss : 0.047, train acc : 0.992, valid acc : 0.968, train f1 : 0.918, valid f1 : 0.683

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 340.66it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 341.61it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 345.24it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 346.98it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 347.88it/s][A100%|██████████| 194/194 [00:00<00:00, 341.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  45%|████▍     | 57/128 [1:31:07<1:57:47, 99.55s/it]Best score increase :0.712 -> 0.725
training process:  45%|████▌     | 58/128 [1:32:34<1:52:00, 96.01s/it]EarlyStopping counter : 1 out of 40
training process:  46%|████▌     | 59/128 [1:34:01<1:47:20, 93.35s/it]EarlyStopping counter : 2 out of 40
training process:  47%|████▋     | 60/128 [1:35:28<1:43:36, 91.42s/it]epoch : 61, train loss : 0.006, valid loss : 0.048, train acc : 0.992, valid acc : 0.969, train f1 : 0.922, valid f1 : 0.705

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 335.46it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 342.36it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 344.15it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 341.52it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 343.22it/s][A100%|██████████| 194/194 [00:00<00:00, 342.78it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  48%|████▊     | 61/128 [1:37:22<1:49:37, 98.17s/it]EarlyStopping counter : 4 out of 40
training process:  48%|████▊     | 62/128 [1:38:53<1:45:39, 96.05s/it]EarlyStopping counter : 5 out of 40
training process:  49%|████▉     | 63/128 [1:40:24<1:42:08, 94.28s/it]EarlyStopping counter : 6 out of 40
training process:  50%|█████     | 64/128 [1:41:51<1:38:16, 92.14s/it]epoch : 65, train loss : 0.005, valid loss : 0.051, train acc : 0.993, valid acc : 0.966, train f1 : 0.925, valid f1 : 0.688

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 342.62it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 343.70it/s][A
 55%|█████▍    | 106/194 [00:00<00:00, 347.35it/s][A
 73%|███████▎  | 142/194 [00:00<00:00, 349.05it/s][A
 92%|█████████▏| 178/194 [00:00<00:00, 350.01it/s][A100%|██████████| 194/194 [00:00<00:00, 348.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  51%|█████     | 65/128 [1:43:42<1:42:50, 97.95s/it]EarlyStopping counter : 8 out of 40
training process:  52%|█████▏    | 66/128 [1:45:10<1:38:03, 94.89s/it]EarlyStopping counter : 9 out of 40
training process:  52%|█████▏    | 67/128 [1:46:39<1:34:35, 93.04s/it]EarlyStopping counter : 10 out of 40
training process:  53%|█████▎    | 68/128 [1:48:08<1:31:58, 91.98s/it]epoch : 69, train loss : 0.005, valid loss : 0.049, train acc : 0.993, valid acc : 0.969, train f1 : 0.931, valid f1 : 0.683

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 321.10it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 325.91it/s][A
 51%|█████     | 99/194 [00:00<00:00, 272.02it/s][A
 66%|██████▌   | 128/194 [00:00<00:00, 271.77it/s][A
 83%|████████▎ | 161/194 [00:00<00:00, 290.15it/s][A
 98%|█████████▊| 191/194 [00:00<00:00, 260.18it/s][A100%|██████████| 194/194 [00:00<00:00, 273.70it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  54%|█████▍    | 69/128 [1:50:04<1:37:20, 98.98s/it]EarlyStopping counter : 12 out of 40
training process:  55%|█████▍    | 70/128 [1:51:32<1:32:37, 95.82s/it]EarlyStopping counter : 13 out of 40
training process:  55%|█████▌    | 71/128 [1:53:04<1:29:50, 94.56s/it]EarlyStopping counter : 14 out of 40
training process:  56%|█████▋    | 72/128 [1:54:32<1:26:33, 92.74s/it]epoch : 73, train loss : 0.005, valid loss : 0.052, train acc : 0.993, valid acc : 0.971, train f1 : 0.935, valid f1 : 0.689

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 347.26it/s][A
 37%|███▋      | 71/194 [00:00<00:00, 351.76it/s][A
 55%|█████▌    | 107/194 [00:00<00:00, 353.99it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 291.48it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 290.20it/s][A100%|██████████| 194/194 [00:00<00:00, 308.61it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  57%|█████▋    | 73/128 [1:56:28<1:31:22, 99.68s/it]EarlyStopping counter : 16 out of 40
training process:  58%|█████▊    | 74/128 [1:57:53<1:25:50, 95.37s/it]EarlyStopping counter : 17 out of 40
training process:  59%|█████▊    | 75/128 [1:59:23<1:22:51, 93.81s/it]EarlyStopping counter : 18 out of 40
training process:  59%|█████▉    | 76/128 [2:00:53<1:20:13, 92.57s/it]epoch : 77, train loss : 0.004, valid loss : 0.061, train acc : 0.994, valid acc : 0.964, train f1 : 0.942, valid f1 : 0.685

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 274.24it/s][A
 29%|██▉       | 57/194 [00:00<00:00, 277.79it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 279.03it/s][A
 59%|█████▉    | 115/194 [00:00<00:00, 279.60it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 277.86it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 278.75it/s][A100%|██████████| 194/194 [00:00<00:00, 277.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  60%|██████    | 77/128 [2:02:48<1:24:23, 99.29s/it]EarlyStopping counter : 20 out of 40
training process:  61%|██████    | 78/128 [2:04:18<1:20:30, 96.61s/it]EarlyStopping counter : 21 out of 40
training process:  62%|██████▏   | 79/128 [2:05:45<1:16:21, 93.50s/it]EarlyStopping counter : 22 out of 40
training process:  62%|██████▎   | 80/128 [2:07:11<1:13:09, 91.46s/it]epoch : 81, train loss : 0.004, valid loss : 0.057, train acc : 0.995, valid acc : 0.969, train f1 : 0.946, valid f1 : 0.685

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 330.25it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 335.00it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 323.23it/s][A
 70%|███████   | 136/194 [00:00<00:00, 329.00it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 333.47it/s][A100%|██████████| 194/194 [00:00<00:00, 332.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  63%|██████▎   | 81/128 [2:09:04<1:16:30, 97.67s/it]EarlyStopping counter : 24 out of 40
training process:  64%|██████▍   | 82/128 [2:10:33<1:12:56, 95.15s/it]EarlyStopping counter : 25 out of 40
training process:  65%|██████▍   | 83/128 [2:12:02<1:10:06, 93.49s/it]EarlyStopping counter : 26 out of 40
training process:  66%|██████▌   | 84/128 [2:13:27<1:06:35, 90.81s/it]epoch : 85, train loss : 0.004, valid loss : 0.055, train acc : 0.995, valid acc : 0.969, train f1 : 0.948, valid f1 : 0.687

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 326.61it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 340.58it/s][A
 54%|█████▍    | 105/194 [00:00<00:00, 345.25it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 337.94it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 340.65it/s][A100%|██████████| 194/194 [00:00<00:00, 340.52it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  66%|██████▋   | 85/128 [2:15:22<1:10:21, 98.18s/it]EarlyStopping counter : 28 out of 40
training process:  67%|██████▋   | 86/128 [2:16:52<1:06:56, 95.64s/it]EarlyStopping counter : 29 out of 40
training process:  68%|██████▊   | 87/128 [2:18:19<1:03:32, 92.98s/it]EarlyStopping counter : 30 out of 40
training process:  69%|██████▉   | 88/128 [2:19:48<1:01:10, 91.76s/it]epoch : 89, train loss : 0.004, valid loss : 0.060, train acc : 0.995, valid acc : 0.970, train f1 : 0.952, valid f1 : 0.689

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 326.60it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 339.28it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 343.36it/s][A
 71%|███████   | 138/194 [00:00<00:00, 345.51it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 346.54it/s][A100%|██████████| 194/194 [00:00<00:00, 344.48it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  70%|██████▉   | 89/128 [2:21:42<1:03:56, 98.38s/it]EarlyStopping counter : 32 out of 40
training process:  70%|███████   | 90/128 [2:23:10<1:00:24, 95.38s/it]EarlyStopping counter : 33 out of 40
training process:  71%|███████   | 91/128 [2:24:38<57:32, 93.31s/it]  EarlyStopping counter : 34 out of 40
training process:  72%|███████▏  | 92/128 [2:26:07<55:09, 91.93s/it]epoch : 93, train loss : 0.004, valid loss : 0.061, train acc : 0.995, valid acc : 0.968, train f1 : 0.953, valid f1 : 0.693

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 35/194 [00:00<00:00, 343.38it/s][A
 36%|███▌      | 70/194 [00:00<00:00, 344.84it/s][A
 55%|█████▍    | 106/194 [00:00<00:00, 347.49it/s][A
 73%|███████▎  | 142/194 [00:00<00:00, 348.78it/s][A
 92%|█████████▏| 178/194 [00:00<00:00, 349.39it/s][A100%|██████████| 194/194 [00:00<00:00, 348.33it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 35 out of 40
training process:  73%|███████▎  | 93/128 [2:28:01<57:28, 98.54s/it]EarlyStopping counter : 36 out of 40
training process:  73%|███████▎  | 94/128 [2:29:27<53:45, 94.88s/it]EarlyStopping counter : 37 out of 40
training process:  74%|███████▍  | 95/128 [2:30:55<51:00, 92.75s/it]EarlyStopping counter : 38 out of 40
training process:  75%|███████▌  | 96/128 [2:32:26<49:05, 92.04s/it]epoch : 97, train loss : 0.004, valid loss : 0.060, train acc : 0.995, valid acc : 0.970, train f1 : 0.952, valid f1 : 0.695

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 329.58it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 339.42it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 340.94it/s][A
 71%|███████   | 138/194 [00:00<00:00, 335.15it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 338.80it/s][A100%|██████████| 194/194 [00:00<00:00, 338.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 39 out of 40
training process:  76%|███████▌  | 97/128 [2:34:21<51:10, 99.05s/it]EarlyStopping counter : 40 out of 40
Early stopping | epoch : 97, best f1 score : 0.725
training process:  76%|███████▌  | 97/128 [2:35:50<49:48, 96.39s/it]
training process finished, best loss : 0.042 and best acc : 0.973, best f1 : 0.725, best epoch : 57

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.46      0.38      0.42       453
           1       0.98      0.99      0.99     16880

    accuracy                           0.97     17333
   macro avg       0.72      0.68      0.70     17333
weighted avg       0.97      0.97      0.97     17333


# test acc : 0.97, test f1 : 0.70, test AUC : 0.68, test loss : 11.770

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:11<03:00, 11.31s/it]processing for feature importance:  12%|█▏        | 2/17 [00:22<02:51, 11.43s/it]processing for feature importance:  18%|█▊        | 3/17 [00:33<02:35, 11.14s/it]processing for feature importance:  24%|██▎       | 4/17 [00:44<02:26, 11.24s/it]processing for feature importance:  29%|██▉       | 5/17 [00:56<02:15, 11.30s/it]processing for feature importance:  35%|███▌      | 6/17 [01:07<02:05, 11.38s/it]processing for feature importance:  41%|████      | 7/17 [01:19<01:54, 11.45s/it]processing for feature importance:  47%|████▋     | 8/17 [01:31<01:45, 11.73s/it]processing for feature importance:  53%|█████▎    | 9/17 [01:43<01:32, 11.62s/it]processing for feature importance:  59%|█████▉    | 10/17 [01:55<01:22, 11.84s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:06<01:09, 11.57s/it]processing for feature importance:  71%|███████   | 12/17 [02:18<00:57, 11.57s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:29<00:45, 11.48s/it]processing for feature importance:  82%|████████▏ | 14/17 [02:41<00:35, 11.68s/it]processing for feature importance:  88%|████████▊ | 15/17 [02:52<00:23, 11.54s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:04<00:11, 11.47s/it]processing for feature importance: 100%|██████████| 17/17 [03:15<00:00, 11.40s/it]processing for feature importance: 100%|██████████| 17/17 [03:15<00:00, 11.49s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<10:53,  3.10s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<05:53,  1.68s/it]visualize 2D latent space:   1%|          | 2/212 [00:05<09:18,  2.66s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:09,  1.93s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:25,  1.30s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<12:28,  3.55s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<05:27,  1.56s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:05<09:30,  2.72s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:02<02:16,  2.04s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:35,  1.45s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 16%|█▋        | 32/194 [00:00<00:00, 316.29it/s] 35%|███▌      | 68/194 [00:00<00:00, 336.64it/s] 53%|█████▎    | 103/194 [00:00<00:00, 340.50it/s] 72%|███████▏  | 139/194 [00:00<00:00, 345.07it/s] 90%|█████████ | 175/194 [00:00<00:00, 347.39it/s]100%|██████████| 194/194 [00:00<00:00, 344.03it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_Focal_RS_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 207.76it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 204.59it/s]remove invalid data : null / measurement error:  10%|█         | 63/616 [00:00<00:02, 202.62it/s]remove invalid data : null / measurement error:  14%|█▎        | 84/616 [00:00<00:02, 205.06it/s]remove invalid data : null / measurement error:  17%|█▋        | 106/616 [00:00<00:02, 206.81it/s]remove invalid data : null / measurement error:  21%|██        | 128/616 [00:00<00:02, 209.62it/s]remove invalid data : null / measurement error:  24%|██▍       | 150/616 [00:00<00:02, 211.95it/s]remove invalid data : null / measurement error:  28%|██▊       | 172/616 [00:00<00:02, 213.39it/s]remove invalid data : null / measurement error:  31%|███▏      | 194/616 [00:00<00:02, 210.82it/s]remove invalid data : null / measurement error:  35%|███▌      | 216/616 [00:01<00:01, 210.04it/s]remove invalid data : null / measurement error:  39%|███▊      | 238/616 [00:01<00:01, 209.87it/s]remove invalid data : null / measurement error:  42%|████▏     | 260/616 [00:01<00:01, 209.97it/s]remove invalid data : null / measurement error:  46%|████▌     | 282/616 [00:01<00:01, 209.90it/s]remove invalid data : null / measurement error:  49%|████▉     | 303/616 [00:01<00:01, 209.25it/s]remove invalid data : null / measurement error:  53%|█████▎    | 324/616 [00:01<00:01, 208.43it/s]remove invalid data : null / measurement error:  56%|█████▌    | 345/616 [00:01<00:01, 207.96it/s]remove invalid data : null / measurement error:  60%|█████▉    | 368/616 [00:01<00:01, 212.82it/s]remove invalid data : null / measurement error:  64%|██████▍   | 394/616 [00:01<00:00, 226.57it/s]remove invalid data : null / measurement error:  69%|██████▊   | 422/616 [00:01<00:00, 239.08it/s]remove invalid data : null / measurement error:  72%|███████▏  | 446/616 [00:02<00:00, 234.49it/s]remove invalid data : null / measurement error:  76%|███████▋  | 470/616 [00:02<00:00, 230.49it/s]remove invalid data : null / measurement error:  80%|████████  | 494/616 [00:02<00:00, 224.19it/s]remove invalid data : null / measurement error:  84%|████████▍ | 517/616 [00:02<00:00, 219.70it/s]remove invalid data : null / measurement error:  88%|████████▊ | 540/616 [00:02<00:00, 215.23it/s]remove invalid data : null / measurement error:  91%|█████████ | 562/616 [00:02<00:00, 211.37it/s]remove invalid data : null / measurement error:  95%|█████████▍| 584/616 [00:02<00:00, 209.86it/s]remove invalid data : null / measurement error:  98%|█████████▊| 605/616 [00:02<00:00, 208.34it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 213.59it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 235.11it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 236.70it/s]replace nan value:  14%|█▍        | 73/515 [00:00<00:01, 239.73it/s]replace nan value:  19%|█▉        | 98/515 [00:00<00:01, 242.12it/s]replace nan value:  24%|██▍       | 123/515 [00:00<00:01, 244.18it/s]replace nan value:  29%|██▊       | 148/515 [00:00<00:01, 245.95it/s]replace nan value:  34%|███▎      | 173/515 [00:00<00:01, 246.84it/s]replace nan value:  38%|███▊      | 198/515 [00:00<00:01, 247.36it/s]replace nan value:  43%|████▎     | 223/515 [00:00<00:01, 247.74it/s]replace nan value:  48%|████▊     | 248/515 [00:01<00:01, 248.23it/s]replace nan value:  53%|█████▎    | 274/515 [00:01<00:00, 248.83it/s]replace nan value:  58%|█████▊    | 299/515 [00:01<00:00, 247.88it/s]replace nan value:  63%|██████▎   | 324/515 [00:01<00:00, 247.78it/s]replace nan value:  68%|██████▊   | 349/515 [00:01<00:00, 244.85it/s]replace nan value:  73%|███████▎  | 374/515 [00:01<00:00, 246.22it/s]replace nan value:  77%|███████▋  | 399/515 [00:01<00:00, 246.99it/s]replace nan value:  82%|████████▏ | 424/515 [00:01<00:00, 247.17it/s]replace nan value:  87%|████████▋ | 449/515 [00:01<00:00, 245.68it/s]replace nan value:  92%|█████████▏| 474/515 [00:01<00:00, 246.34it/s]replace nan value:  97%|█████████▋| 499/515 [00:02<00:00, 247.30it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 245.97it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 40.44it/s]generate index:   3%|▎         | 13/515 [00:00<00:08, 56.39it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 76.36it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 74.10it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 73.89it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 55.59it/s]generate index:  11%|█         | 56/515 [00:00<00:07, 58.33it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 48.51it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 55.35it/s]generate index:  15%|█▌        | 78/515 [00:01<00:08, 54.41it/s]generate index:  17%|█▋        | 88/515 [00:01<00:06, 62.50it/s]generate index:  18%|█▊        | 95/515 [00:01<00:06, 62.14it/s]generate index:  20%|█▉        | 102/515 [00:01<00:06, 60.00it/s]generate index:  22%|██▏       | 111/515 [00:01<00:06, 65.92it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 64.44it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 72.25it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 72.41it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 73.09it/s]generate index:  30%|██▉       | 152/515 [00:02<00:04, 72.70it/s]generate index:  31%|███       | 160/515 [00:02<00:04, 73.46it/s]generate index:  33%|███▎      | 168/515 [00:02<00:04, 72.51it/s]generate index:  34%|███▍      | 176/515 [00:02<00:04, 70.53it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 71.90it/s]generate index:  37%|███▋      | 192/515 [00:02<00:04, 72.34it/s]generate index:  39%|███▉      | 200/515 [00:03<00:04, 65.22it/s]generate index:  41%|████      | 210/515 [00:03<00:04, 72.76it/s]generate index:  43%|████▎     | 222/515 [00:03<00:03, 83.72it/s]generate index:  45%|████▌     | 233/515 [00:03<00:03, 89.45it/s]generate index:  47%|████▋     | 243/515 [00:03<00:03, 89.33it/s]generate index:  49%|████▉     | 253/515 [00:03<00:03, 74.30it/s]generate index:  51%|█████     | 262/515 [00:03<00:03, 77.06it/s]generate index:  53%|█████▎    | 272/515 [00:03<00:02, 81.13it/s]generate index:  55%|█████▍    | 281/515 [00:04<00:03, 65.14it/s]generate index:  56%|█████▌    | 289/515 [00:04<00:03, 66.62it/s]generate index:  58%|█████▊    | 297/515 [00:04<00:03, 64.34it/s]generate index:  59%|█████▉    | 304/515 [00:04<00:03, 64.11it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 65.13it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 61.17it/s]generate index:  63%|██████▎   | 327/515 [00:04<00:02, 65.15it/s]generate index:  65%|██████▍   | 334/515 [00:04<00:03, 58.90it/s]generate index:  66%|██████▌   | 341/515 [00:05<00:03, 47.62it/s]generate index:  67%|██████▋   | 347/515 [00:05<00:03, 45.84it/s]generate index:  69%|██████▉   | 355/515 [00:05<00:03, 52.11it/s]generate index:  71%|███████   | 364/515 [00:05<00:02, 60.43it/s]generate index:  73%|███████▎  | 376/515 [00:05<00:01, 73.84it/s]generate index:  75%|███████▍  | 385/515 [00:05<00:01, 77.53it/s]generate index:  77%|███████▋  | 394/515 [00:05<00:01, 78.04it/s]generate index:  78%|███████▊  | 403/515 [00:06<00:01, 73.05it/s]generate index:  80%|███████▉  | 411/515 [00:06<00:01, 65.21it/s]generate index:  82%|████████▏ | 422/515 [00:06<00:01, 75.57it/s]generate index:  83%|████████▎ | 430/515 [00:06<00:01, 75.40it/s]generate index:  85%|████████▌ | 438/515 [00:06<00:01, 53.48it/s]generate index:  86%|████████▋ | 445/515 [00:06<00:01, 49.97it/s]generate index:  88%|████████▊ | 455/515 [00:06<00:00, 60.09it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 64.93it/s]generate index:  92%|█████████▏| 472/515 [00:07<00:00, 57.77it/s]generate index:  94%|█████████▍| 483/515 [00:07<00:00, 68.20it/s]generate index:  95%|█████████▌| 491/515 [00:07<00:00, 66.05it/s]generate index:  97%|█████████▋| 499/515 [00:07<00:00, 64.99it/s]generate index:  99%|█████████▊| 508/515 [00:07<00:00, 70.97it/s]generate index: 100%|██████████| 515/515 [00:07<00:00, 65.62it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   6%|▋         | 10/154 [00:00<00:01, 97.51it/s]remove invalid data : null / measurement error:  21%|██        | 32/154 [00:00<00:00, 164.34it/s]remove invalid data : null / measurement error:  35%|███▌      | 54/154 [00:00<00:00, 185.88it/s]remove invalid data : null / measurement error:  49%|████▉     | 76/154 [00:00<00:00, 197.40it/s]remove invalid data : null / measurement error:  65%|██████▍   | 100/154 [00:00<00:00, 209.02it/s]remove invalid data : null / measurement error:  80%|███████▉  | 123/154 [00:00<00:00, 214.44it/s]remove invalid data : null / measurement error:  94%|█████████▍| 145/154 [00:00<00:00, 212.69it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 200.43it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  20%|█▉        | 26/131 [00:00<00:00, 255.73it/s]replace nan value:  40%|███▉      | 52/131 [00:00<00:00, 256.86it/s]replace nan value:  60%|█████▉    | 78/131 [00:00<00:00, 257.50it/s]replace nan value:  79%|███████▉  | 104/131 [00:00<00:00, 254.84it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 256.50it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 256.30it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 69.99it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 50.58it/s]generate index:  17%|█▋        | 22/131 [00:00<00:01, 56.10it/s]generate index:  23%|██▎       | 30/131 [00:00<00:01, 62.45it/s]generate index:  28%|██▊       | 37/131 [00:00<00:01, 64.67it/s]generate index:  34%|███▎      | 44/131 [00:00<00:01, 62.89it/s]generate index:  39%|███▉      | 51/131 [00:00<00:01, 62.81it/s]generate index:  44%|████▍     | 58/131 [00:00<00:01, 64.59it/s]generate index:  50%|█████     | 66/131 [00:01<00:00, 68.61it/s]generate index:  56%|█████▋    | 74/131 [00:01<00:00, 70.57it/s]generate index:  63%|██████▎   | 82/131 [00:01<00:00, 65.35it/s]generate index:  68%|██████▊   | 89/131 [00:01<00:00, 49.94it/s]generate index:  73%|███████▎  | 95/131 [00:01<00:00, 48.45it/s]generate index:  77%|███████▋  | 101/131 [00:01<00:00, 48.25it/s]generate index:  82%|████████▏ | 107/131 [00:01<00:00, 49.07it/s]generate index:  89%|████████▊ | 116/131 [00:01<00:00, 58.63it/s]generate index:  97%|█████████▋| 127/131 [00:02<00:00, 71.09it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 60.77it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   5%|▍         | 9/193 [00:00<00:02, 89.58it/s]remove invalid data : null / measurement error:  16%|█▌        | 31/193 [00:00<00:01, 161.83it/s]remove invalid data : null / measurement error:  27%|██▋       | 53/193 [00:00<00:00, 187.15it/s]remove invalid data : null / measurement error:  39%|███▉      | 75/193 [00:00<00:00, 199.12it/s]remove invalid data : null / measurement error:  50%|█████     | 97/193 [00:00<00:00, 204.54it/s]remove invalid data : null / measurement error:  62%|██████▏   | 120/193 [00:00<00:00, 210.78it/s]remove invalid data : null / measurement error:  75%|███████▌  | 145/193 [00:00<00:00, 220.46it/s]remove invalid data : null / measurement error:  87%|████████▋ | 168/193 [00:00<00:00, 216.12it/s]remove invalid data : null / measurement error:  98%|█████████▊| 190/193 [00:00<00:00, 213.80it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:00<00:00, 203.57it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  16%|█▋        | 26/160 [00:00<00:00, 254.76it/s]replace nan value:  32%|███▎      | 52/160 [00:00<00:00, 257.78it/s]replace nan value:  49%|████▉     | 78/160 [00:00<00:00, 257.42it/s]replace nan value:  65%|██████▌   | 104/160 [00:00<00:00, 254.69it/s]replace nan value:  81%|████████▏ | 130/160 [00:00<00:00, 254.67it/s]replace nan value:  98%|█████████▊| 156/160 [00:00<00:00, 254.88it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 255.18it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 106.61it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 64.07it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 62.65it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 75.65it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 82.66it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 84.83it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 85.13it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 70.14it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 60.37it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 61.25it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 54.82it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 50.92it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 61.05it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 62.21it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 57.59it/s]generate index:  87%|████████▋ | 139/160 [00:02<00:00, 55.54it/s]generate index:  92%|█████████▏| 147/160 [00:02<00:00, 61.07it/s]generate index:  97%|█████████▋| 155/160 [00:02<00:00, 60.89it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 64.03it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.135, valid loss : 0.110, train acc : 0.727, valid acc : 0.774, train f1 : 0.726, valid f1 : 0.504

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 339.31it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 345.39it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 345.33it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 348.53it/s][A
 91%|█████████ | 176/194 [00:00<00:00, 349.53it/s][A100%|██████████| 194/194 [00:00<00:00, 348.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.504
training process:   1%|          | 1/128 [01:59<4:12:33, 119.32s/it]Best score increase :0.504 -> 0.549
training process:   2%|▏         | 2/128 [03:34<3:40:45, 105.12s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [05:09<3:29:09, 100.39s/it]EarlyStopping counter : 2 out of 40
training process:   3%|▎         | 4/128 [06:41<3:21:06, 97.31s/it] epoch : 5, train loss : 0.052, valid loss : 0.080, train acc : 0.924, valid acc : 0.885, train f1 : 0.924, valid f1 : 0.591

  0%|          | 0/194 [00:00<?, ?it/s][A
 15%|█▍        | 29/194 [00:00<00:00, 283.23it/s][A
 31%|███▏      | 61/194 [00:00<00:00, 299.40it/s][A
 47%|████▋     | 92/194 [00:00<00:00, 303.91it/s][A
 64%|██████▍   | 124/194 [00:00<00:00, 306.89it/s][A
 80%|████████  | 156/194 [00:00<00:00, 309.01it/s][A
 96%|█████████▋| 187/194 [00:00<00:00, 303.29it/s][A100%|██████████| 194/194 [00:00<00:00, 303.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.549 -> 0.591
training process:   4%|▍         | 5/128 [08:39<3:34:40, 104.72s/it]EarlyStopping counter : 1 out of 40
training process:   5%|▍         | 6/128 [10:11<3:24:16, 100.46s/it]EarlyStopping counter : 2 out of 40
training process:   5%|▌         | 7/128 [11:45<3:18:13, 98.29s/it] Best score increase :0.591 -> 0.594
training process:   6%|▋         | 8/128 [13:18<3:13:12, 96.61s/it]epoch : 9, train loss : 0.032, valid loss : 0.112, train acc : 0.957, valid acc : 0.879, train f1 : 0.957, valid f1 : 0.576

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 312.07it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 329.34it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 335.97it/s][A
 71%|███████   | 137/194 [00:00<00:00, 339.56it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 341.47it/s][A100%|██████████| 194/194 [00:00<00:00, 338.22it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   7%|▋         | 9/128 [15:18<3:25:44, 103.74s/it]EarlyStopping counter : 2 out of 40
training process:   8%|▊         | 10/128 [16:51<3:17:47, 100.58s/it]EarlyStopping counter : 3 out of 40
training process:   9%|▊         | 11/128 [18:24<3:11:29, 98.20s/it] EarlyStopping counter : 4 out of 40
training process:   9%|▉         | 12/128 [19:59<3:08:14, 97.36s/it]epoch : 13, train loss : 0.025, valid loss : 0.106, train acc : 0.968, valid acc : 0.887, train f1 : 0.968, valid f1 : 0.583

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 310.65it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 324.50it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 329.64it/s][A
 69%|██████▊   | 133/194 [00:00<00:00, 329.05it/s][A
 86%|████████▌ | 167/194 [00:00<00:00, 331.91it/s][A100%|██████████| 194/194 [00:00<00:00, 330.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  10%|█         | 13/128 [22:01<3:20:42, 104.72s/it]EarlyStopping counter : 6 out of 40
training process:  11%|█         | 14/128 [23:32<3:11:00, 100.53s/it]Best score increase :0.594 -> 0.597
training process:  12%|█▏        | 15/128 [25:04<3:04:41, 98.07s/it] EarlyStopping counter : 1 out of 40
training process:  12%|█▎        | 16/128 [26:36<2:59:44, 96.29s/it]epoch : 17, train loss : 0.020, valid loss : 0.081, train acc : 0.974, valid acc : 0.913, train f1 : 0.974, valid f1 : 0.601

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 319.96it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 336.92it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 343.89it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 347.29it/s][A
 90%|█████████ | 175/194 [00:00<00:00, 349.06it/s][A100%|██████████| 194/194 [00:00<00:00, 345.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.597 -> 0.601
training process:  13%|█▎        | 17/128 [28:32<3:09:08, 102.24s/it]EarlyStopping counter : 1 out of 40
training process:  14%|█▍        | 18/128 [30:05<3:02:04, 99.31s/it] EarlyStopping counter : 2 out of 40
training process:  15%|█▍        | 19/128 [31:37<2:56:20, 97.07s/it]Best score increase :0.601 -> 0.614
training process:  16%|█▌        | 20/128 [33:11<2:53:11, 96.22s/it]epoch : 21, train loss : 0.016, valid loss : 0.110, train acc : 0.980, valid acc : 0.907, train f1 : 0.980, valid f1 : 0.592

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 309.56it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 327.88it/s][A
 52%|█████▏    | 101/194 [00:00<00:00, 334.62it/s][A
 70%|███████   | 136/194 [00:00<00:00, 338.00it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 339.97it/s][A100%|██████████| 194/194 [00:00<00:00, 336.76it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  16%|█▋        | 21/128 [35:08<3:02:54, 102.57s/it]EarlyStopping counter : 2 out of 40
training process:  17%|█▋        | 22/128 [36:42<2:56:15, 99.77s/it] EarlyStopping counter : 3 out of 40
training process:  18%|█▊        | 23/128 [38:16<2:51:48, 98.18s/it]EarlyStopping counter : 4 out of 40
training process:  19%|█▉        | 24/128 [39:48<2:46:48, 96.24s/it]epoch : 25, train loss : 0.015, valid loss : 0.087, train acc : 0.982, valid acc : 0.915, train f1 : 0.982, valid f1 : 0.601

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▋        | 32/194 [00:00<00:00, 319.00it/s][A
 35%|███▍      | 67/194 [00:00<00:00, 332.67it/s][A
 53%|█████▎    | 102/194 [00:00<00:00, 337.07it/s][A
 71%|███████   | 137/194 [00:00<00:00, 339.87it/s][A
 89%|████████▊ | 172/194 [00:00<00:00, 341.41it/s][A100%|██████████| 194/194 [00:00<00:00, 338.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  20%|█▉        | 25/128 [41:48<2:57:16, 103.27s/it]Best score increase :0.614 -> 0.619
training process:  20%|██        | 26/128 [43:20<2:50:04, 100.04s/it]Best score increase :0.619 -> 0.651
training process:  21%|██        | 27/128 [44:55<2:45:43, 98.45s/it] EarlyStopping counter : 1 out of 40
training process:  22%|██▏       | 28/128 [46:30<2:42:21, 97.42s/it]epoch : 29, train loss : 0.012, valid loss : 0.070, train acc : 0.986, valid acc : 0.942, train f1 : 0.986, valid f1 : 0.635

  0%|          | 0/194 [00:00<?, ?it/s][A
 10%|▉         | 19/194 [00:00<00:00, 184.82it/s][A
 24%|██▍       | 47/194 [00:00<00:00, 236.83it/s][A
 38%|███▊      | 74/194 [00:00<00:00, 251.42it/s][A
 52%|█████▏    | 100/194 [00:00<00:00, 252.33it/s][A
 65%|██████▌   | 127/194 [00:00<00:00, 257.63it/s][A
 80%|████████  | 156/194 [00:00<00:00, 268.03it/s][A
 95%|█████████▌| 185/194 [00:00<00:00, 273.22it/s][A100%|██████████| 194/194 [00:00<00:00, 260.23it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  23%|██▎       | 29/128 [48:36<2:54:49, 105.95s/it]EarlyStopping counter : 3 out of 40
training process:  23%|██▎       | 30/128 [50:10<2:47:09, 102.34s/it]EarlyStopping counter : 4 out of 40
training process:  24%|██▍       | 31/128 [51:45<2:41:53, 100.14s/it]EarlyStopping counter : 5 out of 40
training process:  25%|██▌       | 32/128 [53:20<2:37:52, 98.67s/it] epoch : 33, train loss : 0.012, valid loss : 0.085, train acc : 0.986, valid acc : 0.940, train f1 : 0.986, valid f1 : 0.634

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 249.09it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 278.78it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 289.40it/s][A
 60%|██████    | 117/194 [00:00<00:00, 294.67it/s][A
 76%|███████▌  | 147/194 [00:00<00:00, 291.68it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 298.82it/s][A100%|██████████| 194/194 [00:00<00:00, 294.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  26%|██▌       | 33/128 [55:20<2:46:34, 105.20s/it]EarlyStopping counter : 7 out of 40
training process:  27%|██▋       | 34/128 [56:55<2:39:49, 102.02s/it]EarlyStopping counter : 8 out of 40
training process:  27%|██▋       | 35/128 [58:31<2:35:14, 100.16s/it]EarlyStopping counter : 9 out of 40
training process:  28%|██▊       | 36/128 [1:00:06<2:31:09, 98.58s/it]epoch : 37, train loss : 0.010, valid loss : 0.081, train acc : 0.988, valid acc : 0.936, train f1 : 0.988, valid f1 : 0.619

  0%|          | 0/194 [00:00<?, ?it/s][A
 15%|█▍        | 29/194 [00:00<00:00, 285.27it/s][A
 31%|███▏      | 61/194 [00:00<00:00, 301.04it/s][A
 48%|████▊     | 93/194 [00:00<00:00, 307.23it/s][A
 65%|██████▌   | 127/194 [00:00<00:00, 318.11it/s][A
 82%|████████▏ | 159/194 [00:00<00:00, 310.17it/s][A
 98%|█████████▊| 191/194 [00:00<00:00, 301.78it/s][A100%|██████████| 194/194 [00:00<00:00, 304.18it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  29%|██▉       | 37/128 [1:02:07<2:40:03, 105.53s/it]EarlyStopping counter : 11 out of 40
training process:  30%|██▉       | 38/128 [1:03:43<2:33:59, 102.67s/it]EarlyStopping counter : 12 out of 40
training process:  30%|███       | 39/128 [1:05:17<2:28:09, 99.88s/it] EarlyStopping counter : 13 out of 40
training process:  31%|███▏      | 40/128 [1:06:52<2:24:19, 98.40s/it]epoch : 41, train loss : 0.010, valid loss : 0.079, train acc : 0.988, valid acc : 0.942, train f1 : 0.988, valid f1 : 0.638

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 303.27it/s][A
 34%|███▎      | 65/194 [00:00<00:00, 319.89it/s][A
 51%|█████     | 99/194 [00:00<00:00, 325.63it/s][A
 68%|██████▊   | 132/194 [00:00<00:00, 327.13it/s][A
 85%|████████▌ | 165/194 [00:00<00:00, 324.54it/s][A100%|██████████| 194/194 [00:00<00:00, 323.31it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 14 out of 40
training process:  32%|███▏      | 41/128 [1:08:55<2:33:26, 105.82s/it]EarlyStopping counter : 15 out of 40
training process:  33%|███▎      | 42/128 [1:10:29<2:26:42, 102.35s/it]EarlyStopping counter : 16 out of 40
training process:  34%|███▎      | 43/128 [1:12:04<2:21:59, 100.23s/it]EarlyStopping counter : 17 out of 40
training process:  34%|███▍      | 44/128 [1:13:40<2:18:32, 98.96s/it] epoch : 45, train loss : 0.009, valid loss : 0.094, train acc : 0.990, valid acc : 0.939, train f1 : 0.990, valid f1 : 0.622

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 277.39it/s][A
 29%|██▉       | 57/194 [00:00<00:00, 284.70it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 283.64it/s][A
 59%|█████▉    | 115/194 [00:00<00:00, 283.31it/s][A
 74%|███████▍  | 144/194 [00:00<00:00, 283.64it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 287.89it/s][A100%|██████████| 194/194 [00:00<00:00, 287.13it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 18 out of 40
training process:  35%|███▌      | 45/128 [1:15:44<2:27:08, 106.37s/it]EarlyStopping counter : 19 out of 40
training process:  36%|███▌      | 46/128 [1:17:19<2:20:35, 102.88s/it]EarlyStopping counter : 20 out of 40
training process:  37%|███▋      | 47/128 [1:18:53<2:15:27, 100.34s/it]EarlyStopping counter : 21 out of 40
training process:  38%|███▊      | 48/128 [1:20:27<2:11:20, 98.51s/it] epoch : 49, train loss : 0.009, valid loss : 0.085, train acc : 0.990, valid acc : 0.948, train f1 : 0.990, valid f1 : 0.639

  0%|          | 0/194 [00:00<?, ?it/s][A
 11%|█         | 21/194 [00:00<00:00, 208.50it/s][A
 23%|██▎       | 45/194 [00:00<00:00, 222.58it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 228.40it/s][A
 48%|████▊     | 93/194 [00:00<00:00, 231.31it/s][A
 60%|██████    | 117/194 [00:00<00:00, 233.43it/s][A
 73%|███████▎  | 141/194 [00:00<00:00, 234.30it/s][A
 85%|████████▌ | 165/194 [00:00<00:00, 235.06it/s][A
 97%|█████████▋| 189/194 [00:00<00:00, 232.67it/s][A100%|██████████| 194/194 [00:00<00:00, 231.09it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 22 out of 40
training process:  38%|███▊      | 49/128 [1:22:28<2:18:31, 105.21s/it]EarlyStopping counter : 23 out of 40
training process:  39%|███▉      | 50/128 [1:24:04<2:13:13, 102.48s/it]EarlyStopping counter : 24 out of 40
training process:  40%|███▉      | 51/128 [1:25:37<2:07:49, 99.61s/it] EarlyStopping counter : 25 out of 40
training process:  41%|████      | 52/128 [1:27:13<2:04:36, 98.37s/it]epoch : 53, train loss : 0.008, valid loss : 0.083, train acc : 0.990, valid acc : 0.947, train f1 : 0.990, valid f1 : 0.639

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 276.59it/s][A
 30%|██▉       | 58/194 [00:00<00:00, 285.78it/s][A
 45%|████▍     | 87/194 [00:00<00:00, 286.81it/s][A
 60%|██████    | 117/194 [00:00<00:00, 290.09it/s][A
 76%|███████▌  | 147/194 [00:00<00:00, 291.52it/s][A
 91%|█████████ | 177/194 [00:00<00:00, 292.78it/s][A100%|██████████| 194/194 [00:00<00:00, 291.30it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 26 out of 40
training process:  41%|████▏     | 53/128 [1:29:14<2:11:22, 105.11s/it]EarlyStopping counter : 27 out of 40
training process:  42%|████▏     | 54/128 [1:30:45<2:04:41, 101.10s/it]EarlyStopping counter : 28 out of 40
training process:  43%|████▎     | 55/128 [1:32:21<2:01:11, 99.60s/it] EarlyStopping counter : 29 out of 40
training process:  44%|████▍     | 56/128 [1:33:55<1:57:26, 97.87s/it]epoch : 57, train loss : 0.008, valid loss : 0.091, train acc : 0.991, valid acc : 0.951, train f1 : 0.991, valid f1 : 0.648

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 275.79it/s][A
 29%|██▉       | 57/194 [00:00<00:00, 282.70it/s][A
 45%|████▍     | 87/194 [00:00<00:00, 288.05it/s][A
 60%|██████    | 117/194 [00:00<00:00, 291.46it/s][A
 76%|███████▌  | 147/194 [00:00<00:00, 292.53it/s][A
 91%|█████████ | 177/194 [00:00<00:00, 290.09it/s][A100%|██████████| 194/194 [00:00<00:00, 289.39it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 30 out of 40
training process:  45%|████▍     | 57/128 [1:35:56<2:03:47, 104.61s/it]Best score increase :0.651 -> 0.661
training process:  45%|████▌     | 58/128 [1:37:29<1:58:04, 101.21s/it]EarlyStopping counter : 1 out of 40
training process:  46%|████▌     | 59/128 [1:39:01<1:53:24, 98.62s/it] EarlyStopping counter : 2 out of 40
training process:  47%|████▋     | 60/128 [1:40:36<1:50:25, 97.43s/it]epoch : 61, train loss : 0.006, valid loss : 0.087, train acc : 0.993, valid acc : 0.952, train f1 : 0.993, valid f1 : 0.649

  0%|          | 0/194 [00:00<?, ?it/s][A
 16%|█▌        | 31/194 [00:00<00:00, 303.00it/s][A
 32%|███▏      | 63/194 [00:00<00:00, 309.51it/s][A
 50%|█████     | 97/194 [00:00<00:00, 321.12it/s][A
 67%|██████▋   | 130/194 [00:00<00:00, 318.94it/s][A
 84%|████████▎ | 162/194 [00:00<00:00, 310.14it/s][A
100%|██████████| 194/194 [00:00<00:00, 304.28it/s][A100%|██████████| 194/194 [00:00<00:00, 308.96it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  48%|████▊     | 61/128 [1:42:40<1:57:31, 105.24s/it]EarlyStopping counter : 4 out of 40
training process:  48%|████▊     | 62/128 [1:44:13<1:51:45, 101.60s/it]EarlyStopping counter : 5 out of 40
training process:  49%|████▉     | 63/128 [1:45:47<1:47:42, 99.42s/it] EarlyStopping counter : 6 out of 40
training process:  50%|█████     | 64/128 [1:47:17<1:42:59, 96.55s/it]epoch : 65, train loss : 0.007, valid loss : 0.088, train acc : 0.992, valid acc : 0.950, train f1 : 0.992, valid f1 : 0.651

  0%|          | 0/194 [00:00<?, ?it/s][A
 15%|█▍        | 29/194 [00:00<00:00, 289.62it/s][A
 30%|███       | 59/194 [00:00<00:00, 294.26it/s][A
 47%|████▋     | 92/194 [00:00<00:00, 308.51it/s][A
 64%|██████▍   | 124/194 [00:00<00:00, 312.11it/s][A
 80%|████████  | 156/194 [00:00<00:00, 314.15it/s][A
 97%|█████████▋| 188/194 [00:00<00:00, 316.06it/s][A100%|██████████| 194/194 [00:00<00:00, 311.35it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  51%|█████     | 65/128 [1:49:15<1:48:20, 103.18s/it]EarlyStopping counter : 8 out of 40
training process:  52%|█████▏    | 66/128 [1:50:51<1:44:12, 100.85s/it]EarlyStopping counter : 9 out of 40
training process:  52%|█████▏    | 67/128 [1:52:23<1:40:00, 98.37s/it] EarlyStopping counter : 10 out of 40
training process:  53%|█████▎    | 68/128 [1:53:57<1:36:48, 96.81s/it]epoch : 69, train loss : 0.006, valid loss : 0.082, train acc : 0.993, valid acc : 0.958, train f1 : 0.993, valid f1 : 0.666

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 321.52it/s][A
 34%|███▍      | 66/194 [00:00<00:00, 312.89it/s][A
 51%|█████     | 98/194 [00:00<00:00, 311.41it/s][A
 68%|██████▊   | 132/194 [00:00<00:00, 320.07it/s][A
 86%|████████▌ | 166/194 [00:00<00:00, 326.17it/s][A100%|██████████| 194/194 [00:00<00:00, 322.79it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.661 -> 0.666
training process:  54%|█████▍    | 69/128 [1:55:51<1:40:29, 102.19s/it]EarlyStopping counter : 1 out of 40
training process:  55%|█████▍    | 70/128 [1:57:23<1:35:50, 99.15s/it] EarlyStopping counter : 2 out of 40
training process:  55%|█████▌    | 71/128 [1:58:51<1:30:55, 95.71s/it]EarlyStopping counter : 3 out of 40
training process:  56%|█████▋    | 72/128 [2:00:21<1:27:43, 93.99s/it]epoch : 73, train loss : 0.006, valid loss : 0.103, train acc : 0.994, valid acc : 0.947, train f1 : 0.994, valid f1 : 0.640

  0%|          | 0/194 [00:00<?, ?it/s][A
 10%|█         | 20/194 [00:00<00:00, 193.19it/s][A
 26%|██▌       | 50/194 [00:00<00:00, 252.80it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 286.50it/s][A
 60%|█████▉    | 116/194 [00:00<00:00, 302.64it/s][A
 76%|███████▋  | 148/194 [00:00<00:00, 307.95it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 308.50it/s][A100%|██████████| 194/194 [00:00<00:00, 296.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  57%|█████▋    | 73/128 [2:02:18<1:32:34, 101.00s/it]EarlyStopping counter : 5 out of 40
training process:  58%|█████▊    | 74/128 [2:03:49<1:28:02, 97.82s/it] EarlyStopping counter : 6 out of 40
training process:  59%|█████▊    | 75/128 [2:05:22<1:25:16, 96.55s/it]EarlyStopping counter : 7 out of 40
training process:  59%|█████▉    | 76/128 [2:06:57<1:23:17, 96.11s/it]epoch : 77, train loss : 0.005, valid loss : 0.097, train acc : 0.994, valid acc : 0.952, train f1 : 0.994, valid f1 : 0.646

  0%|          | 0/194 [00:00<?, ?it/s][A
  9%|▉         | 18/194 [00:00<00:01, 172.52it/s][A
 19%|█▊        | 36/194 [00:00<00:00, 174.86it/s][A
 31%|███▏      | 61/194 [00:00<00:00, 207.89it/s][A
 45%|████▌     | 88/194 [00:00<00:00, 230.64it/s][A
 59%|█████▉    | 115/194 [00:00<00:00, 244.06it/s][A
 74%|███████▎  | 143/194 [00:00<00:00, 253.84it/s][A
 88%|████████▊ | 171/194 [00:00<00:00, 259.86it/s][A100%|██████████| 194/194 [00:00<00:00, 242.08it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  60%|██████    | 77/128 [2:08:56<1:27:18, 102.71s/it]EarlyStopping counter : 9 out of 40
training process:  61%|██████    | 78/128 [2:10:29<1:23:19, 99.98s/it] EarlyStopping counter : 10 out of 40
training process:  62%|██████▏   | 79/128 [2:12:02<1:19:49, 97.75s/it]EarlyStopping counter : 11 out of 40
training process:  62%|██████▎   | 80/128 [2:13:35<1:17:05, 96.36s/it]epoch : 81, train loss : 0.006, valid loss : 0.097, train acc : 0.994, valid acc : 0.952, train f1 : 0.994, valid f1 : 0.645

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 26/194 [00:00<00:00, 253.76it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 272.95it/s][A
 44%|████▍     | 86/194 [00:00<00:00, 287.55it/s][A
 61%|██████    | 118/194 [00:00<00:00, 294.09it/s][A
 77%|███████▋  | 149/194 [00:00<00:00, 297.19it/s][A
 92%|█████████▏| 179/194 [00:00<00:00, 296.33it/s][A100%|██████████| 194/194 [00:00<00:00, 291.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 12 out of 40
training process:  63%|██████▎   | 81/128 [2:15:38<1:21:49, 104.45s/it]EarlyStopping counter : 13 out of 40
training process:  64%|██████▍   | 82/128 [2:17:12<1:17:38, 101.27s/it]EarlyStopping counter : 14 out of 40
training process:  65%|██████▍   | 83/128 [2:18:48<1:14:42, 99.61s/it] EarlyStopping counter : 15 out of 40
training process:  66%|██████▌   | 84/128 [2:20:22<1:11:52, 98.00s/it]epoch : 85, train loss : 0.004, valid loss : 0.102, train acc : 0.995, valid acc : 0.954, train f1 : 0.995, valid f1 : 0.648

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 243.03it/s][A
 27%|██▋       | 53/194 [00:00<00:00, 261.67it/s][A
 41%|████      | 80/194 [00:00<00:00, 265.34it/s][A
 56%|█████▌    | 108/194 [00:00<00:00, 267.57it/s][A
 70%|███████   | 136/194 [00:00<00:00, 269.78it/s][A
 84%|████████▍ | 163/194 [00:00<00:00, 269.69it/s][A
 98%|█████████▊| 191/194 [00:00<00:00, 272.10it/s][A100%|██████████| 194/194 [00:00<00:00, 268.42it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 16 out of 40
training process:  66%|██████▋   | 85/128 [2:22:24<1:15:27, 105.28s/it]Best score increase :0.666 -> 0.668
training process:  67%|██████▋   | 86/128 [2:23:57<1:11:06, 101.58s/it]EarlyStopping counter : 1 out of 40
training process:  68%|██████▊   | 87/128 [2:25:31<1:07:52, 99.33s/it] EarlyStopping counter : 2 out of 40
training process:  69%|██████▉   | 88/128 [2:27:05<1:05:10, 97.76s/it]epoch : 89, train loss : 0.005, valid loss : 0.108, train acc : 0.995, valid acc : 0.951, train f1 : 0.995, valid f1 : 0.640

  0%|          | 0/194 [00:00<?, ?it/s][A
 12%|█▏        | 24/194 [00:00<00:00, 233.75it/s][A
 25%|██▌       | 49/194 [00:00<00:00, 238.45it/s][A
 38%|███▊      | 73/194 [00:00<00:00, 238.91it/s][A
 50%|█████     | 97/194 [00:00<00:00, 238.48it/s][A
 63%|██████▎   | 123/194 [00:00<00:00, 243.02it/s][A
 76%|███████▋  | 148/194 [00:00<00:00, 244.84it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 248.82it/s][A100%|██████████| 194/194 [00:00<00:00, 244.93it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  70%|██████▉   | 89/128 [2:29:10<1:08:43, 105.73s/it]EarlyStopping counter : 4 out of 40
training process:  70%|███████   | 90/128 [2:30:45<1:04:55, 102.51s/it]EarlyStopping counter : 5 out of 40
training process:  71%|███████   | 91/128 [2:32:21<1:01:59, 100.53s/it]EarlyStopping counter : 6 out of 40
training process:  72%|███████▏  | 92/128 [2:33:56<59:19, 98.87s/it]   epoch : 93, train loss : 0.004, valid loss : 0.109, train acc : 0.995, valid acc : 0.954, train f1 : 0.995, valid f1 : 0.650

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 276.74it/s][A
 30%|███       | 59/194 [00:00<00:00, 291.98it/s][A
 48%|████▊     | 93/194 [00:00<00:00, 309.95it/s][A
 66%|██████▌   | 128/194 [00:00<00:00, 324.33it/s][A
 84%|████████▍ | 163/194 [00:00<00:00, 332.97it/s][A100%|██████████| 194/194 [00:00<00:00, 324.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  73%|███████▎  | 93/128 [2:36:00<1:02:06, 106.47s/it]EarlyStopping counter : 8 out of 40
training process:  73%|███████▎  | 94/128 [2:37:36<58:33, 103.33s/it]  EarlyStopping counter : 9 out of 40
training process:  74%|███████▍  | 95/128 [2:39:08<55:03, 100.09s/it]EarlyStopping counter : 10 out of 40
training process:  75%|███████▌  | 96/128 [2:40:46<52:54, 99.20s/it] epoch : 97, train loss : 0.004, valid loss : 0.108, train acc : 0.995, valid acc : 0.958, train f1 : 0.995, valid f1 : 0.658

  0%|          | 0/194 [00:00<?, ?it/s][A
 15%|█▌        | 30/194 [00:00<00:00, 298.90it/s][A
 31%|███       | 60/194 [00:00<00:00, 295.55it/s][A
 46%|████▋     | 90/194 [00:00<00:00, 294.00it/s][A
 62%|██████▏   | 120/194 [00:00<00:00, 290.95it/s][A
 77%|███████▋  | 150/194 [00:00<00:00, 291.74it/s][A
 93%|█████████▎| 180/194 [00:00<00:00, 290.70it/s][A100%|██████████| 194/194 [00:00<00:00, 291.34it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  76%|███████▌  | 97/128 [2:42:47<54:39, 105.79s/it]EarlyStopping counter : 12 out of 40
training process:  77%|███████▋  | 98/128 [2:44:21<51:06, 102.22s/it]EarlyStopping counter : 13 out of 40
training process:  77%|███████▋  | 99/128 [2:45:55<48:18, 99.96s/it] EarlyStopping counter : 14 out of 40
training process:  78%|███████▊  | 100/128 [2:47:27<45:30, 97.50s/it]epoch : 101, train loss : 0.004, valid loss : 0.110, train acc : 0.995, valid acc : 0.958, train f1 : 0.995, valid f1 : 0.663

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 272.38it/s][A
 30%|███       | 59/194 [00:00<00:00, 292.60it/s][A
 46%|████▋     | 90/194 [00:00<00:00, 297.15it/s][A
 63%|██████▎   | 122/194 [00:00<00:00, 304.48it/s][A
 79%|███████▉  | 154/194 [00:00<00:00, 308.58it/s][A
 95%|█████████▌| 185/194 [00:00<00:00, 308.09it/s][A100%|██████████| 194/194 [00:00<00:00, 303.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 15 out of 40
training process:  79%|███████▉  | 101/128 [2:49:30<47:18, 105.15s/it]EarlyStopping counter : 16 out of 40
training process:  80%|███████▉  | 102/128 [2:51:05<44:11, 101.98s/it]EarlyStopping counter : 17 out of 40
training process:  80%|████████  | 103/128 [2:52:38<41:26, 99.47s/it] EarlyStopping counter : 18 out of 40
training process:  81%|████████▏ | 104/128 [2:54:11<39:01, 97.58s/it]epoch : 105, train loss : 0.004, valid loss : 0.116, train acc : 0.996, valid acc : 0.951, train f1 : 0.996, valid f1 : 0.639

  0%|          | 0/194 [00:00<?, ?it/s][A
 13%|█▎        | 25/194 [00:00<00:00, 248.74it/s][A
 27%|██▋       | 53/194 [00:00<00:00, 266.94it/s][A
 42%|████▏     | 82/194 [00:00<00:00, 274.05it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 277.81it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 279.53it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 280.83it/s][A100%|██████████| 194/194 [00:00<00:00, 281.90it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 19 out of 40
training process:  82%|████████▏ | 105/128 [2:56:14<40:17, 105.09s/it]EarlyStopping counter : 20 out of 40
training process:  83%|████████▎ | 106/128 [2:57:47<37:09, 101.34s/it]EarlyStopping counter : 21 out of 40
training process:  84%|████████▎ | 107/128 [2:59:21<34:41, 99.13s/it] EarlyStopping counter : 22 out of 40
training process:  84%|████████▍ | 108/128 [3:00:54<32:25, 97.28s/it]epoch : 109, train loss : 0.004, valid loss : 0.118, train acc : 0.996, valid acc : 0.955, train f1 : 0.996, valid f1 : 0.649

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 28/194 [00:00<00:00, 274.57it/s][A
 30%|██▉       | 58/194 [00:00<00:00, 285.07it/s][A
 47%|████▋     | 91/194 [00:00<00:00, 301.39it/s][A
 64%|██████▍   | 125/194 [00:00<00:00, 315.07it/s][A
 82%|████████▏ | 159/194 [00:00<00:00, 322.10it/s][A
 99%|█████████▉| 193/194 [00:00<00:00, 325.20it/s][A100%|██████████| 194/194 [00:00<00:00, 314.84it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 23 out of 40
training process:  85%|████████▌ | 109/128 [3:02:53<32:55, 103.97s/it]EarlyStopping counter : 24 out of 40
training process:  86%|████████▌ | 110/128 [3:04:26<30:12, 100.71s/it]EarlyStopping counter : 25 out of 40
training process:  87%|████████▋ | 111/128 [3:05:59<27:49, 98.23s/it] EarlyStopping counter : 26 out of 40
training process:  88%|████████▊ | 112/128 [3:07:33<25:50, 96.93s/it]epoch : 113, train loss : 0.004, valid loss : 0.112, train acc : 0.997, valid acc : 0.961, train f1 : 0.997, valid f1 : 0.668

  0%|          | 0/194 [00:00<?, ?it/s][A
 14%|█▍        | 27/194 [00:00<00:00, 266.99it/s][A
 28%|██▊       | 55/194 [00:00<00:00, 273.87it/s][A
 43%|████▎     | 83/194 [00:00<00:00, 276.21it/s][A
 57%|█████▋    | 111/194 [00:00<00:00, 277.55it/s][A
 72%|███████▏  | 140/194 [00:00<00:00, 278.53it/s][A
 87%|████████▋ | 169/194 [00:00<00:00, 279.28it/s][A100%|██████████| 194/194 [00:00<00:00, 277.97it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 27 out of 40
training process:  88%|████████▊ | 113/128 [3:09:32<25:53, 103.55s/it]EarlyStopping counter : 28 out of 40
training process:  89%|████████▉ | 114/128 [3:11:04<23:24, 100.31s/it]EarlyStopping counter : 29 out of 40
training process:  90%|████████▉ | 115/128 [3:12:36<21:09, 97.63s/it] EarlyStopping counter : 30 out of 40
training process:  91%|█████████ | 116/128 [3:14:08<19:13, 96.10s/it]epoch : 117, train loss : 0.003, valid loss : 0.129, train acc : 0.997, valid acc : 0.954, train f1 : 0.997, valid f1 : 0.650

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 334.45it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 341.68it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 344.17it/s][A
 72%|███████▏  | 139/194 [00:00<00:00, 345.74it/s][A
 90%|████████▉ | 174/194 [00:00<00:00, 346.24it/s][A100%|██████████| 194/194 [00:00<00:00, 345.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 31 out of 40
training process:  91%|█████████▏| 117/128 [3:16:06<18:48, 102.63s/it]EarlyStopping counter : 32 out of 40
training process:  92%|█████████▏| 118/128 [3:17:39<16:37, 99.73s/it] EarlyStopping counter : 33 out of 40
training process:  93%|█████████▎| 119/128 [3:19:13<14:41, 97.98s/it]EarlyStopping counter : 34 out of 40
training process:  94%|█████████▍| 120/128 [3:20:47<12:54, 96.83s/it]epoch : 121, train loss : 0.003, valid loss : 0.120, train acc : 0.997, valid acc : 0.962, train f1 : 0.997, valid f1 : 0.669

  0%|          | 0/194 [00:00<?, ?it/s][A
 18%|█▊        | 34/194 [00:00<00:00, 330.35it/s][A
 36%|███▌      | 69/194 [00:00<00:00, 336.88it/s][A
 54%|█████▎    | 104/194 [00:00<00:00, 339.36it/s][A
 71%|███████   | 138/194 [00:00<00:00, 337.54it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 338.56it/s][A100%|██████████| 194/194 [00:00<00:00, 338.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.668 -> 0.669
training process:  95%|█████████▍| 121/128 [3:22:46<12:03, 103.34s/it]EarlyStopping counter : 1 out of 40
training process:  95%|█████████▌| 122/128 [3:24:18<10:00, 100.12s/it]EarlyStopping counter : 2 out of 40
training process:  96%|█████████▌| 123/128 [3:25:51<08:08, 97.79s/it] EarlyStopping counter : 3 out of 40
training process:  97%|█████████▋| 124/128 [3:27:23<06:25, 96.28s/it]epoch : 125, train loss : 0.003, valid loss : 0.138, train acc : 0.997, valid acc : 0.952, train f1 : 0.997, valid f1 : 0.645

  0%|          | 0/194 [00:00<?, ?it/s][A
 17%|█▋        | 33/194 [00:00<00:00, 328.96it/s][A
 35%|███▌      | 68/194 [00:00<00:00, 337.71it/s][A
 53%|█████▎    | 103/194 [00:00<00:00, 340.59it/s][A
 71%|███████   | 138/194 [00:00<00:00, 342.87it/s][A
 89%|████████▉ | 173/194 [00:00<00:00, 344.48it/s][A100%|██████████| 194/194 [00:00<00:00, 340.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  98%|█████████▊| 125/128 [3:29:21<05:08, 102.83s/it]EarlyStopping counter : 5 out of 40
training process:  98%|█████████▊| 126/128 [3:30:53<03:18, 99.46s/it] EarlyStopping counter : 6 out of 40
training process:  99%|█████████▉| 127/128 [3:32:25<01:37, 97.10s/it]EarlyStopping counter : 7 out of 40
training process: 100%|██████████| 128/128 [3:33:57<00:00, 95.67s/it]training process: 100%|██████████| 128/128 [3:33:57<00:00, 100.29s/it]
training process finished, best loss : 0.120 and best acc : 0.962, best f1 : 0.669, best epoch : 120

====================== evaluation process ======================

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.35      0.33      0.34       453
           1       0.98      0.98      0.98     16880

    accuracy                           0.97     17333
   macro avg       0.67      0.66      0.66     17333
weighted avg       0.97      0.97      0.97     17333


# test acc : 0.97, test f1 : 0.66, test AUC : 0.66, test loss : 30.881

====================== Feature Importance ======================

processing for feature importance:   0%|          | 0/17 [00:00<?, ?it/s]processing for feature importance:   6%|▌         | 1/17 [00:13<03:36, 13.52s/it]processing for feature importance:  12%|█▏        | 2/17 [00:26<03:16, 13.10s/it]processing for feature importance:  18%|█▊        | 3/17 [00:43<03:31, 15.09s/it]processing for feature importance:  24%|██▎       | 4/17 [00:56<03:05, 14.24s/it]processing for feature importance:  29%|██▉       | 5/17 [01:11<02:53, 14.46s/it]processing for feature importance:  35%|███▌      | 6/17 [01:24<02:33, 13.94s/it]processing for feature importance:  41%|████      | 7/17 [01:36<02:13, 13.36s/it]processing for feature importance:  47%|████▋     | 8/17 [01:50<02:01, 13.49s/it]processing for feature importance:  53%|█████▎    | 9/17 [02:03<01:45, 13.21s/it]processing for feature importance:  59%|█████▉    | 10/17 [02:16<01:33, 13.35s/it]processing for feature importance:  65%|██████▍   | 11/17 [02:30<01:20, 13.36s/it]processing for feature importance:  71%|███████   | 12/17 [02:41<01:04, 12.86s/it]processing for feature importance:  76%|███████▋  | 13/17 [02:54<00:51, 12.95s/it]processing for feature importance:  82%|████████▏ | 14/17 [03:07<00:38, 12.89s/it]processing for feature importance:  88%|████████▊ | 15/17 [03:20<00:25, 13.00s/it]processing for feature importance:  94%|█████████▍| 16/17 [03:34<00:13, 13.09s/it]processing for feature importance: 100%|██████████| 17/17 [03:47<00:00, 13.27s/it]processing for feature importance: 100%|██████████| 17/17 [03:47<00:00, 13.41s/it]

====================== Visualization process ======================

visualize 2D latent space:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space:   0%|          | 1/212 [00:03<11:26,  3.25s/it]visualize 2D latent space:   1%|          | 2/212 [00:03<06:28,  1.85s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space:   1%|▏         | 1/68 [00:01<02:13,  2.00s/it]visualize 2D latent space:   3%|▎         | 2/68 [00:02<01:32,  1.40s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/212 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   0%|          | 1/212 [00:03<11:03,  3.14s/it]visualize 2D latent space with decision boundary:   1%|          | 2/212 [00:03<06:27,  1.84s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete
visualize 2D latent space with decision boundary:   0%|          | 0/68 [00:00<?, ?it/s]visualize 2D latent space with decision boundary:   1%|▏         | 1/68 [00:01<02:07,  1.91s/it]visualize 2D latent space with decision boundary:   3%|▎         | 2/68 [00:02<01:31,  1.38s/it]
Dimension reduction process : start | latent vector : (768, 128)
Dimension reduction process : complete

====================== Probability curve generation process ======================

  0%|          | 0/194 [00:00<?, ?it/s] 12%|█▏        | 23/194 [00:00<00:00, 226.79it/s] 25%|██▌       | 49/194 [00:00<00:00, 244.76it/s] 39%|███▊      | 75/194 [00:00<00:00, 250.84it/s] 52%|█████▏    | 101/194 [00:00<00:00, 253.62it/s] 65%|██████▌   | 127/194 [00:00<00:00, 254.60it/s] 79%|███████▉  | 153/194 [00:00<00:00, 251.34it/s] 92%|█████████▏| 179/194 [00:00<00:00, 247.73it/s]100%|██████████| 194/194 [00:00<00:00, 248.00it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

================= device setup =================
torch device avaliable :  True
torch current device :  0
torch device num :  4
================= Running code =================
Setting : Transformer_clip_10_dist_2_Focal_RW_Robust_TQ_seed_42
remove invalid data : null / measurement error:   0%|          | 0/616 [00:00<?, ?it/s]remove invalid data : null / measurement error:   3%|▎         | 21/616 [00:00<00:02, 202.32it/s]remove invalid data : null / measurement error:   7%|▋         | 42/616 [00:00<00:02, 199.69it/s]remove invalid data : null / measurement error:  10%|█         | 62/616 [00:00<00:02, 197.47it/s]remove invalid data : null / measurement error:  13%|█▎        | 83/616 [00:00<00:02, 199.80it/s]remove invalid data : null / measurement error:  17%|█▋        | 104/616 [00:00<00:02, 201.68it/s]remove invalid data : null / measurement error:  20%|██        | 126/616 [00:00<00:02, 204.55it/s]remove invalid data : null / measurement error:  24%|██▍       | 148/616 [00:00<00:02, 206.31it/s]remove invalid data : null / measurement error:  28%|██▊       | 170/616 [00:00<00:02, 208.94it/s]remove invalid data : null / measurement error:  31%|███       | 191/616 [00:00<00:02, 206.79it/s]remove invalid data : null / measurement error:  34%|███▍      | 212/616 [00:01<00:01, 206.16it/s]remove invalid data : null / measurement error:  38%|███▊      | 233/616 [00:01<00:01, 206.05it/s]remove invalid data : null / measurement error:  41%|████      | 254/616 [00:01<00:01, 205.75it/s]remove invalid data : null / measurement error:  45%|████▍     | 275/616 [00:01<00:01, 206.04it/s]remove invalid data : null / measurement error:  48%|████▊     | 296/616 [00:01<00:01, 205.15it/s]remove invalid data : null / measurement error:  51%|█████▏    | 317/616 [00:01<00:01, 203.11it/s]remove invalid data : null / measurement error:  55%|█████▍    | 338/616 [00:01<00:01, 200.38it/s]remove invalid data : null / measurement error:  58%|█████▊    | 359/616 [00:01<00:01, 197.59it/s]remove invalid data : null / measurement error:  62%|██████▏   | 384/616 [00:01<00:01, 210.75it/s]remove invalid data : null / measurement error:  66%|██████▋   | 409/616 [00:01<00:00, 221.06it/s]remove invalid data : null / measurement error:  70%|███████   | 432/616 [00:02<00:00, 223.35it/s]remove invalid data : null / measurement error:  74%|███████▍  | 456/616 [00:02<00:00, 227.67it/s]remove invalid data : null / measurement error:  78%|███████▊  | 479/616 [00:02<00:00, 221.21it/s]remove invalid data : null / measurement error:  81%|████████▏ | 502/616 [00:02<00:00, 214.95it/s]remove invalid data : null / measurement error:  85%|████████▌ | 524/616 [00:02<00:00, 211.85it/s]remove invalid data : null / measurement error:  89%|████████▊ | 546/616 [00:02<00:00, 207.90it/s]remove invalid data : null / measurement error:  92%|█████████▏| 567/616 [00:02<00:00, 207.12it/s]remove invalid data : null / measurement error:  95%|█████████▌| 588/616 [00:02<00:00, 206.47it/s]remove invalid data : null / measurement error:  99%|█████████▉| 609/616 [00:02<00:00, 206.12it/s]remove invalid data : null / measurement error: 100%|██████████| 616/616 [00:02<00:00, 208.02it/s]
replace nan value:   0%|          | 0/515 [00:00<?, ?it/s]replace nan value:   5%|▍         | 24/515 [00:00<00:02, 238.47it/s]replace nan value:   9%|▉         | 48/515 [00:00<00:01, 238.07it/s]replace nan value:  14%|█▍        | 72/515 [00:00<00:01, 237.64it/s]replace nan value:  19%|█▉        | 97/515 [00:00<00:01, 239.01it/s]replace nan value:  24%|██▎       | 122/515 [00:00<00:01, 239.52it/s]replace nan value:  29%|██▊       | 147/515 [00:00<00:01, 240.30it/s]replace nan value:  33%|███▎      | 172/515 [00:00<00:01, 239.79it/s]replace nan value:  38%|███▊      | 196/515 [00:00<00:01, 238.93it/s]replace nan value:  43%|████▎     | 220/515 [00:00<00:01, 239.03it/s]replace nan value:  48%|████▊     | 245/515 [00:01<00:01, 239.50it/s]replace nan value:  52%|█████▏    | 270/515 [00:01<00:01, 239.79it/s]replace nan value:  57%|█████▋    | 294/515 [00:01<00:00, 239.15it/s]replace nan value:  62%|██████▏   | 318/515 [00:01<00:00, 238.71it/s]replace nan value:  66%|██████▋   | 342/515 [00:01<00:00, 236.82it/s]replace nan value:  71%|███████   | 366/515 [00:01<00:00, 236.11it/s]replace nan value:  76%|███████▌  | 390/515 [00:01<00:00, 236.71it/s]replace nan value:  80%|████████  | 414/515 [00:01<00:00, 236.39it/s]replace nan value:  85%|████████▌ | 438/515 [00:01<00:00, 235.63it/s]replace nan value:  90%|████████▉ | 462/515 [00:01<00:00, 235.98it/s]replace nan value:  94%|█████████▍| 486/515 [00:02<00:00, 236.42it/s]replace nan value:  99%|█████████▉| 510/515 [00:02<00:00, 236.74it/s]replace nan value: 100%|██████████| 515/515 [00:02<00:00, 237.72it/s]
generate index:   0%|          | 0/515 [00:00<?, ?it/s]generate index:   1%|          | 5/515 [00:00<00:12, 39.65it/s]generate index:   3%|▎         | 13/515 [00:00<00:09, 54.86it/s]generate index:   5%|▍         | 24/515 [00:00<00:06, 73.31it/s]generate index:   6%|▌         | 32/515 [00:00<00:06, 70.71it/s]generate index:   8%|▊         | 41/515 [00:00<00:06, 70.42it/s]generate index:  10%|▉         | 49/515 [00:00<00:08, 53.33it/s]generate index:  11%|█         | 56/515 [00:00<00:08, 56.12it/s]generate index:  12%|█▏        | 63/515 [00:01<00:09, 47.00it/s]generate index:  14%|█▍        | 71/515 [00:01<00:08, 53.68it/s]generate index:  15%|█▍        | 77/515 [00:01<00:08, 51.83it/s]generate index:  17%|█▋        | 87/515 [00:01<00:06, 62.29it/s]generate index:  18%|█▊        | 94/515 [00:01<00:06, 61.68it/s]generate index:  20%|█▉        | 101/515 [00:01<00:07, 57.57it/s]generate index:  21%|██▏       | 110/515 [00:01<00:06, 63.67it/s]generate index:  23%|██▎       | 118/515 [00:01<00:06, 62.01it/s]generate index:  25%|██▍       | 128/515 [00:02<00:05, 69.69it/s]generate index:  26%|██▋       | 136/515 [00:02<00:05, 70.20it/s]generate index:  28%|██▊       | 144/515 [00:02<00:05, 70.90it/s]generate index:  30%|██▉       | 152/515 [00:02<00:05, 70.00it/s]generate index:  31%|███       | 160/515 [00:02<00:05, 70.36it/s]generate index:  33%|███▎      | 168/515 [00:02<00:05, 68.98it/s]generate index:  34%|███▍      | 175/515 [00:02<00:05, 65.82it/s]generate index:  36%|███▌      | 184/515 [00:02<00:04, 67.68it/s]generate index:  37%|███▋      | 191/515 [00:03<00:04, 66.50it/s]generate index:  38%|███▊      | 198/515 [00:03<00:04, 65.09it/s]generate index:  40%|███▉      | 205/515 [00:03<00:04, 63.73it/s]generate index:  43%|████▎     | 219/515 [00:03<00:03, 84.13it/s]generate index:  44%|████▍     | 228/515 [00:03<00:03, 77.55it/s]generate index:  46%|████▌     | 236/515 [00:03<00:03, 78.19it/s]generate index:  48%|████▊     | 246/515 [00:03<00:03, 82.48it/s]generate index:  50%|████▉     | 255/515 [00:03<00:04, 63.78it/s]generate index:  51%|█████▏    | 265/515 [00:04<00:03, 71.88it/s]generate index:  53%|█████▎    | 275/515 [00:04<00:03, 75.45it/s]generate index:  55%|█████▌    | 284/515 [00:04<00:03, 59.45it/s]generate index:  57%|█████▋    | 291/515 [00:04<00:03, 61.39it/s]generate index:  58%|█████▊    | 298/515 [00:04<00:03, 59.15it/s]generate index:  59%|█████▉    | 305/515 [00:04<00:03, 60.16it/s]generate index:  61%|██████    | 312/515 [00:04<00:03, 61.45it/s]generate index:  62%|██████▏   | 319/515 [00:04<00:03, 57.81it/s]generate index:  63%|██████▎   | 327/515 [00:05<00:03, 61.48it/s]generate index:  65%|██████▍   | 334/515 [00:05<00:03, 55.72it/s]generate index:  66%|██████▌   | 340/515 [00:05<00:03, 46.17it/s]generate index:  67%|██████▋   | 345/515 [00:05<00:03, 46.46it/s]generate index:  68%|██████▊   | 350/515 [00:05<00:04, 39.75it/s]generate index:  70%|███████   | 361/515 [00:05<00:02, 55.19it/s]generate index:  72%|███████▏  | 372/515 [00:05<00:02, 67.18it/s]generate index:  74%|███████▍  | 381/515 [00:06<00:01, 71.63it/s]generate index:  76%|███████▌  | 389/515 [00:06<00:01, 68.59it/s]generate index:  77%|███████▋  | 399/515 [00:06<00:01, 74.03it/s]generate index:  79%|███████▉  | 407/515 [00:06<00:01, 61.00it/s]generate index:  81%|████████  | 415/515 [00:06<00:01, 64.59it/s]generate index:  83%|████████▎ | 425/515 [00:06<00:01, 73.03it/s]generate index:  84%|████████▍ | 433/515 [00:06<00:01, 62.73it/s]generate index:  85%|████████▌ | 440/515 [00:07<00:01, 49.56it/s]generate index:  87%|████████▋ | 446/515 [00:07<00:01, 48.28it/s]generate index:  88%|████████▊ | 455/515 [00:07<00:01, 56.98it/s]generate index:  90%|█████████ | 464/515 [00:07<00:00, 62.53it/s]generate index:  91%|█████████▏| 471/515 [00:07<00:00, 54.51it/s]generate index:  93%|█████████▎| 481/515 [00:07<00:00, 64.73it/s]generate index:  95%|█████████▍| 489/515 [00:07<00:00, 66.16it/s]generate index:  97%|█████████▋| 497/515 [00:07<00:00, 62.34it/s]generate index:  98%|█████████▊| 507/515 [00:08<00:00, 68.42it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 57.53it/s]generate index: 100%|██████████| 515/515 [00:08<00:00, 62.20it/s]
remove invalid data : null / measurement error:   0%|          | 0/154 [00:00<?, ?it/s]remove invalid data : null / measurement error:   4%|▍         | 6/154 [00:00<00:02, 58.27it/s]remove invalid data : null / measurement error:  18%|█▊        | 27/154 [00:00<00:00, 143.00it/s]remove invalid data : null / measurement error:  31%|███       | 48/154 [00:00<00:00, 170.99it/s]remove invalid data : null / measurement error:  45%|████▍     | 69/154 [00:00<00:00, 186.02it/s]remove invalid data : null / measurement error:  58%|█████▊    | 90/154 [00:00<00:00, 191.25it/s]remove invalid data : null / measurement error:  74%|███████▍  | 114/154 [00:00<00:00, 204.97it/s]remove invalid data : null / measurement error:  88%|████████▊ | 135/154 [00:00<00:00, 202.43it/s]remove invalid data : null / measurement error: 100%|██████████| 154/154 [00:00<00:00, 187.46it/s]
replace nan value:   0%|          | 0/131 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 24/131 [00:00<00:00, 234.63it/s]replace nan value:  37%|███▋      | 49/131 [00:00<00:00, 237.93it/s]replace nan value:  56%|█████▌    | 73/131 [00:00<00:00, 238.83it/s]replace nan value:  74%|███████▍  | 97/131 [00:00<00:00, 236.73it/s]replace nan value:  92%|█████████▏| 121/131 [00:00<00:00, 236.56it/s]replace nan value: 100%|██████████| 131/131 [00:00<00:00, 237.19it/s]
generate index:   0%|          | 0/131 [00:00<?, ?it/s]generate index:   5%|▌         | 7/131 [00:00<00:01, 66.11it/s]generate index:  11%|█         | 14/131 [00:00<00:02, 47.89it/s]generate index:  16%|█▌        | 21/131 [00:00<00:01, 55.72it/s]generate index:  21%|██        | 27/131 [00:00<00:01, 56.48it/s]generate index:  25%|██▌       | 33/131 [00:00<00:01, 57.52it/s]generate index:  32%|███▏      | 42/131 [00:00<00:01, 60.93it/s]generate index:  37%|███▋      | 49/131 [00:00<00:01, 61.65it/s]generate index:  43%|████▎     | 56/131 [00:00<00:01, 61.96it/s]generate index:  48%|████▊     | 63/131 [00:01<00:01, 63.72it/s]generate index:  53%|█████▎    | 70/131 [00:01<00:00, 63.84it/s]generate index:  59%|█████▉    | 77/131 [00:01<00:00, 65.39it/s]generate index:  64%|██████▍   | 84/131 [00:01<00:00, 65.95it/s]generate index:  69%|██████▉   | 91/131 [00:01<00:00, 45.54it/s]generate index:  74%|███████▍  | 97/131 [00:01<00:00, 47.78it/s]generate index:  79%|███████▊  | 103/131 [00:01<00:00, 46.45it/s]generate index:  83%|████████▎ | 109/131 [00:01<00:00, 48.98it/s]generate index:  90%|█████████ | 118/131 [00:02<00:00, 58.63it/s]generate index:  98%|█████████▊| 129/131 [00:02<00:00, 71.57it/s]generate index: 100%|██████████| 131/131 [00:02<00:00, 58.40it/s]
remove invalid data : null / measurement error:   0%|          | 0/193 [00:00<?, ?it/s]remove invalid data : null / measurement error:   2%|▏         | 4/193 [00:00<00:04, 39.03it/s]remove invalid data : null / measurement error:  13%|█▎        | 25/193 [00:00<00:01, 136.12it/s]remove invalid data : null / measurement error:  24%|██▍       | 46/193 [00:00<00:00, 165.88it/s]remove invalid data : null / measurement error:  35%|███▍      | 67/193 [00:00<00:00, 181.32it/s]remove invalid data : null / measurement error:  46%|████▌     | 89/193 [00:00<00:00, 191.90it/s]remove invalid data : null / measurement error:  56%|█████▋    | 109/193 [00:00<00:00, 193.43it/s]remove invalid data : null / measurement error:  69%|██████▉   | 133/193 [00:00<00:00, 207.92it/s]remove invalid data : null / measurement error:  80%|███████▉  | 154/193 [00:00<00:00, 206.78it/s]remove invalid data : null / measurement error:  91%|█████████ | 175/193 [00:00<00:00, 203.45it/s]remove invalid data : null / measurement error: 100%|██████████| 193/193 [00:01<00:00, 188.92it/s]
replace nan value:   0%|          | 0/160 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 24/160 [00:00<00:00, 236.21it/s]replace nan value:  31%|███       | 49/160 [00:00<00:00, 239.22it/s]replace nan value:  46%|████▋     | 74/160 [00:00<00:00, 240.38it/s]replace nan value:  62%|██████▏   | 99/160 [00:00<00:00, 239.75it/s]replace nan value:  78%|███████▊  | 124/160 [00:00<00:00, 241.33it/s]replace nan value:  93%|█████████▎| 149/160 [00:00<00:00, 242.28it/s]replace nan value: 100%|██████████| 160/160 [00:00<00:00, 241.37it/s]
generate index:   0%|          | 0/160 [00:00<?, ?it/s]generate index:   7%|▋         | 11/160 [00:00<00:01, 104.59it/s]generate index:  14%|█▍        | 22/160 [00:00<00:02, 63.12it/s] generate index:  19%|█▉        | 30/160 [00:00<00:02, 61.39it/s]generate index:  26%|██▌       | 41/160 [00:00<00:01, 73.73it/s]generate index:  32%|███▏      | 51/160 [00:00<00:01, 80.36it/s]generate index:  38%|███▊      | 60/160 [00:00<00:01, 82.34it/s]generate index:  44%|████▍     | 71/160 [00:00<00:01, 82.75it/s]generate index:  50%|█████     | 80/160 [00:01<00:01, 67.97it/s]generate index:  55%|█████▌    | 88/160 [00:01<00:01, 58.23it/s]generate index:  59%|█████▉    | 95/160 [00:01<00:01, 59.07it/s]generate index:  64%|██████▍   | 102/160 [00:01<00:01, 52.69it/s]generate index:  68%|██████▊   | 108/160 [00:01<00:01, 48.72it/s]generate index:  74%|███████▍  | 118/160 [00:01<00:00, 58.15it/s]generate index:  78%|███████▊  | 125/160 [00:01<00:00, 59.06it/s]generate index:  82%|████████▎ | 132/160 [00:02<00:00, 54.52it/s]generate index:  86%|████████▋ | 138/160 [00:02<00:00, 53.27it/s]generate index:  91%|█████████▏| 146/160 [00:02<00:00, 56.78it/s]generate index:  96%|█████████▋| 154/160 [00:02<00:00, 60.93it/s]generate index: 100%|██████████| 160/160 [00:02<00:00, 61.38it/s]
================= Dataset information =================
train data : 54044, disrupt : 1442, non-disrupt : 52602
valid data : 15008, disrupt : 375, non-disrupt : 14633
test data : 17333, disrupt : 453, non-disrupt : 16880

==================== model summary ====================

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
   TransformerEncoder-1         [2, 10, 17]         813,348         813,348
               Linear-2            [2, 128]          16,512          16,512
          BatchNorm1d-3            [2, 128]             256             256
                 GELU-4            [2, 128]               0               0
               Linear-5            [2, 128]             258             258
============================================================================
Total params: 830,374
Trainable params: 830,374
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

======================= training process =======================

training process:   0%|          | 0/128 [00:00<?, ?it/s]| epoch : 1 | train loss : 0.009 | valid loss : 0.009 | train acc : 0.602 | valid acc : 0.663 | train f1 : 0.414 | valid f1 : 0.432

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  18%|█▊        | 34/194 [00:00<00:00, 339.02it/s][A
Evaluation : continuous disruption prediction:  36%|███▌      | 69/194 [00:00<00:00, 344.97it/s][A
Evaluation : continuous disruption prediction:  54%|█████▎    | 104/194 [00:00<00:00, 345.38it/s][A
Evaluation : continuous disruption prediction:  72%|███████▏  | 139/194 [00:00<00:00, 343.95it/s][A
Evaluation : continuous disruption prediction:  90%|████████▉ | 174/194 [00:00<00:00, 345.81it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 345.40it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.000 -> 0.432
training process:   1%|          | 1/128 [01:56<4:06:57, 116.68s/it]Best score increase :0.432 -> 0.498
training process:   2%|▏         | 2/128 [03:29<3:35:40, 102.70s/it]EarlyStopping counter : 1 out of 40
training process:   2%|▏         | 3/128 [04:58<3:20:59, 96.47s/it] Best score increase :0.498 -> 0.516
training process:   3%|▎         | 4/128 [06:28<3:13:49, 93.79s/it]| epoch : 5 | train loss : 0.006 | valid loss : 0.007 | train acc : 0.742 | valid acc : 0.632 | train f1 : 0.496 | valid f1 : 0.438

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  15%|█▍        | 29/194 [00:00<00:00, 288.90it/s][A
Evaluation : continuous disruption prediction:  30%|███       | 59/194 [00:00<00:00, 292.84it/s][A
Evaluation : continuous disruption prediction:  46%|████▌     | 89/194 [00:00<00:00, 294.22it/s][A
Evaluation : continuous disruption prediction:  61%|██████▏   | 119/194 [00:00<00:00, 294.97it/s][A
Evaluation : continuous disruption prediction:  77%|███████▋  | 149/194 [00:00<00:00, 295.05it/s][A
Evaluation : continuous disruption prediction:  92%|█████████▏| 179/194 [00:00<00:00, 295.47it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 295.41it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:   4%|▍         | 5/128 [08:22<3:27:21, 101.15s/it]Best score increase :0.516 -> 0.533
training process:   5%|▍         | 6/128 [09:50<3:16:48, 96.79s/it] Best score increase :0.533 -> 0.542
training process:   5%|▌         | 7/128 [11:19<3:09:37, 94.03s/it]EarlyStopping counter : 1 out of 40
training process:   6%|▋         | 8/128 [12:46<3:03:57, 91.98s/it]| epoch : 9 | train loss : 0.005 | valid loss : 0.006 | train acc : 0.823 | valid acc : 0.809 | train f1 : 0.553 | valid f1 : 0.534

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  15%|█▍        | 29/194 [00:00<00:00, 286.20it/s][A
Evaluation : continuous disruption prediction:  30%|███       | 59/194 [00:00<00:00, 290.35it/s][A
Evaluation : continuous disruption prediction:  46%|████▌     | 89/194 [00:00<00:00, 294.60it/s][A
Evaluation : continuous disruption prediction:  62%|██████▏   | 120/194 [00:00<00:00, 298.76it/s][A
Evaluation : continuous disruption prediction:  77%|███████▋  | 150/194 [00:00<00:00, 296.63it/s][A
Evaluation : continuous disruption prediction:  93%|█████████▎| 180/194 [00:00<00:00, 295.46it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 294.83it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:   7%|▋         | 9/128 [14:40<3:15:56, 98.80s/it]Best score increase :0.542 -> 0.545
training process:   8%|▊         | 10/128 [16:10<3:09:02, 96.12s/it]EarlyStopping counter : 1 out of 40
training process:   9%|▊         | 11/128 [17:40<3:03:48, 94.26s/it]Best score increase :0.545 -> 0.558
training process:   9%|▉         | 12/128 [19:12<3:00:32, 93.38s/it]| epoch : 13 | train loss : 0.004 | valid loss : 0.007 | train acc : 0.863 | valid acc : 0.761 | train f1 : 0.590 | valid f1 : 0.502

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  15%|█▌        | 30/194 [00:00<00:00, 290.97it/s][A
Evaluation : continuous disruption prediction:  31%|███       | 60/194 [00:00<00:00, 293.45it/s][A
Evaluation : continuous disruption prediction:  46%|████▋     | 90/194 [00:00<00:00, 296.22it/s][A
Evaluation : continuous disruption prediction:  62%|██████▏   | 120/194 [00:00<00:00, 295.83it/s][A
Evaluation : continuous disruption prediction:  77%|███████▋  | 150/194 [00:00<00:00, 296.64it/s][A
Evaluation : continuous disruption prediction:  93%|█████████▎| 181/194 [00:00<00:00, 297.86it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 296.67it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  10%|█         | 13/128 [21:09<3:12:51, 100.62s/it]Best score increase :0.558 -> 0.586
training process:  11%|█         | 14/128 [22:37<3:03:55, 96.80s/it] EarlyStopping counter : 1 out of 40
training process:  12%|█▏        | 15/128 [24:05<2:57:29, 94.24s/it]EarlyStopping counter : 2 out of 40
training process:  12%|█▎        | 16/128 [25:32<2:51:55, 92.10s/it]| epoch : 17 | train loss : 0.004 | valid loss : 0.008 | train acc : 0.878 | valid acc : 0.856 | train f1 : 0.607 | valid f1 : 0.562

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  18%|█▊        | 34/194 [00:00<00:00, 337.36it/s][A
Evaluation : continuous disruption prediction:  36%|███▌      | 69/194 [00:00<00:00, 342.90it/s][A
Evaluation : continuous disruption prediction:  54%|█████▎    | 104/194 [00:00<00:00, 344.60it/s][A
Evaluation : continuous disruption prediction:  72%|███████▏  | 139/194 [00:00<00:00, 345.41it/s][A
Evaluation : continuous disruption prediction:  90%|████████▉ | 174/194 [00:00<00:00, 345.88it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 344.82it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  13%|█▎        | 17/128 [27:24<3:01:31, 98.12s/it]EarlyStopping counter : 4 out of 40
training process:  14%|█▍        | 18/128 [28:56<2:56:16, 96.15s/it]EarlyStopping counter : 5 out of 40
training process:  15%|█▍        | 19/128 [30:24<2:50:28, 93.84s/it]EarlyStopping counter : 6 out of 40
training process:  16%|█▌        | 20/128 [31:54<2:46:33, 92.53s/it]| epoch : 21 | train loss : 0.003 | valid loss : 0.008 | train acc : 0.898 | valid acc : 0.833 | train f1 : 0.634 | valid f1 : 0.545

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  15%|█▌        | 30/194 [00:00<00:00, 291.94it/s][A
Evaluation : continuous disruption prediction:  31%|███▏      | 61/194 [00:00<00:00, 297.81it/s][A
Evaluation : continuous disruption prediction:  47%|████▋     | 92/194 [00:00<00:00, 298.92it/s][A
Evaluation : continuous disruption prediction:  63%|██████▎   | 122/194 [00:00<00:00, 298.40it/s][A
Evaluation : continuous disruption prediction:  78%|███████▊  | 152/194 [00:00<00:00, 296.54it/s][A
Evaluation : continuous disruption prediction:  94%|█████████▍| 182/194 [00:00<00:00, 297.34it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 297.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  16%|█▋        | 21/128 [33:52<2:58:26, 100.06s/it]Best score increase :0.586 -> 0.593
training process:  17%|█▋        | 22/128 [35:20<2:50:48, 96.69s/it] EarlyStopping counter : 1 out of 40
training process:  18%|█▊        | 23/128 [36:51<2:45:53, 94.80s/it]EarlyStopping counter : 2 out of 40
training process:  19%|█▉        | 24/128 [38:21<2:41:45, 93.32s/it]| epoch : 25 | train loss : 0.003 | valid loss : 0.010 | train acc : 0.910 | valid acc : 0.907 | train f1 : 0.652 | valid f1 : 0.612

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  18%|█▊        | 34/194 [00:00<00:00, 333.21it/s][A
Evaluation : continuous disruption prediction:  36%|███▌      | 69/194 [00:00<00:00, 338.61it/s][A
Evaluation : continuous disruption prediction:  54%|█████▎    | 104/194 [00:00<00:00, 340.30it/s][A
Evaluation : continuous disruption prediction:  72%|███████▏  | 139/194 [00:00<00:00, 341.29it/s][A
Evaluation : continuous disruption prediction:  90%|████████▉ | 174/194 [00:00<00:00, 336.07it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 336.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

Best score increase :0.593 -> 0.612
training process:  20%|█▉        | 25/128 [40:14<2:50:43, 99.45s/it]EarlyStopping counter : 1 out of 40
training process:  20%|██        | 26/128 [41:44<2:44:17, 96.64s/it]EarlyStopping counter : 2 out of 40
training process:  21%|██        | 27/128 [43:14<2:38:59, 94.45s/it]EarlyStopping counter : 3 out of 40
training process:  22%|██▏       | 28/128 [44:43<2:34:41, 92.82s/it]| epoch : 29 | train loss : 0.002 | valid loss : 0.011 | train acc : 0.924 | valid acc : 0.883 | train f1 : 0.679 | valid f1 : 0.584

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  15%|█▍        | 29/194 [00:00<00:00, 288.73it/s][A
Evaluation : continuous disruption prediction:  30%|███       | 59/194 [00:00<00:00, 292.10it/s][A
Evaluation : continuous disruption prediction:  46%|████▌     | 89/194 [00:00<00:00, 293.21it/s][A
Evaluation : continuous disruption prediction:  61%|██████▏   | 119/194 [00:00<00:00, 293.17it/s][A
Evaluation : continuous disruption prediction:  77%|███████▋  | 149/194 [00:00<00:00, 293.63it/s][A
Evaluation : continuous disruption prediction:  92%|█████████▏| 179/194 [00:00<00:00, 295.60it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 294.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 4 out of 40
training process:  23%|██▎       | 29/128 [46:35<2:42:57, 98.77s/it]EarlyStopping counter : 5 out of 40
training process:  23%|██▎       | 30/128 [48:06<2:37:19, 96.32s/it]EarlyStopping counter : 6 out of 40
training process:  24%|██▍       | 31/128 [49:39<2:33:53, 95.19s/it]EarlyStopping counter : 7 out of 40
training process:  25%|██▌       | 32/128 [51:14<2:32:21, 95.23s/it]| epoch : 33 | train loss : 0.002 | valid loss : 0.011 | train acc : 0.932 | valid acc : 0.882 | train f1 : 0.695 | valid f1 : 0.581

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  18%|█▊        | 34/194 [00:00<00:00, 335.86it/s][A
Evaluation : continuous disruption prediction:  35%|███▌      | 68/194 [00:00<00:00, 337.05it/s][A
Evaluation : continuous disruption prediction:  53%|█████▎    | 102/194 [00:00<00:00, 326.87it/s][A
Evaluation : continuous disruption prediction:  70%|██████▉   | 135/194 [00:00<00:00, 320.37it/s][A
Evaluation : continuous disruption prediction:  87%|████████▋ | 168/194 [00:00<00:00, 318.26it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 320.85it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 8 out of 40
training process:  26%|██▌       | 33/128 [53:14<2:42:24, 102.57s/it]Best score increase :0.612 -> 0.617
training process:  27%|██▋       | 34/128 [54:41<2:33:26, 97.94s/it] EarlyStopping counter : 1 out of 40
training process:  27%|██▋       | 35/128 [56:08<2:26:41, 94.64s/it]EarlyStopping counter : 2 out of 40
training process:  28%|██▊       | 36/128 [57:35<2:21:45, 92.45s/it]| epoch : 37 | train loss : 0.002 | valid loss : 0.013 | train acc : 0.942 | valid acc : 0.905 | train f1 : 0.718 | valid f1 : 0.601

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  17%|█▋        | 33/194 [00:00<00:00, 325.28it/s][A
Evaluation : continuous disruption prediction:  35%|███▍      | 67/194 [00:00<00:00, 332.44it/s][A
Evaluation : continuous disruption prediction:  52%|█████▏    | 101/194 [00:00<00:00, 334.85it/s][A
Evaluation : continuous disruption prediction:  70%|██████▉   | 135/194 [00:00<00:00, 335.18it/s][A
Evaluation : continuous disruption prediction:  87%|████████▋ | 169/194 [00:00<00:00, 332.49it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 332.19it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 3 out of 40
training process:  29%|██▉       | 37/128 [59:35<2:32:51, 100.79s/it]EarlyStopping counter : 4 out of 40
training process:  30%|██▉       | 38/128 [1:01:08<2:27:23, 98.27s/it]EarlyStopping counter : 5 out of 40
training process:  30%|███       | 39/128 [1:02:43<2:24:35, 97.47s/it]EarlyStopping counter : 6 out of 40
training process:  31%|███▏      | 40/128 [1:04:15<2:20:35, 95.86s/it]| epoch : 41 | train loss : 0.002 | valid loss : 0.015 | train acc : 0.949 | valid acc : 0.909 | train f1 : 0.738 | valid f1 : 0.602

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  16%|█▋        | 32/194 [00:00<00:00, 316.23it/s][A
Evaluation : continuous disruption prediction:  34%|███▎      | 65/194 [00:00<00:00, 323.00it/s][A
Evaluation : continuous disruption prediction:  52%|█████▏    | 100/194 [00:00<00:00, 334.09it/s][A
Evaluation : continuous disruption prediction:  70%|██████▉   | 135/194 [00:00<00:00, 337.31it/s][A
Evaluation : continuous disruption prediction:  87%|████████▋ | 169/194 [00:00<00:00, 336.64it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 332.99it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 7 out of 40
training process:  32%|███▏      | 41/128 [1:06:14<2:28:46, 102.61s/it]EarlyStopping counter : 8 out of 40
training process:  33%|███▎      | 42/128 [1:07:48<2:23:18, 99.99s/it] EarlyStopping counter : 9 out of 40
training process:  34%|███▎      | 43/128 [1:09:24<2:19:55, 98.77s/it]EarlyStopping counter : 10 out of 40
training process:  34%|███▍      | 44/128 [1:10:56<2:15:37, 96.87s/it]| epoch : 45 | train loss : 0.002 | valid loss : 0.014 | train acc : 0.955 | valid acc : 0.896 | train f1 : 0.754 | valid f1 : 0.592

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  18%|█▊        | 34/194 [00:00<00:00, 333.43it/s][A
Evaluation : continuous disruption prediction:  35%|███▌      | 68/194 [00:00<00:00, 333.67it/s][A
Evaluation : continuous disruption prediction:  53%|█████▎    | 102/194 [00:00<00:00, 328.63it/s][A
Evaluation : continuous disruption prediction:  70%|██████▉   | 135/194 [00:00<00:00, 326.40it/s][A
Evaluation : continuous disruption prediction:  87%|████████▋ | 168/194 [00:00<00:00, 325.13it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 326.59it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 11 out of 40
training process:  35%|███▌      | 45/128 [1:12:54<2:22:39, 103.13s/it]EarlyStopping counter : 12 out of 40
training process:  36%|███▌      | 46/128 [1:14:26<2:16:30, 99.88s/it] EarlyStopping counter : 13 out of 40
training process:  37%|███▋      | 47/128 [1:15:58<2:11:47, 97.63s/it]Best score increase :0.617 -> 0.630
training process:  38%|███▊      | 48/128 [1:17:33<2:08:54, 96.68s/it]| epoch : 49 | train loss : 0.001 | valid loss : 0.018 | train acc : 0.961 | valid acc : 0.902 | train f1 : 0.773 | valid f1 : 0.598

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  13%|█▎        | 25/194 [00:00<00:00, 242.03it/s][A
Evaluation : continuous disruption prediction:  26%|██▌       | 50/194 [00:00<00:00, 243.37it/s][A
Evaluation : continuous disruption prediction:  40%|███▉      | 77/194 [00:00<00:00, 253.24it/s][A
Evaluation : continuous disruption prediction:  54%|█████▎    | 104/194 [00:00<00:00, 259.25it/s][A
Evaluation : continuous disruption prediction:  67%|██████▋   | 130/194 [00:00<00:00, 256.90it/s][A
Evaluation : continuous disruption prediction:  80%|████████  | 156/194 [00:00<00:00, 253.96it/s][A
Evaluation : continuous disruption prediction:  94%|█████████▍| 182/194 [00:00<00:00, 251.31it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 252.01it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  38%|███▊      | 49/128 [1:19:34<2:16:47, 103.90s/it]EarlyStopping counter : 2 out of 40
training process:  39%|███▉      | 50/128 [1:21:02<2:09:07, 99.33s/it] EarlyStopping counter : 3 out of 40
training process:  40%|███▉      | 51/128 [1:22:29<2:02:40, 95.59s/it]EarlyStopping counter : 4 out of 40
training process:  41%|████      | 52/128 [1:23:56<1:57:41, 92.91s/it]| epoch : 53 | train loss : 0.002 | valid loss : 0.018 | train acc : 0.963 | valid acc : 0.909 | train f1 : 0.780 | valid f1 : 0.601

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  17%|█▋        | 33/194 [00:00<00:00, 329.76it/s][A
Evaluation : continuous disruption prediction:  35%|███▍      | 67/194 [00:00<00:00, 330.89it/s][A
Evaluation : continuous disruption prediction:  52%|█████▏    | 101/194 [00:00<00:00, 325.45it/s][A
Evaluation : continuous disruption prediction:  69%|██████▉   | 134/194 [00:00<00:00, 326.54it/s][A
Evaluation : continuous disruption prediction:  86%|████████▌ | 167/194 [00:00<00:00, 326.05it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 326.57it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  41%|████▏     | 53/128 [1:25:54<2:05:47, 100.63s/it]EarlyStopping counter : 6 out of 40
training process:  42%|████▏     | 54/128 [1:27:27<2:01:01, 98.13s/it] EarlyStopping counter : 7 out of 40
training process:  43%|████▎     | 55/128 [1:28:54<1:55:18, 94.77s/it]EarlyStopping counter : 8 out of 40
training process:  44%|████▍     | 56/128 [1:30:24<1:52:11, 93.49s/it]| epoch : 57 | train loss : 0.001 | valid loss : 0.017 | train acc : 0.967 | valid acc : 0.904 | train f1 : 0.797 | valid f1 : 0.596

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  17%|█▋        | 33/194 [00:00<00:00, 327.51it/s][A
Evaluation : continuous disruption prediction:  35%|███▍      | 67/194 [00:00<00:00, 334.47it/s][A
Evaluation : continuous disruption prediction:  52%|█████▏    | 101/194 [00:00<00:00, 334.43it/s][A
Evaluation : continuous disruption prediction:  70%|██████▉   | 135/194 [00:00<00:00, 336.45it/s][A
Evaluation : continuous disruption prediction:  87%|████████▋ | 169/194 [00:00<00:00, 337.62it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 336.54it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  45%|████▍     | 57/128 [1:32:17<1:57:36, 99.39s/it]EarlyStopping counter : 10 out of 40
training process:  45%|████▌     | 58/128 [1:33:45<1:51:47, 95.82s/it]EarlyStopping counter : 11 out of 40
training process:  46%|████▌     | 59/128 [1:35:16<1:48:44, 94.55s/it]EarlyStopping counter : 12 out of 40
training process:  47%|████▋     | 60/128 [1:36:47<1:45:54, 93.46s/it]| epoch : 61 | train loss : 0.001 | valid loss : 0.020 | train acc : 0.967 | valid acc : 0.908 | train f1 : 0.796 | valid f1 : 0.593

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  17%|█▋        | 33/194 [00:00<00:00, 322.44it/s][A
Evaluation : continuous disruption prediction:  35%|███▍      | 67/194 [00:00<00:00, 329.39it/s][A
Evaluation : continuous disruption prediction:  52%|█████▏    | 100/194 [00:00<00:00, 326.48it/s][A
Evaluation : continuous disruption prediction:  69%|██████▉   | 134/194 [00:00<00:00, 329.53it/s][A
Evaluation : continuous disruption prediction:  87%|████████▋ | 168/194 [00:00<00:00, 331.50it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 330.37it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 13 out of 40
training process:  48%|████▊     | 61/128 [1:38:40<1:50:56, 99.35s/it]EarlyStopping counter : 14 out of 40
training process:  48%|████▊     | 62/128 [1:40:10<1:46:13, 96.56s/it]EarlyStopping counter : 15 out of 40
training process:  49%|████▉     | 63/128 [1:41:44<1:43:39, 95.68s/it]EarlyStopping counter : 16 out of 40
training process:  50%|█████     | 64/128 [1:43:15<1:40:38, 94.36s/it]| epoch : 65 | train loss : 0.001 | valid loss : 0.022 | train acc : 0.970 | valid acc : 0.914 | train f1 : 0.810 | valid f1 : 0.599

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  16%|█▋        | 32/194 [00:00<00:00, 317.65it/s][A
Evaluation : continuous disruption prediction:  34%|███▎      | 65/194 [00:00<00:00, 323.92it/s][A
Evaluation : continuous disruption prediction:  51%|█████     | 99/194 [00:00<00:00, 329.41it/s][A
Evaluation : continuous disruption prediction:  69%|██████▊   | 133/194 [00:00<00:00, 332.36it/s][A
Evaluation : continuous disruption prediction:  86%|████████▌ | 167/194 [00:00<00:00, 333.98it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 330.16it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 17 out of 40
training process:  51%|█████     | 65/128 [1:45:12<1:46:12, 101.15s/it]EarlyStopping counter : 18 out of 40
training process:  52%|█████▏    | 66/128 [1:46:44<1:41:33, 98.28s/it] EarlyStopping counter : 19 out of 40
training process:  52%|█████▏    | 67/128 [1:48:16<1:37:57, 96.34s/it]EarlyStopping counter : 20 out of 40
training process:  53%|█████▎    | 68/128 [1:49:46<1:34:38, 94.64s/it]| epoch : 69 | train loss : 0.001 | valid loss : 0.022 | train acc : 0.973 | valid acc : 0.926 | train f1 : 0.823 | valid f1 : 0.620

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  17%|█▋        | 33/194 [00:00<00:00, 299.57it/s][A
Evaluation : continuous disruption prediction:  32%|███▏      | 63/194 [00:00<00:00, 237.84it/s][A
Evaluation : continuous disruption prediction:  46%|████▌     | 89/194 [00:00<00:00, 244.48it/s][A
Evaluation : continuous disruption prediction:  59%|█████▉    | 114/194 [00:00<00:00, 230.73it/s][A
Evaluation : continuous disruption prediction:  74%|███████▍  | 144/194 [00:00<00:00, 252.38it/s][A
Evaluation : continuous disruption prediction:  91%|█████████ | 177/194 [00:00<00:00, 274.83it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 264.44it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 21 out of 40
training process:  54%|█████▍    | 69/128 [1:51:46<1:40:23, 102.10s/it]EarlyStopping counter : 22 out of 40
training process:  55%|█████▍    | 70/128 [1:53:15<1:34:52, 98.14s/it] Best score increase :0.630 -> 0.636
training process:  55%|█████▌    | 71/128 [1:54:49<1:32:05, 96.93s/it]EarlyStopping counter : 1 out of 40
training process:  56%|█████▋    | 72/128 [1:56:21<1:29:05, 95.45s/it]| epoch : 73 | train loss : 0.001 | valid loss : 0.024 | train acc : 0.974 | valid acc : 0.920 | train f1 : 0.827 | valid f1 : 0.616

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  14%|█▍        | 27/194 [00:00<00:00, 265.00it/s][A
Evaluation : continuous disruption prediction:  29%|██▉       | 56/194 [00:00<00:00, 276.23it/s][A
Evaluation : continuous disruption prediction:  44%|████▍     | 85/194 [00:00<00:00, 279.89it/s][A
Evaluation : continuous disruption prediction:  59%|█████▉    | 114/194 [00:00<00:00, 281.76it/s][A
Evaluation : continuous disruption prediction:  74%|███████▎  | 143/194 [00:00<00:00, 282.83it/s][A
Evaluation : continuous disruption prediction:  89%|████████▊ | 172/194 [00:00<00:00, 283.42it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 280.38it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 2 out of 40
training process:  57%|█████▋    | 73/128 [1:58:20<1:33:54, 102.45s/it]EarlyStopping counter : 3 out of 40
training process:  58%|█████▊    | 74/128 [1:59:51<1:29:15, 99.18s/it] EarlyStopping counter : 4 out of 40
training process:  59%|█████▊    | 75/128 [2:01:23<1:25:38, 96.94s/it]EarlyStopping counter : 5 out of 40
training process:  59%|█████▉    | 76/128 [2:02:51<1:21:40, 94.25s/it]| epoch : 77 | train loss : 0.001 | valid loss : 0.027 | train acc : 0.976 | valid acc : 0.918 | train f1 : 0.837 | valid f1 : 0.608

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  10%|█         | 20/194 [00:00<00:00, 194.21it/s][A
Evaluation : continuous disruption prediction:  24%|██▎       | 46/194 [00:00<00:00, 230.84it/s][A
Evaluation : continuous disruption prediction:  41%|████      | 79/194 [00:00<00:00, 272.40it/s][A
Evaluation : continuous disruption prediction:  58%|█████▊    | 113/194 [00:00<00:00, 296.95it/s][A
Evaluation : continuous disruption prediction:  76%|███████▌  | 147/194 [00:00<00:00, 310.75it/s][A
Evaluation : continuous disruption prediction:  93%|█████████▎| 181/194 [00:00<00:00, 319.05it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 297.58it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 6 out of 40
training process:  60%|██████    | 77/128 [2:04:51<1:26:48, 102.13s/it]EarlyStopping counter : 7 out of 40
training process:  61%|██████    | 78/128 [2:06:24<1:22:42, 99.25s/it] EarlyStopping counter : 8 out of 40
training process:  62%|██████▏   | 79/128 [2:07:57<1:19:26, 97.27s/it]EarlyStopping counter : 9 out of 40
training process:  62%|██████▎   | 80/128 [2:09:30<1:16:59, 96.23s/it]| epoch : 81 | train loss : 0.001 | valid loss : 0.027 | train acc : 0.980 | valid acc : 0.930 | train f1 : 0.853 | valid f1 : 0.627

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  14%|█▍        | 28/194 [00:00<00:00, 277.07it/s][A
Evaluation : continuous disruption prediction:  31%|███▏      | 61/194 [00:00<00:00, 304.30it/s][A
Evaluation : continuous disruption prediction:  48%|████▊     | 94/194 [00:00<00:00, 312.19it/s][A
Evaluation : continuous disruption prediction:  65%|██████▍   | 126/194 [00:00<00:00, 312.51it/s][A
Evaluation : continuous disruption prediction:  82%|████████▏ | 159/194 [00:00<00:00, 316.42it/s][A
Evaluation : continuous disruption prediction:  99%|█████████▉| 192/194 [00:00<00:00, 318.65it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 313.50it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 10 out of 40
training process:  63%|██████▎   | 81/128 [2:11:28<1:20:25, 102.67s/it]EarlyStopping counter : 11 out of 40
training process:  64%|██████▍   | 82/128 [2:13:01<1:16:24, 99.65s/it] EarlyStopping counter : 12 out of 40
training process:  65%|██████▍   | 83/128 [2:14:33<1:13:06, 97.47s/it]Best score increase :0.636 -> 0.646
training process:  66%|██████▌   | 84/128 [2:16:03<1:09:49, 95.22s/it]| epoch : 85 | train loss : 0.001 | valid loss : 0.028 | train acc : 0.980 | valid acc : 0.934 | train f1 : 0.854 | valid f1 : 0.628

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  16%|█▋        | 32/194 [00:00<00:00, 314.49it/s][A
Evaluation : continuous disruption prediction:  34%|███▍      | 66/194 [00:00<00:00, 327.82it/s][A
Evaluation : continuous disruption prediction:  52%|█████▏    | 100/194 [00:00<00:00, 332.18it/s][A
Evaluation : continuous disruption prediction:  69%|██████▉   | 134/194 [00:00<00:00, 334.12it/s][A
Evaluation : continuous disruption prediction:  87%|████████▋ | 168/194 [00:00<00:00, 335.32it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 332.25it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 1 out of 40
training process:  66%|██████▋   | 85/128 [2:18:02<1:13:21, 102.37s/it]EarlyStopping counter : 2 out of 40
training process:  67%|██████▋   | 86/128 [2:19:32<1:08:59, 98.56s/it] EarlyStopping counter : 3 out of 40
training process:  68%|██████▊   | 87/128 [2:21:07<1:06:39, 97.55s/it]EarlyStopping counter : 4 out of 40
training process:  69%|██████▉   | 88/128 [2:22:37<1:03:27, 95.19s/it]| epoch : 89 | train loss : 0.001 | valid loss : 0.028 | train acc : 0.981 | valid acc : 0.932 | train f1 : 0.863 | valid f1 : 0.629

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  13%|█▎        | 26/194 [00:00<00:00, 256.09it/s][A
Evaluation : continuous disruption prediction:  28%|██▊       | 54/194 [00:00<00:00, 265.42it/s][A
Evaluation : continuous disruption prediction:  42%|████▏     | 82/194 [00:00<00:00, 270.46it/s][A
Evaluation : continuous disruption prediction:  57%|█████▋    | 110/194 [00:00<00:00, 272.79it/s][A
Evaluation : continuous disruption prediction:  71%|███████   | 138/194 [00:00<00:00, 274.72it/s][A
Evaluation : continuous disruption prediction:  86%|████████▌ | 166/194 [00:00<00:00, 275.97it/s][A
Evaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 276.14it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 273.29it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 5 out of 40
training process:  70%|██████▉   | 89/128 [2:24:36<1:06:33, 102.39s/it]EarlyStopping counter : 6 out of 40
training process:  70%|███████   | 90/128 [2:26:10<1:03:15, 99.89s/it] EarlyStopping counter : 7 out of 40
training process:  71%|███████   | 91/128 [2:27:40<59:50, 97.05s/it]  EarlyStopping counter : 8 out of 40
training process:  72%|███████▏  | 92/128 [2:29:10<56:50, 94.73s/it]| epoch : 93 | train loss : 0.001 | valid loss : 0.029 | train acc : 0.981 | valid acc : 0.937 | train f1 : 0.864 | valid f1 : 0.635

Evaluation : continuous disruption prediction:   0%|          | 0/194 [00:00<?, ?it/s][A
Evaluation : continuous disruption prediction:  16%|█▌        | 31/194 [00:00<00:00, 308.41it/s][A
Evaluation : continuous disruption prediction:  34%|███▎      | 65/194 [00:00<00:00, 323.75it/s][A
Evaluation : continuous disruption prediction:  51%|█████     | 99/194 [00:00<00:00, 328.87it/s][A
Evaluation : continuous disruption prediction:  69%|██████▊   | 133/194 [00:00<00:00, 331.25it/s][A
Evaluation : continuous disruption prediction:  86%|████████▌ | 167/194 [00:00<00:00, 330.15it/s][AEvaluation : continuous disruption prediction: 100%|██████████| 194/194 [00:00<00:00, 328.75it/s]

(Info) flat-top : 1.500(s) | thermal quench : 5.342(s) | current quench : 5.373(s)

EarlyStopping counter : 9 out of 40
training process:  73%|███████▎  | 93/128 [2:31:04<58:42, 100.65s/it]